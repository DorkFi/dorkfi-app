/* eslint-disable */
/**
 * This file was automatically generated by @algorandfoundation/algokit-client-generator.
 * DO NOT MODIFY IT BY HAND.
 * requires: @algorandfoundation/algokit-utils: ^2
 */
import * as algokit from '@algorandfoundation/algokit-utils'
import type {
  ABIAppCallArg,
  AppCallTransactionResult,
  AppCallTransactionResultOfType,
  AppCompilationResult,
  AppReference,
  AppState,
  CoreAppCallArgs,
  RawAppCallArgs,
  TealTemplateParams,
} from '@algorandfoundation/algokit-utils/types/app'
import type {
  AppClientCallCoreParams,
  AppClientCompilationParams,
  AppClientDeployCoreParams,
  AppDetails,
  ApplicationClient,
} from '@algorandfoundation/algokit-utils/types/app-client'
import type { AppSpec } from '@algorandfoundation/algokit-utils/types/app-spec'
import type { SendTransactionResult, TransactionToSign, SendTransactionFrom, SendTransactionParams } from '@algorandfoundation/algokit-utils/types/transaction'
import type { ABIResult, TransactionWithSigner } from 'algosdk'
import { Algodv2, OnApplicationComplete, Transaction, AtomicTransactionComposer, modelsv2 } from 'algosdk'
export const APP_SPEC: AppSpec = {
  "hints": {
    "post_update()void": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "get_owner()address": {
      "read_only": true,
      "call_config": {
        "no_op": "CALL"
      }
    },
    "transfer_ownership(address)void": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "is_paused()bool": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "pause(uint64)void": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "get_stoken_app_id()uint64": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "set_stoken_app_id(uint64)void": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "get_user(address,uint64)(uint256,uint256,uint256,uint256,uint64,uint256)": {
      "call_config": {
        "no_op": "CALL"
      },
      "structs": {
        "output": {
          "name": "UserData",
          "elements": [
            [
              "scaled_deposits",
              "uint256"
            ],
            [
              "scaled_borrows",
              "uint256"
            ],
            [
              "deposit_index",
              "uint256"
            ],
            [
              "borrow_index",
              "uint256"
            ],
            [
              "last_update_time",
              "uint64"
            ],
            [
              "last_price",
              "uint256"
            ]
          ]
        }
      }
    },
    "create_market(uint64,uint64,uint64,uint64,uint64,uint64,uint256,uint256,uint64,uint64)uint64": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "create_market_cost()uint64": {
      "read_only": true,
      "call_config": {
        "no_op": "CALL"
      }
    },
    "get_market(uint64)(bool,uint256,uint256,uint64,uint64,uint64,uint64,uint64,uint64,uint256,uint256,uint256,uint256,uint64,uint256,uint256,uint64,uint64)": {
      "read_only": true,
      "call_config": {
        "no_op": "CALL"
      },
      "structs": {
        "output": {
          "name": "MarketData",
          "elements": [
            [
              "paused",
              "bool"
            ],
            [
              "max_total_deposits",
              "uint256"
            ],
            [
              "max_total_borrows",
              "uint256"
            ],
            [
              "liquidation_bonus",
              "uint64"
            ],
            [
              "collateral_factor",
              "uint64"
            ],
            [
              "liquidation_threshold",
              "uint64"
            ],
            [
              "reserve_factor",
              "uint64"
            ],
            [
              "borrow_rate",
              "uint64"
            ],
            [
              "slope",
              "uint64"
            ],
            [
              "total_scaled_deposits",
              "uint256"
            ],
            [
              "total_scaled_borrows",
              "uint256"
            ],
            [
              "deposit_index",
              "uint256"
            ],
            [
              "borrow_index",
              "uint256"
            ],
            [
              "last_update_time",
              "uint64"
            ],
            [
              "reserves",
              "uint256"
            ],
            [
              "price",
              "uint256"
            ],
            [
              "ntoken_id",
              "uint64"
            ],
            [
              "close_factor",
              "uint64"
            ]
          ]
        }
      }
    },
    "get_market_price(uint64)uint256": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "get_market_ntoken_id(uint64)uint64": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "set_market_price(uint64,uint256)void": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "pause_market(uint64,uint64)void": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "deposit(uint64,uint256)void": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "withdraw(uint64,uint256)void": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "borrow(uint64,uint256)void": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "get_scaled_repay_amount(uint64,uint256)uint256": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "repay(uint64,uint256)void": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "redeem(uint64,uint256)void": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "mint(uint64,uint256)void": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "sync_user_market_for_price_change(address,uint64)void": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "get_global_user(address)(uint256,uint256,uint64)": {
      "call_config": {
        "no_op": "CALL"
      },
      "structs": {
        "output": {
          "name": "GlobalUserData",
          "elements": [
            [
              "total_collateral_value",
              "uint256"
            ],
            [
              "total_borrow_value",
              "uint256"
            ],
            [
              "last_update_time",
              "uint64"
            ]
          ]
        }
      }
    },
    "get_global_user_collateral(address)uint256": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "get_global_user_health(address,uint64)uint256": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "liquidate_cross_market(uint64,uint64,address,uint256)void": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "calculate_cross_market_liquidation_amounts(uint64,uint64,address,uint256)uint256[3]": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "set_version(uint64,uint64)void": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "grant_upgrader(address)void": {
      "call_config": {
        "no_op": "CALL"
      }
    },
    "approve_update(bool)void": {
      "call_config": {
        "no_op": "CALL"
      }
    }
  },
  "source": {
    "approval": "I3ByYWdtYSB2ZXJzaW9uIDEwCgpjb250cmFjdC5Eb3JrRmlMZW5kaW5nUG9vbC5hcHByb3ZhbF9wcm9ncmFtOgogICAgdHhuIEFwcGxpY2F0aW9uSUQKICAgIGJueiBtYWluX2VudHJ5cG9pbnRAMgogICAgY2FsbHN1YiBfX2luaXRfXwoKbWFpbl9lbnRyeXBvaW50QDI6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjIwOTgKICAgIC8vIGNsYXNzIERvcmtGaUxlbmRpbmdQb29sKExlbmRpbmdQb29sLCBVcGdyYWRlYWJsZSk6CiAgICB0eG4gTnVtQXBwQXJncwogICAgYnogbWFpbl9iYXJlX3JvdXRpbmdAMzcKICAgIG1ldGhvZCAicG9zdF91cGRhdGUoKXZvaWQiCiAgICBtZXRob2QgImdldF9vd25lcigpYWRkcmVzcyIKICAgIG1ldGhvZCAidHJhbnNmZXJfb3duZXJzaGlwKGFkZHJlc3Mpdm9pZCIKICAgIG1ldGhvZCAiaXNfcGF1c2VkKClib29sIgogICAgbWV0aG9kICJwYXVzZSh1aW50NjQpdm9pZCIKICAgIG1ldGhvZCAiZ2V0X3N0b2tlbl9hcHBfaWQoKXVpbnQ2NCIKICAgIG1ldGhvZCAic2V0X3N0b2tlbl9hcHBfaWQodWludDY0KXZvaWQiCiAgICBtZXRob2QgImdldF91c2VyKGFkZHJlc3MsdWludDY0KSh1aW50MjU2LHVpbnQyNTYsdWludDI1Nix1aW50MjU2LHVpbnQ2NCx1aW50MjU2KSIKICAgIG1ldGhvZCAiY3JlYXRlX21hcmtldCh1aW50NjQsdWludDY0LHVpbnQ2NCx1aW50NjQsdWludDY0LHVpbnQ2NCx1aW50MjU2LHVpbnQyNTYsdWludDY0LHVpbnQ2NCl1aW50NjQiCiAgICBtZXRob2QgImNyZWF0ZV9tYXJrZXRfY29zdCgpdWludDY0IgogICAgbWV0aG9kICJnZXRfbWFya2V0KHVpbnQ2NCkoYm9vbCx1aW50MjU2LHVpbnQyNTYsdWludDY0LHVpbnQ2NCx1aW50NjQsdWludDY0LHVpbnQ2NCx1aW50NjQsdWludDI1Nix1aW50MjU2LHVpbnQyNTYsdWludDI1Nix1aW50NjQsdWludDI1Nix1aW50MjU2LHVpbnQ2NCx1aW50NjQpIgogICAgbWV0aG9kICJnZXRfbWFya2V0X3ByaWNlKHVpbnQ2NCl1aW50MjU2IgogICAgbWV0aG9kICJnZXRfbWFya2V0X250b2tlbl9pZCh1aW50NjQpdWludDY0IgogICAgbWV0aG9kICJzZXRfbWFya2V0X3ByaWNlKHVpbnQ2NCx1aW50MjU2KXZvaWQiCiAgICBtZXRob2QgInBhdXNlX21hcmtldCh1aW50NjQsdWludDY0KXZvaWQiCiAgICBtZXRob2QgImRlcG9zaXQodWludDY0LHVpbnQyNTYpdm9pZCIKICAgIG1ldGhvZCAid2l0aGRyYXcodWludDY0LHVpbnQyNTYpdm9pZCIKICAgIG1ldGhvZCAiYm9ycm93KHVpbnQ2NCx1aW50MjU2KXZvaWQiCiAgICBtZXRob2QgImdldF9zY2FsZWRfcmVwYXlfYW1vdW50KHVpbnQ2NCx1aW50MjU2KXVpbnQyNTYiCiAgICBtZXRob2QgInJlcGF5KHVpbnQ2NCx1aW50MjU2KXZvaWQiCiAgICBtZXRob2QgInJlZGVlbSh1aW50NjQsdWludDI1Nil2b2lkIgogICAgbWV0aG9kICJtaW50KHVpbnQ2NCx1aW50MjU2KXZvaWQiCiAgICBtZXRob2QgInN5bmNfdXNlcl9tYXJrZXRfZm9yX3ByaWNlX2NoYW5nZShhZGRyZXNzLHVpbnQ2NCl2b2lkIgogICAgbWV0aG9kICJnZXRfZ2xvYmFsX3VzZXIoYWRkcmVzcykodWludDI1Nix1aW50MjU2LHVpbnQ2NCkiCiAgICBtZXRob2QgImdldF9nbG9iYWxfdXNlcl9jb2xsYXRlcmFsKGFkZHJlc3MpdWludDI1NiIKICAgIG1ldGhvZCAiZ2V0X2dsb2JhbF91c2VyX2hlYWx0aChhZGRyZXNzLHVpbnQ2NCl1aW50MjU2IgogICAgbWV0aG9kICJsaXF1aWRhdGVfY3Jvc3NfbWFya2V0KHVpbnQ2NCx1aW50NjQsYWRkcmVzcyx1aW50MjU2KXZvaWQiCiAgICBtZXRob2QgImNhbGN1bGF0ZV9jcm9zc19tYXJrZXRfbGlxdWlkYXRpb25fYW1vdW50cyh1aW50NjQsdWludDY0LGFkZHJlc3MsdWludDI1Nil1aW50MjU2WzNdIgogICAgbWV0aG9kICJzZXRfdmVyc2lvbih1aW50NjQsdWludDY0KXZvaWQiCiAgICBtZXRob2QgImdyYW50X3VwZ3JhZGVyKGFkZHJlc3Mpdm9pZCIKICAgIG1ldGhvZCAiYXBwcm92ZV91cGRhdGUoYm9vbCl2b2lkIgogICAgdHhuYSBBcHBsaWNhdGlvbkFyZ3MgMAogICAgbWF0Y2ggbWFpbl9wb3N0X3VwZGF0ZV9yb3V0ZUA0IG1haW5fZ2V0X293bmVyX3JvdXRlQDUgbWFpbl90cmFuc2Zlcl9vd25lcnNoaXBfcm91dGVANiBtYWluX2lzX3BhdXNlZF9yb3V0ZUA3IG1haW5fcGF1c2Vfcm91dGVAOCBtYWluX2dldF9zdG9rZW5fYXBwX2lkX3JvdXRlQDkgbWFpbl9zZXRfc3Rva2VuX2FwcF9pZF9yb3V0ZUAxMCBtYWluX2dldF91c2VyX3JvdXRlQDExIG1haW5fY3JlYXRlX21hcmtldF9yb3V0ZUAxMiBtYWluX2NyZWF0ZV9tYXJrZXRfY29zdF9yb3V0ZUAxMyBtYWluX2dldF9tYXJrZXRfcm91dGVAMTQgbWFpbl9nZXRfbWFya2V0X3ByaWNlX3JvdXRlQDE1IG1haW5fZ2V0X21hcmtldF9udG9rZW5faWRfcm91dGVAMTYgbWFpbl9zZXRfbWFya2V0X3ByaWNlX3JvdXRlQDE3IG1haW5fcGF1c2VfbWFya2V0X3JvdXRlQDE4IG1haW5fZGVwb3NpdF9yb3V0ZUAxOSBtYWluX3dpdGhkcmF3X3JvdXRlQDIwIG1haW5fYm9ycm93X3JvdXRlQDIxIG1haW5fZ2V0X3NjYWxlZF9yZXBheV9hbW91bnRfcm91dGVAMjIgbWFpbl9yZXBheV9yb3V0ZUAyMyBtYWluX3JlZGVlbV9yb3V0ZUAyNCBtYWluX21pbnRfcm91dGVAMjUgbWFpbl9zeW5jX3VzZXJfbWFya2V0X2Zvcl9wcmljZV9jaGFuZ2Vfcm91dGVAMjYgbWFpbl9nZXRfZ2xvYmFsX3VzZXJfcm91dGVAMjcgbWFpbl9nZXRfZ2xvYmFsX3VzZXJfY29sbGF0ZXJhbF9yb3V0ZUAyOCBtYWluX2dldF9nbG9iYWxfdXNlcl9oZWFsdGhfcm91dGVAMjkgbWFpbl9saXF1aWRhdGVfY3Jvc3NfbWFya2V0X3JvdXRlQDMwIG1haW5fY2FsY3VsYXRlX2Nyb3NzX21hcmtldF9saXF1aWRhdGlvbl9hbW91bnRzX3JvdXRlQDMxIG1haW5fc2V0X3ZlcnNpb25fcm91dGVAMzIgbWFpbl9ncmFudF91cGdyYWRlcl9yb3V0ZUAzMyBtYWluX2FwcHJvdmVfdXBkYXRlX3JvdXRlQDM0CiAgICBlcnIgLy8gcmVqZWN0IHRyYW5zYWN0aW9uCgptYWluX3Bvc3RfdXBkYXRlX3JvdXRlQDQ6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjIxMTMKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgdHhuIE9uQ29tcGxldGlvbgogICAgIQogICAgYXNzZXJ0IC8vIE9uQ29tcGxldGlvbiBpcyBOb09wCiAgICB0eG4gQXBwbGljYXRpb25JRAogICAgYXNzZXJ0IC8vIGlzIG5vdCBjcmVhdGluZwogICAgY2FsbHN1YiBwb3N0X3VwZGF0ZQogICAgaW50IDEKICAgIHJldHVybgoKbWFpbl9nZXRfb3duZXJfcm91dGVANToKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTIyCiAgICAvLyBAYXJjNC5hYmltZXRob2QocmVhZG9ubHk9VHJ1ZSkKICAgIHR4biBPbkNvbXBsZXRpb24KICAgICEKICAgIGFzc2VydCAvLyBPbkNvbXBsZXRpb24gaXMgTm9PcAogICAgdHhuIEFwcGxpY2F0aW9uSUQKICAgIGFzc2VydCAvLyBpcyBub3QgY3JlYXRpbmcKICAgIGNhbGxzdWIgZ2V0X293bmVyCiAgICBieXRlIDB4MTUxZjdjNzUKICAgIHN3YXAKICAgIGNvbmNhdAogICAgbG9nCiAgICBpbnQgMQogICAgcmV0dXJuCgptYWluX3RyYW5zZmVyX293bmVyc2hpcF9yb3V0ZUA2OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1MjYKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgdHhuIE9uQ29tcGxldGlvbgogICAgIQogICAgYXNzZXJ0IC8vIE9uQ29tcGxldGlvbiBpcyBOb09wCiAgICB0eG4gQXBwbGljYXRpb25JRAogICAgYXNzZXJ0IC8vIGlzIG5vdCBjcmVhdGluZwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToyMDk4CiAgICAvLyBjbGFzcyBEb3JrRmlMZW5kaW5nUG9vbChMZW5kaW5nUG9vbCwgVXBncmFkZWFibGUpOgogICAgdHhuYSBBcHBsaWNhdGlvbkFyZ3MgMQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1MjYKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgY2FsbHN1YiB0cmFuc2Zlcl9vd25lcnNoaXAKICAgIGludCAxCiAgICByZXR1cm4KCm1haW5faXNfcGF1c2VkX3JvdXRlQDc6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjU0MwogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICB0eG4gT25Db21wbGV0aW9uCiAgICAhCiAgICBhc3NlcnQgLy8gT25Db21wbGV0aW9uIGlzIE5vT3AKICAgIHR4biBBcHBsaWNhdGlvbklECiAgICBhc3NlcnQgLy8gaXMgbm90IGNyZWF0aW5nCiAgICBjYWxsc3ViIGlzX3BhdXNlZAogICAgYnl0ZSAweDE1MWY3Yzc1CiAgICBzd2FwCiAgICBjb25jYXQKICAgIGxvZwogICAgaW50IDEKICAgIHJldHVybgoKbWFpbl9wYXVzZV9yb3V0ZUA4OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1NTEKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgdHhuIE9uQ29tcGxldGlvbgogICAgIQogICAgYXNzZXJ0IC8vIE9uQ29tcGxldGlvbiBpcyBOb09wCiAgICB0eG4gQXBwbGljYXRpb25JRAogICAgYXNzZXJ0IC8vIGlzIG5vdCBjcmVhdGluZwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToyMDk4CiAgICAvLyBjbGFzcyBEb3JrRmlMZW5kaW5nUG9vbChMZW5kaW5nUG9vbCwgVXBncmFkZWFibGUpOgogICAgdHhuYSBBcHBsaWNhdGlvbkFyZ3MgMQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1NTEKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgY2FsbHN1YiBwYXVzZQogICAgaW50IDEKICAgIHJldHVybgoKbWFpbl9nZXRfc3Rva2VuX2FwcF9pZF9yb3V0ZUA5OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1NjIKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgdHhuIE9uQ29tcGxldGlvbgogICAgIQogICAgYXNzZXJ0IC8vIE9uQ29tcGxldGlvbiBpcyBOb09wCiAgICB0eG4gQXBwbGljYXRpb25JRAogICAgYXNzZXJ0IC8vIGlzIG5vdCBjcmVhdGluZwogICAgY2FsbHN1YiBnZXRfc3Rva2VuX2FwcF9pZAogICAgYnl0ZSAweDE1MWY3Yzc1CiAgICBzd2FwCiAgICBjb25jYXQKICAgIGxvZwogICAgaW50IDEKICAgIHJldHVybgoKbWFpbl9zZXRfc3Rva2VuX2FwcF9pZF9yb3V0ZUAxMDoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTcwCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIHR4biBPbkNvbXBsZXRpb24KICAgICEKICAgIGFzc2VydCAvLyBPbkNvbXBsZXRpb24gaXMgTm9PcAogICAgdHhuIEFwcGxpY2F0aW9uSUQKICAgIGFzc2VydCAvLyBpcyBub3QgY3JlYXRpbmcKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MjA5OAogICAgLy8gY2xhc3MgRG9ya0ZpTGVuZGluZ1Bvb2woTGVuZGluZ1Bvb2wsIFVwZ3JhZGVhYmxlKToKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDEKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTcwCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIGNhbGxzdWIgc2V0X3N0b2tlbl9hcHBfaWQKICAgIGludCAxCiAgICByZXR1cm4KCm1haW5fZ2V0X3VzZXJfcm91dGVAMTE6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjU4MQogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICB0eG4gT25Db21wbGV0aW9uCiAgICAhCiAgICBhc3NlcnQgLy8gT25Db21wbGV0aW9uIGlzIE5vT3AKICAgIHR4biBBcHBsaWNhdGlvbklECiAgICBhc3NlcnQgLy8gaXMgbm90IGNyZWF0aW5nCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjIwOTgKICAgIC8vIGNsYXNzIERvcmtGaUxlbmRpbmdQb29sKExlbmRpbmdQb29sLCBVcGdyYWRlYWJsZSk6CiAgICB0eG5hIEFwcGxpY2F0aW9uQXJncyAxCiAgICB0eG5hIEFwcGxpY2F0aW9uQXJncyAyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjU4MQogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICBjYWxsc3ViIGdldF91c2VyCiAgICBieXRlIDB4MTUxZjdjNzUKICAgIHN3YXAKICAgIGNvbmNhdAogICAgbG9nCiAgICBpbnQgMQogICAgcmV0dXJuCgptYWluX2NyZWF0ZV9tYXJrZXRfcm91dGVAMTI6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjY4NgogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICB0eG4gT25Db21wbGV0aW9uCiAgICAhCiAgICBhc3NlcnQgLy8gT25Db21wbGV0aW9uIGlzIE5vT3AKICAgIHR4biBBcHBsaWNhdGlvbklECiAgICBhc3NlcnQgLy8gaXMgbm90IGNyZWF0aW5nCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjIwOTgKICAgIC8vIGNsYXNzIERvcmtGaUxlbmRpbmdQb29sKExlbmRpbmdQb29sLCBVcGdyYWRlYWJsZSk6CiAgICB0eG5hIEFwcGxpY2F0aW9uQXJncyAxCiAgICB0eG5hIEFwcGxpY2F0aW9uQXJncyAyCiAgICB0eG5hIEFwcGxpY2F0aW9uQXJncyAzCiAgICB0eG5hIEFwcGxpY2F0aW9uQXJncyA0CiAgICB0eG5hIEFwcGxpY2F0aW9uQXJncyA1CiAgICB0eG5hIEFwcGxpY2F0aW9uQXJncyA2CiAgICB0eG5hIEFwcGxpY2F0aW9uQXJncyA3CiAgICB0eG5hIEFwcGxpY2F0aW9uQXJncyA4CiAgICB0eG5hIEFwcGxpY2F0aW9uQXJncyA5CiAgICB0eG5hIEFwcGxpY2F0aW9uQXJncyAxMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo2ODYKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgY2FsbHN1YiBjcmVhdGVfbWFya2V0CiAgICBieXRlIDB4MTUxZjdjNzUKICAgIHN3YXAKICAgIGNvbmNhdAogICAgbG9nCiAgICBpbnQgMQogICAgcmV0dXJuCgptYWluX2NyZWF0ZV9tYXJrZXRfY29zdF9yb3V0ZUAxMzoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NzU4CiAgICAvLyBAYXJjNC5hYmltZXRob2QocmVhZG9ubHk9VHJ1ZSkKICAgIHR4biBPbkNvbXBsZXRpb24KICAgICEKICAgIGFzc2VydCAvLyBPbkNvbXBsZXRpb24gaXMgTm9PcAogICAgdHhuIEFwcGxpY2F0aW9uSUQKICAgIGFzc2VydCAvLyBpcyBub3QgY3JlYXRpbmcKICAgIGNhbGxzdWIgY3JlYXRlX21hcmtldF9jb3N0CiAgICBieXRlIDB4MTUxZjdjNzUKICAgIHN3YXAKICAgIGNvbmNhdAogICAgbG9nCiAgICBpbnQgMQogICAgcmV0dXJuCgptYWluX2dldF9tYXJrZXRfcm91dGVAMTQ6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojc2NgogICAgLy8gQGFyYzQuYWJpbWV0aG9kKHJlYWRvbmx5PVRydWUpCiAgICB0eG4gT25Db21wbGV0aW9uCiAgICAhCiAgICBhc3NlcnQgLy8gT25Db21wbGV0aW9uIGlzIE5vT3AKICAgIHR4biBBcHBsaWNhdGlvbklECiAgICBhc3NlcnQgLy8gaXMgbm90IGNyZWF0aW5nCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjIwOTgKICAgIC8vIGNsYXNzIERvcmtGaUxlbmRpbmdQb29sKExlbmRpbmdQb29sLCBVcGdyYWRlYWJsZSk6CiAgICB0eG5hIEFwcGxpY2F0aW9uQXJncyAxCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojc2NgogICAgLy8gQGFyYzQuYWJpbWV0aG9kKHJlYWRvbmx5PVRydWUpCiAgICBjYWxsc3ViIGdldF9tYXJrZXQKICAgIGJ5dGUgMHgxNTFmN2M3NQogICAgc3dhcAogICAgY29uY2F0CiAgICBsb2cKICAgIGludCAxCiAgICByZXR1cm4KCm1haW5fZ2V0X21hcmtldF9wcmljZV9yb3V0ZUAxNToKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6Nzk2CiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIHR4biBPbkNvbXBsZXRpb24KICAgICEKICAgIGFzc2VydCAvLyBPbkNvbXBsZXRpb24gaXMgTm9PcAogICAgdHhuIEFwcGxpY2F0aW9uSUQKICAgIGFzc2VydCAvLyBpcyBub3QgY3JlYXRpbmcKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MjA5OAogICAgLy8gY2xhc3MgRG9ya0ZpTGVuZGluZ1Bvb2woTGVuZGluZ1Bvb2wsIFVwZ3JhZGVhYmxlKToKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDEKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6Nzk2CiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIGNhbGxzdWIgZ2V0X21hcmtldF9wcmljZQogICAgYnl0ZSAweDE1MWY3Yzc1CiAgICBzd2FwCiAgICBjb25jYXQKICAgIGxvZwogICAgaW50IDEKICAgIHJldHVybgoKbWFpbl9nZXRfbWFya2V0X250b2tlbl9pZF9yb3V0ZUAxNjoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODAxCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIHR4biBPbkNvbXBsZXRpb24KICAgICEKICAgIGFzc2VydCAvLyBPbkNvbXBsZXRpb24gaXMgTm9PcAogICAgdHhuIEFwcGxpY2F0aW9uSUQKICAgIGFzc2VydCAvLyBpcyBub3QgY3JlYXRpbmcKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MjA5OAogICAgLy8gY2xhc3MgRG9ya0ZpTGVuZGluZ1Bvb2woTGVuZGluZ1Bvb2wsIFVwZ3JhZGVhYmxlKToKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDEKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODAxCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIGNhbGxzdWIgZ2V0X21hcmtldF9udG9rZW5faWQKICAgIGJ5dGUgMHgxNTFmN2M3NQogICAgc3dhcAogICAgY29uY2F0CiAgICBsb2cKICAgIGludCAxCiAgICByZXR1cm4KCm1haW5fc2V0X21hcmtldF9wcmljZV9yb3V0ZUAxNzoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODA2CiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIHR4biBPbkNvbXBsZXRpb24KICAgICEKICAgIGFzc2VydCAvLyBPbkNvbXBsZXRpb24gaXMgTm9PcAogICAgdHhuIEFwcGxpY2F0aW9uSUQKICAgIGFzc2VydCAvLyBpcyBub3QgY3JlYXRpbmcKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MjA5OAogICAgLy8gY2xhc3MgRG9ya0ZpTGVuZGluZ1Bvb2woTGVuZGluZ1Bvb2wsIFVwZ3JhZGVhYmxlKToKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDEKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODA2CiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIGNhbGxzdWIgc2V0X21hcmtldF9wcmljZQogICAgaW50IDEKICAgIHJldHVybgoKbWFpbl9wYXVzZV9tYXJrZXRfcm91dGVAMTg6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojg3NgogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICB0eG4gT25Db21wbGV0aW9uCiAgICAhCiAgICBhc3NlcnQgLy8gT25Db21wbGV0aW9uIGlzIE5vT3AKICAgIHR4biBBcHBsaWNhdGlvbklECiAgICBhc3NlcnQgLy8gaXMgbm90IGNyZWF0aW5nCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjIwOTgKICAgIC8vIGNsYXNzIERvcmtGaUxlbmRpbmdQb29sKExlbmRpbmdQb29sLCBVcGdyYWRlYWJsZSk6CiAgICB0eG5hIEFwcGxpY2F0aW9uQXJncyAxCiAgICB0eG5hIEFwcGxpY2F0aW9uQXJncyAyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojg3NgogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICBjYWxsc3ViIHBhdXNlX21hcmtldAogICAgaW50IDEKICAgIHJldHVybgoKbWFpbl9kZXBvc2l0X3JvdXRlQDE5OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5NjQKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgdHhuIE9uQ29tcGxldGlvbgogICAgIQogICAgYXNzZXJ0IC8vIE9uQ29tcGxldGlvbiBpcyBOb09wCiAgICB0eG4gQXBwbGljYXRpb25JRAogICAgYXNzZXJ0IC8vIGlzIG5vdCBjcmVhdGluZwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToyMDk4CiAgICAvLyBjbGFzcyBEb3JrRmlMZW5kaW5nUG9vbChMZW5kaW5nUG9vbCwgVXBncmFkZWFibGUpOgogICAgdHhuYSBBcHBsaWNhdGlvbkFyZ3MgMQogICAgdHhuYSBBcHBsaWNhdGlvbkFyZ3MgMgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5NjQKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgY2FsbHN1YiBkZXBvc2l0CiAgICBpbnQgMQogICAgcmV0dXJuCgptYWluX3dpdGhkcmF3X3JvdXRlQDIwOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDI3CiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIHR4biBPbkNvbXBsZXRpb24KICAgICEKICAgIGFzc2VydCAvLyBPbkNvbXBsZXRpb24gaXMgTm9PcAogICAgdHhuIEFwcGxpY2F0aW9uSUQKICAgIGFzc2VydCAvLyBpcyBub3QgY3JlYXRpbmcKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MjA5OAogICAgLy8gY2xhc3MgRG9ya0ZpTGVuZGluZ1Bvb2woTGVuZGluZ1Bvb2wsIFVwZ3JhZGVhYmxlKToKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDEKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTAyNwogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICBjYWxsc3ViIHdpdGhkcmF3CiAgICBpbnQgMQogICAgcmV0dXJuCgptYWluX2JvcnJvd19yb3V0ZUAyMToKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTExMAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICB0eG4gT25Db21wbGV0aW9uCiAgICAhCiAgICBhc3NlcnQgLy8gT25Db21wbGV0aW9uIGlzIE5vT3AKICAgIHR4biBBcHBsaWNhdGlvbklECiAgICBhc3NlcnQgLy8gaXMgbm90IGNyZWF0aW5nCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjIwOTgKICAgIC8vIGNsYXNzIERvcmtGaUxlbmRpbmdQb29sKExlbmRpbmdQb29sLCBVcGdyYWRlYWJsZSk6CiAgICB0eG5hIEFwcGxpY2F0aW9uQXJncyAxCiAgICB0eG5hIEFwcGxpY2F0aW9uQXJncyAyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExMTAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgY2FsbHN1YiBib3Jyb3cKICAgIGludCAxCiAgICByZXR1cm4KCm1haW5fZ2V0X3NjYWxlZF9yZXBheV9hbW91bnRfcm91dGVAMjI6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExOTEKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgdHhuIE9uQ29tcGxldGlvbgogICAgIQogICAgYXNzZXJ0IC8vIE9uQ29tcGxldGlvbiBpcyBOb09wCiAgICB0eG4gQXBwbGljYXRpb25JRAogICAgYXNzZXJ0IC8vIGlzIG5vdCBjcmVhdGluZwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToyMDk4CiAgICAvLyBjbGFzcyBEb3JrRmlMZW5kaW5nUG9vbChMZW5kaW5nUG9vbCwgVXBncmFkZWFibGUpOgogICAgdHhuYSBBcHBsaWNhdGlvbkFyZ3MgMQogICAgdHhuYSBBcHBsaWNhdGlvbkFyZ3MgMgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMTkxCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIGNhbGxzdWIgZ2V0X3NjYWxlZF9yZXBheV9hbW91bnQKICAgIGJ5dGUgMHgxNTFmN2M3NQogICAgc3dhcAogICAgY29uY2F0CiAgICBsb2cKICAgIGludCAxCiAgICByZXR1cm4KCm1haW5fcmVwYXlfcm91dGVAMjM6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyMDQKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgdHhuIE9uQ29tcGxldGlvbgogICAgIQogICAgYXNzZXJ0IC8vIE9uQ29tcGxldGlvbiBpcyBOb09wCiAgICB0eG4gQXBwbGljYXRpb25JRAogICAgYXNzZXJ0IC8vIGlzIG5vdCBjcmVhdGluZwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToyMDk4CiAgICAvLyBjbGFzcyBEb3JrRmlMZW5kaW5nUG9vbChMZW5kaW5nUG9vbCwgVXBncmFkZWFibGUpOgogICAgdHhuYSBBcHBsaWNhdGlvbkFyZ3MgMQogICAgdHhuYSBBcHBsaWNhdGlvbkFyZ3MgMgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjA0CiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIGNhbGxzdWIgcmVwYXkKICAgIGludCAxCiAgICByZXR1cm4KCm1haW5fcmVkZWVtX3JvdXRlQDI0OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjY0CiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIHR4biBPbkNvbXBsZXRpb24KICAgICEKICAgIGFzc2VydCAvLyBPbkNvbXBsZXRpb24gaXMgTm9PcAogICAgdHhuIEFwcGxpY2F0aW9uSUQKICAgIGFzc2VydCAvLyBpcyBub3QgY3JlYXRpbmcKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MjA5OAogICAgLy8gY2xhc3MgRG9ya0ZpTGVuZGluZ1Bvb2woTGVuZGluZ1Bvb2wsIFVwZ3JhZGVhYmxlKToKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDEKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTI2NAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICBjYWxsc3ViIHJlZGVlbQogICAgaW50IDEKICAgIHJldHVybgoKbWFpbl9taW50X3JvdXRlQDI1OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjk5CiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIHR4biBPbkNvbXBsZXRpb24KICAgICEKICAgIGFzc2VydCAvLyBPbkNvbXBsZXRpb24gaXMgTm9PcAogICAgdHhuIEFwcGxpY2F0aW9uSUQKICAgIGFzc2VydCAvLyBpcyBub3QgY3JlYXRpbmcKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MjA5OAogICAgLy8gY2xhc3MgRG9ya0ZpTGVuZGluZ1Bvb2woTGVuZGluZ1Bvb2wsIFVwZ3JhZGVhYmxlKToKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDEKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTI5OQogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICBjYWxsc3ViIG1pbnQKICAgIGludCAxCiAgICByZXR1cm4KCm1haW5fc3luY191c2VyX21hcmtldF9mb3JfcHJpY2VfY2hhbmdlX3JvdXRlQDI2OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMzQ3CiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIHR4biBPbkNvbXBsZXRpb24KICAgICEKICAgIGFzc2VydCAvLyBPbkNvbXBsZXRpb24gaXMgTm9PcAogICAgdHhuIEFwcGxpY2F0aW9uSUQKICAgIGFzc2VydCAvLyBpcyBub3QgY3JlYXRpbmcKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MjA5OAogICAgLy8gY2xhc3MgRG9ya0ZpTGVuZGluZ1Bvb2woTGVuZGluZ1Bvb2wsIFVwZ3JhZGVhYmxlKToKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDEKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTM0NwogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICBjYWxsc3ViIHN5bmNfdXNlcl9tYXJrZXRfZm9yX3ByaWNlX2NoYW5nZQogICAgaW50IDEKICAgIHJldHVybgoKbWFpbl9nZXRfZ2xvYmFsX3VzZXJfcm91dGVAMjc6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE0MDMKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgdHhuIE9uQ29tcGxldGlvbgogICAgIQogICAgYXNzZXJ0IC8vIE9uQ29tcGxldGlvbiBpcyBOb09wCiAgICB0eG4gQXBwbGljYXRpb25JRAogICAgYXNzZXJ0IC8vIGlzIG5vdCBjcmVhdGluZwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToyMDk4CiAgICAvLyBjbGFzcyBEb3JrRmlMZW5kaW5nUG9vbChMZW5kaW5nUG9vbCwgVXBncmFkZWFibGUpOgogICAgdHhuYSBBcHBsaWNhdGlvbkFyZ3MgMQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNDAzCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIGNhbGxzdWIgZ2V0X2dsb2JhbF91c2VyCiAgICBieXRlIDB4MTUxZjdjNzUKICAgIHN3YXAKICAgIGNvbmNhdAogICAgbG9nCiAgICBpbnQgMQogICAgcmV0dXJuCgptYWluX2dldF9nbG9iYWxfdXNlcl9jb2xsYXRlcmFsX3JvdXRlQDI4OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNDA3CiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIHR4biBPbkNvbXBsZXRpb24KICAgICEKICAgIGFzc2VydCAvLyBPbkNvbXBsZXRpb24gaXMgTm9PcAogICAgdHhuIEFwcGxpY2F0aW9uSUQKICAgIGFzc2VydCAvLyBpcyBub3QgY3JlYXRpbmcKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MjA5OAogICAgLy8gY2xhc3MgRG9ya0ZpTGVuZGluZ1Bvb2woTGVuZGluZ1Bvb2wsIFVwZ3JhZGVhYmxlKToKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDEKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTQwNwogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICBjYWxsc3ViIGdldF9nbG9iYWxfdXNlcl9jb2xsYXRlcmFsCiAgICBieXRlIDB4MTUxZjdjNzUKICAgIHN3YXAKICAgIGNvbmNhdAogICAgbG9nCiAgICBpbnQgMQogICAgcmV0dXJuCgptYWluX2dldF9nbG9iYWxfdXNlcl9oZWFsdGhfcm91dGVAMjk6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE0NTcKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgdHhuIE9uQ29tcGxldGlvbgogICAgIQogICAgYXNzZXJ0IC8vIE9uQ29tcGxldGlvbiBpcyBOb09wCiAgICB0eG4gQXBwbGljYXRpb25JRAogICAgYXNzZXJ0IC8vIGlzIG5vdCBjcmVhdGluZwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToyMDk4CiAgICAvLyBjbGFzcyBEb3JrRmlMZW5kaW5nUG9vbChMZW5kaW5nUG9vbCwgVXBncmFkZWFibGUpOgogICAgdHhuYSBBcHBsaWNhdGlvbkFyZ3MgMQogICAgdHhuYSBBcHBsaWNhdGlvbkFyZ3MgMgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNDU3CiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIGNhbGxzdWIgZ2V0X2dsb2JhbF91c2VyX2hlYWx0aAogICAgYnl0ZSAweDE1MWY3Yzc1CiAgICBzd2FwCiAgICBjb25jYXQKICAgIGxvZwogICAgaW50IDEKICAgIHJldHVybgoKbWFpbl9saXF1aWRhdGVfY3Jvc3NfbWFya2V0X3JvdXRlQDMwOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNDg1CiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIHR4biBPbkNvbXBsZXRpb24KICAgICEKICAgIGFzc2VydCAvLyBPbkNvbXBsZXRpb24gaXMgTm9PcAogICAgdHhuIEFwcGxpY2F0aW9uSUQKICAgIGFzc2VydCAvLyBpcyBub3QgY3JlYXRpbmcKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MjA5OAogICAgLy8gY2xhc3MgRG9ya0ZpTGVuZGluZ1Bvb2woTGVuZGluZ1Bvb2wsIFVwZ3JhZGVhYmxlKToKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDEKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDIKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDMKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTQ4NQogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICBjYWxsc3ViIGxpcXVpZGF0ZV9jcm9zc19tYXJrZXQKICAgIGludCAxCiAgICByZXR1cm4KCm1haW5fY2FsY3VsYXRlX2Nyb3NzX21hcmtldF9saXF1aWRhdGlvbl9hbW91bnRzX3JvdXRlQDMxOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNjQ2CiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIHR4biBPbkNvbXBsZXRpb24KICAgICEKICAgIGFzc2VydCAvLyBPbkNvbXBsZXRpb24gaXMgTm9PcAogICAgdHhuIEFwcGxpY2F0aW9uSUQKICAgIGFzc2VydCAvLyBpcyBub3QgY3JlYXRpbmcKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MjA5OAogICAgLy8gY2xhc3MgRG9ya0ZpTGVuZGluZ1Bvb2woTGVuZGluZ1Bvb2wsIFVwZ3JhZGVhYmxlKToKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDEKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDIKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDMKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTY0NgogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICBjYWxsc3ViIGNhbGN1bGF0ZV9jcm9zc19tYXJrZXRfbGlxdWlkYXRpb25fYW1vdW50cwogICAgYnl0ZSAweDE1MWY3Yzc1CiAgICBzd2FwCiAgICBjb25jYXQKICAgIGxvZwogICAgaW50IDEKICAgIHJldHVybgoKbWFpbl9zZXRfdmVyc2lvbl9yb3V0ZUAzMjoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTAyCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIHR4biBPbkNvbXBsZXRpb24KICAgICEKICAgIGFzc2VydCAvLyBPbkNvbXBsZXRpb24gaXMgTm9PcAogICAgdHhuIEFwcGxpY2F0aW9uSUQKICAgIGFzc2VydCAvLyBpcyBub3QgY3JlYXRpbmcKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MjA5OAogICAgLy8gY2xhc3MgRG9ya0ZpTGVuZGluZ1Bvb2woTGVuZGluZ1Bvb2wsIFVwZ3JhZGVhYmxlKToKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDEKICAgIHR4bmEgQXBwbGljYXRpb25BcmdzIDIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTAyCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIGNhbGxzdWIgc2V0X3ZlcnNpb24KICAgIGludCAxCiAgICByZXR1cm4KCm1haW5fZ3JhbnRfdXBncmFkZXJfcm91dGVAMzM6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyNgogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICB0eG4gT25Db21wbGV0aW9uCiAgICAhCiAgICBhc3NlcnQgLy8gT25Db21wbGV0aW9uIGlzIE5vT3AKICAgIHR4biBBcHBsaWNhdGlvbklECiAgICBhc3NlcnQgLy8gaXMgbm90IGNyZWF0aW5nCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjIwOTgKICAgIC8vIGNsYXNzIERvcmtGaUxlbmRpbmdQb29sKExlbmRpbmdQb29sLCBVcGdyYWRlYWJsZSk6CiAgICB0eG5hIEFwcGxpY2F0aW9uQXJncyAxCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyNgogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICBjYWxsc3ViIGdyYW50X3VwZ3JhZGVyCiAgICBpbnQgMQogICAgcmV0dXJuCgptYWluX2FwcHJvdmVfdXBkYXRlX3JvdXRlQDM0OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo3OQogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICB0eG4gT25Db21wbGV0aW9uCiAgICAhCiAgICBhc3NlcnQgLy8gT25Db21wbGV0aW9uIGlzIE5vT3AKICAgIHR4biBBcHBsaWNhdGlvbklECiAgICBhc3NlcnQgLy8gaXMgbm90IGNyZWF0aW5nCiAgICBpbnQgMQogICAgcmV0dXJuCgptYWluX2JhcmVfcm91dGluZ0AzNzoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MjA5OAogICAgLy8gY2xhc3MgRG9ya0ZpTGVuZGluZ1Bvb2woTGVuZGluZ1Bvb2wsIFVwZ3JhZGVhYmxlKToKICAgIGludCAwCiAgICBpbnQgNAogICAgdHhuIE9uQ29tcGxldGlvbgogICAgbWF0Y2ggbWFpbl9jcmVhdGVAMzggbWFpbl9vbl91cGRhdGVAMzkKICAgIGVyciAvLyByZWplY3QgdHJhbnNhY3Rpb24KCm1haW5fY3JlYXRlQDM4OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToyMDk4CiAgICAvLyBjbGFzcyBEb3JrRmlMZW5kaW5nUG9vbChMZW5kaW5nUG9vbCwgVXBncmFkZWFibGUpOgogICAgdHhuIEFwcGxpY2F0aW9uSUQKICAgICEKICAgIGFzc2VydCAvLyBpcyBjcmVhdGluZwogICAgaW50IDEKICAgIHJldHVybgoKbWFpbl9vbl91cGRhdGVAMzk6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExMAogICAgLy8gQGFyYzQuYmFyZW1ldGhvZChhbGxvd19hY3Rpb25zPVsiVXBkYXRlQXBwbGljYXRpb24iXSkKICAgIHR4biBBcHBsaWNhdGlvbklECiAgICBhc3NlcnQgLy8gaXMgbm90IGNyZWF0aW5nCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExMC0xMTEKICAgIC8vIEBhcmM0LmJhcmVtZXRob2QoYWxsb3dfYWN0aW9ucz1bIlVwZGF0ZUFwcGxpY2F0aW9uIl0pCiAgICAvLyBkZWYgb25fdXBkYXRlKHNlbGYpIC0+IE5vbmU6CiAgICBjYWxsc3ViIG9uX3VwZGF0ZQogICAgaW50IDEKICAgIHJldHVybgoKCi8vIGNvbnRyYWN0LkRvcmtGaUxlbmRpbmdQb29sLnBvc3RfdXBkYXRlKCkgLT4gdm9pZDoKcG9zdF91cGRhdGU6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjIxMTMtMjExNAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgcG9zdF91cGRhdGUoc2VsZikgLT4gTm9uZToKICAgIHByb3RvIDAgMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToyMTE1CiAgICAvLyBhc3NlcnQgVHhuLnNlbmRlciA9PSBzZWxmLnVwZ3JhZGVyLCAibXVzdCBiZSB1cGdyYWRlciIKICAgIHR4biBTZW5kZXIKICAgIGludCAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjYxCiAgICAvLyBzZWxmLnVwZ3JhZGVyID0gQWNjb3VudCgpCiAgICBieXRlICJ1cGdyYWRlciIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MjExNQogICAgLy8gYXNzZXJ0IFR4bi5zZW5kZXIgPT0gc2VsZi51cGdyYWRlciwgIm11c3QgYmUgdXBncmFkZXIiCiAgICBhcHBfZ2xvYmFsX2dldF9leAogICAgYXNzZXJ0IC8vIGNoZWNrIHNlbGYudXBncmFkZXIgZXhpc3RzCiAgICA9PQogICAgYXNzZXJ0IC8vIG11c3QgYmUgdXBncmFkZXIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTgKICAgIC8vIHNlbGYuY29udHJhY3RfdmVyc2lvbiA9IFVJbnQ2NCgpCiAgICBieXRlICJjb250cmFjdF92ZXJzaW9uIgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToyMTE2CiAgICAvLyBzZWxmLmNvbnRyYWN0X3ZlcnNpb24gPSBVSW50NjQoMCkKICAgIGludCAwCiAgICBhcHBfZ2xvYmFsX3B1dAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1OQogICAgLy8gc2VsZi5kZXBsb3ltZW50X3ZlcnNpb24gPSBVSW50NjQoKQogICAgYnl0ZSAiZGVwbG95bWVudF92ZXJzaW9uIgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToyMTE3CiAgICAvLyBzZWxmLmRlcGxveW1lbnRfdmVyc2lvbiA9IFVJbnQ2NCgxKQogICAgaW50IDEKICAgIGFwcF9nbG9iYWxfcHV0CiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5nZXRfb3duZXIoKSAtPiBieXRlczoKZ2V0X293bmVyOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1MjItNTIzCiAgICAvLyBAYXJjNC5hYmltZXRob2QocmVhZG9ubHk9VHJ1ZSkKICAgIC8vIGRlZiBnZXRfb3duZXIoc2VsZikgLT4gYXJjNC5BZGRyZXNzOgogICAgcHJvdG8gMCAxCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjUyNAogICAgLy8gcmV0dXJuIGFyYzQuQWRkcmVzcyhzZWxmLm93bmVyKQogICAgaW50IDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTA2CiAgICAvLyBzZWxmLm93bmVyID0gQWNjb3VudCgpCiAgICBieXRlICJvd25lciIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTI0CiAgICAvLyByZXR1cm4gYXJjNC5BZGRyZXNzKHNlbGYub3duZXIpCiAgICBhcHBfZ2xvYmFsX2dldF9leAogICAgYXNzZXJ0IC8vIGNoZWNrIHNlbGYub3duZXIgZXhpc3RzCiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC50cmFuc2Zlcl9vd25lcnNoaXAobmV3X293bmVyOiBieXRlcykgLT4gdm9pZDoKdHJhbnNmZXJfb3duZXJzaGlwOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1MjYtNTI3CiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiB0cmFuc2Zlcl9vd25lcnNoaXAoc2VsZiwgbmV3X293bmVyOiBhcmM0LkFkZHJlc3MpIC0+IE5vbmU6CiAgICBwcm90byAxIDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTI4CiAgICAvLyBzZWxmLl9vbmx5X293bmVyKCkKICAgIGNhbGxzdWIgX29ubHlfb3duZXIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTI5CiAgICAvLyBzZWxmLl90cmFuc2Zlcl9vd25lcnNoaXAobmV3X293bmVyLm5hdGl2ZSkKICAgIGZyYW1lX2RpZyAtMQogICAgY2FsbHN1YiBfdHJhbnNmZXJfb3duZXJzaGlwCiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5fb25seV9vd25lcigpIC0+IHZvaWQ6Cl9vbmx5X293bmVyOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1MTgtNTE5CiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9vbmx5X293bmVyKHNlbGYpIC0+IE5vbmU6CiAgICBwcm90byAwIDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTIwCiAgICAvLyBhc3NlcnQgVHhuLnNlbmRlciA9PSBzZWxmLm93bmVyLCAib25seSB0aGUgb3duZXIgY2FuIGNhbGwgdGhpcyBmdW5jdGlvbiIKICAgIHR4biBTZW5kZXIKICAgIGludCAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjUwNgogICAgLy8gc2VsZi5vd25lciA9IEFjY291bnQoKQogICAgYnl0ZSAib3duZXIiCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjUyMAogICAgLy8gYXNzZXJ0IFR4bi5zZW5kZXIgPT0gc2VsZi5vd25lciwgIm9ubHkgdGhlIG93bmVyIGNhbiBjYWxsIHRoaXMgZnVuY3Rpb24iCiAgICBhcHBfZ2xvYmFsX2dldF9leAogICAgYXNzZXJ0IC8vIGNoZWNrIHNlbGYub3duZXIgZXhpc3RzCiAgICA9PQogICAgYXNzZXJ0IC8vIG9ubHkgdGhlIG93bmVyIGNhbiBjYWxsIHRoaXMgZnVuY3Rpb24KICAgIHJldHN1YgoKCi8vIGNvbnRyYWN0LkxlbmRpbmdQb29sLl90cmFuc2Zlcl9vd25lcnNoaXAobmV3X293bmVyOiBieXRlcykgLT4gdm9pZDoKX3RyYW5zZmVyX293bmVyc2hpcDoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTMxLTUzMgogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfdHJhbnNmZXJfb3duZXJzaGlwKHNlbGYsIG5ld19vd25lcjogQWNjb3VudCkgLT4gTm9uZToKICAgIHByb3RvIDEgMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1MzMKICAgIC8vIHByZXZpb3VzX293bmVyID0gc2VsZi5vd25lcgogICAgaW50IDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTA2CiAgICAvLyBzZWxmLm93bmVyID0gQWNjb3VudCgpCiAgICBieXRlICJvd25lciIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTMzCiAgICAvLyBwcmV2aW91c19vd25lciA9IHNlbGYub3duZXIKICAgIGFwcF9nbG9iYWxfZ2V0X2V4CiAgICBhc3NlcnQgLy8gY2hlY2sgc2VsZi5vd25lciBleGlzdHMKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTA2CiAgICAvLyBzZWxmLm93bmVyID0gQWNjb3VudCgpCiAgICBieXRlICJvd25lciIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTM0CiAgICAvLyBzZWxmLm93bmVyID0gbmV3X293bmVyCiAgICBmcmFtZV9kaWcgLTEKICAgIGFwcF9nbG9iYWxfcHV0CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjUzNgogICAgLy8gT3duZXJzaGlwVHJhbnNmZXJyZWQoYXJjNC5BZGRyZXNzKHByZXZpb3VzX293bmVyKSwgYXJjNC5BZGRyZXNzKG5ld19vd25lcikpCiAgICBmcmFtZV9kaWcgLTEKICAgIGNvbmNhdAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1MzUtNTM3CiAgICAvLyBhcmM0LmVtaXQoCiAgICAvLyAgICAgT3duZXJzaGlwVHJhbnNmZXJyZWQoYXJjNC5BZGRyZXNzKHByZXZpb3VzX293bmVyKSwgYXJjNC5BZGRyZXNzKG5ld19vd25lcikpCiAgICAvLyApCiAgICBtZXRob2QgIk93bmVyc2hpcFRyYW5zZmVycmVkKGFkZHJlc3MsYWRkcmVzcykiCiAgICBzd2FwCiAgICBjb25jYXQKICAgIGxvZwogICAgcmV0c3ViCgoKLy8gY29udHJhY3QuTGVuZGluZ1Bvb2wuaXNfcGF1c2VkKCkgLT4gYnl0ZXM6CmlzX3BhdXNlZDoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTQzLTU0NAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgaXNfcGF1c2VkKHNlbGYpIC0+IGFyYzQuQm9vbDoKICAgIHByb3RvIDAgMQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1NDUKICAgIC8vIHJldHVybiBhcmM0LkJvb2woc2VsZi5faXNfcGF1c2VkKCkpCiAgICBjYWxsc3ViIF9pc19wYXVzZWQKICAgIGJ5dGUgMHgwMAogICAgaW50IDAKICAgIHVuY292ZXIgMgogICAgc2V0Yml0CiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5faXNfcGF1c2VkKCkgLT4gdWludDY0OgpfaXNfcGF1c2VkOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1NDctNTQ4CiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9pc19wYXVzZWQoc2VsZikgLT4gYm9vbDoKICAgIHByb3RvIDAgMQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1NDkKICAgIC8vIHJldHVybiBzZWxmLnBhdXNlZCA9PSBVSW50NjQoMSkKICAgIGludCAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjUwNwogICAgLy8gc2VsZi5wYXVzZWQgPSBVSW50NjQoKQogICAgYnl0ZSAicGF1c2VkIgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1NDkKICAgIC8vIHJldHVybiBzZWxmLnBhdXNlZCA9PSBVSW50NjQoMSkKICAgIGFwcF9nbG9iYWxfZ2V0X2V4CiAgICBhc3NlcnQgLy8gY2hlY2sgc2VsZi5wYXVzZWQgZXhpc3RzCiAgICBpbnQgMQogICAgPT0KICAgIHJldHN1YgoKCi8vIGNvbnRyYWN0LkxlbmRpbmdQb29sLnBhdXNlKHBhdXNlOiBieXRlcykgLT4gdm9pZDoKcGF1c2U6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjU1MS01NTIKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIHBhdXNlKHNlbGYsIHBhdXNlOiBhcmM0LlVJbnQ2NCkgLT4gTm9uZToKICAgIHByb3RvIDEgMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1NTMKICAgIC8vIHNlbGYuX29ubHlfb3duZXIoKQogICAgY2FsbHN1YiBfb25seV9vd25lcgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1NTQKICAgIC8vIHNlbGYuX3BhdXNlKHBhdXNlLm5hdGl2ZSkKICAgIGZyYW1lX2RpZyAtMQogICAgYnRvaQogICAgY2FsbHN1YiBfcGF1c2UKICAgIHJldHN1YgoKCi8vIGNvbnRyYWN0LkxlbmRpbmdQb29sLl9wYXVzZShwYXVzZTogdWludDY0KSAtPiB2b2lkOgpfcGF1c2U6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjU1Ni01NTcKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3BhdXNlKHNlbGYsIHBhdXNlOiBVSW50NjQpIC0+IE5vbmU6CiAgICBwcm90byAxIDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTA3CiAgICAvLyBzZWxmLnBhdXNlZCA9IFVJbnQ2NCgpCiAgICBieXRlICJwYXVzZWQiCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjU1OAogICAgLy8gc2VsZi5wYXVzZWQgPSBwYXVzZQogICAgZnJhbWVfZGlnIC0xCiAgICBhcHBfZ2xvYmFsX3B1dAogICAgcmV0c3ViCgoKLy8gY29udHJhY3QuTGVuZGluZ1Bvb2wuZ2V0X3N0b2tlbl9hcHBfaWQoKSAtPiBieXRlczoKZ2V0X3N0b2tlbl9hcHBfaWQ6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjU2Mi01NjMKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF9zdG9rZW5fYXBwX2lkKHNlbGYpIC0+IGFyYzQuVUludDY0OgogICAgcHJvdG8gMCAxCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjU2NAogICAgLy8gcmV0dXJuIGFyYzQuVUludDY0KHNlbGYuX2dldF9zdG9rZW5fYXBwX2lkKCkpCiAgICBjYWxsc3ViIF9nZXRfc3Rva2VuX2FwcF9pZAogICAgaXRvYgogICAgcmV0c3ViCgoKLy8gY29udHJhY3QuTGVuZGluZ1Bvb2wuX2dldF9zdG9rZW5fYXBwX2lkKCkgLT4gdWludDY0OgpfZ2V0X3N0b2tlbl9hcHBfaWQ6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjU2Ni01NjcKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2dldF9zdG9rZW5fYXBwX2lkKHNlbGYpIC0+IFVJbnQ2NDoKICAgIHByb3RvIDAgMQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1NjgKICAgIC8vIHJldHVybiBzZWxmLnN0b2tlbl9hcHBfaWQKICAgIGludCAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjUwOAogICAgLy8gc2VsZi5zdG9rZW5fYXBwX2lkID0gVUludDY0KCkgICMgc3RhYmxlIG1hcmtldAogICAgYnl0ZSAic3Rva2VuX2FwcF9pZCIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTY4CiAgICAvLyByZXR1cm4gc2VsZi5zdG9rZW5fYXBwX2lkCiAgICBhcHBfZ2xvYmFsX2dldF9leAogICAgYXNzZXJ0IC8vIGNoZWNrIHNlbGYuc3Rva2VuX2FwcF9pZCBleGlzdHMKICAgIHJldHN1YgoKCi8vIGNvbnRyYWN0LkxlbmRpbmdQb29sLnNldF9zdG9rZW5fYXBwX2lkKHN0b2tlbl9hcHBfaWQ6IGJ5dGVzKSAtPiB2b2lkOgpzZXRfc3Rva2VuX2FwcF9pZDoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTcwLTU3MQogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgc2V0X3N0b2tlbl9hcHBfaWQoc2VsZiwgc3Rva2VuX2FwcF9pZDogYXJjNC5VSW50NjQpIC0+IE5vbmU6CiAgICBwcm90byAxIDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTcyCiAgICAvLyBzZWxmLl9vbmx5X293bmVyKCkKICAgIGNhbGxzdWIgX29ubHlfb3duZXIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTczCiAgICAvLyBzZWxmLnN0b2tlbl9hcHBfaWQgPSBzdG9rZW5fYXBwX2lkLm5hdGl2ZQogICAgZnJhbWVfZGlnIC0xCiAgICBidG9pCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjUwOAogICAgLy8gc2VsZi5zdG9rZW5fYXBwX2lkID0gVUludDY0KCkgICMgc3RhYmxlIG1hcmtldAogICAgYnl0ZSAic3Rva2VuX2FwcF9pZCIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTczCiAgICAvLyBzZWxmLnN0b2tlbl9hcHBfaWQgPSBzdG9rZW5fYXBwX2lkLm5hdGl2ZQogICAgc3dhcAogICAgYXBwX2dsb2JhbF9wdXQKICAgIHJldHN1YgoKCi8vIGNvbnRyYWN0LkxlbmRpbmdQb29sLmdldF91c2VyKHVzZXJfaWQ6IGJ5dGVzLCBtYXJrZXRfaWQ6IGJ5dGVzKSAtPiBieXRlczoKZ2V0X3VzZXI6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjU4MS01ODIKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF91c2VyKHNlbGYsIHVzZXJfaWQ6IGFyYzQuQWRkcmVzcywgbWFya2V0X2lkOiBhcmM0LlVJbnQ2NCkgLT4gVXNlckRhdGE6CiAgICBwcm90byAyIDEKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTgzCiAgICAvLyByZXR1cm4gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZC5uYXRpdmUsIG1hcmtldF9pZC5uYXRpdmUpCiAgICBmcmFtZV9kaWcgLTEKICAgIGJ0b2kKICAgIGZyYW1lX2RpZyAtMgogICAgc3dhcAogICAgY2FsbHN1YiBfZ2V0X3VzZXIKICAgIHJldHN1YgoKCi8vIGNvbnRyYWN0LkxlbmRpbmdQb29sLl9nZXRfdXNlcih1c2VyX2lkOiBieXRlcywgbWFya2V0X2lkOiB1aW50NjQpIC0+IGJ5dGVzOgpfZ2V0X3VzZXI6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjU4NS01ODYKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2dldF91c2VyKHNlbGYsIHVzZXJfaWQ6IEFjY291bnQsIG1hcmtldF9pZDogVUludDY0KSAtPiBVc2VyRGF0YToKICAgIHByb3RvIDIgMQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1ODcKICAgIC8vIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIGZyYW1lX2RpZyAtMgogICAgZnJhbWVfZGlnIC0xCiAgICBjYWxsc3ViIF9nZXRfdXNlcl9rZXkKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTExCiAgICAvLyBzZWxmLnVzZXJzID0gQm94TWFwKEJ5dGVzNDAsIFVzZXJEYXRhKSAgIyBQZXItbWFya2V0IHVzZXIgc3RhdGUKICAgIGJ5dGUgInVzZXJzIgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1ODgtNTk4CiAgICAvLyByZXR1cm4gc2VsZi51c2Vycy5nZXQoCiAgICAvLyAgICAgdXNlcl9rZXksCiAgICAvLyAgICAgZGVmYXVsdD1Vc2VyRGF0YSgKICAgIC8vICAgICAgICAgc2NhbGVkX2RlcG9zaXRzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgc2NhbGVkX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICBkZXBvc2l0X2luZGV4PWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgYm9ycm93X2luZGV4PWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgbGFzdF91cGRhdGVfdGltZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgbGFzdF9wcmljZT1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgKSwKICAgIC8vICkKICAgIHN3YXAKICAgIGNvbmNhdAogICAgYm94X2dldAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1OTAtNTk3CiAgICAvLyBkZWZhdWx0PVVzZXJEYXRhKAogICAgLy8gICAgIHNjYWxlZF9kZXBvc2l0cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgc2NhbGVkX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgIGRlcG9zaXRfaW5kZXg9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgIGJvcnJvd19pbmRleD1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgbGFzdF91cGRhdGVfdGltZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICBsYXN0X3ByaWNlPWFyYzQuVUludDI1NigwKSwKICAgIC8vICksCiAgICBieXRlIDB4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjU4OC01OTgKICAgIC8vIHJldHVybiBzZWxmLnVzZXJzLmdldCgKICAgIC8vICAgICB1c2VyX2tleSwKICAgIC8vICAgICBkZWZhdWx0PVVzZXJEYXRhKAogICAgLy8gICAgICAgICBzY2FsZWRfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICBzY2FsZWRfYm9ycm93cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgIGRlcG9zaXRfaW5kZXg9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICBib3Jyb3dfaW5kZXg9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICBsYXN0X3VwZGF0ZV90aW1lPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICBsYXN0X3ByaWNlPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICApLAogICAgLy8gKQogICAgY292ZXIgMgogICAgc2VsZWN0CiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQ6IGJ5dGVzLCBtYXJrZXRfaWQ6IHVpbnQ2NCkgLT4gYnl0ZXM6Cl9nZXRfdXNlcl9rZXk6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjU3NS01NzYKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2dldF91c2VyX2tleShzZWxmLCB1c2VyX2lkOiBBY2NvdW50LCBtYXJrZXRfaWQ6IFVJbnQ2NCkgLT4gQnl0ZXM0MDoKICAgIHByb3RvIDIgMQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1NzgKICAgIC8vIGFyYzQuQWRkcmVzcyh1c2VyX2lkKS5ieXRlcyArIGFyYzQuVUludDY0KG1hcmtldF9pZCkuYnl0ZXMKICAgIGZyYW1lX2RpZyAtMQogICAgaXRvYgogICAgZnJhbWVfZGlnIC0yCiAgICBzd2FwCiAgICBjb25jYXQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTc3LTU3OQogICAgLy8gcmV0dXJuIEJ5dGVzNDAuZnJvbV9ieXRlcygKICAgIC8vICAgICBhcmM0LkFkZHJlc3ModXNlcl9pZCkuYnl0ZXMgKyBhcmM0LlVJbnQ2NChtYXJrZXRfaWQpLmJ5dGVzCiAgICAvLyApCiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5jcmVhdGVfbWFya2V0KHRva2VuX2lkOiBieXRlcywgY29sbGF0ZXJhbF9mYWN0b3I6IGJ5dGVzLCBsaXF1aWRhdGlvbl90aHJlc2hvbGQ6IGJ5dGVzLCByZXNlcnZlX2ZhY3RvcjogYnl0ZXMsIGJvcnJvd19yYXRlOiBieXRlcywgc2xvcGU6IGJ5dGVzLCBtYXhfdG90YWxfZGVwb3NpdHM6IGJ5dGVzLCBtYXhfdG90YWxfYm9ycm93czogYnl0ZXMsIGxpcXVpZGF0aW9uX2JvbnVzOiBieXRlcywgY2xvc2VfZmFjdG9yOiBieXRlcykgLT4gYnl0ZXM6CmNyZWF0ZV9tYXJrZXQ6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjY4Ni02OTkKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGNyZWF0ZV9tYXJrZXQoCiAgICAvLyAgICAgc2VsZiwKICAgIC8vICAgICB0b2tlbl9pZDogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgY29sbGF0ZXJhbF9mYWN0b3I6IGFyYzQuVUludDY0LAogICAgLy8gICAgIGxpcXVpZGF0aW9uX3RocmVzaG9sZDogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgcmVzZXJ2ZV9mYWN0b3I6IGFyYzQuVUludDY0LAogICAgLy8gICAgIGJvcnJvd19yYXRlOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBzbG9wZTogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgbWF4X3RvdGFsX2RlcG9zaXRzOiBhcmM0LlVJbnQyNTYsCiAgICAvLyAgICAgbWF4X3RvdGFsX2JvcnJvd3M6IGFyYzQuVUludDI1NiwKICAgIC8vICAgICBsaXF1aWRhdGlvbl9ib251czogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgY2xvc2VfZmFjdG9yOiBhcmM0LlVJbnQ2NCwKICAgIC8vICkgLT4gYXJjNC5VSW50NjQ6CiAgICBwcm90byAxMCAxCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjcwMAogICAgLy8gc2VsZi5fb25seV9vd25lcigpCiAgICBjYWxsc3ViIF9vbmx5X293bmVyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjcwMQogICAgLy8gYXNzZXJ0IG5vdCBzZWxmLl9pc19wYXVzZWQoKSwgIlByb3RvY29sIGlzIHBhdXNlZCIKICAgIGNhbGxzdWIgX2lzX3BhdXNlZAogICAgIQogICAgYXNzZXJ0IC8vIFByb3RvY29sIGlzIHBhdXNlZAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo3MDQKICAgIC8vIHRva2VuX2lkLm5hdGl2ZSwKICAgIGZyYW1lX2RpZyAtMTAKICAgIGJ0b2kKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NzE5CiAgICAvLyBsYXN0X3VwZGF0ZV90aW1lPWFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKSwKICAgIGdsb2JhbCBMYXRlc3RUaW1lc3RhbXAKICAgIGl0b2IKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NzA2CiAgICAvLyBwYXVzZWQ9YXJjNC5Cb29sKFRydWUpLCAgIyBTdGFydCBwYXVzZWQgdW50aWwgcHJpY2UgaXMgc2V0CiAgICBieXRlIDB4ODAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NzA1LTcyNgogICAgLy8gTWFya2V0RGF0YSgKICAgIC8vICAgICBwYXVzZWQ9YXJjNC5Cb29sKFRydWUpLCAgIyBTdGFydCBwYXVzZWQgdW50aWwgcHJpY2UgaXMgc2V0CiAgICAvLyAgICAgbWF4X3RvdGFsX2RlcG9zaXRzPW1heF90b3RhbF9kZXBvc2l0cywKICAgIC8vICAgICBtYXhfdG90YWxfYm9ycm93cz1tYXhfdG90YWxfYm9ycm93cywKICAgIC8vICAgICBsaXF1aWRhdGlvbl9ib251cz1saXF1aWRhdGlvbl9ib251cywKICAgIC8vICAgICBjb2xsYXRlcmFsX2ZhY3Rvcj1jb2xsYXRlcmFsX2ZhY3RvciwKICAgIC8vICAgICBsaXF1aWRhdGlvbl90aHJlc2hvbGQ9bGlxdWlkYXRpb25fdGhyZXNob2xkLAogICAgLy8gICAgIHJlc2VydmVfZmFjdG9yPXJlc2VydmVfZmFjdG9yLAogICAgLy8gICAgIGJvcnJvd19yYXRlPWJvcnJvd19yYXRlLAogICAgLy8gICAgIHNsb3BlPXNsb3BlLAogICAgLy8gICAgIHRvdGFsX3NjYWxlZF9kZXBvc2l0cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgdG90YWxfc2NhbGVkX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgIGRlcG9zaXRfaW5kZXg9YXJjNC5VSW50MjU2KFNDQUxFKSwgICMgU3RhcnQgYXQgU0NBTEUgKDEuMCkKICAgIC8vICAgICBib3Jyb3dfaW5kZXg9YXJjNC5VSW50MjU2KFNDQUxFKSwgICMgU3RhcnQgYXQgU0NBTEUgKDEuMCkKICAgIC8vICAgICBsYXN0X3VwZGF0ZV90aW1lPWFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKSwKICAgIC8vICAgICByZXNlcnZlcz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgcHJpY2U9YXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICAwCiAgICAvLyAgICAgKSwgICMgUHJpY2UgbXVzdCBiZSBzZXQgYmVmb3JlIG1hcmtldCBjYW4gYmUgdXNlZAogICAgLy8gICAgIG50b2tlbl9pZD1hcmM0LlVJbnQ2NCgwKSwgICMgV2lsbCBiZSBzZXQgZHVyaW5nIHRva2VuIGluaXRpYWxpemF0aW9uCiAgICAvLyAgICAgY2xvc2VfZmFjdG9yPWNsb3NlX2ZhY3RvciwKICAgIC8vICksCiAgICBmcmFtZV9kaWcgLTQKICAgIGNvbmNhdAogICAgZnJhbWVfZGlnIC0zCiAgICBjb25jYXQKICAgIGZyYW1lX2RpZyAtMgogICAgY29uY2F0CiAgICBmcmFtZV9kaWcgLTkKICAgIGNvbmNhdAogICAgZnJhbWVfZGlnIC04CiAgICBjb25jYXQKICAgIGZyYW1lX2RpZyAtNwogICAgY29uY2F0CiAgICBmcmFtZV9kaWcgLTYKICAgIGNvbmNhdAogICAgZnJhbWVfZGlnIC01CiAgICBjb25jYXQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NzE1CiAgICAvLyB0b3RhbF9zY2FsZWRfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgYnl0ZSAweDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NzA1LTcyNgogICAgLy8gTWFya2V0RGF0YSgKICAgIC8vICAgICBwYXVzZWQ9YXJjNC5Cb29sKFRydWUpLCAgIyBTdGFydCBwYXVzZWQgdW50aWwgcHJpY2UgaXMgc2V0CiAgICAvLyAgICAgbWF4X3RvdGFsX2RlcG9zaXRzPW1heF90b3RhbF9kZXBvc2l0cywKICAgIC8vICAgICBtYXhfdG90YWxfYm9ycm93cz1tYXhfdG90YWxfYm9ycm93cywKICAgIC8vICAgICBsaXF1aWRhdGlvbl9ib251cz1saXF1aWRhdGlvbl9ib251cywKICAgIC8vICAgICBjb2xsYXRlcmFsX2ZhY3Rvcj1jb2xsYXRlcmFsX2ZhY3RvciwKICAgIC8vICAgICBsaXF1aWRhdGlvbl90aHJlc2hvbGQ9bGlxdWlkYXRpb25fdGhyZXNob2xkLAogICAgLy8gICAgIHJlc2VydmVfZmFjdG9yPXJlc2VydmVfZmFjdG9yLAogICAgLy8gICAgIGJvcnJvd19yYXRlPWJvcnJvd19yYXRlLAogICAgLy8gICAgIHNsb3BlPXNsb3BlLAogICAgLy8gICAgIHRvdGFsX3NjYWxlZF9kZXBvc2l0cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgdG90YWxfc2NhbGVkX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgIGRlcG9zaXRfaW5kZXg9YXJjNC5VSW50MjU2KFNDQUxFKSwgICMgU3RhcnQgYXQgU0NBTEUgKDEuMCkKICAgIC8vICAgICBib3Jyb3dfaW5kZXg9YXJjNC5VSW50MjU2KFNDQUxFKSwgICMgU3RhcnQgYXQgU0NBTEUgKDEuMCkKICAgIC8vICAgICBsYXN0X3VwZGF0ZV90aW1lPWFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKSwKICAgIC8vICAgICByZXNlcnZlcz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgcHJpY2U9YXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICAwCiAgICAvLyAgICAgKSwgICMgUHJpY2UgbXVzdCBiZSBzZXQgYmVmb3JlIG1hcmtldCBjYW4gYmUgdXNlZAogICAgLy8gICAgIG50b2tlbl9pZD1hcmM0LlVJbnQ2NCgwKSwgICMgV2lsbCBiZSBzZXQgZHVyaW5nIHRva2VuIGluaXRpYWxpemF0aW9uCiAgICAvLyAgICAgY2xvc2VfZmFjdG9yPWNsb3NlX2ZhY3RvciwKICAgIC8vICksCiAgICBjb25jYXQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NzE2CiAgICAvLyB0b3RhbF9zY2FsZWRfYm9ycm93cz1hcmM0LlVJbnQyNTYoMCksCiAgICBieXRlIDB4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo3MDUtNzI2CiAgICAvLyBNYXJrZXREYXRhKAogICAgLy8gICAgIHBhdXNlZD1hcmM0LkJvb2woVHJ1ZSksICAjIFN0YXJ0IHBhdXNlZCB1bnRpbCBwcmljZSBpcyBzZXQKICAgIC8vICAgICBtYXhfdG90YWxfZGVwb3NpdHM9bWF4X3RvdGFsX2RlcG9zaXRzLAogICAgLy8gICAgIG1heF90b3RhbF9ib3Jyb3dzPW1heF90b3RhbF9ib3Jyb3dzLAogICAgLy8gICAgIGxpcXVpZGF0aW9uX2JvbnVzPWxpcXVpZGF0aW9uX2JvbnVzLAogICAgLy8gICAgIGNvbGxhdGVyYWxfZmFjdG9yPWNvbGxhdGVyYWxfZmFjdG9yLAogICAgLy8gICAgIGxpcXVpZGF0aW9uX3RocmVzaG9sZD1saXF1aWRhdGlvbl90aHJlc2hvbGQsCiAgICAvLyAgICAgcmVzZXJ2ZV9mYWN0b3I9cmVzZXJ2ZV9mYWN0b3IsCiAgICAvLyAgICAgYm9ycm93X3JhdGU9Ym9ycm93X3JhdGUsCiAgICAvLyAgICAgc2xvcGU9c2xvcGUsCiAgICAvLyAgICAgdG90YWxfc2NhbGVkX2RlcG9zaXRzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICB0b3RhbF9zY2FsZWRfYm9ycm93cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgZGVwb3NpdF9pbmRleD1hcmM0LlVJbnQyNTYoU0NBTEUpLCAgIyBTdGFydCBhdCBTQ0FMRSAoMS4wKQogICAgLy8gICAgIGJvcnJvd19pbmRleD1hcmM0LlVJbnQyNTYoU0NBTEUpLCAgIyBTdGFydCBhdCBTQ0FMRSAoMS4wKQogICAgLy8gICAgIGxhc3RfdXBkYXRlX3RpbWU9YXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApLAogICAgLy8gICAgIHJlc2VydmVzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICBwcmljZT1hcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgIDAKICAgIC8vICAgICApLCAgIyBQcmljZSBtdXN0IGJlIHNldCBiZWZvcmUgbWFya2V0IGNhbiBiZSB1c2VkCiAgICAvLyAgICAgbnRva2VuX2lkPWFyYzQuVUludDY0KDApLCAgIyBXaWxsIGJlIHNldCBkdXJpbmcgdG9rZW4gaW5pdGlhbGl6YXRpb24KICAgIC8vICAgICBjbG9zZV9mYWN0b3I9Y2xvc2VfZmFjdG9yLAogICAgLy8gKSwKICAgIGNvbmNhdAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo3MTcKICAgIC8vIGRlcG9zaXRfaW5kZXg9YXJjNC5VSW50MjU2KFNDQUxFKSwgICMgU3RhcnQgYXQgU0NBTEUgKDEuMCkKICAgIGJ5dGUgMHgwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwZGUwYjZiM2E3NjQwMDAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjcwNS03MjYKICAgIC8vIE1hcmtldERhdGEoCiAgICAvLyAgICAgcGF1c2VkPWFyYzQuQm9vbChUcnVlKSwgICMgU3RhcnQgcGF1c2VkIHVudGlsIHByaWNlIGlzIHNldAogICAgLy8gICAgIG1heF90b3RhbF9kZXBvc2l0cz1tYXhfdG90YWxfZGVwb3NpdHMsCiAgICAvLyAgICAgbWF4X3RvdGFsX2JvcnJvd3M9bWF4X3RvdGFsX2JvcnJvd3MsCiAgICAvLyAgICAgbGlxdWlkYXRpb25fYm9udXM9bGlxdWlkYXRpb25fYm9udXMsCiAgICAvLyAgICAgY29sbGF0ZXJhbF9mYWN0b3I9Y29sbGF0ZXJhbF9mYWN0b3IsCiAgICAvLyAgICAgbGlxdWlkYXRpb25fdGhyZXNob2xkPWxpcXVpZGF0aW9uX3RocmVzaG9sZCwKICAgIC8vICAgICByZXNlcnZlX2ZhY3Rvcj1yZXNlcnZlX2ZhY3RvciwKICAgIC8vICAgICBib3Jyb3dfcmF0ZT1ib3Jyb3dfcmF0ZSwKICAgIC8vICAgICBzbG9wZT1zbG9wZSwKICAgIC8vICAgICB0b3RhbF9zY2FsZWRfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgIHRvdGFsX3NjYWxlZF9ib3Jyb3dzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICBkZXBvc2l0X2luZGV4PWFyYzQuVUludDI1NihTQ0FMRSksICAjIFN0YXJ0IGF0IFNDQUxFICgxLjApCiAgICAvLyAgICAgYm9ycm93X2luZGV4PWFyYzQuVUludDI1NihTQ0FMRSksICAjIFN0YXJ0IGF0IFNDQUxFICgxLjApCiAgICAvLyAgICAgbGFzdF91cGRhdGVfdGltZT1hcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCksCiAgICAvLyAgICAgcmVzZXJ2ZXM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgIHByaWNlPWFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgMAogICAgLy8gICAgICksICAjIFByaWNlIG11c3QgYmUgc2V0IGJlZm9yZSBtYXJrZXQgY2FuIGJlIHVzZWQKICAgIC8vICAgICBudG9rZW5faWQ9YXJjNC5VSW50NjQoMCksICAjIFdpbGwgYmUgc2V0IGR1cmluZyB0b2tlbiBpbml0aWFsaXphdGlvbgogICAgLy8gICAgIGNsb3NlX2ZhY3Rvcj1jbG9zZV9mYWN0b3IsCiAgICAvLyApLAogICAgY29uY2F0CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjcxOAogICAgLy8gYm9ycm93X2luZGV4PWFyYzQuVUludDI1NihTQ0FMRSksICAjIFN0YXJ0IGF0IFNDQUxFICgxLjApCiAgICBieXRlIDB4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGRlMGI2YjNhNzY0MDAwMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo3MDUtNzI2CiAgICAvLyBNYXJrZXREYXRhKAogICAgLy8gICAgIHBhdXNlZD1hcmM0LkJvb2woVHJ1ZSksICAjIFN0YXJ0IHBhdXNlZCB1bnRpbCBwcmljZSBpcyBzZXQKICAgIC8vICAgICBtYXhfdG90YWxfZGVwb3NpdHM9bWF4X3RvdGFsX2RlcG9zaXRzLAogICAgLy8gICAgIG1heF90b3RhbF9ib3Jyb3dzPW1heF90b3RhbF9ib3Jyb3dzLAogICAgLy8gICAgIGxpcXVpZGF0aW9uX2JvbnVzPWxpcXVpZGF0aW9uX2JvbnVzLAogICAgLy8gICAgIGNvbGxhdGVyYWxfZmFjdG9yPWNvbGxhdGVyYWxfZmFjdG9yLAogICAgLy8gICAgIGxpcXVpZGF0aW9uX3RocmVzaG9sZD1saXF1aWRhdGlvbl90aHJlc2hvbGQsCiAgICAvLyAgICAgcmVzZXJ2ZV9mYWN0b3I9cmVzZXJ2ZV9mYWN0b3IsCiAgICAvLyAgICAgYm9ycm93X3JhdGU9Ym9ycm93X3JhdGUsCiAgICAvLyAgICAgc2xvcGU9c2xvcGUsCiAgICAvLyAgICAgdG90YWxfc2NhbGVkX2RlcG9zaXRzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICB0b3RhbF9zY2FsZWRfYm9ycm93cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgZGVwb3NpdF9pbmRleD1hcmM0LlVJbnQyNTYoU0NBTEUpLCAgIyBTdGFydCBhdCBTQ0FMRSAoMS4wKQogICAgLy8gICAgIGJvcnJvd19pbmRleD1hcmM0LlVJbnQyNTYoU0NBTEUpLCAgIyBTdGFydCBhdCBTQ0FMRSAoMS4wKQogICAgLy8gICAgIGxhc3RfdXBkYXRlX3RpbWU9YXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApLAogICAgLy8gICAgIHJlc2VydmVzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICBwcmljZT1hcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgIDAKICAgIC8vICAgICApLCAgIyBQcmljZSBtdXN0IGJlIHNldCBiZWZvcmUgbWFya2V0IGNhbiBiZSB1c2VkCiAgICAvLyAgICAgbnRva2VuX2lkPWFyYzQuVUludDY0KDApLCAgIyBXaWxsIGJlIHNldCBkdXJpbmcgdG9rZW4gaW5pdGlhbGl6YXRpb24KICAgIC8vICAgICBjbG9zZV9mYWN0b3I9Y2xvc2VfZmFjdG9yLAogICAgLy8gKSwKICAgIGNvbmNhdAogICAgc3dhcAogICAgY29uY2F0CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjcyMAogICAgLy8gcmVzZXJ2ZXM9YXJjNC5VSW50MjU2KDApLAogICAgYnl0ZSAweDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NzA1LTcyNgogICAgLy8gTWFya2V0RGF0YSgKICAgIC8vICAgICBwYXVzZWQ9YXJjNC5Cb29sKFRydWUpLCAgIyBTdGFydCBwYXVzZWQgdW50aWwgcHJpY2UgaXMgc2V0CiAgICAvLyAgICAgbWF4X3RvdGFsX2RlcG9zaXRzPW1heF90b3RhbF9kZXBvc2l0cywKICAgIC8vICAgICBtYXhfdG90YWxfYm9ycm93cz1tYXhfdG90YWxfYm9ycm93cywKICAgIC8vICAgICBsaXF1aWRhdGlvbl9ib251cz1saXF1aWRhdGlvbl9ib251cywKICAgIC8vICAgICBjb2xsYXRlcmFsX2ZhY3Rvcj1jb2xsYXRlcmFsX2ZhY3RvciwKICAgIC8vICAgICBsaXF1aWRhdGlvbl90aHJlc2hvbGQ9bGlxdWlkYXRpb25fdGhyZXNob2xkLAogICAgLy8gICAgIHJlc2VydmVfZmFjdG9yPXJlc2VydmVfZmFjdG9yLAogICAgLy8gICAgIGJvcnJvd19yYXRlPWJvcnJvd19yYXRlLAogICAgLy8gICAgIHNsb3BlPXNsb3BlLAogICAgLy8gICAgIHRvdGFsX3NjYWxlZF9kZXBvc2l0cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgdG90YWxfc2NhbGVkX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgIGRlcG9zaXRfaW5kZXg9YXJjNC5VSW50MjU2KFNDQUxFKSwgICMgU3RhcnQgYXQgU0NBTEUgKDEuMCkKICAgIC8vICAgICBib3Jyb3dfaW5kZXg9YXJjNC5VSW50MjU2KFNDQUxFKSwgICMgU3RhcnQgYXQgU0NBTEUgKDEuMCkKICAgIC8vICAgICBsYXN0X3VwZGF0ZV90aW1lPWFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKSwKICAgIC8vICAgICByZXNlcnZlcz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgcHJpY2U9YXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICAwCiAgICAvLyAgICAgKSwgICMgUHJpY2UgbXVzdCBiZSBzZXQgYmVmb3JlIG1hcmtldCBjYW4gYmUgdXNlZAogICAgLy8gICAgIG50b2tlbl9pZD1hcmM0LlVJbnQ2NCgwKSwgICMgV2lsbCBiZSBzZXQgZHVyaW5nIHRva2VuIGluaXRpYWxpemF0aW9uCiAgICAvLyAgICAgY2xvc2VfZmFjdG9yPWNsb3NlX2ZhY3RvciwKICAgIC8vICksCiAgICBjb25jYXQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NzIxLTcyMwogICAgLy8gcHJpY2U9YXJjNC5VSW50MjU2KAogICAgLy8gICAgIDAKICAgIC8vICksICAjIFByaWNlIG11c3QgYmUgc2V0IGJlZm9yZSBtYXJrZXQgY2FuIGJlIHVzZWQKICAgIGJ5dGUgMHgwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjcwNS03MjYKICAgIC8vIE1hcmtldERhdGEoCiAgICAvLyAgICAgcGF1c2VkPWFyYzQuQm9vbChUcnVlKSwgICMgU3RhcnQgcGF1c2VkIHVudGlsIHByaWNlIGlzIHNldAogICAgLy8gICAgIG1heF90b3RhbF9kZXBvc2l0cz1tYXhfdG90YWxfZGVwb3NpdHMsCiAgICAvLyAgICAgbWF4X3RvdGFsX2JvcnJvd3M9bWF4X3RvdGFsX2JvcnJvd3MsCiAgICAvLyAgICAgbGlxdWlkYXRpb25fYm9udXM9bGlxdWlkYXRpb25fYm9udXMsCiAgICAvLyAgICAgY29sbGF0ZXJhbF9mYWN0b3I9Y29sbGF0ZXJhbF9mYWN0b3IsCiAgICAvLyAgICAgbGlxdWlkYXRpb25fdGhyZXNob2xkPWxpcXVpZGF0aW9uX3RocmVzaG9sZCwKICAgIC8vICAgICByZXNlcnZlX2ZhY3Rvcj1yZXNlcnZlX2ZhY3RvciwKICAgIC8vICAgICBib3Jyb3dfcmF0ZT1ib3Jyb3dfcmF0ZSwKICAgIC8vICAgICBzbG9wZT1zbG9wZSwKICAgIC8vICAgICB0b3RhbF9zY2FsZWRfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgIHRvdGFsX3NjYWxlZF9ib3Jyb3dzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICBkZXBvc2l0X2luZGV4PWFyYzQuVUludDI1NihTQ0FMRSksICAjIFN0YXJ0IGF0IFNDQUxFICgxLjApCiAgICAvLyAgICAgYm9ycm93X2luZGV4PWFyYzQuVUludDI1NihTQ0FMRSksICAjIFN0YXJ0IGF0IFNDQUxFICgxLjApCiAgICAvLyAgICAgbGFzdF91cGRhdGVfdGltZT1hcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCksCiAgICAvLyAgICAgcmVzZXJ2ZXM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgIHByaWNlPWFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgMAogICAgLy8gICAgICksICAjIFByaWNlIG11c3QgYmUgc2V0IGJlZm9yZSBtYXJrZXQgY2FuIGJlIHVzZWQKICAgIC8vICAgICBudG9rZW5faWQ9YXJjNC5VSW50NjQoMCksICAjIFdpbGwgYmUgc2V0IGR1cmluZyB0b2tlbiBpbml0aWFsaXphdGlvbgogICAgLy8gICAgIGNsb3NlX2ZhY3Rvcj1jbG9zZV9mYWN0b3IsCiAgICAvLyApLAogICAgY29uY2F0CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjcyNAogICAgLy8gbnRva2VuX2lkPWFyYzQuVUludDY0KDApLCAgIyBXaWxsIGJlIHNldCBkdXJpbmcgdG9rZW4gaW5pdGlhbGl6YXRpb24KICAgIGJ5dGUgMHgwMDAwMDAwMDAwMDAwMDAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjcwNS03MjYKICAgIC8vIE1hcmtldERhdGEoCiAgICAvLyAgICAgcGF1c2VkPWFyYzQuQm9vbChUcnVlKSwgICMgU3RhcnQgcGF1c2VkIHVudGlsIHByaWNlIGlzIHNldAogICAgLy8gICAgIG1heF90b3RhbF9kZXBvc2l0cz1tYXhfdG90YWxfZGVwb3NpdHMsCiAgICAvLyAgICAgbWF4X3RvdGFsX2JvcnJvd3M9bWF4X3RvdGFsX2JvcnJvd3MsCiAgICAvLyAgICAgbGlxdWlkYXRpb25fYm9udXM9bGlxdWlkYXRpb25fYm9udXMsCiAgICAvLyAgICAgY29sbGF0ZXJhbF9mYWN0b3I9Y29sbGF0ZXJhbF9mYWN0b3IsCiAgICAvLyAgICAgbGlxdWlkYXRpb25fdGhyZXNob2xkPWxpcXVpZGF0aW9uX3RocmVzaG9sZCwKICAgIC8vICAgICByZXNlcnZlX2ZhY3Rvcj1yZXNlcnZlX2ZhY3RvciwKICAgIC8vICAgICBib3Jyb3dfcmF0ZT1ib3Jyb3dfcmF0ZSwKICAgIC8vICAgICBzbG9wZT1zbG9wZSwKICAgIC8vICAgICB0b3RhbF9zY2FsZWRfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgIHRvdGFsX3NjYWxlZF9ib3Jyb3dzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICBkZXBvc2l0X2luZGV4PWFyYzQuVUludDI1NihTQ0FMRSksICAjIFN0YXJ0IGF0IFNDQUxFICgxLjApCiAgICAvLyAgICAgYm9ycm93X2luZGV4PWFyYzQuVUludDI1NihTQ0FMRSksICAjIFN0YXJ0IGF0IFNDQUxFICgxLjApCiAgICAvLyAgICAgbGFzdF91cGRhdGVfdGltZT1hcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCksCiAgICAvLyAgICAgcmVzZXJ2ZXM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgIHByaWNlPWFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgMAogICAgLy8gICAgICksICAjIFByaWNlIG11c3QgYmUgc2V0IGJlZm9yZSBtYXJrZXQgY2FuIGJlIHVzZWQKICAgIC8vICAgICBudG9rZW5faWQ9YXJjNC5VSW50NjQoMCksICAjIFdpbGwgYmUgc2V0IGR1cmluZyB0b2tlbiBpbml0aWFsaXphdGlvbgogICAgLy8gICAgIGNsb3NlX2ZhY3Rvcj1jbG9zZV9mYWN0b3IsCiAgICAvLyApLAogICAgY29uY2F0CiAgICBmcmFtZV9kaWcgLTEKICAgIGNvbmNhdAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo3MDMtNzI3CiAgICAvLyBzZWxmLl9jcmVhdGVfbWFya2V0KAogICAgLy8gICAgIHRva2VuX2lkLm5hdGl2ZSwKICAgIC8vICAgICBNYXJrZXREYXRhKAogICAgLy8gICAgICAgICBwYXVzZWQ9YXJjNC5Cb29sKFRydWUpLCAgIyBTdGFydCBwYXVzZWQgdW50aWwgcHJpY2UgaXMgc2V0CiAgICAvLyAgICAgICAgIG1heF90b3RhbF9kZXBvc2l0cz1tYXhfdG90YWxfZGVwb3NpdHMsCiAgICAvLyAgICAgICAgIG1heF90b3RhbF9ib3Jyb3dzPW1heF90b3RhbF9ib3Jyb3dzLAogICAgLy8gICAgICAgICBsaXF1aWRhdGlvbl9ib251cz1saXF1aWRhdGlvbl9ib251cywKICAgIC8vICAgICAgICAgY29sbGF0ZXJhbF9mYWN0b3I9Y29sbGF0ZXJhbF9mYWN0b3IsCiAgICAvLyAgICAgICAgIGxpcXVpZGF0aW9uX3RocmVzaG9sZD1saXF1aWRhdGlvbl90aHJlc2hvbGQsCiAgICAvLyAgICAgICAgIHJlc2VydmVfZmFjdG9yPXJlc2VydmVfZmFjdG9yLAogICAgLy8gICAgICAgICBib3Jyb3dfcmF0ZT1ib3Jyb3dfcmF0ZSwKICAgIC8vICAgICAgICAgc2xvcGU9c2xvcGUsCiAgICAvLyAgICAgICAgIHRvdGFsX3NjYWxlZF9kZXBvc2l0cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgIHRvdGFsX3NjYWxlZF9ib3Jyb3dzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgZGVwb3NpdF9pbmRleD1hcmM0LlVJbnQyNTYoU0NBTEUpLCAgIyBTdGFydCBhdCBTQ0FMRSAoMS4wKQogICAgLy8gICAgICAgICBib3Jyb3dfaW5kZXg9YXJjNC5VSW50MjU2KFNDQUxFKSwgICMgU3RhcnQgYXQgU0NBTEUgKDEuMCkKICAgIC8vICAgICAgICAgbGFzdF91cGRhdGVfdGltZT1hcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCksCiAgICAvLyAgICAgICAgIHJlc2VydmVzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgcHJpY2U9YXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICAgICAgMAogICAgLy8gICAgICAgICApLCAgIyBQcmljZSBtdXN0IGJlIHNldCBiZWZvcmUgbWFya2V0IGNhbiBiZSB1c2VkCiAgICAvLyAgICAgICAgIG50b2tlbl9pZD1hcmM0LlVJbnQ2NCgwKSwgICMgV2lsbCBiZSBzZXQgZHVyaW5nIHRva2VuIGluaXRpYWxpemF0aW9uCiAgICAvLyAgICAgICAgIGNsb3NlX2ZhY3Rvcj1jbG9zZV9mYWN0b3IsCiAgICAvLyAgICAgKSwKICAgIC8vICkKICAgIGNhbGxzdWIgX2NyZWF0ZV9tYXJrZXQKICAgIHBvcAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo3MDItNzI4CiAgICAvLyByZXR1cm4gYXJjNC5VSW50NjQoCiAgICAvLyAgICAgc2VsZi5fY3JlYXRlX21hcmtldCgKICAgIC8vICAgICAgICAgdG9rZW5faWQubmF0aXZlLAogICAgLy8gICAgICAgICBNYXJrZXREYXRhKAogICAgLy8gICAgICAgICAgICAgcGF1c2VkPWFyYzQuQm9vbChUcnVlKSwgICMgU3RhcnQgcGF1c2VkIHVudGlsIHByaWNlIGlzIHNldAogICAgLy8gICAgICAgICAgICAgbWF4X3RvdGFsX2RlcG9zaXRzPW1heF90b3RhbF9kZXBvc2l0cywKICAgIC8vICAgICAgICAgICAgIG1heF90b3RhbF9ib3Jyb3dzPW1heF90b3RhbF9ib3Jyb3dzLAogICAgLy8gICAgICAgICAgICAgbGlxdWlkYXRpb25fYm9udXM9bGlxdWlkYXRpb25fYm9udXMsCiAgICAvLyAgICAgICAgICAgICBjb2xsYXRlcmFsX2ZhY3Rvcj1jb2xsYXRlcmFsX2ZhY3RvciwKICAgIC8vICAgICAgICAgICAgIGxpcXVpZGF0aW9uX3RocmVzaG9sZD1saXF1aWRhdGlvbl90aHJlc2hvbGQsCiAgICAvLyAgICAgICAgICAgICByZXNlcnZlX2ZhY3Rvcj1yZXNlcnZlX2ZhY3RvciwKICAgIC8vICAgICAgICAgICAgIGJvcnJvd19yYXRlPWJvcnJvd19yYXRlLAogICAgLy8gICAgICAgICAgICAgc2xvcGU9c2xvcGUsCiAgICAvLyAgICAgICAgICAgICB0b3RhbF9zY2FsZWRfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgdG90YWxfc2NhbGVkX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgZGVwb3NpdF9pbmRleD1hcmM0LlVJbnQyNTYoU0NBTEUpLCAgIyBTdGFydCBhdCBTQ0FMRSAoMS4wKQogICAgLy8gICAgICAgICAgICAgYm9ycm93X2luZGV4PWFyYzQuVUludDI1NihTQ0FMRSksICAjIFN0YXJ0IGF0IFNDQUxFICgxLjApCiAgICAvLyAgICAgICAgICAgICBsYXN0X3VwZGF0ZV90aW1lPWFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKSwKICAgIC8vICAgICAgICAgICAgIHJlc2VydmVzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIHByaWNlPWFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgICAgICAgICAwCiAgICAvLyAgICAgICAgICAgICApLCAgIyBQcmljZSBtdXN0IGJlIHNldCBiZWZvcmUgbWFya2V0IGNhbiBiZSB1c2VkCiAgICAvLyAgICAgICAgICAgICBudG9rZW5faWQ9YXJjNC5VSW50NjQoMCksICAjIFdpbGwgYmUgc2V0IGR1cmluZyB0b2tlbiBpbml0aWFsaXphdGlvbgogICAgLy8gICAgICAgICAgICAgY2xvc2VfZmFjdG9yPWNsb3NlX2ZhY3RvciwKICAgIC8vICAgICAgICAgKSwKICAgIC8vICAgICApCiAgICAvLyApCiAgICBpdG9iCiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5fY3JlYXRlX21hcmtldCh0b2tlbl9pZDogdWludDY0LCBtYXJrZXRfZGF0YTogYnl0ZXMpIC0+IHVpbnQ2NCwgYnl0ZXM6Cl9jcmVhdGVfbWFya2V0OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo3MzAtNzMxCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9jcmVhdGVfbWFya2V0KHNlbGYsIHRva2VuX2lkOiBVSW50NjQsIG1hcmtldF9kYXRhOiBNYXJrZXREYXRhKSAtPiBVSW50NjQ6CiAgICBwcm90byAyIDIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTEwLTczMgogICAgLy8gICAgIHNlbGYubWFya2V0cyA9IEJveE1hcChVSW50NjQsIE1hcmtldERhdGEpICAjIE1hcmtldCBzdGF0ZQogICAgLy8gICAgIHNlbGYudXNlcnMgPSBCb3hNYXAoQnl0ZXM0MCwgVXNlckRhdGEpICAjIFBlci1tYXJrZXQgdXNlciBzdGF0ZQogICAgLy8gICAgIHNlbGYuZ2xvYmFsX3VzZXJzID0gQm94TWFwKEFjY291bnQsIEdsb2JhbFVzZXJEYXRhKSAgIyBHbG9iYWwgdXNlciBzdGF0ZQogICAgLy8gCiAgICAvLyAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vICMgT3duYWJsZQogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX29ubHlfb3duZXIoc2VsZikgLT4gTm9uZToKICAgIC8vICAgICBhc3NlcnQgVHhuLnNlbmRlciA9PSBzZWxmLm93bmVyLCAib25seSB0aGUgb3duZXIgY2FuIGNhbGwgdGhpcyBmdW5jdGlvbiIKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kKHJlYWRvbmx5PVRydWUpCiAgICAvLyBkZWYgZ2V0X293bmVyKHNlbGYpIC0+IGFyYzQuQWRkcmVzczoKICAgIC8vICAgICByZXR1cm4gYXJjNC5BZGRyZXNzKHNlbGYub3duZXIpCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIHRyYW5zZmVyX293bmVyc2hpcChzZWxmLCBuZXdfb3duZXI6IGFyYzQuQWRkcmVzcykgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLl9vbmx5X293bmVyKCkKICAgIC8vICAgICBzZWxmLl90cmFuc2Zlcl9vd25lcnNoaXAobmV3X293bmVyLm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfdHJhbnNmZXJfb3duZXJzaGlwKHNlbGYsIG5ld19vd25lcjogQWNjb3VudCkgLT4gTm9uZToKICAgIC8vICAgICBwcmV2aW91c19vd25lciA9IHNlbGYub3duZXIKICAgIC8vICAgICBzZWxmLm93bmVyID0gbmV3X293bmVyCiAgICAvLyAgICAgYXJjNC5lbWl0KAogICAgLy8gICAgICAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChhcmM0LkFkZHJlc3MocHJldmlvdXNfb3duZXIpLCBhcmM0LkFkZHJlc3MobmV3X293bmVyKSkKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gCiAgICAvLyAjIFJFTSBoYXZpbmcgaXNzdWVzIHdpdGggdGhlIGluaGVyaXRhbmNlIGhlcmUKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgaXNfcGF1c2VkKHNlbGYpIC0+IGFyYzQuQm9vbDoKICAgIC8vICAgICByZXR1cm4gYXJjNC5Cb29sKHNlbGYuX2lzX3BhdXNlZCgpKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9pc19wYXVzZWQoc2VsZikgLT4gYm9vbDoKICAgIC8vICAgICByZXR1cm4gc2VsZi5wYXVzZWQgPT0gVUludDY0KDEpCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIHBhdXNlKHNlbGYsIHBhdXNlOiBhcmM0LlVJbnQ2NCkgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLl9vbmx5X293bmVyKCkKICAgIC8vICAgICBzZWxmLl9wYXVzZShwYXVzZS5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3BhdXNlKHNlbGYsIHBhdXNlOiBVSW50NjQpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5wYXVzZWQgPSBwYXVzZQogICAgLy8gCiAgICAvLyAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgZ2V0X3N0b2tlbl9hcHBfaWQoc2VsZikgLT4gYXJjNC5VSW50NjQ6CiAgICAvLyAgICAgcmV0dXJuIGFyYzQuVUludDY0KHNlbGYuX2dldF9zdG9rZW5fYXBwX2lkKCkpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2dldF9zdG9rZW5fYXBwX2lkKHNlbGYpIC0+IFVJbnQ2NDoKICAgIC8vICAgICByZXR1cm4gc2VsZi5zdG9rZW5fYXBwX2lkCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIHNldF9zdG9rZW5fYXBwX2lkKHNlbGYsIHN0b2tlbl9hcHBfaWQ6IGFyYzQuVUludDY0KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX29ubHlfb3duZXIoKQogICAgLy8gICAgIHNlbGYuc3Rva2VuX2FwcF9pZCA9IHN0b2tlbl9hcHBfaWQubmF0aXZlCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2dldF91c2VyX2tleShzZWxmLCB1c2VyX2lkOiBBY2NvdW50LCBtYXJrZXRfaWQ6IFVJbnQ2NCkgLT4gQnl0ZXM0MDoKICAgIC8vICAgICByZXR1cm4gQnl0ZXM0MC5mcm9tX2J5dGVzKAogICAgLy8gICAgICAgICBhcmM0LkFkZHJlc3ModXNlcl9pZCkuYnl0ZXMgKyBhcmM0LlVJbnQ2NChtYXJrZXRfaWQpLmJ5dGVzCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBnZXRfdXNlcihzZWxmLCB1c2VyX2lkOiBhcmM0LkFkZHJlc3MsIG1hcmtldF9pZDogYXJjNC5VSW50NjQpIC0+IFVzZXJEYXRhOgogICAgLy8gICAgIHJldHVybiBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLm5hdGl2ZSwgbWFya2V0X2lkLm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X3VzZXIoc2VsZiwgdXNlcl9pZDogQWNjb3VudCwgbWFya2V0X2lkOiBVSW50NjQpIC0+IFVzZXJEYXRhOgogICAgLy8gICAgIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICByZXR1cm4gc2VsZi51c2Vycy5nZXQoCiAgICAvLyAgICAgICAgIHVzZXJfa2V5LAogICAgLy8gICAgICAgICBkZWZhdWx0PVVzZXJEYXRhKAogICAgLy8gICAgICAgICAgICAgc2NhbGVkX2RlcG9zaXRzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIHNjYWxlZF9ib3Jyb3dzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGRlcG9zaXRfaW5kZXg9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgYm9ycm93X2luZGV4PWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGxhc3RfdXBkYXRlX3RpbWU9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICBsYXN0X3ByaWNlPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgKSwKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2hhc19wb3NpdGlvbihzZWxmLCB1c2VyX2lkOiBBY2NvdW50LCBtYXJrZXRfaWQ6IFVJbnQ2NCkgLT4gYm9vbDoKICAgIC8vICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHJldHVybiB1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgPiAwCiAgICAvLyAKICAgIC8vICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gCiAgICAvLyAjIFJFTSBjb25zaWRlciByZW1vdmluZyBhbmQgY2FsY3VsYXRpbmcgaW4gdGhlIGNsaWVudAogICAgLy8gIyBSRU0gdHJ5aW5nIHRvIGN1dCBiYWNrIG9uIGV4dHJhIHBhZ2VzCiAgICAvLyAKICAgIC8vICMgQGFyYzQuYWJpbWV0aG9kCiAgICAvLyAjIGRlZiBnZXRfdXNlcl9kZXBvc2l0X3VuZGVybHlpbmdfYW1vdW50KAogICAgLy8gIyAgICAgc2VsZiwgdXNlcl9pZDogYXJjNC5BZGRyZXNzLCBtYXJrZXRfaWQ6IGFyYzQuVUludDY0CiAgICAvLyAjICkgLT4gYXJjNC5VSW50MjU2OgogICAgLy8gIyAgICAgcmV0dXJuIGFyYzQuVUludDI1NigKICAgIC8vICMgICAgICAgICBzZWxmLl9nZXRfdXNlcl9kZXBvc2l0X3VuZGVybHlpbmdfYW1vdW50KHVzZXJfaWQubmF0aXZlLCBtYXJrZXRfaWQubmF0aXZlKQogICAgLy8gIyAgICAgKQogICAgLy8gCiAgICAvLyAjIEBzdWJyb3V0aW5lCiAgICAvLyAjIGRlZiBfZ2V0X3VzZXJfZGVwb3NpdF91bmRlcmx5aW5nX2Ftb3VudCgKICAgIC8vICMgICAgIHNlbGYsIHVzZXJfaWQ6IEFjY291bnQsIG1hcmtldF9pZDogVUludDY0CiAgICAvLyAjICkgLT4gQmlnVUludDoKICAgIC8vICMgICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAjICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkgICMgQWRkIHRoaXMgbGluZQogICAgLy8gIyAgICAgcmV0dXJuICh1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKiBtYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUpIC8vIFNDQUxFCiAgICAvLyAKICAgIC8vICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9pbmNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2RlcG9zaXRzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCB1c2VyX2lkOiBBY2NvdW50LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyLnNjYWxlZF9kZXBvc2l0cyA9IGFyYzQuVUludDI1Nih1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKyBhbW91bnQpCiAgICAvLyAgICAgdXNlci5kZXBvc2l0X2luZGV4ID0gbWFya2V0LmRlcG9zaXRfaW5kZXgKICAgIC8vICAgICB1c2VyLmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vICAgICB1c2VyLmxhc3RfcHJpY2UgPSBtYXJrZXQucHJpY2UgICMgVXBkYXRlIHVzZXIncyBsYXN0IGtub3duIHByaWNlCiAgICAvLyAgICAgc2VsZi51c2Vyc1t1c2VyX2tleV0gPSB1c2VyLmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9pbmNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2JvcnJvd3MoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIHVzZXJfaWQ6IEFjY291bnQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlcl9rZXkgPSBzZWxmLl9nZXRfdXNlcl9rZXkodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIuc2NhbGVkX2JvcnJvd3MgPSBhcmM0LlVJbnQyNTYodXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgKyBhbW91bnQpCiAgICAvLyAgICAgdXNlci5ib3Jyb3dfaW5kZXggPSBtYXJrZXQuYm9ycm93X2luZGV4CiAgICAvLyAgICAgdXNlci5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApCiAgICAvLyAgICAgdXNlci5sYXN0X3ByaWNlID0gbWFya2V0LnByaWNlICAjIFVwZGF0ZSB1c2VyJ3MgbGFzdCBrbm93biBwcmljZQogICAgLy8gICAgIHNlbGYudXNlcnNbdXNlcl9rZXldID0gdXNlci5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZGVjcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9kZXBvc2l0cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgdXNlcl9pZDogQWNjb3VudCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyX2tleSA9IHNlbGYuX2dldF91c2VyX2tleSh1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgYXNzZXJ0ICgKICAgIC8vICAgICAgICAgdXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlID49IGFtb3VudAogICAgLy8gICAgICksICJJbnN1ZmZpY2llbnQgYmFsYW5jZSB0byB3aXRoZHJhdyB0aGlzIGFtb3VudCIKICAgIC8vICAgICB1c2VyLnNjYWxlZF9kZXBvc2l0cyA9IGFyYzQuVUludDI1Nih1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgLSBhbW91bnQpCiAgICAvLyAgICAgdXNlci5kZXBvc2l0X2luZGV4ID0gbWFya2V0LmRlcG9zaXRfaW5kZXgKICAgIC8vICAgICB1c2VyLmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vICAgICB1c2VyLmxhc3RfcHJpY2UgPSBtYXJrZXQucHJpY2UgICMgVXBkYXRlIHVzZXIncyBsYXN0IGtub3duIHByaWNlCiAgICAvLyAgICAgc2VsZi51c2Vyc1t1c2VyX2tleV0gPSB1c2VyLmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9kZWNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2JvcnJvd3MoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIHVzZXJfaWQ6IEFjY291bnQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlcl9rZXkgPSBzZWxmLl9nZXRfdXNlcl9rZXkodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgIHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlID49IGFtb3VudAogICAgLy8gICAgICksICJJbnN1ZmZpY2llbnQgYmFsYW5jZSB0byByZXBheSB0aGlzIGFtb3VudCIKICAgIC8vICAgICB1c2VyLnNjYWxlZF9ib3Jyb3dzID0gYXJjNC5VSW50MjU2KHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlIC0gYW1vdW50KQogICAgLy8gICAgIHVzZXIuYm9ycm93X2luZGV4ID0gbWFya2V0LmJvcnJvd19pbmRleAogICAgLy8gICAgIHVzZXIubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gICAgIHVzZXIubGFzdF9wcmljZSA9IG1hcmtldC5wcmljZSAgIyBVcGRhdGUgdXNlcidzIGxhc3Qga25vd24gcHJpY2UKICAgIC8vICAgICBzZWxmLnVzZXJzW3VzZXJfa2V5XSA9IHVzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGNyZWF0ZV9tYXJrZXQoCiAgICAvLyAgICAgc2VsZiwKICAgIC8vICAgICB0b2tlbl9pZDogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgY29sbGF0ZXJhbF9mYWN0b3I6IGFyYzQuVUludDY0LAogICAgLy8gICAgIGxpcXVpZGF0aW9uX3RocmVzaG9sZDogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgcmVzZXJ2ZV9mYWN0b3I6IGFyYzQuVUludDY0LAogICAgLy8gICAgIGJvcnJvd19yYXRlOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBzbG9wZTogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgbWF4X3RvdGFsX2RlcG9zaXRzOiBhcmM0LlVJbnQyNTYsCiAgICAvLyAgICAgbWF4X3RvdGFsX2JvcnJvd3M6IGFyYzQuVUludDI1NiwKICAgIC8vICAgICBsaXF1aWRhdGlvbl9ib251czogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgY2xvc2VfZmFjdG9yOiBhcmM0LlVJbnQ2NCwKICAgIC8vICkgLT4gYXJjNC5VSW50NjQ6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgYXNzZXJ0IG5vdCBzZWxmLl9pc19wYXVzZWQoKSwgIlByb3RvY29sIGlzIHBhdXNlZCIKICAgIC8vICAgICByZXR1cm4gYXJjNC5VSW50NjQoCiAgICAvLyAgICAgICAgIHNlbGYuX2NyZWF0ZV9tYXJrZXQoCiAgICAvLyAgICAgICAgICAgICB0b2tlbl9pZC5uYXRpdmUsCiAgICAvLyAgICAgICAgICAgICBNYXJrZXREYXRhKAogICAgLy8gICAgICAgICAgICAgICAgIHBhdXNlZD1hcmM0LkJvb2woVHJ1ZSksICAjIFN0YXJ0IHBhdXNlZCB1bnRpbCBwcmljZSBpcyBzZXQKICAgIC8vICAgICAgICAgICAgICAgICBtYXhfdG90YWxfZGVwb3NpdHM9bWF4X3RvdGFsX2RlcG9zaXRzLAogICAgLy8gICAgICAgICAgICAgICAgIG1heF90b3RhbF9ib3Jyb3dzPW1heF90b3RhbF9ib3Jyb3dzLAogICAgLy8gICAgICAgICAgICAgICAgIGxpcXVpZGF0aW9uX2JvbnVzPWxpcXVpZGF0aW9uX2JvbnVzLAogICAgLy8gICAgICAgICAgICAgICAgIGNvbGxhdGVyYWxfZmFjdG9yPWNvbGxhdGVyYWxfZmFjdG9yLAogICAgLy8gICAgICAgICAgICAgICAgIGxpcXVpZGF0aW9uX3RocmVzaG9sZD1saXF1aWRhdGlvbl90aHJlc2hvbGQsCiAgICAvLyAgICAgICAgICAgICAgICAgcmVzZXJ2ZV9mYWN0b3I9cmVzZXJ2ZV9mYWN0b3IsCiAgICAvLyAgICAgICAgICAgICAgICAgYm9ycm93X3JhdGU9Ym9ycm93X3JhdGUsCiAgICAvLyAgICAgICAgICAgICAgICAgc2xvcGU9c2xvcGUsCiAgICAvLyAgICAgICAgICAgICAgICAgdG90YWxfc2NhbGVkX2RlcG9zaXRzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgICAgICB0b3RhbF9zY2FsZWRfYm9ycm93cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICAgICAgZGVwb3NpdF9pbmRleD1hcmM0LlVJbnQyNTYoU0NBTEUpLCAgIyBTdGFydCBhdCBTQ0FMRSAoMS4wKQogICAgLy8gICAgICAgICAgICAgICAgIGJvcnJvd19pbmRleD1hcmM0LlVJbnQyNTYoU0NBTEUpLCAgIyBTdGFydCBhdCBTQ0FMRSAoMS4wKQogICAgLy8gICAgICAgICAgICAgICAgIGxhc3RfdXBkYXRlX3RpbWU9YXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApLAogICAgLy8gICAgICAgICAgICAgICAgIHJlc2VydmVzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgICAgICBwcmljZT1hcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgICAgICAgICAgICAgIDAKICAgIC8vICAgICAgICAgICAgICAgICApLCAgIyBQcmljZSBtdXN0IGJlIHNldCBiZWZvcmUgbWFya2V0IGNhbiBiZSB1c2VkCiAgICAvLyAgICAgICAgICAgICAgICAgbnRva2VuX2lkPWFyYzQuVUludDY0KDApLCAgIyBXaWxsIGJlIHNldCBkdXJpbmcgdG9rZW4gaW5pdGlhbGl6YXRpb24KICAgIC8vICAgICAgICAgICAgICAgICBjbG9zZV9mYWN0b3I9Y2xvc2VfZmFjdG9yLAogICAgLy8gICAgICAgICAgICAgKSwKICAgIC8vICAgICAgICAgKQogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfY3JlYXRlX21hcmtldChzZWxmLCB0b2tlbl9pZDogVUludDY0LCBtYXJrZXRfZGF0YTogTWFya2V0RGF0YSkgLT4gVUludDY0OgogICAgLy8gICAgIGFzc2VydCBub3QgdG9rZW5faWQgaW4gc2VsZi5tYXJrZXRzLCAiTWFya2V0IGFscmVhZHkgZXhpc3RzIgogICAgZnJhbWVfZGlnIC0yCiAgICBpdG9iCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjUxMAogICAgLy8gc2VsZi5tYXJrZXRzID0gQm94TWFwKFVJbnQ2NCwgTWFya2V0RGF0YSkgICMgTWFya2V0IHN0YXRlCiAgICBieXRlICJtYXJrZXRzIgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1MTAtNzMyCiAgICAvLyAgICAgc2VsZi5tYXJrZXRzID0gQm94TWFwKFVJbnQ2NCwgTWFya2V0RGF0YSkgICMgTWFya2V0IHN0YXRlCiAgICAvLyAgICAgc2VsZi51c2VycyA9IEJveE1hcChCeXRlczQwLCBVc2VyRGF0YSkgICMgUGVyLW1hcmtldCB1c2VyIHN0YXRlCiAgICAvLyAgICAgc2VsZi5nbG9iYWxfdXNlcnMgPSBCb3hNYXAoQWNjb3VudCwgR2xvYmFsVXNlckRhdGEpICAjIEdsb2JhbCB1c2VyIHN0YXRlCiAgICAvLyAKICAgIC8vICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gIyBPd25hYmxlCiAgICAvLyAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfb25seV9vd25lcihzZWxmKSAtPiBOb25lOgogICAgLy8gICAgIGFzc2VydCBUeG4uc2VuZGVyID09IHNlbGYub3duZXIsICJvbmx5IHRoZSBvd25lciBjYW4gY2FsbCB0aGlzIGZ1bmN0aW9uIgogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QocmVhZG9ubHk9VHJ1ZSkKICAgIC8vIGRlZiBnZXRfb3duZXIoc2VsZikgLT4gYXJjNC5BZGRyZXNzOgogICAgLy8gICAgIHJldHVybiBhcmM0LkFkZHJlc3Moc2VsZi5vd25lcikKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgdHJhbnNmZXJfb3duZXJzaGlwKHNlbGYsIG5ld19vd25lcjogYXJjNC5BZGRyZXNzKSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX29ubHlfb3duZXIoKQogICAgLy8gICAgIHNlbGYuX3RyYW5zZmVyX293bmVyc2hpcChuZXdfb3duZXIubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF90cmFuc2Zlcl9vd25lcnNoaXAoc2VsZiwgbmV3X293bmVyOiBBY2NvdW50KSAtPiBOb25lOgogICAgLy8gICAgIHByZXZpb3VzX293bmVyID0gc2VsZi5vd25lcgogICAgLy8gICAgIHNlbGYub3duZXIgPSBuZXdfb3duZXIKICAgIC8vICAgICBhcmM0LmVtaXQoCiAgICAvLyAgICAgICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKGFyYzQuQWRkcmVzcyhwcmV2aW91c19vd25lciksIGFyYzQuQWRkcmVzcyhuZXdfb3duZXIpKQogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAKICAgIC8vICMgUkVNIGhhdmluZyBpc3N1ZXMgd2l0aCB0aGUgaW5oZXJpdGFuY2UgaGVyZQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBpc19wYXVzZWQoc2VsZikgLT4gYXJjNC5Cb29sOgogICAgLy8gICAgIHJldHVybiBhcmM0LkJvb2woc2VsZi5faXNfcGF1c2VkKCkpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2lzX3BhdXNlZChzZWxmKSAtPiBib29sOgogICAgLy8gICAgIHJldHVybiBzZWxmLnBhdXNlZCA9PSBVSW50NjQoMSkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgcGF1c2Uoc2VsZiwgcGF1c2U6IGFyYzQuVUludDY0KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX29ubHlfb3duZXIoKQogICAgLy8gICAgIHNlbGYuX3BhdXNlKHBhdXNlLm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfcGF1c2Uoc2VsZiwgcGF1c2U6IFVJbnQ2NCkgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLnBhdXNlZCA9IHBhdXNlCiAgICAvLyAKICAgIC8vICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBnZXRfc3Rva2VuX2FwcF9pZChzZWxmKSAtPiBhcmM0LlVJbnQ2NDoKICAgIC8vICAgICByZXR1cm4gYXJjNC5VSW50NjQoc2VsZi5fZ2V0X3N0b2tlbl9hcHBfaWQoKSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X3N0b2tlbl9hcHBfaWQoc2VsZikgLT4gVUludDY0OgogICAgLy8gICAgIHJldHVybiBzZWxmLnN0b2tlbl9hcHBfaWQKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgc2V0X3N0b2tlbl9hcHBfaWQoc2VsZiwgc3Rva2VuX2FwcF9pZDogYXJjNC5VSW50NjQpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgc2VsZi5zdG9rZW5fYXBwX2lkID0gc3Rva2VuX2FwcF9pZC5uYXRpdmUKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X3VzZXJfa2V5KHNlbGYsIHVzZXJfaWQ6IEFjY291bnQsIG1hcmtldF9pZDogVUludDY0KSAtPiBCeXRlczQwOgogICAgLy8gICAgIHJldHVybiBCeXRlczQwLmZyb21fYnl0ZXMoCiAgICAvLyAgICAgICAgIGFyYzQuQWRkcmVzcyh1c2VyX2lkKS5ieXRlcyArIGFyYzQuVUludDY0KG1hcmtldF9pZCkuYnl0ZXMKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF91c2VyKHNlbGYsIHVzZXJfaWQ6IGFyYzQuQWRkcmVzcywgbWFya2V0X2lkOiBhcmM0LlVJbnQ2NCkgLT4gVXNlckRhdGE6CiAgICAvLyAgICAgcmV0dXJuIHNlbGYuX2dldF91c2VyKHVzZXJfaWQubmF0aXZlLCBtYXJrZXRfaWQubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9nZXRfdXNlcihzZWxmLCB1c2VyX2lkOiBBY2NvdW50LCBtYXJrZXRfaWQ6IFVJbnQ2NCkgLT4gVXNlckRhdGE6CiAgICAvLyAgICAgdXNlcl9rZXkgPSBzZWxmLl9nZXRfdXNlcl9rZXkodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHJldHVybiBzZWxmLnVzZXJzLmdldCgKICAgIC8vICAgICAgICAgdXNlcl9rZXksCiAgICAvLyAgICAgICAgIGRlZmF1bHQ9VXNlckRhdGEoCiAgICAvLyAgICAgICAgICAgICBzY2FsZWRfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgc2NhbGVkX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgZGVwb3NpdF9pbmRleD1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBib3Jyb3dfaW5kZXg9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgbGFzdF91cGRhdGVfdGltZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIGxhc3RfcHJpY2U9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICApLAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaGFzX3Bvc2l0aW9uKHNlbGYsIHVzZXJfaWQ6IEFjY291bnQsIG1hcmtldF9pZDogVUludDY0KSAtPiBib29sOgogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgcmV0dXJuIHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSA+IDAKICAgIC8vIAogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAKICAgIC8vICMgUkVNIGNvbnNpZGVyIHJlbW92aW5nIGFuZCBjYWxjdWxhdGluZyBpbiB0aGUgY2xpZW50CiAgICAvLyAjIFJFTSB0cnlpbmcgdG8gY3V0IGJhY2sgb24gZXh0cmEgcGFnZXMKICAgIC8vIAogICAgLy8gIyBAYXJjNC5hYmltZXRob2QKICAgIC8vICMgZGVmIGdldF91c2VyX2RlcG9zaXRfdW5kZXJseWluZ19hbW91bnQoCiAgICAvLyAjICAgICBzZWxmLCB1c2VyX2lkOiBhcmM0LkFkZHJlc3MsIG1hcmtldF9pZDogYXJjNC5VSW50NjQKICAgIC8vICMgKSAtPiBhcmM0LlVJbnQyNTY6CiAgICAvLyAjICAgICByZXR1cm4gYXJjNC5VSW50MjU2KAogICAgLy8gIyAgICAgICAgIHNlbGYuX2dldF91c2VyX2RlcG9zaXRfdW5kZXJseWluZ19hbW91bnQodXNlcl9pZC5uYXRpdmUsIG1hcmtldF9pZC5uYXRpdmUpCiAgICAvLyAjICAgICApCiAgICAvLyAKICAgIC8vICMgQHN1YnJvdXRpbmUKICAgIC8vICMgZGVmIF9nZXRfdXNlcl9kZXBvc2l0X3VuZGVybHlpbmdfYW1vdW50KAogICAgLy8gIyAgICAgc2VsZiwgdXNlcl9pZDogQWNjb3VudCwgbWFya2V0X2lkOiBVSW50NjQKICAgIC8vICMgKSAtPiBCaWdVSW50OgogICAgLy8gIyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICMgICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKSAgIyBBZGQgdGhpcyBsaW5lCiAgICAvLyAjICAgICByZXR1cm4gKHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSAqIG1hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZSkgLy8gU0NBTEUKICAgIC8vIAogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2luY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfZGVwb3NpdHMoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIHVzZXJfaWQ6IEFjY291bnQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlcl9rZXkgPSBzZWxmLl9nZXRfdXNlcl9rZXkodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIuc2NhbGVkX2RlcG9zaXRzID0gYXJjNC5VSW50MjU2KHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSArIGFtb3VudCkKICAgIC8vICAgICB1c2VyLmRlcG9zaXRfaW5kZXggPSBtYXJrZXQuZGVwb3NpdF9pbmRleAogICAgLy8gICAgIHVzZXIubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gICAgIHVzZXIubGFzdF9wcmljZSA9IG1hcmtldC5wcmljZSAgIyBVcGRhdGUgdXNlcidzIGxhc3Qga25vd24gcHJpY2UKICAgIC8vICAgICBzZWxmLnVzZXJzW3VzZXJfa2V5XSA9IHVzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2luY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfYm9ycm93cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgdXNlcl9pZDogQWNjb3VudCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyX2tleSA9IHNlbGYuX2dldF91c2VyX2tleSh1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlci5zY2FsZWRfYm9ycm93cyA9IGFyYzQuVUludDI1Nih1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSArIGFtb3VudCkKICAgIC8vICAgICB1c2VyLmJvcnJvd19pbmRleCA9IG1hcmtldC5ib3Jyb3dfaW5kZXgKICAgIC8vICAgICB1c2VyLmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vICAgICB1c2VyLmxhc3RfcHJpY2UgPSBtYXJrZXQucHJpY2UgICMgVXBkYXRlIHVzZXIncyBsYXN0IGtub3duIHByaWNlCiAgICAvLyAgICAgc2VsZi51c2Vyc1t1c2VyX2tleV0gPSB1c2VyLmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9kZWNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2RlcG9zaXRzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCB1c2VyX2lkOiBBY2NvdW50LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICB1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgPj0gYW1vdW50CiAgICAvLyAgICAgKSwgIkluc3VmZmljaWVudCBiYWxhbmNlIHRvIHdpdGhkcmF3IHRoaXMgYW1vdW50IgogICAgLy8gICAgIHVzZXIuc2NhbGVkX2RlcG9zaXRzID0gYXJjNC5VSW50MjU2KHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSAtIGFtb3VudCkKICAgIC8vICAgICB1c2VyLmRlcG9zaXRfaW5kZXggPSBtYXJrZXQuZGVwb3NpdF9pbmRleAogICAgLy8gICAgIHVzZXIubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gICAgIHVzZXIubGFzdF9wcmljZSA9IG1hcmtldC5wcmljZSAgIyBVcGRhdGUgdXNlcidzIGxhc3Qga25vd24gcHJpY2UKICAgIC8vICAgICBzZWxmLnVzZXJzW3VzZXJfa2V5XSA9IHVzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2RlY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfYm9ycm93cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgdXNlcl9pZDogQWNjb3VudCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyX2tleSA9IHNlbGYuX2dldF91c2VyX2tleSh1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgYXNzZXJ0ICgKICAgIC8vICAgICAgICAgdXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgPj0gYW1vdW50CiAgICAvLyAgICAgKSwgIkluc3VmZmljaWVudCBiYWxhbmNlIHRvIHJlcGF5IHRoaXMgYW1vdW50IgogICAgLy8gICAgIHVzZXIuc2NhbGVkX2JvcnJvd3MgPSBhcmM0LlVJbnQyNTYodXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgLSBhbW91bnQpCiAgICAvLyAgICAgdXNlci5ib3Jyb3dfaW5kZXggPSBtYXJrZXQuYm9ycm93X2luZGV4CiAgICAvLyAgICAgdXNlci5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApCiAgICAvLyAgICAgdXNlci5sYXN0X3ByaWNlID0gbWFya2V0LnByaWNlICAjIFVwZGF0ZSB1c2VyJ3MgbGFzdCBrbm93biBwcmljZQogICAgLy8gICAgIHNlbGYudXNlcnNbdXNlcl9rZXldID0gdXNlci5jb3B5KCkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgY3JlYXRlX21hcmtldCgKICAgIC8vICAgICBzZWxmLAogICAgLy8gICAgIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBjb2xsYXRlcmFsX2ZhY3RvcjogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgbGlxdWlkYXRpb25fdGhyZXNob2xkOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICByZXNlcnZlX2ZhY3RvcjogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgYm9ycm93X3JhdGU6IGFyYzQuVUludDY0LAogICAgLy8gICAgIHNsb3BlOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBtYXhfdG90YWxfZGVwb3NpdHM6IGFyYzQuVUludDI1NiwKICAgIC8vICAgICBtYXhfdG90YWxfYm9ycm93czogYXJjNC5VSW50MjU2LAogICAgLy8gICAgIGxpcXVpZGF0aW9uX2JvbnVzOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBjbG9zZV9mYWN0b3I6IGFyYzQuVUludDY0LAogICAgLy8gKSAtPiBhcmM0LlVJbnQ2NDoKICAgIC8vICAgICBzZWxmLl9vbmx5X293bmVyKCkKICAgIC8vICAgICBhc3NlcnQgbm90IHNlbGYuX2lzX3BhdXNlZCgpLCAiUHJvdG9jb2wgaXMgcGF1c2VkIgogICAgLy8gICAgIHJldHVybiBhcmM0LlVJbnQ2NCgKICAgIC8vICAgICAgICAgc2VsZi5fY3JlYXRlX21hcmtldCgKICAgIC8vICAgICAgICAgICAgIHRva2VuX2lkLm5hdGl2ZSwKICAgIC8vICAgICAgICAgICAgIE1hcmtldERhdGEoCiAgICAvLyAgICAgICAgICAgICAgICAgcGF1c2VkPWFyYzQuQm9vbChUcnVlKSwgICMgU3RhcnQgcGF1c2VkIHVudGlsIHByaWNlIGlzIHNldAogICAgLy8gICAgICAgICAgICAgICAgIG1heF90b3RhbF9kZXBvc2l0cz1tYXhfdG90YWxfZGVwb3NpdHMsCiAgICAvLyAgICAgICAgICAgICAgICAgbWF4X3RvdGFsX2JvcnJvd3M9bWF4X3RvdGFsX2JvcnJvd3MsCiAgICAvLyAgICAgICAgICAgICAgICAgbGlxdWlkYXRpb25fYm9udXM9bGlxdWlkYXRpb25fYm9udXMsCiAgICAvLyAgICAgICAgICAgICAgICAgY29sbGF0ZXJhbF9mYWN0b3I9Y29sbGF0ZXJhbF9mYWN0b3IsCiAgICAvLyAgICAgICAgICAgICAgICAgbGlxdWlkYXRpb25fdGhyZXNob2xkPWxpcXVpZGF0aW9uX3RocmVzaG9sZCwKICAgIC8vICAgICAgICAgICAgICAgICByZXNlcnZlX2ZhY3Rvcj1yZXNlcnZlX2ZhY3RvciwKICAgIC8vICAgICAgICAgICAgICAgICBib3Jyb3dfcmF0ZT1ib3Jyb3dfcmF0ZSwKICAgIC8vICAgICAgICAgICAgICAgICBzbG9wZT1zbG9wZSwKICAgIC8vICAgICAgICAgICAgICAgICB0b3RhbF9zY2FsZWRfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgICAgIHRvdGFsX3NjYWxlZF9ib3Jyb3dzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgICAgICBkZXBvc2l0X2luZGV4PWFyYzQuVUludDI1NihTQ0FMRSksICAjIFN0YXJ0IGF0IFNDQUxFICgxLjApCiAgICAvLyAgICAgICAgICAgICAgICAgYm9ycm93X2luZGV4PWFyYzQuVUludDI1NihTQ0FMRSksICAjIFN0YXJ0IGF0IFNDQUxFICgxLjApCiAgICAvLyAgICAgICAgICAgICAgICAgbGFzdF91cGRhdGVfdGltZT1hcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCksCiAgICAvLyAgICAgICAgICAgICAgICAgcmVzZXJ2ZXM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgICAgIHByaWNlPWFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgICAgICAgICAgICAgMAogICAgLy8gICAgICAgICAgICAgICAgICksICAjIFByaWNlIG11c3QgYmUgc2V0IGJlZm9yZSBtYXJrZXQgY2FuIGJlIHVzZWQKICAgIC8vICAgICAgICAgICAgICAgICBudG9rZW5faWQ9YXJjNC5VSW50NjQoMCksICAjIFdpbGwgYmUgc2V0IGR1cmluZyB0b2tlbiBpbml0aWFsaXphdGlvbgogICAgLy8gICAgICAgICAgICAgICAgIGNsb3NlX2ZhY3Rvcj1jbG9zZV9mYWN0b3IsCiAgICAvLyAgICAgICAgICAgICApLAogICAgLy8gICAgICAgICApCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9jcmVhdGVfbWFya2V0KHNlbGYsIHRva2VuX2lkOiBVSW50NjQsIG1hcmtldF9kYXRhOiBNYXJrZXREYXRhKSAtPiBVSW50NjQ6CiAgICAvLyAgICAgYXNzZXJ0IG5vdCB0b2tlbl9pZCBpbiBzZWxmLm1hcmtldHMsICJNYXJrZXQgYWxyZWFkeSBleGlzdHMiCiAgICBkaWcgMQogICAgY29uY2F0CiAgICBkdXAKICAgIGJveF9sZW4KICAgIGJ1cnkgMQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo3MzIKICAgIC8vIGFzc2VydCBub3QgdG9rZW5faWQgaW4gc2VsZi5tYXJrZXRzLCAiTWFya2V0IGFscmVhZHkgZXhpc3RzIgogICAgIQogICAgYXNzZXJ0IC8vIE1hcmtldCBhbHJlYWR5IGV4aXN0cwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo3MzMKICAgIC8vIHBheW1lbnQgPSByZXF1aXJlX3BheW1lbnQoVHhuLnNlbmRlcikKICAgIHR4biBTZW5kZXIKICAgIGNhbGxzdWIgcmVxdWlyZV9wYXltZW50CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjczNQogICAgLy8gcGF5bWVudCA+PSBzZWxmLl9jcmVhdGVfbWFya2V0X2Nvc3QoKQogICAgY2FsbHN1YiBfY3JlYXRlX21hcmtldF9jb3N0CiAgICA+PQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo3MzQtNzM2CiAgICAvLyBhc3NlcnQgKAogICAgLy8gICAgIHBheW1lbnQgPj0gc2VsZi5fY3JlYXRlX21hcmtldF9jb3N0KCkKICAgIC8vICksICJpbnN1ZmZpY2llbnQgcGF5bWVudCBmb3IgY3JlYXRlIG1hcmtldCIKICAgIGFzc2VydCAvLyBpbnN1ZmZpY2llbnQgcGF5bWVudCBmb3IgY3JlYXRlIG1hcmtldAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo3MzgKICAgIC8vIGJhc2VfYXBwID0gYXJjNC5hcmM0X2NyZWF0ZShOVG9rZW4sIGNvbXBpbGVkPWNvbXBpbGVkKS5jcmVhdGVkX2FwcAogICAgaXR4bl9iZWdpbgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo3MzcKICAgIC8vIGNvbXBpbGVkID0gY29tcGlsZV9jb250cmFjdChOVG9rZW4sIGV4dHJhX3Byb2dyYW1fcGFnZXM9MCkgICMgbm8gZXh0cmEgcGFnZXMKICAgIGludCA3CiAgICBpdHhuX2ZpZWxkIEdsb2JhbE51bVVpbnQKICAgIGludCA2CiAgICBpdHhuX2ZpZWxkIEdsb2JhbE51bUJ5dGVTbGljZQogICAgYnl0ZSBiYXNlNjQgQ29FQlF3PT0KICAgIGl0eG5fZmllbGQgQ2xlYXJTdGF0ZVByb2dyYW1QYWdlcwogICAgYnl0ZSBiYXNlNjQgQ2lBRUFBRWdCaVlVQkJVZmZIVUxkRzkwWVd4VGRYQndiSGtGYjNkdVpYSUFDR0poYkdGdVkyVnpDSFJ2YTJWdVgybGtBWUFKY0dGeVpXNTBYMmxrQkhtRHcxd0lkWEJuY21Ga1pYSUVibUZ0WlFaemVXMWliMndJWkdWamFXMWhiSE1FWlgwVDdBUzJyaG9sQklUc0U5VUpZWEJ3Y205MllXeHpFR052Ym5SeVlXTjBYM1psY25OcGIyNFNaR1Z3Ykc5NWJXVnVkRjkyWlhKemFXOXVDWFZ3WkdGMFlXSnNaVEVZUUFBRGlBY0FNUnRCQWdPQ0NRUjJqT3JrQkxDcE9POEVwckxUK3dURS90ZnpCTFdWN0JNRThWQlZKd1R6ZURjQkJOcHdKYmtFU3BhUGp5Y05KdzRuRDRJSkJPeVpZRUVFZ3VWenhBUzdzeG56QkxWQ0lTVUUveXVseFFTRkprMStCSGk4bWRRRTFKYS9Rd1JyQzQvNE5ob0FqaFVBQVFBVUFDY0FOZ0JHQUZnQVp3QjVBSThBcUFDNEFNZ0EyQURvQVBzQkVRRW5BVGNCUmdGWUFXY0FNUmtVUkRFWVJEWWFBWWdCZnloTVVMQWpRekVaRkVReEdFUTJHZ0dJQWlBb1RGQ3dJME14R1JSRU1SaEVOaG9CaUFKU0kwTXhHUlJFTVJoRWlBTGlLRXhRc0NORE1Sa1VSREVZUkRZYUFUWWFBb2dDM2lORE1Sa1VSREVZUkRZYUFZZ0RIQ05ETVJrVVJERVlSRFlhQVRZYUFvZ0RiQ05ETVJrVVJERVlSRFlhQVRZYUFvZ0R1aWhNVUxBalF6RVpGRVF4R0VRMkdnRTJHZ0kyR2dPSUJEVW9URkN3STBNeEdSUkVNUmhFaUFTN0tFeFFzQ05ETVJrVVJERVlSSWdFdENoTVVMQWpRekVaRkVReEdFU0lCSzBvVEZDd0kwTXhHUlJFTVJoRWlBU3FLRXhRc0NORE1Sa1VSREVZUkRZYUFZZ0VweWhNVUxBalF6RVpGRVF4R0VRMkdnRTJHZ0tJQktJb1RGQ3dJME14R1JSRU1SaEVOaG9CTmhvQ2lBU2ZLRXhRc0NORE1Sa1VSREVZUklnRW5paE1VTEFqUXpFWkZFUXhHRVEyR2dHSUJKTWpRekVaRkVReEdFUTJHZ0UyR2dLSUJMRWpRekVaRkVReEdFUTJHZ0dJQk1JalF6RVpGRVF4R0VRalF5S0JCREVaamdJQUFRQUtBREVZRkVTSUJNUWpRekVZUklnRXlDTkRpZ0VCaS8rSUFBbEpGU1FPUkNTdnE0bUtBUUdMLzRnQUdVbUwvNGdBSVVsT0FxWkJBQVFyakFDSml3Q0xBYUdNQUltS0FRRW5CSXYvVUw0clRnSk5pWW9CQWJFaUp3VmxSQllpSndkbFJMSVlnQVFKd1AxQXNocUwvN0lhc2hvbHNoQWlzZ0d6dEQ1SlZ3UUFURmNBQkNnU1JMRWlKd1ZsUkJZaUp3ZGxSTElZZ0FRZU1UV3ZzaHF5R2lXeUVDS3lBYk8wUGtsWEJBQk1Wd0FFS0JKRVRGY0FJRXhYc1NDamdBZ040TGF6cDJRQUFLS0ppZ0VCaS8rSUFBR0ppZ0VCaS8rSS8yMkwvNGovZGt5TC80ai9RVTRDU1JVa0RrUWtyMGxPQXF0T0Frc0JGU1FPUkVsT0FxdE1Td01WSkE1RVR3T3JUZ0pRVEZDSmlnRUFJaWNGWlVRVVJJdi9GNGdBQzRBRVhTdVI1NHYvVUxDSmlnRUFzWXYvc2hnbkQ3SWFKYklRSXJJQnM3UStTVmNFQUV4WEFBUW9Fa1N4aS8reUdDY05zaG9sc2hBaXNnR3p0RDVKVndRQVRGY0FCQ2dTUkxHTC83SVlKdzZ5R2lXeUVDS3lBYk8wUGtsWEJBQk1Wd0FFS0JKRWdBZEViM0pyUm1rZ1R3SlFKd3BNWjRBQmJreFFKd3RNWnhjbkRFeG5LU3RuSndXTC8yZUppZ0FCaUFBQ0ZvbUtBQUV5QVlIRVJRaUppZ0lBTVFBaUttVkVFa1NML292L2lBQUJpWW9DQUNJcFpVU0wvNkFwVEdlTC9vaitaaWNFaS81UVRJdi9vRXhKdkVoTXZ6SURpLzhWSkE1RUpLK0wvNnRNaS81UVRGQW5DRXhRc0ltS0FRQWlLbVZFTVFBU1FRQUdpLytJQUJDSk1RQ0kvZ1dMLzZkRWkvK0lBQUdKaWdFQU1RQ0kvaFJKaS8rblJDY0VNUUJRVEl2L29VeEp2RWhNdnlJcFpVU0wvNkVwVEdjeEFESURpLzhWSkE1RUpLK0wvNnRPQWxCTVVDY0lURkN3aVlvQ0FDSXFaVVF4QUJKRWkvNkwvNGdBQVltS0FnQ0wvb2o5d1l2L0s2VkVTWXYvcDBRaUtXVkVpLytuUkNjRWkvNVFUSXYvb1V4SnZFaE12eUlwWlVTTC82RXBUR2N5QTR2L0ZTUU9SQ1N2aS8rcmkvNVBBbEJNVUNjSVRGQ3dpWW9DQVNJcVpVUXhBQkpCQUF3eEFJditpLytJQUI0bkJvbUwvaklERTBReEFJajlONHYvcDBReEFJditpLytJQUFNbkJvbUtBd0NML1lqOVFFbUwvb2o5T2s0Q2kvK25SSXY5aS80U1FRQU5Kd1NML1ZCSnZFaE12MElBSHljRWkvMVFUSXYvb1V4SnZFaE12eWNFaS81UWl3Q0wvNkJNU2J4SVRMK0wveFVrRGtRa3I0di9xNHY5aS81UVRGQW5DRXhRc0ltS0F3RWlLbVZFTVFBU1FRQU1pLzJML292L2lBQWVKd2FKaS80eUF4TkVpLzJJL0tPTC82ZEVpLzJML292L2lBQURKd2FKaWdNQU1RQ0wvVXNCaUFBWlNZdi9wMFNMLzZHTC9VNENpQUFkaS8yTC9vdi9pUDlJaVlvQ0FZditpLzlRQVNjUVRGQytLMDRDVFltS0F3Q0wvWXYrVUVrQkp4Qk1VRW04U0l2L3Y0di9GU1FPUkNTdmkvK3JVSUFFR1duNFpVeFFzSW1LQUFFaUp3cGxSSW1LQUFFaUp3dGxSSW1LQUFFaUp3eGxSQlpYQndHSmlnQUJJaWxsUkVrVkpBNUVKSytyaVlvQkFZdi9pUHdiU1JVa0RrUWtyNnVKaWdJQmkvNkwvNGovZVVrVkpBNUVKSytyaVlvQ0FURUFpLzZMLzRqL2R5Y0dpWW9BQVNJcVpVU0ppZ0VBaUFBR2kvK0lBQTJKaWdBQU1RQWlLbVZFRWtTSmlnRUFJaXBsUkNxTC8yZUwvMUNBQkpvaVB2dE1VTENKaWdJQWkvNkwvMUNBQkl5TStjMU1VTENML2hjbkVVeG5pLzhYSnhKTVo0bUtBUUF4QURJSkVrUWlKd2xsUkl2L1VJQUVyZlhpdUV4UXNDY0ppLzluaVlvQUFESU5TVVFuQjB4bmlZb0FBREVBSWljSlpVUVNSQ0luRTJWRUl4SkVpWW9BQUNjS0syY25DeXRuSnd3aVp5a3JaeWNISW1jbkJTSm5LaklKWjRBTVltOXZkSE4wY21Gd2NHVmtJbWNuRVNKbkp4SWlaeWNUSTJjbkNUSUpaNGs9CiAgICBpdHhuX2ZpZWxkIEFwcHJvdmFsUHJvZ3JhbVBhZ2VzCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjczOAogICAgLy8gYmFzZV9hcHAgPSBhcmM0LmFyYzRfY3JlYXRlKE5Ub2tlbiwgY29tcGlsZWQ9Y29tcGlsZWQpLmNyZWF0ZWRfYXBwCiAgICBpbnQgYXBwbAogICAgaXR4bl9maWVsZCBUeXBlRW51bQogICAgaW50IDAKICAgIGl0eG5fZmllbGQgRmVlCiAgICBpdHhuX3N1Ym1pdAogICAgaXR4biBDcmVhdGVkQXBwbGljYXRpb25JRAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo3MzktNzQyCiAgICAvLyBib290c3RyYXA2NF9jb3N0LCB0eG4xID0gYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICBOVG9rZW4uYm9vdHN0cmFwNjRfY29zdCwKICAgIC8vICAgICBhcHBfaWQ9YmFzZV9hcHAsCiAgICAvLyApCiAgICBpdHhuX2JlZ2luCiAgICBkdXAKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25JRAogICAgbWV0aG9kICJib290c3RyYXA2NF9jb3N0KCl1aW50NjQiCiAgICBpdHhuX2ZpZWxkIEFwcGxpY2F0aW9uQXJncwogICAgaW50IGFwcGwKICAgIGl0eG5fZmllbGQgVHlwZUVudW0KICAgIGludCAwCiAgICBpdHhuX2ZpZWxkIEZlZQogICAgaXR4bl9zdWJtaXQKICAgIGl0eG4gTGFzdExvZwogICAgZHVwCiAgICBleHRyYWN0IDQgMAogICAgc3dhcAogICAgZXh0cmFjdCAwIDQKICAgIGJ5dGUgMHgxNTFmN2M3NQogICAgPT0KICAgIGFzc2VydCAvLyBBUkM0IHByZWZpeCBpcyB2YWxpZAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo3NDMtNzQ1CiAgICAvLyBpdHhuLlBheW1lbnQoCiAgICAvLyAgICAgcmVjZWl2ZXI9YmFzZV9hcHAuYWRkcmVzcywgYW1vdW50PWJvb3RzdHJhcDY0X2Nvc3QubmF0aXZlLCBmZWU9MAogICAgLy8gKS5zdWJtaXQoKQogICAgaXR4bl9iZWdpbgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo3NDQKICAgIC8vIHJlY2VpdmVyPWJhc2VfYXBwLmFkZHJlc3MsIGFtb3VudD1ib290c3RyYXA2NF9jb3N0Lm5hdGl2ZSwgZmVlPTAKICAgIGRpZyAxCiAgICBhcHBfcGFyYW1zX2dldCBBcHBBZGRyZXNzCiAgICBhc3NlcnQgLy8gYXBwbGljYXRpb24gZXhpc3RzCiAgICBzd2FwCiAgICBidG9pCiAgICBpdHhuX2ZpZWxkIEFtb3VudAogICAgaXR4bl9maWVsZCBSZWNlaXZlcgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo3NDMKICAgIC8vIGl0eG4uUGF5bWVudCgKICAgIGludCBwYXkKICAgIGl0eG5fZmllbGQgVHlwZUVudW0KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NzQ0CiAgICAvLyByZWNlaXZlcj1iYXNlX2FwcC5hZGRyZXNzLCBhbW91bnQ9Ym9vdHN0cmFwNjRfY29zdC5uYXRpdmUsIGZlZT0wCiAgICBpbnQgMAogICAgaXR4bl9maWVsZCBGZWUKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NzQzLTc0NQogICAgLy8gaXR4bi5QYXltZW50KAogICAgLy8gICAgIHJlY2VpdmVyPWJhc2VfYXBwLmFkZHJlc3MsIGFtb3VudD1ib290c3RyYXA2NF9jb3N0Lm5hdGl2ZSwgZmVlPTAKICAgIC8vICkuc3VibWl0KCkKICAgIGl0eG5fc3VibWl0CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojc0Ni03NTAKICAgIC8vIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgTlRva2VuLmJvb3RzdHJhcDY0LAogICAgLy8gICAgIGFyYzQuVUludDY0KHRva2VuX2lkKSwKICAgIC8vICAgICBhcHBfaWQ9YmFzZV9hcHAsCiAgICAvLyApCiAgICBpdHhuX2JlZ2luCiAgICBkdXAKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25JRAogICAgbWV0aG9kICJib290c3RyYXA2NCh1aW50NjQpdm9pZCIKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICBkaWcgMgogICAgaXR4bl9maWVsZCBBcHBsaWNhdGlvbkFyZ3MKICAgIGludCBhcHBsCiAgICBpdHhuX2ZpZWxkIFR5cGVFbnVtCiAgICBpbnQgMAogICAgaXR4bl9maWVsZCBGZWUKICAgIGl0eG5fc3VibWl0CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojc1MQogICAgLy8gbWFya2V0X2RhdGEubnRva2VuX2lkID0gYXJjNC5VSW50NjQoYmFzZV9hcHAuaWQpCiAgICBkdXAKICAgIGl0b2IKICAgIGZyYW1lX2RpZyAtMQogICAgaW50IDMxMwogICAgZGlnIDIKICAgIHJlcGxhY2UzCiAgICBmcmFtZV9idXJ5IC0xCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojc1MgogICAgLy8gc2VsZi5tYXJrZXRzW3Rva2VuX2lkXSA9IG1hcmtldF9kYXRhLmNvcHkoKQogICAgdW5jb3ZlciAyCiAgICBmcmFtZV9kaWcgLTEKICAgIGJveF9wdXQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NzU0CiAgICAvLyBNYXJrZXRDcmVhdGVkKGFyYzQuVUludDY0KHRva2VuX2lkKSwgYXJjNC5VSW50NjQoYmFzZV9hcHAuaWQpLCBtYXJrZXRfZGF0YSkKICAgIHVuY292ZXIgMgogICAgc3dhcAogICAgY29uY2F0CiAgICBmcmFtZV9kaWcgLTEKICAgIGNvbmNhdAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo3NTMtNzU1CiAgICAvLyBhcmM0LmVtaXQoCiAgICAvLyAgICAgTWFya2V0Q3JlYXRlZChhcmM0LlVJbnQ2NCh0b2tlbl9pZCksIGFyYzQuVUludDY0KGJhc2VfYXBwLmlkKSwgbWFya2V0X2RhdGEpCiAgICAvLyApCiAgICBtZXRob2QgIk1hcmtldENyZWF0ZWQodWludDY0LHVpbnQ2NCwoYm9vbCx1aW50MjU2LHVpbnQyNTYsdWludDY0LHVpbnQ2NCx1aW50NjQsdWludDY0LHVpbnQ2NCx1aW50NjQsdWludDI1Nix1aW50MjU2LHVpbnQyNTYsdWludDI1Nix1aW50NjQsdWludDI1Nix1aW50MjU2LHVpbnQ2NCx1aW50NjQpKSIKICAgIHN3YXAKICAgIGNvbmNhdAogICAgbG9nCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojc1NgogICAgLy8gcmV0dXJuIGJhc2VfYXBwLmlkCiAgICBmcmFtZV9kaWcgLTEKICAgIHJldHN1YgoKCi8vIG9wZW5zdWJtYXJpbmUudXRpbHMuYWxnb3JhbmQucmVxdWlyZV9wYXltZW50KHdobzogYnl0ZXMpIC0+IHVpbnQ2NDoKcmVxdWlyZV9wYXltZW50OgogICAgLy8gdXNyL2xvY2FsL2xpYi9weXRob24zLjEyL3NpdGUtcGFja2FnZXMvb3BlbnN1Ym1hcmluZS91dGlscy9hbGdvcmFuZC5weToxNS0yMwogICAgLy8gIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgLy8gIyBmdW5jdGlvbjogcmVxdWlyZV9wYXltZW50IChpbnRlcm5hbCkKICAgIC8vICMgYXJndW1lbnRzOiBOb25lCiAgICAvLyAjIHB1cnBvc2U6IGNoZWNrIHBheW1lbnQKICAgIC8vICMgcHJlLWNvbmRpdGlvbnM6IE5vbmUKICAgIC8vICMgcG9zdC1jb25kaXRpb25zOiBOb25lCiAgICAvLyAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIHJlcXVpcmVfcGF5bWVudCh3aG86IEFjY291bnQpIC0+IFVJbnQ2NDoKICAgIHByb3RvIDEgMQogICAgLy8gdXNyL2xvY2FsL2xpYi9weXRob24zLjEyL3NpdGUtcGFja2FnZXMvb3BlbnN1Ym1hcmluZS91dGlscy9hbGdvcmFuZC5weToyNAogICAgLy8gcmVmX2dyb3VwX2luZGV4ID0gVHhuLmdyb3VwX2luZGV4CiAgICB0eG4gR3JvdXBJbmRleAogICAgLy8gdXNyL2xvY2FsL2xpYi9weXRob24zLjEyL3NpdGUtcGFja2FnZXMvb3BlbnN1Ym1hcmluZS91dGlscy9hbGdvcmFuZC5weToyNQogICAgLy8gYXNzZXJ0IHJlZl9ncm91cF9pbmRleCA+IDAsICJncm91cCBpbmRleCBncmVhdGVyIHRoYW4gemVybyIKICAgIGR1cAogICAgYXNzZXJ0IC8vIGdyb3VwIGluZGV4IGdyZWF0ZXIgdGhhbiB6ZXJvCiAgICAvLyB1c3IvbG9jYWwvbGliL3B5dGhvbjMuMTIvc2l0ZS1wYWNrYWdlcy9vcGVuc3VibWFyaW5lL3V0aWxzL2FsZ29yYW5kLnB5OjI2CiAgICAvLyBwYXltZW50X2dyb3VwX2luZGV4ID0gcmVmX2dyb3VwX2luZGV4IC0gMQogICAgaW50IDEKICAgIC0KICAgIC8vIHVzci9sb2NhbC9saWIvcHl0aG9uMy4xMi9zaXRlLXBhY2thZ2VzL29wZW5zdWJtYXJpbmUvdXRpbHMvYWxnb3JhbmQucHk6MjgKICAgIC8vIGd0eG4uUGF5bWVudFRyYW5zYWN0aW9uKHBheW1lbnRfZ3JvdXBfaW5kZXgpLnNlbmRlciA9PSB3aG8KICAgIGR1cAogICAgZ3R4bnMgVHlwZUVudW0KICAgIGludCBwYXkKICAgID09CiAgICBhc3NlcnQgLy8gdHJhbnNhY3Rpb24gdHlwZSBpcyBwYXkKICAgIGR1cAogICAgZ3R4bnMgU2VuZGVyCiAgICBmcmFtZV9kaWcgLTEKICAgID09CiAgICAvLyB1c3IvbG9jYWwvbGliL3B5dGhvbjMuMTIvc2l0ZS1wYWNrYWdlcy9vcGVuc3VibWFyaW5lL3V0aWxzL2FsZ29yYW5kLnB5OjI3LTI5CiAgICAvLyBhc3NlcnQgKAogICAgLy8gICAgIGd0eG4uUGF5bWVudFRyYW5zYWN0aW9uKHBheW1lbnRfZ3JvdXBfaW5kZXgpLnNlbmRlciA9PSB3aG8KICAgIC8vICksICJwYXltZW50IHNlbmRlciBhY2N1cmF0ZSIKICAgIGFzc2VydCAvLyBwYXltZW50IHNlbmRlciBhY2N1cmF0ZQogICAgLy8gdXNyL2xvY2FsL2xpYi9weXRob24zLjEyL3NpdGUtcGFja2FnZXMvb3BlbnN1Ym1hcmluZS91dGlscy9hbGdvcmFuZC5weTozMQogICAgLy8gZ3R4bi5QYXltZW50VHJhbnNhY3Rpb24ocGF5bWVudF9ncm91cF9pbmRleCkucmVjZWl2ZXIKICAgIGR1cAogICAgZ3R4bnMgUmVjZWl2ZXIKICAgIC8vIHVzci9sb2NhbC9saWIvcHl0aG9uMy4xMi9zaXRlLXBhY2thZ2VzL29wZW5zdWJtYXJpbmUvdXRpbHMvYWxnb3JhbmQucHk6MzIKICAgIC8vID09IEdsb2JhbC5jdXJyZW50X2FwcGxpY2F0aW9uX2FkZHJlc3MKICAgIGdsb2JhbCBDdXJyZW50QXBwbGljYXRpb25BZGRyZXNzCiAgICAvLyB1c3IvbG9jYWwvbGliL3B5dGhvbjMuMTIvc2l0ZS1wYWNrYWdlcy9vcGVuc3VibWFyaW5lL3V0aWxzL2FsZ29yYW5kLnB5OjMxLTMyCiAgICAvLyBndHhuLlBheW1lbnRUcmFuc2FjdGlvbihwYXltZW50X2dyb3VwX2luZGV4KS5yZWNlaXZlcgogICAgLy8gPT0gR2xvYmFsLmN1cnJlbnRfYXBwbGljYXRpb25fYWRkcmVzcwogICAgPT0KICAgIC8vIHVzci9sb2NhbC9saWIvcHl0aG9uMy4xMi9zaXRlLXBhY2thZ2VzL29wZW5zdWJtYXJpbmUvdXRpbHMvYWxnb3JhbmQucHk6MzAtMzMKICAgIC8vIGFzc2VydCAoCiAgICAvLyAgICAgZ3R4bi5QYXltZW50VHJhbnNhY3Rpb24ocGF5bWVudF9ncm91cF9pbmRleCkucmVjZWl2ZXIKICAgIC8vICAgICA9PSBHbG9iYWwuY3VycmVudF9hcHBsaWNhdGlvbl9hZGRyZXNzCiAgICAvLyApLCAicGF5bWVudCByZWNlaXZlciBhY2N1cmF0ZSIKICAgIGFzc2VydCAvLyBwYXltZW50IHJlY2VpdmVyIGFjY3VyYXRlCiAgICAvLyB1c3IvbG9jYWwvbGliL3B5dGhvbjMuMTIvc2l0ZS1wYWNrYWdlcy9vcGVuc3VibWFyaW5lL3V0aWxzL2FsZ29yYW5kLnB5OjM0CiAgICAvLyByZXR1cm4gZ3R4bi5QYXltZW50VHJhbnNhY3Rpb24ocGF5bWVudF9ncm91cF9pbmRleCkuYW1vdW50CiAgICBndHhucyBBbW91bnQKICAgIHJldHN1YgoKCi8vIGNvbnRyYWN0LkxlbmRpbmdQb29sLl9jcmVhdGVfbWFya2V0X2Nvc3QoKSAtPiB1aW50NjQ6Cl9jcmVhdGVfbWFya2V0X2Nvc3Q6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojc2Mi03NjMKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2NyZWF0ZV9tYXJrZXRfY29zdChzZWxmKSAtPiBVSW50NjQ6CiAgICBwcm90byAwIDEKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NzY0CiAgICAvLyByZXR1cm4gVUludDY0KDFfMDAwXzAwMCkKICAgIGludCAxMDAwMDAwCiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5jcmVhdGVfbWFya2V0X2Nvc3QoKSAtPiBieXRlczoKY3JlYXRlX21hcmtldF9jb3N0OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo3NTgtNzU5CiAgICAvLyBAYXJjNC5hYmltZXRob2QocmVhZG9ubHk9VHJ1ZSkKICAgIC8vIGRlZiBjcmVhdGVfbWFya2V0X2Nvc3Qoc2VsZikgLT4gYXJjNC5VSW50NjQ6CiAgICBwcm90byAwIDEKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NzYwCiAgICAvLyByZXR1cm4gYXJjNC5VSW50NjQoc2VsZi5fY3JlYXRlX21hcmtldF9jb3N0KCkpCiAgICBjYWxsc3ViIF9jcmVhdGVfbWFya2V0X2Nvc3QKICAgIGl0b2IKICAgIHJldHN1YgoKCi8vIGNvbnRyYWN0LkxlbmRpbmdQb29sLmdldF9tYXJrZXQodG9rZW5faWQ6IGJ5dGVzKSAtPiBieXRlczoKZ2V0X21hcmtldDoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NzY2LTc2NwogICAgLy8gQGFyYzQuYWJpbWV0aG9kKHJlYWRvbmx5PVRydWUpCiAgICAvLyBkZWYgZ2V0X21hcmtldChzZWxmLCB0b2tlbl9pZDogYXJjNC5VSW50NjQpIC0+IE1hcmtldERhdGE6CiAgICBwcm90byAxIDEKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NzY4CiAgICAvLyByZXR1cm4gc2VsZi5fZ2V0X21hcmtldCh0b2tlbl9pZC5uYXRpdmUpCiAgICBmcmFtZV9kaWcgLTEKICAgIGJ0b2kKICAgIGNhbGxzdWIgX2dldF9tYXJrZXQKICAgIHJldHN1YgoKCi8vIGNvbnRyYWN0LkxlbmRpbmdQb29sLl9nZXRfbWFya2V0KHRva2VuX2lkOiB1aW50NjQpIC0+IGJ5dGVzOgpfZ2V0X21hcmtldDoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NzcwLTc3MQogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X21hcmtldChzZWxmLCB0b2tlbl9pZDogVUludDY0KSAtPiBNYXJrZXREYXRhOgogICAgcHJvdG8gMSAxCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojc3Mi03OTQKICAgIC8vIHJldHVybiBzZWxmLm1hcmtldHMuZ2V0KAogICAgLy8gICAgIHRva2VuX2lkLAogICAgLy8gICAgIGRlZmF1bHQ9TWFya2V0RGF0YSgKICAgIC8vICAgICAgICAgcGF1c2VkPWFyYzQuQm9vbChUcnVlKSwKICAgIC8vICAgICAgICAgbWF4X3RvdGFsX2RlcG9zaXRzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgbWF4X3RvdGFsX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICBsaXF1aWRhdGlvbl9ib251cz1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgY29sbGF0ZXJhbF9mYWN0b3I9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgIGxpcXVpZGF0aW9uX3RocmVzaG9sZD1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgcmVzZXJ2ZV9mYWN0b3I9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgIGJvcnJvd19yYXRlPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICBzbG9wZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgdG90YWxfc2NhbGVkX2RlcG9zaXRzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgdG90YWxfc2NhbGVkX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICBkZXBvc2l0X2luZGV4PWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgYm9ycm93X2luZGV4PWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgbGFzdF91cGRhdGVfdGltZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgcmVzZXJ2ZXM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICBwcmljZT1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgIG50b2tlbl9pZD1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgY2xvc2VfZmFjdG9yPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICksCiAgICAvLyApCiAgICBmcmFtZV9kaWcgLTEKICAgIGl0b2IKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTEwCiAgICAvLyBzZWxmLm1hcmtldHMgPSBCb3hNYXAoVUludDY0LCBNYXJrZXREYXRhKSAgIyBNYXJrZXQgc3RhdGUKICAgIGJ5dGUgIm1hcmtldHMiCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojc3Mi03OTQKICAgIC8vIHJldHVybiBzZWxmLm1hcmtldHMuZ2V0KAogICAgLy8gICAgIHRva2VuX2lkLAogICAgLy8gICAgIGRlZmF1bHQ9TWFya2V0RGF0YSgKICAgIC8vICAgICAgICAgcGF1c2VkPWFyYzQuQm9vbChUcnVlKSwKICAgIC8vICAgICAgICAgbWF4X3RvdGFsX2RlcG9zaXRzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgbWF4X3RvdGFsX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICBsaXF1aWRhdGlvbl9ib251cz1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgY29sbGF0ZXJhbF9mYWN0b3I9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgIGxpcXVpZGF0aW9uX3RocmVzaG9sZD1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgcmVzZXJ2ZV9mYWN0b3I9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgIGJvcnJvd19yYXRlPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICBzbG9wZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgdG90YWxfc2NhbGVkX2RlcG9zaXRzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgdG90YWxfc2NhbGVkX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICBkZXBvc2l0X2luZGV4PWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgYm9ycm93X2luZGV4PWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgbGFzdF91cGRhdGVfdGltZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgcmVzZXJ2ZXM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICBwcmljZT1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgIG50b2tlbl9pZD1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgY2xvc2VfZmFjdG9yPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICksCiAgICAvLyApCiAgICBzd2FwCiAgICBjb25jYXQKICAgIGJveF9nZXQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6Nzc0LTc5MwogICAgLy8gZGVmYXVsdD1NYXJrZXREYXRhKAogICAgLy8gICAgIHBhdXNlZD1hcmM0LkJvb2woVHJ1ZSksCiAgICAvLyAgICAgbWF4X3RvdGFsX2RlcG9zaXRzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICBtYXhfdG90YWxfYm9ycm93cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgbGlxdWlkYXRpb25fYm9udXM9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgY29sbGF0ZXJhbF9mYWN0b3I9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgbGlxdWlkYXRpb25fdGhyZXNob2xkPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgIHJlc2VydmVfZmFjdG9yPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgIGJvcnJvd19yYXRlPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgIHNsb3BlPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgIHRvdGFsX3NjYWxlZF9kZXBvc2l0cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgdG90YWxfc2NhbGVkX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgIGRlcG9zaXRfaW5kZXg9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgIGJvcnJvd19pbmRleD1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgbGFzdF91cGRhdGVfdGltZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICByZXNlcnZlcz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgcHJpY2U9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgIG50b2tlbl9pZD1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICBjbG9zZV9mYWN0b3I9YXJjNC5VSW50NjQoMCksCiAgICAvLyApLAogICAgYnl0ZSAweDgwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NzcyLTc5NAogICAgLy8gcmV0dXJuIHNlbGYubWFya2V0cy5nZXQoCiAgICAvLyAgICAgdG9rZW5faWQsCiAgICAvLyAgICAgZGVmYXVsdD1NYXJrZXREYXRhKAogICAgLy8gICAgICAgICBwYXVzZWQ9YXJjNC5Cb29sKFRydWUpLAogICAgLy8gICAgICAgICBtYXhfdG90YWxfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICBtYXhfdG90YWxfYm9ycm93cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgIGxpcXVpZGF0aW9uX2JvbnVzPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICBjb2xsYXRlcmFsX2ZhY3Rvcj1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgbGlxdWlkYXRpb25fdGhyZXNob2xkPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICByZXNlcnZlX2ZhY3Rvcj1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgYm9ycm93X3JhdGU9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgIHNsb3BlPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICB0b3RhbF9zY2FsZWRfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICB0b3RhbF9zY2FsZWRfYm9ycm93cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgIGRlcG9zaXRfaW5kZXg9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICBib3Jyb3dfaW5kZXg9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICBsYXN0X3VwZGF0ZV90aW1lPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICByZXNlcnZlcz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgIHByaWNlPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgbnRva2VuX2lkPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICBjbG9zZV9mYWN0b3I9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgKSwKICAgIC8vICkKICAgIGNvdmVyIDIKICAgIHNlbGVjdAogICAgcmV0c3ViCgoKLy8gY29udHJhY3QuTGVuZGluZ1Bvb2wuZ2V0X21hcmtldF9wcmljZSh0b2tlbl9pZDogYnl0ZXMpIC0+IGJ5dGVzOgpnZXRfbWFya2V0X3ByaWNlOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo3OTYtNzk3CiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBnZXRfbWFya2V0X3ByaWNlKHNlbGYsIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCkgLT4gYXJjNC5VSW50MjU2OgogICAgcHJvdG8gMSAxCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojc5OAogICAgLy8gbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldCh0b2tlbl9pZC5uYXRpdmUpCiAgICBmcmFtZV9kaWcgLTEKICAgIGJ0b2kKICAgIGNhbGxzdWIgX2dldF9tYXJrZXQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6Nzk5CiAgICAvLyByZXR1cm4gbWFya2V0LnByaWNlCiAgICBpbnQgMjgxCiAgICBpbnQgMzIKICAgIGV4dHJhY3QzIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgcmV0c3ViCgoKLy8gY29udHJhY3QuTGVuZGluZ1Bvb2wuZ2V0X21hcmtldF9udG9rZW5faWQodG9rZW5faWQ6IGJ5dGVzKSAtPiBieXRlczoKZ2V0X21hcmtldF9udG9rZW5faWQ6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjgwMS04MDIKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF9tYXJrZXRfbnRva2VuX2lkKHNlbGYsIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCkgLT4gYXJjNC5VSW50NjQ6CiAgICBwcm90byAxIDEKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODAzCiAgICAvLyBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KHRva2VuX2lkLm5hdGl2ZSkKICAgIGZyYW1lX2RpZyAtMQogICAgYnRvaQogICAgY2FsbHN1YiBfZ2V0X21hcmtldAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo4MDQKICAgIC8vIHJldHVybiBtYXJrZXQubnRva2VuX2lkCiAgICBpbnQgMzEzCiAgICBpbnQgOAogICAgZXh0cmFjdDMgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5zZXRfbWFya2V0X3ByaWNlKHRva2VuX2lkOiBieXRlcywgcHJpY2U6IGJ5dGVzKSAtPiB2b2lkOgpzZXRfbWFya2V0X3ByaWNlOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo4MDYtODA3CiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBzZXRfbWFya2V0X3ByaWNlKHNlbGYsIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCwgcHJpY2U6IGFyYzQuVUludDI1NikgLT4gTm9uZToKICAgIHByb3RvIDIgMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo4MDgKICAgIC8vIHNlbGYuX29ubHlfb3duZXIoKQogICAgY2FsbHN1YiBfb25seV9vd25lcgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo4MDkKICAgIC8vIGFzc2VydCBub3Qgc2VsZi5faXNfcGF1c2VkKCksICJQcm90b2NvbCBpcyBwYXVzZWQiCiAgICBjYWxsc3ViIF9pc19wYXVzZWQKICAgICEKICAgIGFzc2VydCAvLyBQcm90b2NvbCBpcyBwYXVzZWQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODEwCiAgICAvLyBzZWxmLl9zZXRfbWFya2V0X3ByaWNlKHRva2VuX2lkLm5hdGl2ZSwgcHJpY2UubmF0aXZlKQogICAgZnJhbWVfZGlnIC0yCiAgICBidG9pCiAgICBmcmFtZV9kaWcgLTEKICAgIGNhbGxzdWIgX3NldF9tYXJrZXRfcHJpY2UKICAgIHJldHN1YgoKCi8vIGNvbnRyYWN0LkxlbmRpbmdQb29sLl9zZXRfbWFya2V0X3ByaWNlKHRva2VuX2lkOiB1aW50NjQsIHByaWNlOiBieXRlcykgLT4gdm9pZDoKX3NldF9tYXJrZXRfcHJpY2U6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjgxMi04MTMKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3NldF9tYXJrZXRfcHJpY2Uoc2VsZiwgdG9rZW5faWQ6IFVJbnQ2NCwgcHJpY2U6IEJpZ1VJbnQpIC0+IE5vbmU6CiAgICBwcm90byAyIDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTEwLTgxNAogICAgLy8gICAgIHNlbGYubWFya2V0cyA9IEJveE1hcChVSW50NjQsIE1hcmtldERhdGEpICAjIE1hcmtldCBzdGF0ZQogICAgLy8gICAgIHNlbGYudXNlcnMgPSBCb3hNYXAoQnl0ZXM0MCwgVXNlckRhdGEpICAjIFBlci1tYXJrZXQgdXNlciBzdGF0ZQogICAgLy8gICAgIHNlbGYuZ2xvYmFsX3VzZXJzID0gQm94TWFwKEFjY291bnQsIEdsb2JhbFVzZXJEYXRhKSAgIyBHbG9iYWwgdXNlciBzdGF0ZQogICAgLy8gCiAgICAvLyAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vICMgT3duYWJsZQogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX29ubHlfb3duZXIoc2VsZikgLT4gTm9uZToKICAgIC8vICAgICBhc3NlcnQgVHhuLnNlbmRlciA9PSBzZWxmLm93bmVyLCAib25seSB0aGUgb3duZXIgY2FuIGNhbGwgdGhpcyBmdW5jdGlvbiIKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kKHJlYWRvbmx5PVRydWUpCiAgICAvLyBkZWYgZ2V0X293bmVyKHNlbGYpIC0+IGFyYzQuQWRkcmVzczoKICAgIC8vICAgICByZXR1cm4gYXJjNC5BZGRyZXNzKHNlbGYub3duZXIpCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIHRyYW5zZmVyX293bmVyc2hpcChzZWxmLCBuZXdfb3duZXI6IGFyYzQuQWRkcmVzcykgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLl9vbmx5X293bmVyKCkKICAgIC8vICAgICBzZWxmLl90cmFuc2Zlcl9vd25lcnNoaXAobmV3X293bmVyLm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfdHJhbnNmZXJfb3duZXJzaGlwKHNlbGYsIG5ld19vd25lcjogQWNjb3VudCkgLT4gTm9uZToKICAgIC8vICAgICBwcmV2aW91c19vd25lciA9IHNlbGYub3duZXIKICAgIC8vICAgICBzZWxmLm93bmVyID0gbmV3X293bmVyCiAgICAvLyAgICAgYXJjNC5lbWl0KAogICAgLy8gICAgICAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChhcmM0LkFkZHJlc3MocHJldmlvdXNfb3duZXIpLCBhcmM0LkFkZHJlc3MobmV3X293bmVyKSkKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gCiAgICAvLyAjIFJFTSBoYXZpbmcgaXNzdWVzIHdpdGggdGhlIGluaGVyaXRhbmNlIGhlcmUKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgaXNfcGF1c2VkKHNlbGYpIC0+IGFyYzQuQm9vbDoKICAgIC8vICAgICByZXR1cm4gYXJjNC5Cb29sKHNlbGYuX2lzX3BhdXNlZCgpKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9pc19wYXVzZWQoc2VsZikgLT4gYm9vbDoKICAgIC8vICAgICByZXR1cm4gc2VsZi5wYXVzZWQgPT0gVUludDY0KDEpCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIHBhdXNlKHNlbGYsIHBhdXNlOiBhcmM0LlVJbnQ2NCkgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLl9vbmx5X293bmVyKCkKICAgIC8vICAgICBzZWxmLl9wYXVzZShwYXVzZS5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3BhdXNlKHNlbGYsIHBhdXNlOiBVSW50NjQpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5wYXVzZWQgPSBwYXVzZQogICAgLy8gCiAgICAvLyAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgZ2V0X3N0b2tlbl9hcHBfaWQoc2VsZikgLT4gYXJjNC5VSW50NjQ6CiAgICAvLyAgICAgcmV0dXJuIGFyYzQuVUludDY0KHNlbGYuX2dldF9zdG9rZW5fYXBwX2lkKCkpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2dldF9zdG9rZW5fYXBwX2lkKHNlbGYpIC0+IFVJbnQ2NDoKICAgIC8vICAgICByZXR1cm4gc2VsZi5zdG9rZW5fYXBwX2lkCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIHNldF9zdG9rZW5fYXBwX2lkKHNlbGYsIHN0b2tlbl9hcHBfaWQ6IGFyYzQuVUludDY0KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX29ubHlfb3duZXIoKQogICAgLy8gICAgIHNlbGYuc3Rva2VuX2FwcF9pZCA9IHN0b2tlbl9hcHBfaWQubmF0aXZlCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2dldF91c2VyX2tleShzZWxmLCB1c2VyX2lkOiBBY2NvdW50LCBtYXJrZXRfaWQ6IFVJbnQ2NCkgLT4gQnl0ZXM0MDoKICAgIC8vICAgICByZXR1cm4gQnl0ZXM0MC5mcm9tX2J5dGVzKAogICAgLy8gICAgICAgICBhcmM0LkFkZHJlc3ModXNlcl9pZCkuYnl0ZXMgKyBhcmM0LlVJbnQ2NChtYXJrZXRfaWQpLmJ5dGVzCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBnZXRfdXNlcihzZWxmLCB1c2VyX2lkOiBhcmM0LkFkZHJlc3MsIG1hcmtldF9pZDogYXJjNC5VSW50NjQpIC0+IFVzZXJEYXRhOgogICAgLy8gICAgIHJldHVybiBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLm5hdGl2ZSwgbWFya2V0X2lkLm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X3VzZXIoc2VsZiwgdXNlcl9pZDogQWNjb3VudCwgbWFya2V0X2lkOiBVSW50NjQpIC0+IFVzZXJEYXRhOgogICAgLy8gICAgIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICByZXR1cm4gc2VsZi51c2Vycy5nZXQoCiAgICAvLyAgICAgICAgIHVzZXJfa2V5LAogICAgLy8gICAgICAgICBkZWZhdWx0PVVzZXJEYXRhKAogICAgLy8gICAgICAgICAgICAgc2NhbGVkX2RlcG9zaXRzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIHNjYWxlZF9ib3Jyb3dzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGRlcG9zaXRfaW5kZXg9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgYm9ycm93X2luZGV4PWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGxhc3RfdXBkYXRlX3RpbWU9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICBsYXN0X3ByaWNlPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgKSwKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2hhc19wb3NpdGlvbihzZWxmLCB1c2VyX2lkOiBBY2NvdW50LCBtYXJrZXRfaWQ6IFVJbnQ2NCkgLT4gYm9vbDoKICAgIC8vICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHJldHVybiB1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgPiAwCiAgICAvLyAKICAgIC8vICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gCiAgICAvLyAjIFJFTSBjb25zaWRlciByZW1vdmluZyBhbmQgY2FsY3VsYXRpbmcgaW4gdGhlIGNsaWVudAogICAgLy8gIyBSRU0gdHJ5aW5nIHRvIGN1dCBiYWNrIG9uIGV4dHJhIHBhZ2VzCiAgICAvLyAKICAgIC8vICMgQGFyYzQuYWJpbWV0aG9kCiAgICAvLyAjIGRlZiBnZXRfdXNlcl9kZXBvc2l0X3VuZGVybHlpbmdfYW1vdW50KAogICAgLy8gIyAgICAgc2VsZiwgdXNlcl9pZDogYXJjNC5BZGRyZXNzLCBtYXJrZXRfaWQ6IGFyYzQuVUludDY0CiAgICAvLyAjICkgLT4gYXJjNC5VSW50MjU2OgogICAgLy8gIyAgICAgcmV0dXJuIGFyYzQuVUludDI1NigKICAgIC8vICMgICAgICAgICBzZWxmLl9nZXRfdXNlcl9kZXBvc2l0X3VuZGVybHlpbmdfYW1vdW50KHVzZXJfaWQubmF0aXZlLCBtYXJrZXRfaWQubmF0aXZlKQogICAgLy8gIyAgICAgKQogICAgLy8gCiAgICAvLyAjIEBzdWJyb3V0aW5lCiAgICAvLyAjIGRlZiBfZ2V0X3VzZXJfZGVwb3NpdF91bmRlcmx5aW5nX2Ftb3VudCgKICAgIC8vICMgICAgIHNlbGYsIHVzZXJfaWQ6IEFjY291bnQsIG1hcmtldF9pZDogVUludDY0CiAgICAvLyAjICkgLT4gQmlnVUludDoKICAgIC8vICMgICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAjICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkgICMgQWRkIHRoaXMgbGluZQogICAgLy8gIyAgICAgcmV0dXJuICh1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKiBtYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUpIC8vIFNDQUxFCiAgICAvLyAKICAgIC8vICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9pbmNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2RlcG9zaXRzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCB1c2VyX2lkOiBBY2NvdW50LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyLnNjYWxlZF9kZXBvc2l0cyA9IGFyYzQuVUludDI1Nih1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKyBhbW91bnQpCiAgICAvLyAgICAgdXNlci5kZXBvc2l0X2luZGV4ID0gbWFya2V0LmRlcG9zaXRfaW5kZXgKICAgIC8vICAgICB1c2VyLmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vICAgICB1c2VyLmxhc3RfcHJpY2UgPSBtYXJrZXQucHJpY2UgICMgVXBkYXRlIHVzZXIncyBsYXN0IGtub3duIHByaWNlCiAgICAvLyAgICAgc2VsZi51c2Vyc1t1c2VyX2tleV0gPSB1c2VyLmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9pbmNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2JvcnJvd3MoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIHVzZXJfaWQ6IEFjY291bnQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlcl9rZXkgPSBzZWxmLl9nZXRfdXNlcl9rZXkodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIuc2NhbGVkX2JvcnJvd3MgPSBhcmM0LlVJbnQyNTYodXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgKyBhbW91bnQpCiAgICAvLyAgICAgdXNlci5ib3Jyb3dfaW5kZXggPSBtYXJrZXQuYm9ycm93X2luZGV4CiAgICAvLyAgICAgdXNlci5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApCiAgICAvLyAgICAgdXNlci5sYXN0X3ByaWNlID0gbWFya2V0LnByaWNlICAjIFVwZGF0ZSB1c2VyJ3MgbGFzdCBrbm93biBwcmljZQogICAgLy8gICAgIHNlbGYudXNlcnNbdXNlcl9rZXldID0gdXNlci5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZGVjcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9kZXBvc2l0cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgdXNlcl9pZDogQWNjb3VudCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyX2tleSA9IHNlbGYuX2dldF91c2VyX2tleSh1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgYXNzZXJ0ICgKICAgIC8vICAgICAgICAgdXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlID49IGFtb3VudAogICAgLy8gICAgICksICJJbnN1ZmZpY2llbnQgYmFsYW5jZSB0byB3aXRoZHJhdyB0aGlzIGFtb3VudCIKICAgIC8vICAgICB1c2VyLnNjYWxlZF9kZXBvc2l0cyA9IGFyYzQuVUludDI1Nih1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgLSBhbW91bnQpCiAgICAvLyAgICAgdXNlci5kZXBvc2l0X2luZGV4ID0gbWFya2V0LmRlcG9zaXRfaW5kZXgKICAgIC8vICAgICB1c2VyLmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vICAgICB1c2VyLmxhc3RfcHJpY2UgPSBtYXJrZXQucHJpY2UgICMgVXBkYXRlIHVzZXIncyBsYXN0IGtub3duIHByaWNlCiAgICAvLyAgICAgc2VsZi51c2Vyc1t1c2VyX2tleV0gPSB1c2VyLmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9kZWNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2JvcnJvd3MoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIHVzZXJfaWQ6IEFjY291bnQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlcl9rZXkgPSBzZWxmLl9nZXRfdXNlcl9rZXkodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgIHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlID49IGFtb3VudAogICAgLy8gICAgICksICJJbnN1ZmZpY2llbnQgYmFsYW5jZSB0byByZXBheSB0aGlzIGFtb3VudCIKICAgIC8vICAgICB1c2VyLnNjYWxlZF9ib3Jyb3dzID0gYXJjNC5VSW50MjU2KHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlIC0gYW1vdW50KQogICAgLy8gICAgIHVzZXIuYm9ycm93X2luZGV4ID0gbWFya2V0LmJvcnJvd19pbmRleAogICAgLy8gICAgIHVzZXIubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gICAgIHVzZXIubGFzdF9wcmljZSA9IG1hcmtldC5wcmljZSAgIyBVcGRhdGUgdXNlcidzIGxhc3Qga25vd24gcHJpY2UKICAgIC8vICAgICBzZWxmLnVzZXJzW3VzZXJfa2V5XSA9IHVzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGNyZWF0ZV9tYXJrZXQoCiAgICAvLyAgICAgc2VsZiwKICAgIC8vICAgICB0b2tlbl9pZDogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgY29sbGF0ZXJhbF9mYWN0b3I6IGFyYzQuVUludDY0LAogICAgLy8gICAgIGxpcXVpZGF0aW9uX3RocmVzaG9sZDogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgcmVzZXJ2ZV9mYWN0b3I6IGFyYzQuVUludDY0LAogICAgLy8gICAgIGJvcnJvd19yYXRlOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBzbG9wZTogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgbWF4X3RvdGFsX2RlcG9zaXRzOiBhcmM0LlVJbnQyNTYsCiAgICAvLyAgICAgbWF4X3RvdGFsX2JvcnJvd3M6IGFyYzQuVUludDI1NiwKICAgIC8vICAgICBsaXF1aWRhdGlvbl9ib251czogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgY2xvc2VfZmFjdG9yOiBhcmM0LlVJbnQ2NCwKICAgIC8vICkgLT4gYXJjNC5VSW50NjQ6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgYXNzZXJ0IG5vdCBzZWxmLl9pc19wYXVzZWQoKSwgIlByb3RvY29sIGlzIHBhdXNlZCIKICAgIC8vICAgICByZXR1cm4gYXJjNC5VSW50NjQoCiAgICAvLyAgICAgICAgIHNlbGYuX2NyZWF0ZV9tYXJrZXQoCiAgICAvLyAgICAgICAgICAgICB0b2tlbl9pZC5uYXRpdmUsCiAgICAvLyAgICAgICAgICAgICBNYXJrZXREYXRhKAogICAgLy8gICAgICAgICAgICAgICAgIHBhdXNlZD1hcmM0LkJvb2woVHJ1ZSksICAjIFN0YXJ0IHBhdXNlZCB1bnRpbCBwcmljZSBpcyBzZXQKICAgIC8vICAgICAgICAgICAgICAgICBtYXhfdG90YWxfZGVwb3NpdHM9bWF4X3RvdGFsX2RlcG9zaXRzLAogICAgLy8gICAgICAgICAgICAgICAgIG1heF90b3RhbF9ib3Jyb3dzPW1heF90b3RhbF9ib3Jyb3dzLAogICAgLy8gICAgICAgICAgICAgICAgIGxpcXVpZGF0aW9uX2JvbnVzPWxpcXVpZGF0aW9uX2JvbnVzLAogICAgLy8gICAgICAgICAgICAgICAgIGNvbGxhdGVyYWxfZmFjdG9yPWNvbGxhdGVyYWxfZmFjdG9yLAogICAgLy8gICAgICAgICAgICAgICAgIGxpcXVpZGF0aW9uX3RocmVzaG9sZD1saXF1aWRhdGlvbl90aHJlc2hvbGQsCiAgICAvLyAgICAgICAgICAgICAgICAgcmVzZXJ2ZV9mYWN0b3I9cmVzZXJ2ZV9mYWN0b3IsCiAgICAvLyAgICAgICAgICAgICAgICAgYm9ycm93X3JhdGU9Ym9ycm93X3JhdGUsCiAgICAvLyAgICAgICAgICAgICAgICAgc2xvcGU9c2xvcGUsCiAgICAvLyAgICAgICAgICAgICAgICAgdG90YWxfc2NhbGVkX2RlcG9zaXRzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgICAgICB0b3RhbF9zY2FsZWRfYm9ycm93cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICAgICAgZGVwb3NpdF9pbmRleD1hcmM0LlVJbnQyNTYoU0NBTEUpLCAgIyBTdGFydCBhdCBTQ0FMRSAoMS4wKQogICAgLy8gICAgICAgICAgICAgICAgIGJvcnJvd19pbmRleD1hcmM0LlVJbnQyNTYoU0NBTEUpLCAgIyBTdGFydCBhdCBTQ0FMRSAoMS4wKQogICAgLy8gICAgICAgICAgICAgICAgIGxhc3RfdXBkYXRlX3RpbWU9YXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApLAogICAgLy8gICAgICAgICAgICAgICAgIHJlc2VydmVzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgICAgICBwcmljZT1hcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgICAgICAgICAgICAgIDAKICAgIC8vICAgICAgICAgICAgICAgICApLCAgIyBQcmljZSBtdXN0IGJlIHNldCBiZWZvcmUgbWFya2V0IGNhbiBiZSB1c2VkCiAgICAvLyAgICAgICAgICAgICAgICAgbnRva2VuX2lkPWFyYzQuVUludDY0KDApLCAgIyBXaWxsIGJlIHNldCBkdXJpbmcgdG9rZW4gaW5pdGlhbGl6YXRpb24KICAgIC8vICAgICAgICAgICAgICAgICBjbG9zZV9mYWN0b3I9Y2xvc2VfZmFjdG9yLAogICAgLy8gICAgICAgICAgICAgKSwKICAgIC8vICAgICAgICAgKQogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfY3JlYXRlX21hcmtldChzZWxmLCB0b2tlbl9pZDogVUludDY0LCBtYXJrZXRfZGF0YTogTWFya2V0RGF0YSkgLT4gVUludDY0OgogICAgLy8gICAgIGFzc2VydCBub3QgdG9rZW5faWQgaW4gc2VsZi5tYXJrZXRzLCAiTWFya2V0IGFscmVhZHkgZXhpc3RzIgogICAgLy8gICAgIHBheW1lbnQgPSByZXF1aXJlX3BheW1lbnQoVHhuLnNlbmRlcikKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICBwYXltZW50ID49IHNlbGYuX2NyZWF0ZV9tYXJrZXRfY29zdCgpCiAgICAvLyAgICAgKSwgImluc3VmZmljaWVudCBwYXltZW50IGZvciBjcmVhdGUgbWFya2V0IgogICAgLy8gICAgIGNvbXBpbGVkID0gY29tcGlsZV9jb250cmFjdChOVG9rZW4sIGV4dHJhX3Byb2dyYW1fcGFnZXM9MCkgICMgbm8gZXh0cmEgcGFnZXMKICAgIC8vICAgICBiYXNlX2FwcCA9IGFyYzQuYXJjNF9jcmVhdGUoTlRva2VuLCBjb21waWxlZD1jb21waWxlZCkuY3JlYXRlZF9hcHAKICAgIC8vICAgICBib290c3RyYXA2NF9jb3N0LCB0eG4xID0gYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICAgICAgTlRva2VuLmJvb3RzdHJhcDY0X2Nvc3QsCiAgICAvLyAgICAgICAgIGFwcF9pZD1iYXNlX2FwcCwKICAgIC8vICAgICApCiAgICAvLyAgICAgaXR4bi5QYXltZW50KAogICAgLy8gICAgICAgICByZWNlaXZlcj1iYXNlX2FwcC5hZGRyZXNzLCBhbW91bnQ9Ym9vdHN0cmFwNjRfY29zdC5uYXRpdmUsIGZlZT0wCiAgICAvLyAgICAgKS5zdWJtaXQoKQogICAgLy8gICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIE5Ub2tlbi5ib290c3RyYXA2NCwKICAgIC8vICAgICAgICAgYXJjNC5VSW50NjQodG9rZW5faWQpLAogICAgLy8gICAgICAgICBhcHBfaWQ9YmFzZV9hcHAsCiAgICAvLyAgICAgKQogICAgLy8gICAgIG1hcmtldF9kYXRhLm50b2tlbl9pZCA9IGFyYzQuVUludDY0KGJhc2VfYXBwLmlkKQogICAgLy8gICAgIHNlbGYubWFya2V0c1t0b2tlbl9pZF0gPSBtYXJrZXRfZGF0YS5jb3B5KCkKICAgIC8vICAgICBhcmM0LmVtaXQoCiAgICAvLyAgICAgICAgIE1hcmtldENyZWF0ZWQoYXJjNC5VSW50NjQodG9rZW5faWQpLCBhcmM0LlVJbnQ2NChiYXNlX2FwcC5pZCksIG1hcmtldF9kYXRhKQogICAgLy8gICAgICkKICAgIC8vICAgICByZXR1cm4gYmFzZV9hcHAuaWQKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kKHJlYWRvbmx5PVRydWUpCiAgICAvLyBkZWYgY3JlYXRlX21hcmtldF9jb3N0KHNlbGYpIC0+IGFyYzQuVUludDY0OgogICAgLy8gICAgIHJldHVybiBhcmM0LlVJbnQ2NChzZWxmLl9jcmVhdGVfbWFya2V0X2Nvc3QoKSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfY3JlYXRlX21hcmtldF9jb3N0KHNlbGYpIC0+IFVJbnQ2NDoKICAgIC8vICAgICByZXR1cm4gVUludDY0KDFfMDAwXzAwMCkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kKHJlYWRvbmx5PVRydWUpCiAgICAvLyBkZWYgZ2V0X21hcmtldChzZWxmLCB0b2tlbl9pZDogYXJjNC5VSW50NjQpIC0+IE1hcmtldERhdGE6CiAgICAvLyAgICAgcmV0dXJuIHNlbGYuX2dldF9tYXJrZXQodG9rZW5faWQubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9nZXRfbWFya2V0KHNlbGYsIHRva2VuX2lkOiBVSW50NjQpIC0+IE1hcmtldERhdGE6CiAgICAvLyAgICAgcmV0dXJuIHNlbGYubWFya2V0cy5nZXQoCiAgICAvLyAgICAgICAgIHRva2VuX2lkLAogICAgLy8gICAgICAgICBkZWZhdWx0PU1hcmtldERhdGEoCiAgICAvLyAgICAgICAgICAgICBwYXVzZWQ9YXJjNC5Cb29sKFRydWUpLAogICAgLy8gICAgICAgICAgICAgbWF4X3RvdGFsX2RlcG9zaXRzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIG1heF90b3RhbF9ib3Jyb3dzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGxpcXVpZGF0aW9uX2JvbnVzPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgY29sbGF0ZXJhbF9mYWN0b3I9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICBsaXF1aWRhdGlvbl90aHJlc2hvbGQ9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICByZXNlcnZlX2ZhY3Rvcj1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIGJvcnJvd19yYXRlPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgc2xvcGU9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICB0b3RhbF9zY2FsZWRfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgdG90YWxfc2NhbGVkX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgZGVwb3NpdF9pbmRleD1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBib3Jyb3dfaW5kZXg9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgbGFzdF91cGRhdGVfdGltZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIHJlc2VydmVzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIHByaWNlPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIG50b2tlbl9pZD1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIGNsb3NlX2ZhY3Rvcj1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgKSwKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF9tYXJrZXRfcHJpY2Uoc2VsZiwgdG9rZW5faWQ6IGFyYzQuVUludDY0KSAtPiBhcmM0LlVJbnQyNTY6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldCh0b2tlbl9pZC5uYXRpdmUpCiAgICAvLyAgICAgcmV0dXJuIG1hcmtldC5wcmljZQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBnZXRfbWFya2V0X250b2tlbl9pZChzZWxmLCB0b2tlbl9pZDogYXJjNC5VSW50NjQpIC0+IGFyYzQuVUludDY0OgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQodG9rZW5faWQubmF0aXZlKQogICAgLy8gICAgIHJldHVybiBtYXJrZXQubnRva2VuX2lkCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIHNldF9tYXJrZXRfcHJpY2Uoc2VsZiwgdG9rZW5faWQ6IGFyYzQuVUludDY0LCBwcmljZTogYXJjNC5VSW50MjU2KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX29ubHlfb3duZXIoKQogICAgLy8gICAgIGFzc2VydCBub3Qgc2VsZi5faXNfcGF1c2VkKCksICJQcm90b2NvbCBpcyBwYXVzZWQiCiAgICAvLyAgICAgc2VsZi5fc2V0X21hcmtldF9wcmljZSh0b2tlbl9pZC5uYXRpdmUsIHByaWNlLm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfc2V0X21hcmtldF9wcmljZShzZWxmLCB0b2tlbl9pZDogVUludDY0LCBwcmljZTogQmlnVUludCkgLT4gTm9uZToKICAgIC8vICAgICBhc3NlcnQgdG9rZW5faWQgaW4gc2VsZi5tYXJrZXRzLCAiTWFya2V0IGRvZXMgbm90IGV4aXN0IgogICAgZnJhbWVfZGlnIC0yCiAgICBpdG9iCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjUxMAogICAgLy8gc2VsZi5tYXJrZXRzID0gQm94TWFwKFVJbnQ2NCwgTWFya2V0RGF0YSkgICMgTWFya2V0IHN0YXRlCiAgICBieXRlICJtYXJrZXRzIgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1MTAtODE0CiAgICAvLyAgICAgc2VsZi5tYXJrZXRzID0gQm94TWFwKFVJbnQ2NCwgTWFya2V0RGF0YSkgICMgTWFya2V0IHN0YXRlCiAgICAvLyAgICAgc2VsZi51c2VycyA9IEJveE1hcChCeXRlczQwLCBVc2VyRGF0YSkgICMgUGVyLW1hcmtldCB1c2VyIHN0YXRlCiAgICAvLyAgICAgc2VsZi5nbG9iYWxfdXNlcnMgPSBCb3hNYXAoQWNjb3VudCwgR2xvYmFsVXNlckRhdGEpICAjIEdsb2JhbCB1c2VyIHN0YXRlCiAgICAvLyAKICAgIC8vICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gIyBPd25hYmxlCiAgICAvLyAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfb25seV9vd25lcihzZWxmKSAtPiBOb25lOgogICAgLy8gICAgIGFzc2VydCBUeG4uc2VuZGVyID09IHNlbGYub3duZXIsICJvbmx5IHRoZSBvd25lciBjYW4gY2FsbCB0aGlzIGZ1bmN0aW9uIgogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QocmVhZG9ubHk9VHJ1ZSkKICAgIC8vIGRlZiBnZXRfb3duZXIoc2VsZikgLT4gYXJjNC5BZGRyZXNzOgogICAgLy8gICAgIHJldHVybiBhcmM0LkFkZHJlc3Moc2VsZi5vd25lcikKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgdHJhbnNmZXJfb3duZXJzaGlwKHNlbGYsIG5ld19vd25lcjogYXJjNC5BZGRyZXNzKSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX29ubHlfb3duZXIoKQogICAgLy8gICAgIHNlbGYuX3RyYW5zZmVyX293bmVyc2hpcChuZXdfb3duZXIubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF90cmFuc2Zlcl9vd25lcnNoaXAoc2VsZiwgbmV3X293bmVyOiBBY2NvdW50KSAtPiBOb25lOgogICAgLy8gICAgIHByZXZpb3VzX293bmVyID0gc2VsZi5vd25lcgogICAgLy8gICAgIHNlbGYub3duZXIgPSBuZXdfb3duZXIKICAgIC8vICAgICBhcmM0LmVtaXQoCiAgICAvLyAgICAgICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKGFyYzQuQWRkcmVzcyhwcmV2aW91c19vd25lciksIGFyYzQuQWRkcmVzcyhuZXdfb3duZXIpKQogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAKICAgIC8vICMgUkVNIGhhdmluZyBpc3N1ZXMgd2l0aCB0aGUgaW5oZXJpdGFuY2UgaGVyZQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBpc19wYXVzZWQoc2VsZikgLT4gYXJjNC5Cb29sOgogICAgLy8gICAgIHJldHVybiBhcmM0LkJvb2woc2VsZi5faXNfcGF1c2VkKCkpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2lzX3BhdXNlZChzZWxmKSAtPiBib29sOgogICAgLy8gICAgIHJldHVybiBzZWxmLnBhdXNlZCA9PSBVSW50NjQoMSkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgcGF1c2Uoc2VsZiwgcGF1c2U6IGFyYzQuVUludDY0KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX29ubHlfb3duZXIoKQogICAgLy8gICAgIHNlbGYuX3BhdXNlKHBhdXNlLm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfcGF1c2Uoc2VsZiwgcGF1c2U6IFVJbnQ2NCkgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLnBhdXNlZCA9IHBhdXNlCiAgICAvLyAKICAgIC8vICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBnZXRfc3Rva2VuX2FwcF9pZChzZWxmKSAtPiBhcmM0LlVJbnQ2NDoKICAgIC8vICAgICByZXR1cm4gYXJjNC5VSW50NjQoc2VsZi5fZ2V0X3N0b2tlbl9hcHBfaWQoKSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X3N0b2tlbl9hcHBfaWQoc2VsZikgLT4gVUludDY0OgogICAgLy8gICAgIHJldHVybiBzZWxmLnN0b2tlbl9hcHBfaWQKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgc2V0X3N0b2tlbl9hcHBfaWQoc2VsZiwgc3Rva2VuX2FwcF9pZDogYXJjNC5VSW50NjQpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgc2VsZi5zdG9rZW5fYXBwX2lkID0gc3Rva2VuX2FwcF9pZC5uYXRpdmUKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X3VzZXJfa2V5KHNlbGYsIHVzZXJfaWQ6IEFjY291bnQsIG1hcmtldF9pZDogVUludDY0KSAtPiBCeXRlczQwOgogICAgLy8gICAgIHJldHVybiBCeXRlczQwLmZyb21fYnl0ZXMoCiAgICAvLyAgICAgICAgIGFyYzQuQWRkcmVzcyh1c2VyX2lkKS5ieXRlcyArIGFyYzQuVUludDY0KG1hcmtldF9pZCkuYnl0ZXMKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF91c2VyKHNlbGYsIHVzZXJfaWQ6IGFyYzQuQWRkcmVzcywgbWFya2V0X2lkOiBhcmM0LlVJbnQ2NCkgLT4gVXNlckRhdGE6CiAgICAvLyAgICAgcmV0dXJuIHNlbGYuX2dldF91c2VyKHVzZXJfaWQubmF0aXZlLCBtYXJrZXRfaWQubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9nZXRfdXNlcihzZWxmLCB1c2VyX2lkOiBBY2NvdW50LCBtYXJrZXRfaWQ6IFVJbnQ2NCkgLT4gVXNlckRhdGE6CiAgICAvLyAgICAgdXNlcl9rZXkgPSBzZWxmLl9nZXRfdXNlcl9rZXkodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHJldHVybiBzZWxmLnVzZXJzLmdldCgKICAgIC8vICAgICAgICAgdXNlcl9rZXksCiAgICAvLyAgICAgICAgIGRlZmF1bHQ9VXNlckRhdGEoCiAgICAvLyAgICAgICAgICAgICBzY2FsZWRfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgc2NhbGVkX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgZGVwb3NpdF9pbmRleD1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBib3Jyb3dfaW5kZXg9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgbGFzdF91cGRhdGVfdGltZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIGxhc3RfcHJpY2U9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICApLAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaGFzX3Bvc2l0aW9uKHNlbGYsIHVzZXJfaWQ6IEFjY291bnQsIG1hcmtldF9pZDogVUludDY0KSAtPiBib29sOgogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgcmV0dXJuIHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSA+IDAKICAgIC8vIAogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAKICAgIC8vICMgUkVNIGNvbnNpZGVyIHJlbW92aW5nIGFuZCBjYWxjdWxhdGluZyBpbiB0aGUgY2xpZW50CiAgICAvLyAjIFJFTSB0cnlpbmcgdG8gY3V0IGJhY2sgb24gZXh0cmEgcGFnZXMKICAgIC8vIAogICAgLy8gIyBAYXJjNC5hYmltZXRob2QKICAgIC8vICMgZGVmIGdldF91c2VyX2RlcG9zaXRfdW5kZXJseWluZ19hbW91bnQoCiAgICAvLyAjICAgICBzZWxmLCB1c2VyX2lkOiBhcmM0LkFkZHJlc3MsIG1hcmtldF9pZDogYXJjNC5VSW50NjQKICAgIC8vICMgKSAtPiBhcmM0LlVJbnQyNTY6CiAgICAvLyAjICAgICByZXR1cm4gYXJjNC5VSW50MjU2KAogICAgLy8gIyAgICAgICAgIHNlbGYuX2dldF91c2VyX2RlcG9zaXRfdW5kZXJseWluZ19hbW91bnQodXNlcl9pZC5uYXRpdmUsIG1hcmtldF9pZC5uYXRpdmUpCiAgICAvLyAjICAgICApCiAgICAvLyAKICAgIC8vICMgQHN1YnJvdXRpbmUKICAgIC8vICMgZGVmIF9nZXRfdXNlcl9kZXBvc2l0X3VuZGVybHlpbmdfYW1vdW50KAogICAgLy8gIyAgICAgc2VsZiwgdXNlcl9pZDogQWNjb3VudCwgbWFya2V0X2lkOiBVSW50NjQKICAgIC8vICMgKSAtPiBCaWdVSW50OgogICAgLy8gIyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICMgICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKSAgIyBBZGQgdGhpcyBsaW5lCiAgICAvLyAjICAgICByZXR1cm4gKHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSAqIG1hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZSkgLy8gU0NBTEUKICAgIC8vIAogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2luY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfZGVwb3NpdHMoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIHVzZXJfaWQ6IEFjY291bnQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlcl9rZXkgPSBzZWxmLl9nZXRfdXNlcl9rZXkodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIuc2NhbGVkX2RlcG9zaXRzID0gYXJjNC5VSW50MjU2KHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSArIGFtb3VudCkKICAgIC8vICAgICB1c2VyLmRlcG9zaXRfaW5kZXggPSBtYXJrZXQuZGVwb3NpdF9pbmRleAogICAgLy8gICAgIHVzZXIubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gICAgIHVzZXIubGFzdF9wcmljZSA9IG1hcmtldC5wcmljZSAgIyBVcGRhdGUgdXNlcidzIGxhc3Qga25vd24gcHJpY2UKICAgIC8vICAgICBzZWxmLnVzZXJzW3VzZXJfa2V5XSA9IHVzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2luY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfYm9ycm93cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgdXNlcl9pZDogQWNjb3VudCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyX2tleSA9IHNlbGYuX2dldF91c2VyX2tleSh1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlci5zY2FsZWRfYm9ycm93cyA9IGFyYzQuVUludDI1Nih1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSArIGFtb3VudCkKICAgIC8vICAgICB1c2VyLmJvcnJvd19pbmRleCA9IG1hcmtldC5ib3Jyb3dfaW5kZXgKICAgIC8vICAgICB1c2VyLmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vICAgICB1c2VyLmxhc3RfcHJpY2UgPSBtYXJrZXQucHJpY2UgICMgVXBkYXRlIHVzZXIncyBsYXN0IGtub3duIHByaWNlCiAgICAvLyAgICAgc2VsZi51c2Vyc1t1c2VyX2tleV0gPSB1c2VyLmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9kZWNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2RlcG9zaXRzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCB1c2VyX2lkOiBBY2NvdW50LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICB1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgPj0gYW1vdW50CiAgICAvLyAgICAgKSwgIkluc3VmZmljaWVudCBiYWxhbmNlIHRvIHdpdGhkcmF3IHRoaXMgYW1vdW50IgogICAgLy8gICAgIHVzZXIuc2NhbGVkX2RlcG9zaXRzID0gYXJjNC5VSW50MjU2KHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSAtIGFtb3VudCkKICAgIC8vICAgICB1c2VyLmRlcG9zaXRfaW5kZXggPSBtYXJrZXQuZGVwb3NpdF9pbmRleAogICAgLy8gICAgIHVzZXIubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gICAgIHVzZXIubGFzdF9wcmljZSA9IG1hcmtldC5wcmljZSAgIyBVcGRhdGUgdXNlcidzIGxhc3Qga25vd24gcHJpY2UKICAgIC8vICAgICBzZWxmLnVzZXJzW3VzZXJfa2V5XSA9IHVzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2RlY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfYm9ycm93cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgdXNlcl9pZDogQWNjb3VudCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyX2tleSA9IHNlbGYuX2dldF91c2VyX2tleSh1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgYXNzZXJ0ICgKICAgIC8vICAgICAgICAgdXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgPj0gYW1vdW50CiAgICAvLyAgICAgKSwgIkluc3VmZmljaWVudCBiYWxhbmNlIHRvIHJlcGF5IHRoaXMgYW1vdW50IgogICAgLy8gICAgIHVzZXIuc2NhbGVkX2JvcnJvd3MgPSBhcmM0LlVJbnQyNTYodXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgLSBhbW91bnQpCiAgICAvLyAgICAgdXNlci5ib3Jyb3dfaW5kZXggPSBtYXJrZXQuYm9ycm93X2luZGV4CiAgICAvLyAgICAgdXNlci5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApCiAgICAvLyAgICAgdXNlci5sYXN0X3ByaWNlID0gbWFya2V0LnByaWNlICAjIFVwZGF0ZSB1c2VyJ3MgbGFzdCBrbm93biBwcmljZQogICAgLy8gICAgIHNlbGYudXNlcnNbdXNlcl9rZXldID0gdXNlci5jb3B5KCkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgY3JlYXRlX21hcmtldCgKICAgIC8vICAgICBzZWxmLAogICAgLy8gICAgIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBjb2xsYXRlcmFsX2ZhY3RvcjogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgbGlxdWlkYXRpb25fdGhyZXNob2xkOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICByZXNlcnZlX2ZhY3RvcjogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgYm9ycm93X3JhdGU6IGFyYzQuVUludDY0LAogICAgLy8gICAgIHNsb3BlOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBtYXhfdG90YWxfZGVwb3NpdHM6IGFyYzQuVUludDI1NiwKICAgIC8vICAgICBtYXhfdG90YWxfYm9ycm93czogYXJjNC5VSW50MjU2LAogICAgLy8gICAgIGxpcXVpZGF0aW9uX2JvbnVzOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBjbG9zZV9mYWN0b3I6IGFyYzQuVUludDY0LAogICAgLy8gKSAtPiBhcmM0LlVJbnQ2NDoKICAgIC8vICAgICBzZWxmLl9vbmx5X293bmVyKCkKICAgIC8vICAgICBhc3NlcnQgbm90IHNlbGYuX2lzX3BhdXNlZCgpLCAiUHJvdG9jb2wgaXMgcGF1c2VkIgogICAgLy8gICAgIHJldHVybiBhcmM0LlVJbnQ2NCgKICAgIC8vICAgICAgICAgc2VsZi5fY3JlYXRlX21hcmtldCgKICAgIC8vICAgICAgICAgICAgIHRva2VuX2lkLm5hdGl2ZSwKICAgIC8vICAgICAgICAgICAgIE1hcmtldERhdGEoCiAgICAvLyAgICAgICAgICAgICAgICAgcGF1c2VkPWFyYzQuQm9vbChUcnVlKSwgICMgU3RhcnQgcGF1c2VkIHVudGlsIHByaWNlIGlzIHNldAogICAgLy8gICAgICAgICAgICAgICAgIG1heF90b3RhbF9kZXBvc2l0cz1tYXhfdG90YWxfZGVwb3NpdHMsCiAgICAvLyAgICAgICAgICAgICAgICAgbWF4X3RvdGFsX2JvcnJvd3M9bWF4X3RvdGFsX2JvcnJvd3MsCiAgICAvLyAgICAgICAgICAgICAgICAgbGlxdWlkYXRpb25fYm9udXM9bGlxdWlkYXRpb25fYm9udXMsCiAgICAvLyAgICAgICAgICAgICAgICAgY29sbGF0ZXJhbF9mYWN0b3I9Y29sbGF0ZXJhbF9mYWN0b3IsCiAgICAvLyAgICAgICAgICAgICAgICAgbGlxdWlkYXRpb25fdGhyZXNob2xkPWxpcXVpZGF0aW9uX3RocmVzaG9sZCwKICAgIC8vICAgICAgICAgICAgICAgICByZXNlcnZlX2ZhY3Rvcj1yZXNlcnZlX2ZhY3RvciwKICAgIC8vICAgICAgICAgICAgICAgICBib3Jyb3dfcmF0ZT1ib3Jyb3dfcmF0ZSwKICAgIC8vICAgICAgICAgICAgICAgICBzbG9wZT1zbG9wZSwKICAgIC8vICAgICAgICAgICAgICAgICB0b3RhbF9zY2FsZWRfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgICAgIHRvdGFsX3NjYWxlZF9ib3Jyb3dzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgICAgICBkZXBvc2l0X2luZGV4PWFyYzQuVUludDI1NihTQ0FMRSksICAjIFN0YXJ0IGF0IFNDQUxFICgxLjApCiAgICAvLyAgICAgICAgICAgICAgICAgYm9ycm93X2luZGV4PWFyYzQuVUludDI1NihTQ0FMRSksICAjIFN0YXJ0IGF0IFNDQUxFICgxLjApCiAgICAvLyAgICAgICAgICAgICAgICAgbGFzdF91cGRhdGVfdGltZT1hcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCksCiAgICAvLyAgICAgICAgICAgICAgICAgcmVzZXJ2ZXM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgICAgIHByaWNlPWFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgICAgICAgICAgICAgMAogICAgLy8gICAgICAgICAgICAgICAgICksICAjIFByaWNlIG11c3QgYmUgc2V0IGJlZm9yZSBtYXJrZXQgY2FuIGJlIHVzZWQKICAgIC8vICAgICAgICAgICAgICAgICBudG9rZW5faWQ9YXJjNC5VSW50NjQoMCksICAjIFdpbGwgYmUgc2V0IGR1cmluZyB0b2tlbiBpbml0aWFsaXphdGlvbgogICAgLy8gICAgICAgICAgICAgICAgIGNsb3NlX2ZhY3Rvcj1jbG9zZV9mYWN0b3IsCiAgICAvLyAgICAgICAgICAgICApLAogICAgLy8gICAgICAgICApCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9jcmVhdGVfbWFya2V0KHNlbGYsIHRva2VuX2lkOiBVSW50NjQsIG1hcmtldF9kYXRhOiBNYXJrZXREYXRhKSAtPiBVSW50NjQ6CiAgICAvLyAgICAgYXNzZXJ0IG5vdCB0b2tlbl9pZCBpbiBzZWxmLm1hcmtldHMsICJNYXJrZXQgYWxyZWFkeSBleGlzdHMiCiAgICAvLyAgICAgcGF5bWVudCA9IHJlcXVpcmVfcGF5bWVudChUeG4uc2VuZGVyKQogICAgLy8gICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgIHBheW1lbnQgPj0gc2VsZi5fY3JlYXRlX21hcmtldF9jb3N0KCkKICAgIC8vICAgICApLCAiaW5zdWZmaWNpZW50IHBheW1lbnQgZm9yIGNyZWF0ZSBtYXJrZXQiCiAgICAvLyAgICAgY29tcGlsZWQgPSBjb21waWxlX2NvbnRyYWN0KE5Ub2tlbiwgZXh0cmFfcHJvZ3JhbV9wYWdlcz0wKSAgIyBubyBleHRyYSBwYWdlcwogICAgLy8gICAgIGJhc2VfYXBwID0gYXJjNC5hcmM0X2NyZWF0ZShOVG9rZW4sIGNvbXBpbGVkPWNvbXBpbGVkKS5jcmVhdGVkX2FwcAogICAgLy8gICAgIGJvb3RzdHJhcDY0X2Nvc3QsIHR4bjEgPSBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgICAgICBOVG9rZW4uYm9vdHN0cmFwNjRfY29zdCwKICAgIC8vICAgICAgICAgYXBwX2lkPWJhc2VfYXBwLAogICAgLy8gICAgICkKICAgIC8vICAgICBpdHhuLlBheW1lbnQoCiAgICAvLyAgICAgICAgIHJlY2VpdmVyPWJhc2VfYXBwLmFkZHJlc3MsIGFtb3VudD1ib290c3RyYXA2NF9jb3N0Lm5hdGl2ZSwgZmVlPTAKICAgIC8vICAgICApLnN1Ym1pdCgpCiAgICAvLyAgICAgYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICAgICAgTlRva2VuLmJvb3RzdHJhcDY0LAogICAgLy8gICAgICAgICBhcmM0LlVJbnQ2NCh0b2tlbl9pZCksCiAgICAvLyAgICAgICAgIGFwcF9pZD1iYXNlX2FwcCwKICAgIC8vICAgICApCiAgICAvLyAgICAgbWFya2V0X2RhdGEubnRva2VuX2lkID0gYXJjNC5VSW50NjQoYmFzZV9hcHAuaWQpCiAgICAvLyAgICAgc2VsZi5tYXJrZXRzW3Rva2VuX2lkXSA9IG1hcmtldF9kYXRhLmNvcHkoKQogICAgLy8gICAgIGFyYzQuZW1pdCgKICAgIC8vICAgICAgICAgTWFya2V0Q3JlYXRlZChhcmM0LlVJbnQ2NCh0b2tlbl9pZCksIGFyYzQuVUludDY0KGJhc2VfYXBwLmlkKSwgbWFya2V0X2RhdGEpCiAgICAvLyAgICAgKQogICAgLy8gICAgIHJldHVybiBiYXNlX2FwcC5pZAogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QocmVhZG9ubHk9VHJ1ZSkKICAgIC8vIGRlZiBjcmVhdGVfbWFya2V0X2Nvc3Qoc2VsZikgLT4gYXJjNC5VSW50NjQ6CiAgICAvLyAgICAgcmV0dXJuIGFyYzQuVUludDY0KHNlbGYuX2NyZWF0ZV9tYXJrZXRfY29zdCgpKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9jcmVhdGVfbWFya2V0X2Nvc3Qoc2VsZikgLT4gVUludDY0OgogICAgLy8gICAgIHJldHVybiBVSW50NjQoMV8wMDBfMDAwKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QocmVhZG9ubHk9VHJ1ZSkKICAgIC8vIGRlZiBnZXRfbWFya2V0KHNlbGYsIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCkgLT4gTWFya2V0RGF0YToKICAgIC8vICAgICByZXR1cm4gc2VsZi5fZ2V0X21hcmtldCh0b2tlbl9pZC5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2dldF9tYXJrZXQoc2VsZiwgdG9rZW5faWQ6IFVJbnQ2NCkgLT4gTWFya2V0RGF0YToKICAgIC8vICAgICByZXR1cm4gc2VsZi5tYXJrZXRzLmdldCgKICAgIC8vICAgICAgICAgdG9rZW5faWQsCiAgICAvLyAgICAgICAgIGRlZmF1bHQ9TWFya2V0RGF0YSgKICAgIC8vICAgICAgICAgICAgIHBhdXNlZD1hcmM0LkJvb2woVHJ1ZSksCiAgICAvLyAgICAgICAgICAgICBtYXhfdG90YWxfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgbWF4X3RvdGFsX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgbGlxdWlkYXRpb25fYm9udXM9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICBjb2xsYXRlcmFsX2ZhY3Rvcj1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIGxpcXVpZGF0aW9uX3RocmVzaG9sZD1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIHJlc2VydmVfZmFjdG9yPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgYm9ycm93X3JhdGU9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICBzbG9wZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIHRvdGFsX3NjYWxlZF9kZXBvc2l0cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICB0b3RhbF9zY2FsZWRfYm9ycm93cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBkZXBvc2l0X2luZGV4PWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGJvcnJvd19pbmRleD1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBsYXN0X3VwZGF0ZV90aW1lPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgcmVzZXJ2ZXM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgcHJpY2U9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgbnRva2VuX2lkPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgY2xvc2VfZmFjdG9yPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICApLAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgZ2V0X21hcmtldF9wcmljZShzZWxmLCB0b2tlbl9pZDogYXJjNC5VSW50NjQpIC0+IGFyYzQuVUludDI1NjoKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KHRva2VuX2lkLm5hdGl2ZSkKICAgIC8vICAgICByZXR1cm4gbWFya2V0LnByaWNlCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF9tYXJrZXRfbnRva2VuX2lkKHNlbGYsIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCkgLT4gYXJjNC5VSW50NjQ6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldCh0b2tlbl9pZC5uYXRpdmUpCiAgICAvLyAgICAgcmV0dXJuIG1hcmtldC5udG9rZW5faWQKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgc2V0X21hcmtldF9wcmljZShzZWxmLCB0b2tlbl9pZDogYXJjNC5VSW50NjQsIHByaWNlOiBhcmM0LlVJbnQyNTYpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgYXNzZXJ0IG5vdCBzZWxmLl9pc19wYXVzZWQoKSwgIlByb3RvY29sIGlzIHBhdXNlZCIKICAgIC8vICAgICBzZWxmLl9zZXRfbWFya2V0X3ByaWNlKHRva2VuX2lkLm5hdGl2ZSwgcHJpY2UubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9zZXRfbWFya2V0X3ByaWNlKHNlbGYsIHRva2VuX2lkOiBVSW50NjQsIHByaWNlOiBCaWdVSW50KSAtPiBOb25lOgogICAgLy8gICAgIGFzc2VydCB0b2tlbl9pZCBpbiBzZWxmLm1hcmtldHMsICJNYXJrZXQgZG9lcyBub3QgZXhpc3QiCiAgICBzd2FwCiAgICBjb25jYXQKICAgIGR1cG4gMgogICAgYm94X2xlbgogICAgYnVyeSAxCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjgxNAogICAgLy8gYXNzZXJ0IHRva2VuX2lkIGluIHNlbGYubWFya2V0cywgIk1hcmtldCBkb2VzIG5vdCBleGlzdCIKICAgIGFzc2VydCAvLyBNYXJrZXQgZG9lcyBub3QgZXhpc3QKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODE1CiAgICAvLyBhc3NlcnQgcHJpY2UgPiAwLCAiUHJpY2UgbXVzdCBiZSBwb3NpdGl2ZSIKICAgIGZyYW1lX2RpZyAtMQogICAgYnl0ZSAweAogICAgYj4KICAgIGFzc2VydCAvLyBQcmljZSBtdXN0IGJlIHBvc2l0aXZlCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjgxNwogICAgLy8gbWFya2V0ID0gc2VsZi5tYXJrZXRzW3Rva2VuX2lkXS5jb3B5KCkKICAgIGJveF9nZXQKICAgIHN3YXAKICAgIGR1cAogICAgdW5jb3ZlciAyCiAgICBhc3NlcnQgLy8gY2hlY2sgc2VsZi5tYXJrZXRzIGVudHJ5IGV4aXN0cwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo4MTktODIwCiAgICAvLyAjIFVucGF1c2UgdGhlIG1hcmtldCBvbiBmaXJzdCBwcmljZSBzZXQKICAgIC8vIGlmIG1hcmtldC5wYXVzZWQgYW5kIG1hcmtldC5wcmljZSA9PSAwOgogICAgZHVwCiAgICBpbnQgMAogICAgZ2V0Yml0CiAgICBieXRlIDB4MDAKICAgIGludCAwCiAgICB1bmNvdmVyIDIKICAgIHNldGJpdAogICAgYnl0ZSAweDAwCiAgICAhPQogICAgYnogX3NldF9tYXJrZXRfcHJpY2VfYWZ0ZXJfaWZfZWxzZUAzCiAgICBmcmFtZV9kaWcgMQogICAgZHVwCiAgICBpbnQgMjgxCiAgICBpbnQgMzIKICAgIGV4dHJhY3QzIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgYnl0ZSAweDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAKICAgIGI9PQogICAgc3dhcAogICAgZnJhbWVfYnVyeSAyCiAgICBieiBfc2V0X21hcmtldF9wcmljZV9hZnRlcl9pZl9lbHNlQDMKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODIxCiAgICAvLyBtYXJrZXQucGF1c2VkID0gYXJjNC5Cb29sKEZhbHNlKQogICAgZnJhbWVfZGlnIDEKICAgIGludCAwCiAgICBkdXAKICAgIHNldGJpdAogICAgZnJhbWVfYnVyeSAyCgpfc2V0X21hcmtldF9wcmljZV9hZnRlcl9pZl9lbHNlQDM6CiAgICBmcmFtZV9kaWcgMgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo4MjMtODI0CiAgICAvLyAjIFNjYWxlIHRoZSBwcmljZSBieSBTQ0FMRSBpbnRlcm5hbGx5IGZvciBzdG9yYWdlCiAgICAvLyBtYXJrZXQucHJpY2UgPSBhcmM0LlVJbnQyNTYocHJpY2UgKiBTQ0FMRSkKICAgIGZyYW1lX2RpZyAtMQogICAgYnl0ZSAweDBkZTBiNmIzYTc2NDAwMDAKICAgIGIqCiAgICBkdXAKICAgIGxlbgogICAgaW50IDMyCiAgICA8PQogICAgYXNzZXJ0IC8vIG92ZXJmbG93CiAgICBpbnQgMzIKICAgIGJ6ZXJvCiAgICBifAogICAgaW50IDI4MQogICAgc3dhcAogICAgcmVwbGFjZTMKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODI2CiAgICAvLyBzZWxmLm1hcmtldHNbdG9rZW5faWRdID0gbWFya2V0LmNvcHkoKQogICAgZnJhbWVfZGlnIDAKICAgIHN3YXAKICAgIGJveF9wdXQKICAgIHJldHN1YgoKCi8vIGNvbnRyYWN0LkxlbmRpbmdQb29sLnBhdXNlX21hcmtldCh0b2tlbl9pZDogYnl0ZXMsIHBhdXNlOiBieXRlcykgLT4gdm9pZDoKcGF1c2VfbWFya2V0OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo4NzYtODc3CiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBwYXVzZV9tYXJrZXQoc2VsZiwgdG9rZW5faWQ6IGFyYzQuVUludDY0LCBwYXVzZTogYXJjNC5VSW50NjQpIC0+IE5vbmU6CiAgICBwcm90byAyIDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODc4CiAgICAvLyBzZWxmLl9vbmx5X293bmVyKCkKICAgIGNhbGxzdWIgX29ubHlfb3duZXIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODc5CiAgICAvLyBzZWxmLl9wYXVzZV9tYXJrZXQodG9rZW5faWQubmF0aXZlLCBwYXVzZS5uYXRpdmUpCiAgICBmcmFtZV9kaWcgLTIKICAgIGJ0b2kKICAgIGZyYW1lX2RpZyAtMQogICAgYnRvaQogICAgY2FsbHN1YiBfcGF1c2VfbWFya2V0CiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5fcGF1c2VfbWFya2V0KHRva2VuX2lkOiB1aW50NjQsIHBhdXNlOiB1aW50NjQpIC0+IHZvaWQ6Cl9wYXVzZV9tYXJrZXQ6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojg4MS04ODIKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3BhdXNlX21hcmtldChzZWxmLCB0b2tlbl9pZDogVUludDY0LCBwYXVzZTogVUludDY0KSAtPiBOb25lOgogICAgcHJvdG8gMiAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjUxMC04ODMKICAgIC8vICAgICBzZWxmLm1hcmtldHMgPSBCb3hNYXAoVUludDY0LCBNYXJrZXREYXRhKSAgIyBNYXJrZXQgc3RhdGUKICAgIC8vICAgICBzZWxmLnVzZXJzID0gQm94TWFwKEJ5dGVzNDAsIFVzZXJEYXRhKSAgIyBQZXItbWFya2V0IHVzZXIgc3RhdGUKICAgIC8vICAgICBzZWxmLmdsb2JhbF91c2VycyA9IEJveE1hcChBY2NvdW50LCBHbG9iYWxVc2VyRGF0YSkgICMgR2xvYmFsIHVzZXIgc3RhdGUKICAgIC8vIAogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAjIE93bmFibGUKICAgIC8vICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9vbmx5X293bmVyKHNlbGYpIC0+IE5vbmU6CiAgICAvLyAgICAgYXNzZXJ0IFR4bi5zZW5kZXIgPT0gc2VsZi5vd25lciwgIm9ubHkgdGhlIG93bmVyIGNhbiBjYWxsIHRoaXMgZnVuY3Rpb24iCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZChyZWFkb25seT1UcnVlKQogICAgLy8gZGVmIGdldF9vd25lcihzZWxmKSAtPiBhcmM0LkFkZHJlc3M6CiAgICAvLyAgICAgcmV0dXJuIGFyYzQuQWRkcmVzcyhzZWxmLm93bmVyKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiB0cmFuc2Zlcl9vd25lcnNoaXAoc2VsZiwgbmV3X293bmVyOiBhcmM0LkFkZHJlc3MpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgc2VsZi5fdHJhbnNmZXJfb3duZXJzaGlwKG5ld19vd25lci5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3RyYW5zZmVyX293bmVyc2hpcChzZWxmLCBuZXdfb3duZXI6IEFjY291bnQpIC0+IE5vbmU6CiAgICAvLyAgICAgcHJldmlvdXNfb3duZXIgPSBzZWxmLm93bmVyCiAgICAvLyAgICAgc2VsZi5vd25lciA9IG5ld19vd25lcgogICAgLy8gICAgIGFyYzQuZW1pdCgKICAgIC8vICAgICAgICAgT3duZXJzaGlwVHJhbnNmZXJyZWQoYXJjNC5BZGRyZXNzKHByZXZpb3VzX293bmVyKSwgYXJjNC5BZGRyZXNzKG5ld19vd25lcikpCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIAogICAgLy8gIyBSRU0gaGF2aW5nIGlzc3VlcyB3aXRoIHRoZSBpbmhlcml0YW5jZSBoZXJlCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGlzX3BhdXNlZChzZWxmKSAtPiBhcmM0LkJvb2w6CiAgICAvLyAgICAgcmV0dXJuIGFyYzQuQm9vbChzZWxmLl9pc19wYXVzZWQoKSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaXNfcGF1c2VkKHNlbGYpIC0+IGJvb2w6CiAgICAvLyAgICAgcmV0dXJuIHNlbGYucGF1c2VkID09IFVJbnQ2NCgxKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBwYXVzZShzZWxmLCBwYXVzZTogYXJjNC5VSW50NjQpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgc2VsZi5fcGF1c2UocGF1c2UubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9wYXVzZShzZWxmLCBwYXVzZTogVUludDY0KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYucGF1c2VkID0gcGF1c2UKICAgIC8vIAogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF9zdG9rZW5fYXBwX2lkKHNlbGYpIC0+IGFyYzQuVUludDY0OgogICAgLy8gICAgIHJldHVybiBhcmM0LlVJbnQ2NChzZWxmLl9nZXRfc3Rva2VuX2FwcF9pZCgpKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9nZXRfc3Rva2VuX2FwcF9pZChzZWxmKSAtPiBVSW50NjQ6CiAgICAvLyAgICAgcmV0dXJuIHNlbGYuc3Rva2VuX2FwcF9pZAogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBzZXRfc3Rva2VuX2FwcF9pZChzZWxmLCBzdG9rZW5fYXBwX2lkOiBhcmM0LlVJbnQ2NCkgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLl9vbmx5X293bmVyKCkKICAgIC8vICAgICBzZWxmLnN0b2tlbl9hcHBfaWQgPSBzdG9rZW5fYXBwX2lkLm5hdGl2ZQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9nZXRfdXNlcl9rZXkoc2VsZiwgdXNlcl9pZDogQWNjb3VudCwgbWFya2V0X2lkOiBVSW50NjQpIC0+IEJ5dGVzNDA6CiAgICAvLyAgICAgcmV0dXJuIEJ5dGVzNDAuZnJvbV9ieXRlcygKICAgIC8vICAgICAgICAgYXJjNC5BZGRyZXNzKHVzZXJfaWQpLmJ5dGVzICsgYXJjNC5VSW50NjQobWFya2V0X2lkKS5ieXRlcwogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgZ2V0X3VzZXIoc2VsZiwgdXNlcl9pZDogYXJjNC5BZGRyZXNzLCBtYXJrZXRfaWQ6IGFyYzQuVUludDY0KSAtPiBVc2VyRGF0YToKICAgIC8vICAgICByZXR1cm4gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZC5uYXRpdmUsIG1hcmtldF9pZC5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2dldF91c2VyKHNlbGYsIHVzZXJfaWQ6IEFjY291bnQsIG1hcmtldF9pZDogVUludDY0KSAtPiBVc2VyRGF0YToKICAgIC8vICAgICB1c2VyX2tleSA9IHNlbGYuX2dldF91c2VyX2tleSh1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgcmV0dXJuIHNlbGYudXNlcnMuZ2V0KAogICAgLy8gICAgICAgICB1c2VyX2tleSwKICAgIC8vICAgICAgICAgZGVmYXVsdD1Vc2VyRGF0YSgKICAgIC8vICAgICAgICAgICAgIHNjYWxlZF9kZXBvc2l0cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBzY2FsZWRfYm9ycm93cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBkZXBvc2l0X2luZGV4PWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGJvcnJvd19pbmRleD1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBsYXN0X3VwZGF0ZV90aW1lPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgbGFzdF9wcmljZT1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICksCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9oYXNfcG9zaXRpb24oc2VsZiwgdXNlcl9pZDogQWNjb3VudCwgbWFya2V0X2lkOiBVSW50NjQpIC0+IGJvb2w6CiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICByZXR1cm4gdXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlID4gMAogICAgLy8gCiAgICAvLyAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIAogICAgLy8gIyBSRU0gY29uc2lkZXIgcmVtb3ZpbmcgYW5kIGNhbGN1bGF0aW5nIGluIHRoZSBjbGllbnQKICAgIC8vICMgUkVNIHRyeWluZyB0byBjdXQgYmFjayBvbiBleHRyYSBwYWdlcwogICAgLy8gCiAgICAvLyAjIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gIyBkZWYgZ2V0X3VzZXJfZGVwb3NpdF91bmRlcmx5aW5nX2Ftb3VudCgKICAgIC8vICMgICAgIHNlbGYsIHVzZXJfaWQ6IGFyYzQuQWRkcmVzcywgbWFya2V0X2lkOiBhcmM0LlVJbnQ2NAogICAgLy8gIyApIC0+IGFyYzQuVUludDI1NjoKICAgIC8vICMgICAgIHJldHVybiBhcmM0LlVJbnQyNTYoCiAgICAvLyAjICAgICAgICAgc2VsZi5fZ2V0X3VzZXJfZGVwb3NpdF91bmRlcmx5aW5nX2Ftb3VudCh1c2VyX2lkLm5hdGl2ZSwgbWFya2V0X2lkLm5hdGl2ZSkKICAgIC8vICMgICAgICkKICAgIC8vIAogICAgLy8gIyBAc3Vicm91dGluZQogICAgLy8gIyBkZWYgX2dldF91c2VyX2RlcG9zaXRfdW5kZXJseWluZ19hbW91bnQoCiAgICAvLyAjICAgICBzZWxmLCB1c2VyX2lkOiBBY2NvdW50LCBtYXJrZXRfaWQ6IFVJbnQ2NAogICAgLy8gIyApIC0+IEJpZ1VJbnQ6CiAgICAvLyAjICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gIyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpICAjIEFkZCB0aGlzIGxpbmUKICAgIC8vICMgICAgIHJldHVybiAodXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlICogbWFya2V0LmRlcG9zaXRfaW5kZXgubmF0aXZlKSAvLyBTQ0FMRQogICAgLy8gCiAgICAvLyAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaW5jcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9kZXBvc2l0cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgdXNlcl9pZDogQWNjb3VudCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyX2tleSA9IHNlbGYuX2dldF91c2VyX2tleSh1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlci5zY2FsZWRfZGVwb3NpdHMgPSBhcmM0LlVJbnQyNTYodXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlICsgYW1vdW50KQogICAgLy8gICAgIHVzZXIuZGVwb3NpdF9pbmRleCA9IG1hcmtldC5kZXBvc2l0X2luZGV4CiAgICAvLyAgICAgdXNlci5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApCiAgICAvLyAgICAgdXNlci5sYXN0X3ByaWNlID0gbWFya2V0LnByaWNlICAjIFVwZGF0ZSB1c2VyJ3MgbGFzdCBrbm93biBwcmljZQogICAgLy8gICAgIHNlbGYudXNlcnNbdXNlcl9rZXldID0gdXNlci5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaW5jcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9ib3Jyb3dzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCB1c2VyX2lkOiBBY2NvdW50LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyLnNjYWxlZF9ib3Jyb3dzID0gYXJjNC5VSW50MjU2KHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlICsgYW1vdW50KQogICAgLy8gICAgIHVzZXIuYm9ycm93X2luZGV4ID0gbWFya2V0LmJvcnJvd19pbmRleAogICAgLy8gICAgIHVzZXIubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gICAgIHVzZXIubGFzdF9wcmljZSA9IG1hcmtldC5wcmljZSAgIyBVcGRhdGUgdXNlcidzIGxhc3Qga25vd24gcHJpY2UKICAgIC8vICAgICBzZWxmLnVzZXJzW3VzZXJfa2V5XSA9IHVzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2RlY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfZGVwb3NpdHMoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIHVzZXJfaWQ6IEFjY291bnQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlcl9rZXkgPSBzZWxmLl9nZXRfdXNlcl9rZXkodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgIHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSA+PSBhbW91bnQKICAgIC8vICAgICApLCAiSW5zdWZmaWNpZW50IGJhbGFuY2UgdG8gd2l0aGRyYXcgdGhpcyBhbW91bnQiCiAgICAvLyAgICAgdXNlci5zY2FsZWRfZGVwb3NpdHMgPSBhcmM0LlVJbnQyNTYodXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlIC0gYW1vdW50KQogICAgLy8gICAgIHVzZXIuZGVwb3NpdF9pbmRleCA9IG1hcmtldC5kZXBvc2l0X2luZGV4CiAgICAvLyAgICAgdXNlci5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApCiAgICAvLyAgICAgdXNlci5sYXN0X3ByaWNlID0gbWFya2V0LnByaWNlICAjIFVwZGF0ZSB1c2VyJ3MgbGFzdCBrbm93biBwcmljZQogICAgLy8gICAgIHNlbGYudXNlcnNbdXNlcl9rZXldID0gdXNlci5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZGVjcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9ib3Jyb3dzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCB1c2VyX2lkOiBBY2NvdW50LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICB1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSA+PSBhbW91bnQKICAgIC8vICAgICApLCAiSW5zdWZmaWNpZW50IGJhbGFuY2UgdG8gcmVwYXkgdGhpcyBhbW91bnQiCiAgICAvLyAgICAgdXNlci5zY2FsZWRfYm9ycm93cyA9IGFyYzQuVUludDI1Nih1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAtIGFtb3VudCkKICAgIC8vICAgICB1c2VyLmJvcnJvd19pbmRleCA9IG1hcmtldC5ib3Jyb3dfaW5kZXgKICAgIC8vICAgICB1c2VyLmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vICAgICB1c2VyLmxhc3RfcHJpY2UgPSBtYXJrZXQucHJpY2UgICMgVXBkYXRlIHVzZXIncyBsYXN0IGtub3duIHByaWNlCiAgICAvLyAgICAgc2VsZi51c2Vyc1t1c2VyX2tleV0gPSB1c2VyLmNvcHkoKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBjcmVhdGVfbWFya2V0KAogICAgLy8gICAgIHNlbGYsCiAgICAvLyAgICAgdG9rZW5faWQ6IGFyYzQuVUludDY0LAogICAgLy8gICAgIGNvbGxhdGVyYWxfZmFjdG9yOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBsaXF1aWRhdGlvbl90aHJlc2hvbGQ6IGFyYzQuVUludDY0LAogICAgLy8gICAgIHJlc2VydmVfZmFjdG9yOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBib3Jyb3dfcmF0ZTogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgc2xvcGU6IGFyYzQuVUludDY0LAogICAgLy8gICAgIG1heF90b3RhbF9kZXBvc2l0czogYXJjNC5VSW50MjU2LAogICAgLy8gICAgIG1heF90b3RhbF9ib3Jyb3dzOiBhcmM0LlVJbnQyNTYsCiAgICAvLyAgICAgbGlxdWlkYXRpb25fYm9udXM6IGFyYzQuVUludDY0LAogICAgLy8gICAgIGNsb3NlX2ZhY3RvcjogYXJjNC5VSW50NjQsCiAgICAvLyApIC0+IGFyYzQuVUludDY0OgogICAgLy8gICAgIHNlbGYuX29ubHlfb3duZXIoKQogICAgLy8gICAgIGFzc2VydCBub3Qgc2VsZi5faXNfcGF1c2VkKCksICJQcm90b2NvbCBpcyBwYXVzZWQiCiAgICAvLyAgICAgcmV0dXJuIGFyYzQuVUludDY0KAogICAgLy8gICAgICAgICBzZWxmLl9jcmVhdGVfbWFya2V0KAogICAgLy8gICAgICAgICAgICAgdG9rZW5faWQubmF0aXZlLAogICAgLy8gICAgICAgICAgICAgTWFya2V0RGF0YSgKICAgIC8vICAgICAgICAgICAgICAgICBwYXVzZWQ9YXJjNC5Cb29sKFRydWUpLCAgIyBTdGFydCBwYXVzZWQgdW50aWwgcHJpY2UgaXMgc2V0CiAgICAvLyAgICAgICAgICAgICAgICAgbWF4X3RvdGFsX2RlcG9zaXRzPW1heF90b3RhbF9kZXBvc2l0cywKICAgIC8vICAgICAgICAgICAgICAgICBtYXhfdG90YWxfYm9ycm93cz1tYXhfdG90YWxfYm9ycm93cywKICAgIC8vICAgICAgICAgICAgICAgICBsaXF1aWRhdGlvbl9ib251cz1saXF1aWRhdGlvbl9ib251cywKICAgIC8vICAgICAgICAgICAgICAgICBjb2xsYXRlcmFsX2ZhY3Rvcj1jb2xsYXRlcmFsX2ZhY3RvciwKICAgIC8vICAgICAgICAgICAgICAgICBsaXF1aWRhdGlvbl90aHJlc2hvbGQ9bGlxdWlkYXRpb25fdGhyZXNob2xkLAogICAgLy8gICAgICAgICAgICAgICAgIHJlc2VydmVfZmFjdG9yPXJlc2VydmVfZmFjdG9yLAogICAgLy8gICAgICAgICAgICAgICAgIGJvcnJvd19yYXRlPWJvcnJvd19yYXRlLAogICAgLy8gICAgICAgICAgICAgICAgIHNsb3BlPXNsb3BlLAogICAgLy8gICAgICAgICAgICAgICAgIHRvdGFsX3NjYWxlZF9kZXBvc2l0cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICAgICAgdG90YWxfc2NhbGVkX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgICAgIGRlcG9zaXRfaW5kZXg9YXJjNC5VSW50MjU2KFNDQUxFKSwgICMgU3RhcnQgYXQgU0NBTEUgKDEuMCkKICAgIC8vICAgICAgICAgICAgICAgICBib3Jyb3dfaW5kZXg9YXJjNC5VSW50MjU2KFNDQUxFKSwgICMgU3RhcnQgYXQgU0NBTEUgKDEuMCkKICAgIC8vICAgICAgICAgICAgICAgICBsYXN0X3VwZGF0ZV90aW1lPWFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKSwKICAgIC8vICAgICAgICAgICAgICAgICByZXNlcnZlcz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICAgICAgcHJpY2U9YXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICAgICAgICAgICAgICAwCiAgICAvLyAgICAgICAgICAgICAgICAgKSwgICMgUHJpY2UgbXVzdCBiZSBzZXQgYmVmb3JlIG1hcmtldCBjYW4gYmUgdXNlZAogICAgLy8gICAgICAgICAgICAgICAgIG50b2tlbl9pZD1hcmM0LlVJbnQ2NCgwKSwgICMgV2lsbCBiZSBzZXQgZHVyaW5nIHRva2VuIGluaXRpYWxpemF0aW9uCiAgICAvLyAgICAgICAgICAgICAgICAgY2xvc2VfZmFjdG9yPWNsb3NlX2ZhY3RvciwKICAgIC8vICAgICAgICAgICAgICksCiAgICAvLyAgICAgICAgICkKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2NyZWF0ZV9tYXJrZXQoc2VsZiwgdG9rZW5faWQ6IFVJbnQ2NCwgbWFya2V0X2RhdGE6IE1hcmtldERhdGEpIC0+IFVJbnQ2NDoKICAgIC8vICAgICBhc3NlcnQgbm90IHRva2VuX2lkIGluIHNlbGYubWFya2V0cywgIk1hcmtldCBhbHJlYWR5IGV4aXN0cyIKICAgIC8vICAgICBwYXltZW50ID0gcmVxdWlyZV9wYXltZW50KFR4bi5zZW5kZXIpCiAgICAvLyAgICAgYXNzZXJ0ICgKICAgIC8vICAgICAgICAgcGF5bWVudCA+PSBzZWxmLl9jcmVhdGVfbWFya2V0X2Nvc3QoKQogICAgLy8gICAgICksICJpbnN1ZmZpY2llbnQgcGF5bWVudCBmb3IgY3JlYXRlIG1hcmtldCIKICAgIC8vICAgICBjb21waWxlZCA9IGNvbXBpbGVfY29udHJhY3QoTlRva2VuLCBleHRyYV9wcm9ncmFtX3BhZ2VzPTApICAjIG5vIGV4dHJhIHBhZ2VzCiAgICAvLyAgICAgYmFzZV9hcHAgPSBhcmM0LmFyYzRfY3JlYXRlKE5Ub2tlbiwgY29tcGlsZWQ9Y29tcGlsZWQpLmNyZWF0ZWRfYXBwCiAgICAvLyAgICAgYm9vdHN0cmFwNjRfY29zdCwgdHhuMSA9IGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIE5Ub2tlbi5ib290c3RyYXA2NF9jb3N0LAogICAgLy8gICAgICAgICBhcHBfaWQ9YmFzZV9hcHAsCiAgICAvLyAgICAgKQogICAgLy8gICAgIGl0eG4uUGF5bWVudCgKICAgIC8vICAgICAgICAgcmVjZWl2ZXI9YmFzZV9hcHAuYWRkcmVzcywgYW1vdW50PWJvb3RzdHJhcDY0X2Nvc3QubmF0aXZlLCBmZWU9MAogICAgLy8gICAgICkuc3VibWl0KCkKICAgIC8vICAgICBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgICAgICBOVG9rZW4uYm9vdHN0cmFwNjQsCiAgICAvLyAgICAgICAgIGFyYzQuVUludDY0KHRva2VuX2lkKSwKICAgIC8vICAgICAgICAgYXBwX2lkPWJhc2VfYXBwLAogICAgLy8gICAgICkKICAgIC8vICAgICBtYXJrZXRfZGF0YS5udG9rZW5faWQgPSBhcmM0LlVJbnQ2NChiYXNlX2FwcC5pZCkKICAgIC8vICAgICBzZWxmLm1hcmtldHNbdG9rZW5faWRdID0gbWFya2V0X2RhdGEuY29weSgpCiAgICAvLyAgICAgYXJjNC5lbWl0KAogICAgLy8gICAgICAgICBNYXJrZXRDcmVhdGVkKGFyYzQuVUludDY0KHRva2VuX2lkKSwgYXJjNC5VSW50NjQoYmFzZV9hcHAuaWQpLCBtYXJrZXRfZGF0YSkKICAgIC8vICAgICApCiAgICAvLyAgICAgcmV0dXJuIGJhc2VfYXBwLmlkCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZChyZWFkb25seT1UcnVlKQogICAgLy8gZGVmIGNyZWF0ZV9tYXJrZXRfY29zdChzZWxmKSAtPiBhcmM0LlVJbnQ2NDoKICAgIC8vICAgICByZXR1cm4gYXJjNC5VSW50NjQoc2VsZi5fY3JlYXRlX21hcmtldF9jb3N0KCkpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2NyZWF0ZV9tYXJrZXRfY29zdChzZWxmKSAtPiBVSW50NjQ6CiAgICAvLyAgICAgcmV0dXJuIFVJbnQ2NCgxXzAwMF8wMDApCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZChyZWFkb25seT1UcnVlKQogICAgLy8gZGVmIGdldF9tYXJrZXQoc2VsZiwgdG9rZW5faWQ6IGFyYzQuVUludDY0KSAtPiBNYXJrZXREYXRhOgogICAgLy8gICAgIHJldHVybiBzZWxmLl9nZXRfbWFya2V0KHRva2VuX2lkLm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X21hcmtldChzZWxmLCB0b2tlbl9pZDogVUludDY0KSAtPiBNYXJrZXREYXRhOgogICAgLy8gICAgIHJldHVybiBzZWxmLm1hcmtldHMuZ2V0KAogICAgLy8gICAgICAgICB0b2tlbl9pZCwKICAgIC8vICAgICAgICAgZGVmYXVsdD1NYXJrZXREYXRhKAogICAgLy8gICAgICAgICAgICAgcGF1c2VkPWFyYzQuQm9vbChUcnVlKSwKICAgIC8vICAgICAgICAgICAgIG1heF90b3RhbF9kZXBvc2l0cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBtYXhfdG90YWxfYm9ycm93cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBsaXF1aWRhdGlvbl9ib251cz1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIGNvbGxhdGVyYWxfZmFjdG9yPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgbGlxdWlkYXRpb25fdGhyZXNob2xkPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgcmVzZXJ2ZV9mYWN0b3I9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICBib3Jyb3dfcmF0ZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIHNsb3BlPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgdG90YWxfc2NhbGVkX2RlcG9zaXRzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIHRvdGFsX3NjYWxlZF9ib3Jyb3dzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGRlcG9zaXRfaW5kZXg9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgYm9ycm93X2luZGV4PWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGxhc3RfdXBkYXRlX3RpbWU9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICByZXNlcnZlcz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBwcmljZT1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBudG9rZW5faWQ9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICBjbG9zZV9mYWN0b3I9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICksCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBnZXRfbWFya2V0X3ByaWNlKHNlbGYsIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCkgLT4gYXJjNC5VSW50MjU2OgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQodG9rZW5faWQubmF0aXZlKQogICAgLy8gICAgIHJldHVybiBtYXJrZXQucHJpY2UKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgZ2V0X21hcmtldF9udG9rZW5faWQoc2VsZiwgdG9rZW5faWQ6IGFyYzQuVUludDY0KSAtPiBhcmM0LlVJbnQ2NDoKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KHRva2VuX2lkLm5hdGl2ZSkKICAgIC8vICAgICByZXR1cm4gbWFya2V0Lm50b2tlbl9pZAogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBzZXRfbWFya2V0X3ByaWNlKHNlbGYsIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCwgcHJpY2U6IGFyYzQuVUludDI1NikgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLl9vbmx5X293bmVyKCkKICAgIC8vICAgICBhc3NlcnQgbm90IHNlbGYuX2lzX3BhdXNlZCgpLCAiUHJvdG9jb2wgaXMgcGF1c2VkIgogICAgLy8gICAgIHNlbGYuX3NldF9tYXJrZXRfcHJpY2UodG9rZW5faWQubmF0aXZlLCBwcmljZS5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3NldF9tYXJrZXRfcHJpY2Uoc2VsZiwgdG9rZW5faWQ6IFVJbnQ2NCwgcHJpY2U6IEJpZ1VJbnQpIC0+IE5vbmU6CiAgICAvLyAgICAgYXNzZXJ0IHRva2VuX2lkIGluIHNlbGYubWFya2V0cywgIk1hcmtldCBkb2VzIG5vdCBleGlzdCIKICAgIC8vICAgICBhc3NlcnQgcHJpY2UgPiAwLCAiUHJpY2UgbXVzdCBiZSBwb3NpdGl2ZSIKICAgIC8vIAogICAgLy8gICAgIG1hcmtldCA9IHNlbGYubWFya2V0c1t0b2tlbl9pZF0uY29weSgpCiAgICAvLyAKICAgIC8vICAgICAjIFVucGF1c2UgdGhlIG1hcmtldCBvbiBmaXJzdCBwcmljZSBzZXQKICAgIC8vICAgICBpZiBtYXJrZXQucGF1c2VkIGFuZCBtYXJrZXQucHJpY2UgPT0gMDoKICAgIC8vICAgICAgICAgbWFya2V0LnBhdXNlZCA9IGFyYzQuQm9vbChGYWxzZSkKICAgIC8vIAogICAgLy8gICAgICMgU2NhbGUgdGhlIHByaWNlIGJ5IFNDQUxFIGludGVybmFsbHkgZm9yIHN0b3JhZ2UKICAgIC8vICAgICBtYXJrZXQucHJpY2UgPSBhcmM0LlVJbnQyNTYocHJpY2UgKiBTQ0FMRSkKICAgIC8vIAogICAgLy8gICAgIHNlbGYubWFya2V0c1t0b2tlbl9pZF0gPSBtYXJrZXQuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2luY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2RlcG9zaXRzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSArIGFtb3VudAogICAgLy8gICAgICkKICAgIC8vICAgICBtYXJrZXQubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gICAgIHNlbGYubWFya2V0c1ttYXJrZXRfaWRdID0gbWFya2V0LmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9kZWNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9kZXBvc2l0cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgYXNzZXJ0ICgKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cy5uYXRpdmUgPj0gYW1vdW50CiAgICAvLyAgICAgKSwgIkluc3VmZmljaWVudCBiYWxhbmNlIHRvIHdpdGhkcmF3IHRoaXMgYW1vdW50IgogICAgLy8gICAgIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMgPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlIC0gYW1vdW50CiAgICAvLyAgICAgKQogICAgLy8gICAgIHNlbGYubWFya2V0c1ttYXJrZXRfaWRdID0gbWFya2V0LmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9pbmNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9ib3Jyb3dzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MgPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUgKyBhbW91bnQKICAgIC8vICAgICApCiAgICAvLyAgICAgbWFya2V0Lmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vICAgICBzZWxmLm1hcmtldHNbbWFya2V0X2lkXSA9IG1hcmtldC5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZGVjcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfYm9ycm93cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgYXNzZXJ0ICgKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzLm5hdGl2ZSA+PSBhbW91bnQKICAgIC8vICAgICApLCAiSW5zdWZmaWNpZW50IGJhbGFuY2UgdG8gd2l0aGRyYXcgdGhpcyBhbW91bnQiCiAgICAvLyAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlIC0gYW1vdW50CiAgICAvLyAgICAgKQogICAgLy8gICAgIHNlbGYubWFya2V0c1ttYXJrZXRfaWRdID0gbWFya2V0LmNvcHkoKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBwYXVzZV9tYXJrZXQoc2VsZiwgdG9rZW5faWQ6IGFyYzQuVUludDY0LCBwYXVzZTogYXJjNC5VSW50NjQpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgc2VsZi5fcGF1c2VfbWFya2V0KHRva2VuX2lkLm5hdGl2ZSwgcGF1c2UubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9wYXVzZV9tYXJrZXQoc2VsZiwgdG9rZW5faWQ6IFVJbnQ2NCwgcGF1c2U6IFVJbnQ2NCkgLT4gTm9uZToKICAgIC8vICAgICBhc3NlcnQgdG9rZW5faWQgaW4gc2VsZi5tYXJrZXRzLCAiTWFya2V0IGRvZXMgbm90IGV4aXN0IgogICAgZnJhbWVfZGlnIC0yCiAgICBpdG9iCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjUxMAogICAgLy8gc2VsZi5tYXJrZXRzID0gQm94TWFwKFVJbnQ2NCwgTWFya2V0RGF0YSkgICMgTWFya2V0IHN0YXRlCiAgICBieXRlICJtYXJrZXRzIgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1MTAtODgzCiAgICAvLyAgICAgc2VsZi5tYXJrZXRzID0gQm94TWFwKFVJbnQ2NCwgTWFya2V0RGF0YSkgICMgTWFya2V0IHN0YXRlCiAgICAvLyAgICAgc2VsZi51c2VycyA9IEJveE1hcChCeXRlczQwLCBVc2VyRGF0YSkgICMgUGVyLW1hcmtldCB1c2VyIHN0YXRlCiAgICAvLyAgICAgc2VsZi5nbG9iYWxfdXNlcnMgPSBCb3hNYXAoQWNjb3VudCwgR2xvYmFsVXNlckRhdGEpICAjIEdsb2JhbCB1c2VyIHN0YXRlCiAgICAvLyAKICAgIC8vICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gIyBPd25hYmxlCiAgICAvLyAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfb25seV9vd25lcihzZWxmKSAtPiBOb25lOgogICAgLy8gICAgIGFzc2VydCBUeG4uc2VuZGVyID09IHNlbGYub3duZXIsICJvbmx5IHRoZSBvd25lciBjYW4gY2FsbCB0aGlzIGZ1bmN0aW9uIgogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QocmVhZG9ubHk9VHJ1ZSkKICAgIC8vIGRlZiBnZXRfb3duZXIoc2VsZikgLT4gYXJjNC5BZGRyZXNzOgogICAgLy8gICAgIHJldHVybiBhcmM0LkFkZHJlc3Moc2VsZi5vd25lcikKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgdHJhbnNmZXJfb3duZXJzaGlwKHNlbGYsIG5ld19vd25lcjogYXJjNC5BZGRyZXNzKSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX29ubHlfb3duZXIoKQogICAgLy8gICAgIHNlbGYuX3RyYW5zZmVyX293bmVyc2hpcChuZXdfb3duZXIubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF90cmFuc2Zlcl9vd25lcnNoaXAoc2VsZiwgbmV3X293bmVyOiBBY2NvdW50KSAtPiBOb25lOgogICAgLy8gICAgIHByZXZpb3VzX293bmVyID0gc2VsZi5vd25lcgogICAgLy8gICAgIHNlbGYub3duZXIgPSBuZXdfb3duZXIKICAgIC8vICAgICBhcmM0LmVtaXQoCiAgICAvLyAgICAgICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKGFyYzQuQWRkcmVzcyhwcmV2aW91c19vd25lciksIGFyYzQuQWRkcmVzcyhuZXdfb3duZXIpKQogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAKICAgIC8vICMgUkVNIGhhdmluZyBpc3N1ZXMgd2l0aCB0aGUgaW5oZXJpdGFuY2UgaGVyZQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBpc19wYXVzZWQoc2VsZikgLT4gYXJjNC5Cb29sOgogICAgLy8gICAgIHJldHVybiBhcmM0LkJvb2woc2VsZi5faXNfcGF1c2VkKCkpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2lzX3BhdXNlZChzZWxmKSAtPiBib29sOgogICAgLy8gICAgIHJldHVybiBzZWxmLnBhdXNlZCA9PSBVSW50NjQoMSkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgcGF1c2Uoc2VsZiwgcGF1c2U6IGFyYzQuVUludDY0KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX29ubHlfb3duZXIoKQogICAgLy8gICAgIHNlbGYuX3BhdXNlKHBhdXNlLm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfcGF1c2Uoc2VsZiwgcGF1c2U6IFVJbnQ2NCkgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLnBhdXNlZCA9IHBhdXNlCiAgICAvLyAKICAgIC8vICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBnZXRfc3Rva2VuX2FwcF9pZChzZWxmKSAtPiBhcmM0LlVJbnQ2NDoKICAgIC8vICAgICByZXR1cm4gYXJjNC5VSW50NjQoc2VsZi5fZ2V0X3N0b2tlbl9hcHBfaWQoKSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X3N0b2tlbl9hcHBfaWQoc2VsZikgLT4gVUludDY0OgogICAgLy8gICAgIHJldHVybiBzZWxmLnN0b2tlbl9hcHBfaWQKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgc2V0X3N0b2tlbl9hcHBfaWQoc2VsZiwgc3Rva2VuX2FwcF9pZDogYXJjNC5VSW50NjQpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgc2VsZi5zdG9rZW5fYXBwX2lkID0gc3Rva2VuX2FwcF9pZC5uYXRpdmUKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X3VzZXJfa2V5KHNlbGYsIHVzZXJfaWQ6IEFjY291bnQsIG1hcmtldF9pZDogVUludDY0KSAtPiBCeXRlczQwOgogICAgLy8gICAgIHJldHVybiBCeXRlczQwLmZyb21fYnl0ZXMoCiAgICAvLyAgICAgICAgIGFyYzQuQWRkcmVzcyh1c2VyX2lkKS5ieXRlcyArIGFyYzQuVUludDY0KG1hcmtldF9pZCkuYnl0ZXMKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF91c2VyKHNlbGYsIHVzZXJfaWQ6IGFyYzQuQWRkcmVzcywgbWFya2V0X2lkOiBhcmM0LlVJbnQ2NCkgLT4gVXNlckRhdGE6CiAgICAvLyAgICAgcmV0dXJuIHNlbGYuX2dldF91c2VyKHVzZXJfaWQubmF0aXZlLCBtYXJrZXRfaWQubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9nZXRfdXNlcihzZWxmLCB1c2VyX2lkOiBBY2NvdW50LCBtYXJrZXRfaWQ6IFVJbnQ2NCkgLT4gVXNlckRhdGE6CiAgICAvLyAgICAgdXNlcl9rZXkgPSBzZWxmLl9nZXRfdXNlcl9rZXkodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHJldHVybiBzZWxmLnVzZXJzLmdldCgKICAgIC8vICAgICAgICAgdXNlcl9rZXksCiAgICAvLyAgICAgICAgIGRlZmF1bHQ9VXNlckRhdGEoCiAgICAvLyAgICAgICAgICAgICBzY2FsZWRfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgc2NhbGVkX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgZGVwb3NpdF9pbmRleD1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBib3Jyb3dfaW5kZXg9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgbGFzdF91cGRhdGVfdGltZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIGxhc3RfcHJpY2U9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICApLAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaGFzX3Bvc2l0aW9uKHNlbGYsIHVzZXJfaWQ6IEFjY291bnQsIG1hcmtldF9pZDogVUludDY0KSAtPiBib29sOgogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgcmV0dXJuIHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSA+IDAKICAgIC8vIAogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAKICAgIC8vICMgUkVNIGNvbnNpZGVyIHJlbW92aW5nIGFuZCBjYWxjdWxhdGluZyBpbiB0aGUgY2xpZW50CiAgICAvLyAjIFJFTSB0cnlpbmcgdG8gY3V0IGJhY2sgb24gZXh0cmEgcGFnZXMKICAgIC8vIAogICAgLy8gIyBAYXJjNC5hYmltZXRob2QKICAgIC8vICMgZGVmIGdldF91c2VyX2RlcG9zaXRfdW5kZXJseWluZ19hbW91bnQoCiAgICAvLyAjICAgICBzZWxmLCB1c2VyX2lkOiBhcmM0LkFkZHJlc3MsIG1hcmtldF9pZDogYXJjNC5VSW50NjQKICAgIC8vICMgKSAtPiBhcmM0LlVJbnQyNTY6CiAgICAvLyAjICAgICByZXR1cm4gYXJjNC5VSW50MjU2KAogICAgLy8gIyAgICAgICAgIHNlbGYuX2dldF91c2VyX2RlcG9zaXRfdW5kZXJseWluZ19hbW91bnQodXNlcl9pZC5uYXRpdmUsIG1hcmtldF9pZC5uYXRpdmUpCiAgICAvLyAjICAgICApCiAgICAvLyAKICAgIC8vICMgQHN1YnJvdXRpbmUKICAgIC8vICMgZGVmIF9nZXRfdXNlcl9kZXBvc2l0X3VuZGVybHlpbmdfYW1vdW50KAogICAgLy8gIyAgICAgc2VsZiwgdXNlcl9pZDogQWNjb3VudCwgbWFya2V0X2lkOiBVSW50NjQKICAgIC8vICMgKSAtPiBCaWdVSW50OgogICAgLy8gIyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICMgICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKSAgIyBBZGQgdGhpcyBsaW5lCiAgICAvLyAjICAgICByZXR1cm4gKHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSAqIG1hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZSkgLy8gU0NBTEUKICAgIC8vIAogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2luY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfZGVwb3NpdHMoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIHVzZXJfaWQ6IEFjY291bnQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlcl9rZXkgPSBzZWxmLl9nZXRfdXNlcl9rZXkodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIuc2NhbGVkX2RlcG9zaXRzID0gYXJjNC5VSW50MjU2KHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSArIGFtb3VudCkKICAgIC8vICAgICB1c2VyLmRlcG9zaXRfaW5kZXggPSBtYXJrZXQuZGVwb3NpdF9pbmRleAogICAgLy8gICAgIHVzZXIubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gICAgIHVzZXIubGFzdF9wcmljZSA9IG1hcmtldC5wcmljZSAgIyBVcGRhdGUgdXNlcidzIGxhc3Qga25vd24gcHJpY2UKICAgIC8vICAgICBzZWxmLnVzZXJzW3VzZXJfa2V5XSA9IHVzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2luY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfYm9ycm93cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgdXNlcl9pZDogQWNjb3VudCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyX2tleSA9IHNlbGYuX2dldF91c2VyX2tleSh1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlci5zY2FsZWRfYm9ycm93cyA9IGFyYzQuVUludDI1Nih1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSArIGFtb3VudCkKICAgIC8vICAgICB1c2VyLmJvcnJvd19pbmRleCA9IG1hcmtldC5ib3Jyb3dfaW5kZXgKICAgIC8vICAgICB1c2VyLmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vICAgICB1c2VyLmxhc3RfcHJpY2UgPSBtYXJrZXQucHJpY2UgICMgVXBkYXRlIHVzZXIncyBsYXN0IGtub3duIHByaWNlCiAgICAvLyAgICAgc2VsZi51c2Vyc1t1c2VyX2tleV0gPSB1c2VyLmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9kZWNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2RlcG9zaXRzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCB1c2VyX2lkOiBBY2NvdW50LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICB1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgPj0gYW1vdW50CiAgICAvLyAgICAgKSwgIkluc3VmZmljaWVudCBiYWxhbmNlIHRvIHdpdGhkcmF3IHRoaXMgYW1vdW50IgogICAgLy8gICAgIHVzZXIuc2NhbGVkX2RlcG9zaXRzID0gYXJjNC5VSW50MjU2KHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSAtIGFtb3VudCkKICAgIC8vICAgICB1c2VyLmRlcG9zaXRfaW5kZXggPSBtYXJrZXQuZGVwb3NpdF9pbmRleAogICAgLy8gICAgIHVzZXIubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gICAgIHVzZXIubGFzdF9wcmljZSA9IG1hcmtldC5wcmljZSAgIyBVcGRhdGUgdXNlcidzIGxhc3Qga25vd24gcHJpY2UKICAgIC8vICAgICBzZWxmLnVzZXJzW3VzZXJfa2V5XSA9IHVzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2RlY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfYm9ycm93cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgdXNlcl9pZDogQWNjb3VudCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyX2tleSA9IHNlbGYuX2dldF91c2VyX2tleSh1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgYXNzZXJ0ICgKICAgIC8vICAgICAgICAgdXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgPj0gYW1vdW50CiAgICAvLyAgICAgKSwgIkluc3VmZmljaWVudCBiYWxhbmNlIHRvIHJlcGF5IHRoaXMgYW1vdW50IgogICAgLy8gICAgIHVzZXIuc2NhbGVkX2JvcnJvd3MgPSBhcmM0LlVJbnQyNTYodXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgLSBhbW91bnQpCiAgICAvLyAgICAgdXNlci5ib3Jyb3dfaW5kZXggPSBtYXJrZXQuYm9ycm93X2luZGV4CiAgICAvLyAgICAgdXNlci5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApCiAgICAvLyAgICAgdXNlci5sYXN0X3ByaWNlID0gbWFya2V0LnByaWNlICAjIFVwZGF0ZSB1c2VyJ3MgbGFzdCBrbm93biBwcmljZQogICAgLy8gICAgIHNlbGYudXNlcnNbdXNlcl9rZXldID0gdXNlci5jb3B5KCkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgY3JlYXRlX21hcmtldCgKICAgIC8vICAgICBzZWxmLAogICAgLy8gICAgIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBjb2xsYXRlcmFsX2ZhY3RvcjogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgbGlxdWlkYXRpb25fdGhyZXNob2xkOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICByZXNlcnZlX2ZhY3RvcjogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgYm9ycm93X3JhdGU6IGFyYzQuVUludDY0LAogICAgLy8gICAgIHNsb3BlOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBtYXhfdG90YWxfZGVwb3NpdHM6IGFyYzQuVUludDI1NiwKICAgIC8vICAgICBtYXhfdG90YWxfYm9ycm93czogYXJjNC5VSW50MjU2LAogICAgLy8gICAgIGxpcXVpZGF0aW9uX2JvbnVzOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBjbG9zZV9mYWN0b3I6IGFyYzQuVUludDY0LAogICAgLy8gKSAtPiBhcmM0LlVJbnQ2NDoKICAgIC8vICAgICBzZWxmLl9vbmx5X293bmVyKCkKICAgIC8vICAgICBhc3NlcnQgbm90IHNlbGYuX2lzX3BhdXNlZCgpLCAiUHJvdG9jb2wgaXMgcGF1c2VkIgogICAgLy8gICAgIHJldHVybiBhcmM0LlVJbnQ2NCgKICAgIC8vICAgICAgICAgc2VsZi5fY3JlYXRlX21hcmtldCgKICAgIC8vICAgICAgICAgICAgIHRva2VuX2lkLm5hdGl2ZSwKICAgIC8vICAgICAgICAgICAgIE1hcmtldERhdGEoCiAgICAvLyAgICAgICAgICAgICAgICAgcGF1c2VkPWFyYzQuQm9vbChUcnVlKSwgICMgU3RhcnQgcGF1c2VkIHVudGlsIHByaWNlIGlzIHNldAogICAgLy8gICAgICAgICAgICAgICAgIG1heF90b3RhbF9kZXBvc2l0cz1tYXhfdG90YWxfZGVwb3NpdHMsCiAgICAvLyAgICAgICAgICAgICAgICAgbWF4X3RvdGFsX2JvcnJvd3M9bWF4X3RvdGFsX2JvcnJvd3MsCiAgICAvLyAgICAgICAgICAgICAgICAgbGlxdWlkYXRpb25fYm9udXM9bGlxdWlkYXRpb25fYm9udXMsCiAgICAvLyAgICAgICAgICAgICAgICAgY29sbGF0ZXJhbF9mYWN0b3I9Y29sbGF0ZXJhbF9mYWN0b3IsCiAgICAvLyAgICAgICAgICAgICAgICAgbGlxdWlkYXRpb25fdGhyZXNob2xkPWxpcXVpZGF0aW9uX3RocmVzaG9sZCwKICAgIC8vICAgICAgICAgICAgICAgICByZXNlcnZlX2ZhY3Rvcj1yZXNlcnZlX2ZhY3RvciwKICAgIC8vICAgICAgICAgICAgICAgICBib3Jyb3dfcmF0ZT1ib3Jyb3dfcmF0ZSwKICAgIC8vICAgICAgICAgICAgICAgICBzbG9wZT1zbG9wZSwKICAgIC8vICAgICAgICAgICAgICAgICB0b3RhbF9zY2FsZWRfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgICAgIHRvdGFsX3NjYWxlZF9ib3Jyb3dzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgICAgICBkZXBvc2l0X2luZGV4PWFyYzQuVUludDI1NihTQ0FMRSksICAjIFN0YXJ0IGF0IFNDQUxFICgxLjApCiAgICAvLyAgICAgICAgICAgICAgICAgYm9ycm93X2luZGV4PWFyYzQuVUludDI1NihTQ0FMRSksICAjIFN0YXJ0IGF0IFNDQUxFICgxLjApCiAgICAvLyAgICAgICAgICAgICAgICAgbGFzdF91cGRhdGVfdGltZT1hcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCksCiAgICAvLyAgICAgICAgICAgICAgICAgcmVzZXJ2ZXM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgICAgIHByaWNlPWFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgICAgICAgICAgICAgMAogICAgLy8gICAgICAgICAgICAgICAgICksICAjIFByaWNlIG11c3QgYmUgc2V0IGJlZm9yZSBtYXJrZXQgY2FuIGJlIHVzZWQKICAgIC8vICAgICAgICAgICAgICAgICBudG9rZW5faWQ9YXJjNC5VSW50NjQoMCksICAjIFdpbGwgYmUgc2V0IGR1cmluZyB0b2tlbiBpbml0aWFsaXphdGlvbgogICAgLy8gICAgICAgICAgICAgICAgIGNsb3NlX2ZhY3Rvcj1jbG9zZV9mYWN0b3IsCiAgICAvLyAgICAgICAgICAgICApLAogICAgLy8gICAgICAgICApCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9jcmVhdGVfbWFya2V0KHNlbGYsIHRva2VuX2lkOiBVSW50NjQsIG1hcmtldF9kYXRhOiBNYXJrZXREYXRhKSAtPiBVSW50NjQ6CiAgICAvLyAgICAgYXNzZXJ0IG5vdCB0b2tlbl9pZCBpbiBzZWxmLm1hcmtldHMsICJNYXJrZXQgYWxyZWFkeSBleGlzdHMiCiAgICAvLyAgICAgcGF5bWVudCA9IHJlcXVpcmVfcGF5bWVudChUeG4uc2VuZGVyKQogICAgLy8gICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgIHBheW1lbnQgPj0gc2VsZi5fY3JlYXRlX21hcmtldF9jb3N0KCkKICAgIC8vICAgICApLCAiaW5zdWZmaWNpZW50IHBheW1lbnQgZm9yIGNyZWF0ZSBtYXJrZXQiCiAgICAvLyAgICAgY29tcGlsZWQgPSBjb21waWxlX2NvbnRyYWN0KE5Ub2tlbiwgZXh0cmFfcHJvZ3JhbV9wYWdlcz0wKSAgIyBubyBleHRyYSBwYWdlcwogICAgLy8gICAgIGJhc2VfYXBwID0gYXJjNC5hcmM0X2NyZWF0ZShOVG9rZW4sIGNvbXBpbGVkPWNvbXBpbGVkKS5jcmVhdGVkX2FwcAogICAgLy8gICAgIGJvb3RzdHJhcDY0X2Nvc3QsIHR4bjEgPSBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgICAgICBOVG9rZW4uYm9vdHN0cmFwNjRfY29zdCwKICAgIC8vICAgICAgICAgYXBwX2lkPWJhc2VfYXBwLAogICAgLy8gICAgICkKICAgIC8vICAgICBpdHhuLlBheW1lbnQoCiAgICAvLyAgICAgICAgIHJlY2VpdmVyPWJhc2VfYXBwLmFkZHJlc3MsIGFtb3VudD1ib290c3RyYXA2NF9jb3N0Lm5hdGl2ZSwgZmVlPTAKICAgIC8vICAgICApLnN1Ym1pdCgpCiAgICAvLyAgICAgYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICAgICAgTlRva2VuLmJvb3RzdHJhcDY0LAogICAgLy8gICAgICAgICBhcmM0LlVJbnQ2NCh0b2tlbl9pZCksCiAgICAvLyAgICAgICAgIGFwcF9pZD1iYXNlX2FwcCwKICAgIC8vICAgICApCiAgICAvLyAgICAgbWFya2V0X2RhdGEubnRva2VuX2lkID0gYXJjNC5VSW50NjQoYmFzZV9hcHAuaWQpCiAgICAvLyAgICAgc2VsZi5tYXJrZXRzW3Rva2VuX2lkXSA9IG1hcmtldF9kYXRhLmNvcHkoKQogICAgLy8gICAgIGFyYzQuZW1pdCgKICAgIC8vICAgICAgICAgTWFya2V0Q3JlYXRlZChhcmM0LlVJbnQ2NCh0b2tlbl9pZCksIGFyYzQuVUludDY0KGJhc2VfYXBwLmlkKSwgbWFya2V0X2RhdGEpCiAgICAvLyAgICAgKQogICAgLy8gICAgIHJldHVybiBiYXNlX2FwcC5pZAogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QocmVhZG9ubHk9VHJ1ZSkKICAgIC8vIGRlZiBjcmVhdGVfbWFya2V0X2Nvc3Qoc2VsZikgLT4gYXJjNC5VSW50NjQ6CiAgICAvLyAgICAgcmV0dXJuIGFyYzQuVUludDY0KHNlbGYuX2NyZWF0ZV9tYXJrZXRfY29zdCgpKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9jcmVhdGVfbWFya2V0X2Nvc3Qoc2VsZikgLT4gVUludDY0OgogICAgLy8gICAgIHJldHVybiBVSW50NjQoMV8wMDBfMDAwKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QocmVhZG9ubHk9VHJ1ZSkKICAgIC8vIGRlZiBnZXRfbWFya2V0KHNlbGYsIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCkgLT4gTWFya2V0RGF0YToKICAgIC8vICAgICByZXR1cm4gc2VsZi5fZ2V0X21hcmtldCh0b2tlbl9pZC5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2dldF9tYXJrZXQoc2VsZiwgdG9rZW5faWQ6IFVJbnQ2NCkgLT4gTWFya2V0RGF0YToKICAgIC8vICAgICByZXR1cm4gc2VsZi5tYXJrZXRzLmdldCgKICAgIC8vICAgICAgICAgdG9rZW5faWQsCiAgICAvLyAgICAgICAgIGRlZmF1bHQ9TWFya2V0RGF0YSgKICAgIC8vICAgICAgICAgICAgIHBhdXNlZD1hcmM0LkJvb2woVHJ1ZSksCiAgICAvLyAgICAgICAgICAgICBtYXhfdG90YWxfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgbWF4X3RvdGFsX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgbGlxdWlkYXRpb25fYm9udXM9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICBjb2xsYXRlcmFsX2ZhY3Rvcj1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIGxpcXVpZGF0aW9uX3RocmVzaG9sZD1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIHJlc2VydmVfZmFjdG9yPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgYm9ycm93X3JhdGU9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICBzbG9wZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIHRvdGFsX3NjYWxlZF9kZXBvc2l0cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICB0b3RhbF9zY2FsZWRfYm9ycm93cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBkZXBvc2l0X2luZGV4PWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGJvcnJvd19pbmRleD1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBsYXN0X3VwZGF0ZV90aW1lPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgcmVzZXJ2ZXM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgcHJpY2U9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgbnRva2VuX2lkPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgY2xvc2VfZmFjdG9yPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICApLAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgZ2V0X21hcmtldF9wcmljZShzZWxmLCB0b2tlbl9pZDogYXJjNC5VSW50NjQpIC0+IGFyYzQuVUludDI1NjoKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KHRva2VuX2lkLm5hdGl2ZSkKICAgIC8vICAgICByZXR1cm4gbWFya2V0LnByaWNlCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF9tYXJrZXRfbnRva2VuX2lkKHNlbGYsIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCkgLT4gYXJjNC5VSW50NjQ6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldCh0b2tlbl9pZC5uYXRpdmUpCiAgICAvLyAgICAgcmV0dXJuIG1hcmtldC5udG9rZW5faWQKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgc2V0X21hcmtldF9wcmljZShzZWxmLCB0b2tlbl9pZDogYXJjNC5VSW50NjQsIHByaWNlOiBhcmM0LlVJbnQyNTYpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgYXNzZXJ0IG5vdCBzZWxmLl9pc19wYXVzZWQoKSwgIlByb3RvY29sIGlzIHBhdXNlZCIKICAgIC8vICAgICBzZWxmLl9zZXRfbWFya2V0X3ByaWNlKHRva2VuX2lkLm5hdGl2ZSwgcHJpY2UubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9zZXRfbWFya2V0X3ByaWNlKHNlbGYsIHRva2VuX2lkOiBVSW50NjQsIHByaWNlOiBCaWdVSW50KSAtPiBOb25lOgogICAgLy8gICAgIGFzc2VydCB0b2tlbl9pZCBpbiBzZWxmLm1hcmtldHMsICJNYXJrZXQgZG9lcyBub3QgZXhpc3QiCiAgICAvLyAgICAgYXNzZXJ0IHByaWNlID4gMCwgIlByaWNlIG11c3QgYmUgcG9zaXRpdmUiCiAgICAvLyAKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLm1hcmtldHNbdG9rZW5faWRdLmNvcHkoKQogICAgLy8gCiAgICAvLyAgICAgIyBVbnBhdXNlIHRoZSBtYXJrZXQgb24gZmlyc3QgcHJpY2Ugc2V0CiAgICAvLyAgICAgaWYgbWFya2V0LnBhdXNlZCBhbmQgbWFya2V0LnByaWNlID09IDA6CiAgICAvLyAgICAgICAgIG1hcmtldC5wYXVzZWQgPSBhcmM0LkJvb2woRmFsc2UpCiAgICAvLyAKICAgIC8vICAgICAjIFNjYWxlIHRoZSBwcmljZSBieSBTQ0FMRSBpbnRlcm5hbGx5IGZvciBzdG9yYWdlCiAgICAvLyAgICAgbWFya2V0LnByaWNlID0gYXJjNC5VSW50MjU2KHByaWNlICogU0NBTEUpCiAgICAvLyAKICAgIC8vICAgICBzZWxmLm1hcmtldHNbdG9rZW5faWRdID0gbWFya2V0LmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9pbmNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9kZXBvc2l0cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cyA9IGFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKyBhbW91bnQKICAgIC8vICAgICApCiAgICAvLyAgICAgbWFya2V0Lmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vICAgICBzZWxmLm1hcmtldHNbbWFya2V0X2lkXSA9IG1hcmtldC5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZGVjcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfZGVwb3NpdHMoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlID49IGFtb3VudAogICAgLy8gICAgICksICJJbnN1ZmZpY2llbnQgYmFsYW5jZSB0byB3aXRoZHJhdyB0aGlzIGFtb3VudCIKICAgIC8vICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSAtIGFtb3VudAogICAgLy8gICAgICkKICAgIC8vICAgICBzZWxmLm1hcmtldHNbbWFya2V0X2lkXSA9IG1hcmtldC5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaW5jcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfYm9ycm93cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlICsgYW1vdW50CiAgICAvLyAgICAgKQogICAgLy8gICAgIG1hcmtldC5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApCiAgICAvLyAgICAgc2VsZi5tYXJrZXRzW21hcmtldF9pZF0gPSBtYXJrZXQuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2RlY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2JvcnJvd3MoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUgPj0gYW1vdW50CiAgICAvLyAgICAgKSwgIkluc3VmZmljaWVudCBiYWxhbmNlIHRvIHdpdGhkcmF3IHRoaXMgYW1vdW50IgogICAgLy8gICAgIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cyA9IGFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAtIGFtb3VudAogICAgLy8gICAgICkKICAgIC8vICAgICBzZWxmLm1hcmtldHNbbWFya2V0X2lkXSA9IG1hcmtldC5jb3B5KCkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgcGF1c2VfbWFya2V0KHNlbGYsIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCwgcGF1c2U6IGFyYzQuVUludDY0KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX29ubHlfb3duZXIoKQogICAgLy8gICAgIHNlbGYuX3BhdXNlX21hcmtldCh0b2tlbl9pZC5uYXRpdmUsIHBhdXNlLm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfcGF1c2VfbWFya2V0KHNlbGYsIHRva2VuX2lkOiBVSW50NjQsIHBhdXNlOiBVSW50NjQpIC0+IE5vbmU6CiAgICAvLyAgICAgYXNzZXJ0IHRva2VuX2lkIGluIHNlbGYubWFya2V0cywgIk1hcmtldCBkb2VzIG5vdCBleGlzdCIKICAgIHN3YXAKICAgIGNvbmNhdAogICAgZHVwCiAgICBib3hfbGVuCiAgICBidXJ5IDEKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODgzCiAgICAvLyBhc3NlcnQgdG9rZW5faWQgaW4gc2VsZi5tYXJrZXRzLCAiTWFya2V0IGRvZXMgbm90IGV4aXN0IgogICAgYXNzZXJ0IC8vIE1hcmtldCBkb2VzIG5vdCBleGlzdAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo4ODQKICAgIC8vIHNlbGYubWFya2V0c1t0b2tlbl9pZF0ucGF1c2VkID0gYXJjNC5Cb29sKHBhdXNlID09IFVJbnQ2NCgxKSkKICAgIGZyYW1lX2RpZyAtMQogICAgaW50IDEKICAgID09CiAgICBieXRlIDB4MDAKICAgIGludCAwCiAgICB1bmNvdmVyIDIKICAgIHNldGJpdAogICAgZGlnIDEKICAgIGJveF9nZXQKICAgIHN3YXAKICAgIGNvdmVyIDIKICAgIGFzc2VydCAvLyBjaGVjayBzZWxmLm1hcmtldHMgZW50cnkgZXhpc3RzCiAgICBpbnQgMAogICAgZ2V0Yml0CiAgICBpbnQgMAogICAgc3dhcAogICAgc2V0Yml0CiAgICBib3hfcHV0CiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5kZXBvc2l0KG1hcmtldF9pZDogYnl0ZXMsIGFtb3VudDogYnl0ZXMpIC0+IHZvaWQ6CmRlcG9zaXQ6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojk2NC05NjUKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGRlcG9zaXQoc2VsZiwgbWFya2V0X2lkOiBhcmM0LlVJbnQ2NCwgYW1vdW50OiBhcmM0LlVJbnQyNTYpIC0+IE5vbmU6CiAgICBwcm90byAyIDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6OTY2CiAgICAvLyBzZWxmLl9kZXBvc2l0KG1hcmtldF9pZC5uYXRpdmUsIGFtb3VudC5uYXRpdmUpCiAgICBmcmFtZV9kaWcgLTIKICAgIGJ0b2kKICAgIGZyYW1lX2RpZyAtMQogICAgY2FsbHN1YiBfZGVwb3NpdAogICAgcmV0c3ViCgoKLy8gY29udHJhY3QuTGVuZGluZ1Bvb2wuX2RlcG9zaXQobWFya2V0X2lkOiB1aW50NjQsIGFtb3VudDogYnl0ZXMpIC0+IHZvaWQ6Cl9kZXBvc2l0OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5NjgtOTY5CiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9kZXBvc2l0KHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQpIC0+IE5vbmU6CiAgICBwcm90byAyIDAKICAgIGludCAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojk3MAogICAgLy8gc2VsZi5fdmFsaWRhdGVfbWFya2V0X29wZXJhdGlvbihtYXJrZXRfaWQsIGFtb3VudCwgVHJ1ZSkKICAgIGZyYW1lX2RpZyAtMgogICAgZnJhbWVfZGlnIC0xCiAgICBpbnQgMQogICAgY2FsbHN1YiBfdmFsaWRhdGVfbWFya2V0X29wZXJhdGlvbgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5NzIKICAgIC8vIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgZnJhbWVfZGlnIC0yCiAgICBjYWxsc3ViIF9nZXRfbWFya2V0CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojk3MwogICAgLy8gc2NhbGVkX2Ftb3VudCA9IChhbW91bnQgKiBTQ0FMRSkgLy8gbWFya2V0LmRlcG9zaXRfaW5kZXgubmF0aXZlCiAgICBmcmFtZV9kaWcgLTEKICAgIGJ5dGUgMHgwZGUwYjZiM2E3NjQwMDAwCiAgICBiKgogICAgZGlnIDEKICAgIGV4dHJhY3QgMTc3IDMyIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgZGlnIDEKICAgIHN3YXAKICAgIGIvCiAgICBzd2FwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojk3NQogICAgLy8gbWFya2V0Lm1heF90b3RhbF9kZXBvc2l0cy5uYXRpdmUKICAgIGRpZyAyCiAgICBleHRyYWN0IDEgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBjb3ZlciAyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojk3NgogICAgLy8gPj0gbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKyBzY2FsZWRfYW1vdW50CiAgICBkaWcgMwogICAgZXh0cmFjdCAxMTMgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICB1bmNvdmVyIDIKICAgIGIrCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojk3NS05NzYKICAgIC8vIG1hcmtldC5tYXhfdG90YWxfZGVwb3NpdHMubmF0aXZlCiAgICAvLyA+PSBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSArIHNjYWxlZF9hbW91bnQKICAgIHVuY292ZXIgMgogICAgYjw9CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojk3NC05NzcKICAgIC8vIGFzc2VydCAoCiAgICAvLyAgICAgbWFya2V0Lm1heF90b3RhbF9kZXBvc2l0cy5uYXRpdmUKICAgIC8vICAgICA+PSBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSArIHNjYWxlZF9hbW91bnQKICAgIC8vICksICJEZXBvc2l0IGNhcCBleGNlZWRlZCIKICAgIGFzc2VydCAvLyBEZXBvc2l0IGNhcCBleGNlZWRlZAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5NzktOTg1CiAgICAvLyBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgIEFSQzIwMFRva2VuSW50ZXJmYWNlLmFyYzIwMF90cmFuc2ZlckZyb20sCiAgICAvLyAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgIGFyYzQuQWRkcmVzcyhHbG9iYWwuY3VycmVudF9hcHBsaWNhdGlvbl9hZGRyZXNzKSwKICAgIC8vICAgICBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIC8vICAgICBhcHBfaWQ9QXBwbGljYXRpb24obWFya2V0X2lkKSwKICAgIC8vICkKICAgIGl0eG5fYmVnaW4KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6OTgyCiAgICAvLyBhcmM0LkFkZHJlc3MoR2xvYmFsLmN1cnJlbnRfYXBwbGljYXRpb25fYWRkcmVzcyksCiAgICBnbG9iYWwgQ3VycmVudEFwcGxpY2F0aW9uQWRkcmVzcwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5ODEKICAgIC8vIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIHR4biBTZW5kZXIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6OTgzCiAgICAvLyBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIGZyYW1lX2RpZyAtMQogICAgbGVuCiAgICBpbnQgMzIKICAgIDw9CiAgICBhc3NlcnQgLy8gb3ZlcmZsb3cKICAgIGludCAzMgogICAgYnplcm8KICAgIGZyYW1lX2RpZyAtMQogICAgYnwKICAgIGZyYW1lX2RpZyAtMgogICAgaXR4bl9maWVsZCBBcHBsaWNhdGlvbklECiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojk3OS05ODUKICAgIC8vIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgQVJDMjAwVG9rZW5JbnRlcmZhY2UuYXJjMjAwX3RyYW5zZmVyRnJvbSwKICAgIC8vICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgYXJjNC5BZGRyZXNzKEdsb2JhbC5jdXJyZW50X2FwcGxpY2F0aW9uX2FkZHJlc3MpLAogICAgLy8gICAgIGFyYzQuVUludDI1NihhbW91bnQpLAogICAgLy8gICAgIGFwcF9pZD1BcHBsaWNhdGlvbihtYXJrZXRfaWQpLAogICAgLy8gKQogICAgbWV0aG9kICJhcmMyMDBfdHJhbnNmZXJGcm9tKGFkZHJlc3MsYWRkcmVzcyx1aW50MjU2KWJvb2wiCiAgICBpdHhuX2ZpZWxkIEFwcGxpY2F0aW9uQXJncwogICAgc3dhcAogICAgaXR4bl9maWVsZCBBcHBsaWNhdGlvbkFyZ3MKICAgIHN3YXAKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICBkdXAKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICBpbnQgYXBwbAogICAgaXR4bl9maWVsZCBUeXBlRW51bQogICAgaW50IDAKICAgIGl0eG5fZmllbGQgRmVlCiAgICBpdHhuX3N1Ym1pdAogICAgaXR4biBMYXN0TG9nCiAgICBleHRyYWN0IDAgNAogICAgYnl0ZSAweDE1MWY3Yzc1CiAgICA9PQogICAgYXNzZXJ0IC8vIEFSQzQgcHJlZml4IGlzIHZhbGlkCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojk4NwogICAgLy8gdXNlciA9IHNlbGYuX2dldF91c2VyKFR4bi5zZW5kZXIsIG1hcmtldF9pZCkKICAgIHR4biBTZW5kZXIKICAgIGZyYW1lX2RpZyAtMgogICAgY2FsbHN1YiBfZ2V0X3VzZXIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6OTg4LTk5MAogICAgLy8gbmV3X21hcmtldCA9IHNlbGYuX2FjY3J1ZV9pbnRlcmVzdCgKICAgIC8vICAgICBtYXJrZXRfaWQKICAgIC8vICkgICMgR2V0IHVwZGF0ZWQgbWFya2V0IHdpdGggYWNjcnVlZCBpbnRlcmVzdAogICAgZnJhbWVfZGlnIC0yCiAgICBjYWxsc3ViIF9hY2NydWVfaW50ZXJlc3QKICAgIGR1cAogICAgY292ZXIgNQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5OTMKICAgIC8vICkgLy8gbmV3X21hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZSAgIyBDYWxjdWxhdGUgd2l0aCBuZXcgaW5kZXgKICAgIGR1cAogICAgZXh0cmFjdCAxNzcgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojk5MS05OTMKICAgIC8vIHNjYWxlZF9hbW91bnQgPSAoCiAgICAvLyAgICAgYW1vdW50ICogU0NBTEUKICAgIC8vICkgLy8gbmV3X21hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZSAgIyBDYWxjdWxhdGUgd2l0aCBuZXcgaW5kZXgKICAgIHVuY292ZXIgNAogICAgZGlnIDEKICAgIGIvCiAgICBzd2FwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojk5NgogICAgLy8gbmV3X21hcmtldC5tYXhfdG90YWxfZGVwb3NpdHMubmF0aXZlCiAgICBkaWcgMgogICAgZXh0cmFjdCAxIDMyIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgY292ZXIgMgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5OTcKICAgIC8vID49IG5ld19tYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSArIHNjYWxlZF9hbW91bnQKICAgIHVuY292ZXIgMwogICAgZXh0cmFjdCAxMTMgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBkaWcgMgogICAgYisKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6OTk2LTk5NwogICAgLy8gbmV3X21hcmtldC5tYXhfdG90YWxfZGVwb3NpdHMubmF0aXZlCiAgICAvLyA+PSBuZXdfbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKyBzY2FsZWRfYW1vdW50CiAgICB1bmNvdmVyIDMKICAgIGI8PQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5OTUtOTk4CiAgICAvLyBhc3NlcnQgKAogICAgLy8gICAgIG5ld19tYXJrZXQubWF4X3RvdGFsX2RlcG9zaXRzLm5hdGl2ZQogICAgLy8gICAgID49IG5ld19tYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSArIHNjYWxlZF9hbW91bnQKICAgIC8vICksICJEZXBvc2l0IGNhcCBleGNlZWRlZCIKICAgIGFzc2VydCAvLyBEZXBvc2l0IGNhcCBleGNlZWRlZAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDAwLTEwMDIKICAgIC8vIHNlbGYuX2luY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfZGVwb3NpdHMoCiAgICAvLyAgICAgbWFya2V0X2lkLCBUeG4uc2VuZGVyLCBzY2FsZWRfYW1vdW50CiAgICAvLyApCiAgICBmcmFtZV9kaWcgLTIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTAwMQogICAgLy8gbWFya2V0X2lkLCBUeG4uc2VuZGVyLCBzY2FsZWRfYW1vdW50CiAgICB0eG4gU2VuZGVyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwMDAtMTAwMgogICAgLy8gc2VsZi5faW5jcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9kZXBvc2l0cygKICAgIC8vICAgICBtYXJrZXRfaWQsIFR4bi5zZW5kZXIsIHNjYWxlZF9hbW91bnQKICAgIC8vICkKICAgIGRpZyAzCiAgICBjYWxsc3ViIF9pbmNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2RlcG9zaXRzCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwMDQKICAgIC8vIHNlbGYuX2luY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2RlcG9zaXRzKG1hcmtldF9pZCwgc2NhbGVkX2Ftb3VudCkKICAgIGZyYW1lX2RpZyAtMgogICAgdW5jb3ZlciAyCiAgICBjYWxsc3ViIF9pbmNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9kZXBvc2l0cwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDA2LTEwMTEKICAgIC8vIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgTlRva2VuLm1pbnQsCiAgICAvLyAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgIGFyYzQuVUludDI1NihhbW91bnQpLAogICAgLy8gICAgIGFwcF9pZD1BcHBsaWNhdGlvbihtYXJrZXQubnRva2VuX2lkLm5hdGl2ZSksCiAgICAvLyApCiAgICBpdHhuX2JlZ2luCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwMDgKICAgIC8vIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIHR4biBTZW5kZXIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTAxMAogICAgLy8gYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldC5udG9rZW5faWQubmF0aXZlKSwKICAgIHVuY292ZXIgNAogICAgaW50IDMxMwogICAgaW50IDgKICAgIGV4dHJhY3QzIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgYnRvaQogICAgaXR4bl9maWVsZCBBcHBsaWNhdGlvbklECiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwMDYtMTAxMQogICAgLy8gYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICBOVG9rZW4ubWludCwKICAgIC8vICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldC5udG9rZW5faWQubmF0aXZlKSwKICAgIC8vICkKICAgIG1ldGhvZCAibWludChhZGRyZXNzLHVpbnQyNTYpdm9pZCIKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICBpdHhuX2ZpZWxkIEFwcGxpY2F0aW9uQXJncwogICAgdW5jb3ZlciAyCiAgICBpdHhuX2ZpZWxkIEFwcGxpY2F0aW9uQXJncwogICAgaW50IGFwcGwKICAgIGl0eG5fZmllbGQgVHlwZUVudW0KICAgIGludCAwCiAgICBpdHhuX2ZpZWxkIEZlZQogICAgaXR4bl9zdWJtaXQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTAxNAogICAgLy8gdXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlICogbmV3X21hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZQogICAgZGlnIDEKICAgIGV4dHJhY3QgMCAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIGIqCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwMTUKICAgIC8vICkgLy8gU0NBTEUKICAgIGJ5dGUgMHgwZGUwYjZiM2E3NjQwMDAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwMTMtMTAxNQogICAgLy8gb2xkX2RlcG9zaXRfYW1vdW50ID0gKAogICAgLy8gICAgIHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSAqIG5ld19tYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUKICAgIC8vICkgLy8gU0NBTEUKICAgIGIvCiAgICBkdXAKICAgIGNvdmVyIDIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTAxNgogICAgLy8gbmV3X2RlcG9zaXRfYW1vdW50ID0gb2xkX2RlcG9zaXRfYW1vdW50ICsgYW1vdW50CiAgICBmcmFtZV9kaWcgLTEKICAgIGIrCiAgICBjb3ZlciAyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwMTgKICAgIC8vIGlmIHVzZXIubGFzdF9wcmljZS5uYXRpdmUgPT0gMDoKICAgIGV4dHJhY3QgMTM2IDMyIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgZHVwCiAgICBjb3ZlciAyCiAgICBieXRlIDB4CiAgICBiPT0KICAgIGJ6IF9kZXBvc2l0X2Vsc2VfYm9keUA0CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwMTkKICAgIC8vIG9sZF92YWx1ZSA9IChvbGRfZGVwb3NpdF9hbW91bnQgKiBuZXdfbWFya2V0LnByaWNlLm5hdGl2ZSkgLy8gU0NBTEUKICAgIGZyYW1lX2RpZyAxCiAgICBpbnQgMjgxCiAgICBpbnQgMzIKICAgIGV4dHJhY3QzIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgc3dhcAogICAgZGlnIDEKICAgIGIqCiAgICBieXRlIDB4MGRlMGI2YjNhNzY0MDAwMAogICAgYi8KICAgIHN3YXAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTAyMAogICAgLy8gbmV3X3ZhbHVlID0gKG5ld19kZXBvc2l0X2Ftb3VudCAqIG5ld19tYXJrZXQucHJpY2UubmF0aXZlKSAvLyBTQ0FMRQogICAgZnJhbWVfZGlnIDIKICAgIGIqCiAgICBieXRlIDB4MGRlMGI2YjNhNzY0MDAwMAogICAgYi8KICAgIGZyYW1lX2J1cnkgMAogICAgYiBfZGVwb3NpdF9hZnRlcl9pZl9lbHNlQDUKCl9kZXBvc2l0X2Vsc2VfYm9keUA0OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDIyCiAgICAvLyBvbGRfdmFsdWUgPSAob2xkX2RlcG9zaXRfYW1vdW50ICogdXNlci5sYXN0X3ByaWNlLm5hdGl2ZSkgLy8gU0NBTEUKICAgIGZyYW1lX2RpZyAzCiAgICBiKgogICAgYnl0ZSAweDBkZTBiNmIzYTc2NDAwMDAKICAgIGIvCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwMjMKICAgIC8vIG5ld192YWx1ZSA9IChuZXdfZGVwb3NpdF9hbW91bnQgKiBuZXdfbWFya2V0LnByaWNlLm5hdGl2ZSkgLy8gU0NBTEUKICAgIGZyYW1lX2RpZyAxCiAgICBpbnQgMjgxCiAgICBpbnQgMzIKICAgIGV4dHJhY3QzIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgZnJhbWVfZGlnIDIKICAgIGIqCiAgICBieXRlIDB4MGRlMGI2YjNhNzY0MDAwMAogICAgYi8KICAgIGZyYW1lX2J1cnkgMAoKX2RlcG9zaXRfYWZ0ZXJfaWZfZWxzZUA1OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDI1CiAgICAvLyBzZWxmLl91cGRhdGVfZ2xvYmFsX2NvbGxhdGVyYWwoVHhuLnNlbmRlciwgbWFya2V0X2lkLCBvbGRfdmFsdWUsIG5ld192YWx1ZSkKICAgIHR4biBTZW5kZXIKICAgIGZyYW1lX2RpZyAtMgogICAgdW5jb3ZlciAyCiAgICBmcmFtZV9kaWcgMAogICAgY2FsbHN1YiBfdXBkYXRlX2dsb2JhbF9jb2xsYXRlcmFsCiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5fdmFsaWRhdGVfbWFya2V0X29wZXJhdGlvbihtYXJrZXRfaWQ6IHVpbnQ2NCwgYW1vdW50OiBieXRlcywgZ3VhcmRfc3Rva2VuOiB1aW50NjQpIC0+IHZvaWQ6Cl92YWxpZGF0ZV9tYXJrZXRfb3BlcmF0aW9uOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5NTAtOTUzCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF92YWxpZGF0ZV9tYXJrZXRfb3BlcmF0aW9uKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQsIGd1YXJkX3N0b2tlbjogYm9vbAogICAgLy8gKSAtPiBOb25lOgogICAgcHJvdG8gMyAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojk1NAogICAgLy8gYXNzZXJ0IG5vdCBzZWxmLl9pc19wYXVzZWQoKSwgIlByb3RvY29sIGlzIHBhdXNlZCIKICAgIGNhbGxzdWIgX2lzX3BhdXNlZAogICAgIQogICAgYXNzZXJ0IC8vIFByb3RvY29sIGlzIHBhdXNlZAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1MTAtOTU1CiAgICAvLyAgICAgc2VsZi5tYXJrZXRzID0gQm94TWFwKFVJbnQ2NCwgTWFya2V0RGF0YSkgICMgTWFya2V0IHN0YXRlCiAgICAvLyAgICAgc2VsZi51c2VycyA9IEJveE1hcChCeXRlczQwLCBVc2VyRGF0YSkgICMgUGVyLW1hcmtldCB1c2VyIHN0YXRlCiAgICAvLyAgICAgc2VsZi5nbG9iYWxfdXNlcnMgPSBCb3hNYXAoQWNjb3VudCwgR2xvYmFsVXNlckRhdGEpICAjIEdsb2JhbCB1c2VyIHN0YXRlCiAgICAvLyAKICAgIC8vICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gIyBPd25hYmxlCiAgICAvLyAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfb25seV9vd25lcihzZWxmKSAtPiBOb25lOgogICAgLy8gICAgIGFzc2VydCBUeG4uc2VuZGVyID09IHNlbGYub3duZXIsICJvbmx5IHRoZSBvd25lciBjYW4gY2FsbCB0aGlzIGZ1bmN0aW9uIgogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QocmVhZG9ubHk9VHJ1ZSkKICAgIC8vIGRlZiBnZXRfb3duZXIoc2VsZikgLT4gYXJjNC5BZGRyZXNzOgogICAgLy8gICAgIHJldHVybiBhcmM0LkFkZHJlc3Moc2VsZi5vd25lcikKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgdHJhbnNmZXJfb3duZXJzaGlwKHNlbGYsIG5ld19vd25lcjogYXJjNC5BZGRyZXNzKSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX29ubHlfb3duZXIoKQogICAgLy8gICAgIHNlbGYuX3RyYW5zZmVyX293bmVyc2hpcChuZXdfb3duZXIubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF90cmFuc2Zlcl9vd25lcnNoaXAoc2VsZiwgbmV3X293bmVyOiBBY2NvdW50KSAtPiBOb25lOgogICAgLy8gICAgIHByZXZpb3VzX293bmVyID0gc2VsZi5vd25lcgogICAgLy8gICAgIHNlbGYub3duZXIgPSBuZXdfb3duZXIKICAgIC8vICAgICBhcmM0LmVtaXQoCiAgICAvLyAgICAgICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKGFyYzQuQWRkcmVzcyhwcmV2aW91c19vd25lciksIGFyYzQuQWRkcmVzcyhuZXdfb3duZXIpKQogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAKICAgIC8vICMgUkVNIGhhdmluZyBpc3N1ZXMgd2l0aCB0aGUgaW5oZXJpdGFuY2UgaGVyZQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBpc19wYXVzZWQoc2VsZikgLT4gYXJjNC5Cb29sOgogICAgLy8gICAgIHJldHVybiBhcmM0LkJvb2woc2VsZi5faXNfcGF1c2VkKCkpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2lzX3BhdXNlZChzZWxmKSAtPiBib29sOgogICAgLy8gICAgIHJldHVybiBzZWxmLnBhdXNlZCA9PSBVSW50NjQoMSkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgcGF1c2Uoc2VsZiwgcGF1c2U6IGFyYzQuVUludDY0KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX29ubHlfb3duZXIoKQogICAgLy8gICAgIHNlbGYuX3BhdXNlKHBhdXNlLm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfcGF1c2Uoc2VsZiwgcGF1c2U6IFVJbnQ2NCkgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLnBhdXNlZCA9IHBhdXNlCiAgICAvLyAKICAgIC8vICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBnZXRfc3Rva2VuX2FwcF9pZChzZWxmKSAtPiBhcmM0LlVJbnQ2NDoKICAgIC8vICAgICByZXR1cm4gYXJjNC5VSW50NjQoc2VsZi5fZ2V0X3N0b2tlbl9hcHBfaWQoKSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X3N0b2tlbl9hcHBfaWQoc2VsZikgLT4gVUludDY0OgogICAgLy8gICAgIHJldHVybiBzZWxmLnN0b2tlbl9hcHBfaWQKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgc2V0X3N0b2tlbl9hcHBfaWQoc2VsZiwgc3Rva2VuX2FwcF9pZDogYXJjNC5VSW50NjQpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgc2VsZi5zdG9rZW5fYXBwX2lkID0gc3Rva2VuX2FwcF9pZC5uYXRpdmUKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X3VzZXJfa2V5KHNlbGYsIHVzZXJfaWQ6IEFjY291bnQsIG1hcmtldF9pZDogVUludDY0KSAtPiBCeXRlczQwOgogICAgLy8gICAgIHJldHVybiBCeXRlczQwLmZyb21fYnl0ZXMoCiAgICAvLyAgICAgICAgIGFyYzQuQWRkcmVzcyh1c2VyX2lkKS5ieXRlcyArIGFyYzQuVUludDY0KG1hcmtldF9pZCkuYnl0ZXMKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF91c2VyKHNlbGYsIHVzZXJfaWQ6IGFyYzQuQWRkcmVzcywgbWFya2V0X2lkOiBhcmM0LlVJbnQ2NCkgLT4gVXNlckRhdGE6CiAgICAvLyAgICAgcmV0dXJuIHNlbGYuX2dldF91c2VyKHVzZXJfaWQubmF0aXZlLCBtYXJrZXRfaWQubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9nZXRfdXNlcihzZWxmLCB1c2VyX2lkOiBBY2NvdW50LCBtYXJrZXRfaWQ6IFVJbnQ2NCkgLT4gVXNlckRhdGE6CiAgICAvLyAgICAgdXNlcl9rZXkgPSBzZWxmLl9nZXRfdXNlcl9rZXkodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHJldHVybiBzZWxmLnVzZXJzLmdldCgKICAgIC8vICAgICAgICAgdXNlcl9rZXksCiAgICAvLyAgICAgICAgIGRlZmF1bHQ9VXNlckRhdGEoCiAgICAvLyAgICAgICAgICAgICBzY2FsZWRfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgc2NhbGVkX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgZGVwb3NpdF9pbmRleD1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBib3Jyb3dfaW5kZXg9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgbGFzdF91cGRhdGVfdGltZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIGxhc3RfcHJpY2U9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICApLAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaGFzX3Bvc2l0aW9uKHNlbGYsIHVzZXJfaWQ6IEFjY291bnQsIG1hcmtldF9pZDogVUludDY0KSAtPiBib29sOgogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgcmV0dXJuIHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSA+IDAKICAgIC8vIAogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAKICAgIC8vICMgUkVNIGNvbnNpZGVyIHJlbW92aW5nIGFuZCBjYWxjdWxhdGluZyBpbiB0aGUgY2xpZW50CiAgICAvLyAjIFJFTSB0cnlpbmcgdG8gY3V0IGJhY2sgb24gZXh0cmEgcGFnZXMKICAgIC8vIAogICAgLy8gIyBAYXJjNC5hYmltZXRob2QKICAgIC8vICMgZGVmIGdldF91c2VyX2RlcG9zaXRfdW5kZXJseWluZ19hbW91bnQoCiAgICAvLyAjICAgICBzZWxmLCB1c2VyX2lkOiBhcmM0LkFkZHJlc3MsIG1hcmtldF9pZDogYXJjNC5VSW50NjQKICAgIC8vICMgKSAtPiBhcmM0LlVJbnQyNTY6CiAgICAvLyAjICAgICByZXR1cm4gYXJjNC5VSW50MjU2KAogICAgLy8gIyAgICAgICAgIHNlbGYuX2dldF91c2VyX2RlcG9zaXRfdW5kZXJseWluZ19hbW91bnQodXNlcl9pZC5uYXRpdmUsIG1hcmtldF9pZC5uYXRpdmUpCiAgICAvLyAjICAgICApCiAgICAvLyAKICAgIC8vICMgQHN1YnJvdXRpbmUKICAgIC8vICMgZGVmIF9nZXRfdXNlcl9kZXBvc2l0X3VuZGVybHlpbmdfYW1vdW50KAogICAgLy8gIyAgICAgc2VsZiwgdXNlcl9pZDogQWNjb3VudCwgbWFya2V0X2lkOiBVSW50NjQKICAgIC8vICMgKSAtPiBCaWdVSW50OgogICAgLy8gIyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICMgICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKSAgIyBBZGQgdGhpcyBsaW5lCiAgICAvLyAjICAgICByZXR1cm4gKHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSAqIG1hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZSkgLy8gU0NBTEUKICAgIC8vIAogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2luY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfZGVwb3NpdHMoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIHVzZXJfaWQ6IEFjY291bnQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlcl9rZXkgPSBzZWxmLl9nZXRfdXNlcl9rZXkodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIuc2NhbGVkX2RlcG9zaXRzID0gYXJjNC5VSW50MjU2KHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSArIGFtb3VudCkKICAgIC8vICAgICB1c2VyLmRlcG9zaXRfaW5kZXggPSBtYXJrZXQuZGVwb3NpdF9pbmRleAogICAgLy8gICAgIHVzZXIubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gICAgIHVzZXIubGFzdF9wcmljZSA9IG1hcmtldC5wcmljZSAgIyBVcGRhdGUgdXNlcidzIGxhc3Qga25vd24gcHJpY2UKICAgIC8vICAgICBzZWxmLnVzZXJzW3VzZXJfa2V5XSA9IHVzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2luY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfYm9ycm93cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgdXNlcl9pZDogQWNjb3VudCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyX2tleSA9IHNlbGYuX2dldF91c2VyX2tleSh1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlci5zY2FsZWRfYm9ycm93cyA9IGFyYzQuVUludDI1Nih1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSArIGFtb3VudCkKICAgIC8vICAgICB1c2VyLmJvcnJvd19pbmRleCA9IG1hcmtldC5ib3Jyb3dfaW5kZXgKICAgIC8vICAgICB1c2VyLmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vICAgICB1c2VyLmxhc3RfcHJpY2UgPSBtYXJrZXQucHJpY2UgICMgVXBkYXRlIHVzZXIncyBsYXN0IGtub3duIHByaWNlCiAgICAvLyAgICAgc2VsZi51c2Vyc1t1c2VyX2tleV0gPSB1c2VyLmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9kZWNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2RlcG9zaXRzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCB1c2VyX2lkOiBBY2NvdW50LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICB1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgPj0gYW1vdW50CiAgICAvLyAgICAgKSwgIkluc3VmZmljaWVudCBiYWxhbmNlIHRvIHdpdGhkcmF3IHRoaXMgYW1vdW50IgogICAgLy8gICAgIHVzZXIuc2NhbGVkX2RlcG9zaXRzID0gYXJjNC5VSW50MjU2KHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSAtIGFtb3VudCkKICAgIC8vICAgICB1c2VyLmRlcG9zaXRfaW5kZXggPSBtYXJrZXQuZGVwb3NpdF9pbmRleAogICAgLy8gICAgIHVzZXIubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gICAgIHVzZXIubGFzdF9wcmljZSA9IG1hcmtldC5wcmljZSAgIyBVcGRhdGUgdXNlcidzIGxhc3Qga25vd24gcHJpY2UKICAgIC8vICAgICBzZWxmLnVzZXJzW3VzZXJfa2V5XSA9IHVzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2RlY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfYm9ycm93cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgdXNlcl9pZDogQWNjb3VudCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyX2tleSA9IHNlbGYuX2dldF91c2VyX2tleSh1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgYXNzZXJ0ICgKICAgIC8vICAgICAgICAgdXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgPj0gYW1vdW50CiAgICAvLyAgICAgKSwgIkluc3VmZmljaWVudCBiYWxhbmNlIHRvIHJlcGF5IHRoaXMgYW1vdW50IgogICAgLy8gICAgIHVzZXIuc2NhbGVkX2JvcnJvd3MgPSBhcmM0LlVJbnQyNTYodXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgLSBhbW91bnQpCiAgICAvLyAgICAgdXNlci5ib3Jyb3dfaW5kZXggPSBtYXJrZXQuYm9ycm93X2luZGV4CiAgICAvLyAgICAgdXNlci5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApCiAgICAvLyAgICAgdXNlci5sYXN0X3ByaWNlID0gbWFya2V0LnByaWNlICAjIFVwZGF0ZSB1c2VyJ3MgbGFzdCBrbm93biBwcmljZQogICAgLy8gICAgIHNlbGYudXNlcnNbdXNlcl9rZXldID0gdXNlci5jb3B5KCkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgY3JlYXRlX21hcmtldCgKICAgIC8vICAgICBzZWxmLAogICAgLy8gICAgIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBjb2xsYXRlcmFsX2ZhY3RvcjogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgbGlxdWlkYXRpb25fdGhyZXNob2xkOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICByZXNlcnZlX2ZhY3RvcjogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgYm9ycm93X3JhdGU6IGFyYzQuVUludDY0LAogICAgLy8gICAgIHNsb3BlOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBtYXhfdG90YWxfZGVwb3NpdHM6IGFyYzQuVUludDI1NiwKICAgIC8vICAgICBtYXhfdG90YWxfYm9ycm93czogYXJjNC5VSW50MjU2LAogICAgLy8gICAgIGxpcXVpZGF0aW9uX2JvbnVzOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBjbG9zZV9mYWN0b3I6IGFyYzQuVUludDY0LAogICAgLy8gKSAtPiBhcmM0LlVJbnQ2NDoKICAgIC8vICAgICBzZWxmLl9vbmx5X293bmVyKCkKICAgIC8vICAgICBhc3NlcnQgbm90IHNlbGYuX2lzX3BhdXNlZCgpLCAiUHJvdG9jb2wgaXMgcGF1c2VkIgogICAgLy8gICAgIHJldHVybiBhcmM0LlVJbnQ2NCgKICAgIC8vICAgICAgICAgc2VsZi5fY3JlYXRlX21hcmtldCgKICAgIC8vICAgICAgICAgICAgIHRva2VuX2lkLm5hdGl2ZSwKICAgIC8vICAgICAgICAgICAgIE1hcmtldERhdGEoCiAgICAvLyAgICAgICAgICAgICAgICAgcGF1c2VkPWFyYzQuQm9vbChUcnVlKSwgICMgU3RhcnQgcGF1c2VkIHVudGlsIHByaWNlIGlzIHNldAogICAgLy8gICAgICAgICAgICAgICAgIG1heF90b3RhbF9kZXBvc2l0cz1tYXhfdG90YWxfZGVwb3NpdHMsCiAgICAvLyAgICAgICAgICAgICAgICAgbWF4X3RvdGFsX2JvcnJvd3M9bWF4X3RvdGFsX2JvcnJvd3MsCiAgICAvLyAgICAgICAgICAgICAgICAgbGlxdWlkYXRpb25fYm9udXM9bGlxdWlkYXRpb25fYm9udXMsCiAgICAvLyAgICAgICAgICAgICAgICAgY29sbGF0ZXJhbF9mYWN0b3I9Y29sbGF0ZXJhbF9mYWN0b3IsCiAgICAvLyAgICAgICAgICAgICAgICAgbGlxdWlkYXRpb25fdGhyZXNob2xkPWxpcXVpZGF0aW9uX3RocmVzaG9sZCwKICAgIC8vICAgICAgICAgICAgICAgICByZXNlcnZlX2ZhY3Rvcj1yZXNlcnZlX2ZhY3RvciwKICAgIC8vICAgICAgICAgICAgICAgICBib3Jyb3dfcmF0ZT1ib3Jyb3dfcmF0ZSwKICAgIC8vICAgICAgICAgICAgICAgICBzbG9wZT1zbG9wZSwKICAgIC8vICAgICAgICAgICAgICAgICB0b3RhbF9zY2FsZWRfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgICAgIHRvdGFsX3NjYWxlZF9ib3Jyb3dzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgICAgICBkZXBvc2l0X2luZGV4PWFyYzQuVUludDI1NihTQ0FMRSksICAjIFN0YXJ0IGF0IFNDQUxFICgxLjApCiAgICAvLyAgICAgICAgICAgICAgICAgYm9ycm93X2luZGV4PWFyYzQuVUludDI1NihTQ0FMRSksICAjIFN0YXJ0IGF0IFNDQUxFICgxLjApCiAgICAvLyAgICAgICAgICAgICAgICAgbGFzdF91cGRhdGVfdGltZT1hcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCksCiAgICAvLyAgICAgICAgICAgICAgICAgcmVzZXJ2ZXM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgICAgIHByaWNlPWFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgICAgICAgICAgICAgMAogICAgLy8gICAgICAgICAgICAgICAgICksICAjIFByaWNlIG11c3QgYmUgc2V0IGJlZm9yZSBtYXJrZXQgY2FuIGJlIHVzZWQKICAgIC8vICAgICAgICAgICAgICAgICBudG9rZW5faWQ9YXJjNC5VSW50NjQoMCksICAjIFdpbGwgYmUgc2V0IGR1cmluZyB0b2tlbiBpbml0aWFsaXphdGlvbgogICAgLy8gICAgICAgICAgICAgICAgIGNsb3NlX2ZhY3Rvcj1jbG9zZV9mYWN0b3IsCiAgICAvLyAgICAgICAgICAgICApLAogICAgLy8gICAgICAgICApCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9jcmVhdGVfbWFya2V0KHNlbGYsIHRva2VuX2lkOiBVSW50NjQsIG1hcmtldF9kYXRhOiBNYXJrZXREYXRhKSAtPiBVSW50NjQ6CiAgICAvLyAgICAgYXNzZXJ0IG5vdCB0b2tlbl9pZCBpbiBzZWxmLm1hcmtldHMsICJNYXJrZXQgYWxyZWFkeSBleGlzdHMiCiAgICAvLyAgICAgcGF5bWVudCA9IHJlcXVpcmVfcGF5bWVudChUeG4uc2VuZGVyKQogICAgLy8gICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgIHBheW1lbnQgPj0gc2VsZi5fY3JlYXRlX21hcmtldF9jb3N0KCkKICAgIC8vICAgICApLCAiaW5zdWZmaWNpZW50IHBheW1lbnQgZm9yIGNyZWF0ZSBtYXJrZXQiCiAgICAvLyAgICAgY29tcGlsZWQgPSBjb21waWxlX2NvbnRyYWN0KE5Ub2tlbiwgZXh0cmFfcHJvZ3JhbV9wYWdlcz0wKSAgIyBubyBleHRyYSBwYWdlcwogICAgLy8gICAgIGJhc2VfYXBwID0gYXJjNC5hcmM0X2NyZWF0ZShOVG9rZW4sIGNvbXBpbGVkPWNvbXBpbGVkKS5jcmVhdGVkX2FwcAogICAgLy8gICAgIGJvb3RzdHJhcDY0X2Nvc3QsIHR4bjEgPSBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgICAgICBOVG9rZW4uYm9vdHN0cmFwNjRfY29zdCwKICAgIC8vICAgICAgICAgYXBwX2lkPWJhc2VfYXBwLAogICAgLy8gICAgICkKICAgIC8vICAgICBpdHhuLlBheW1lbnQoCiAgICAvLyAgICAgICAgIHJlY2VpdmVyPWJhc2VfYXBwLmFkZHJlc3MsIGFtb3VudD1ib290c3RyYXA2NF9jb3N0Lm5hdGl2ZSwgZmVlPTAKICAgIC8vICAgICApLnN1Ym1pdCgpCiAgICAvLyAgICAgYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICAgICAgTlRva2VuLmJvb3RzdHJhcDY0LAogICAgLy8gICAgICAgICBhcmM0LlVJbnQ2NCh0b2tlbl9pZCksCiAgICAvLyAgICAgICAgIGFwcF9pZD1iYXNlX2FwcCwKICAgIC8vICAgICApCiAgICAvLyAgICAgbWFya2V0X2RhdGEubnRva2VuX2lkID0gYXJjNC5VSW50NjQoYmFzZV9hcHAuaWQpCiAgICAvLyAgICAgc2VsZi5tYXJrZXRzW3Rva2VuX2lkXSA9IG1hcmtldF9kYXRhLmNvcHkoKQogICAgLy8gICAgIGFyYzQuZW1pdCgKICAgIC8vICAgICAgICAgTWFya2V0Q3JlYXRlZChhcmM0LlVJbnQ2NCh0b2tlbl9pZCksIGFyYzQuVUludDY0KGJhc2VfYXBwLmlkKSwgbWFya2V0X2RhdGEpCiAgICAvLyAgICAgKQogICAgLy8gICAgIHJldHVybiBiYXNlX2FwcC5pZAogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QocmVhZG9ubHk9VHJ1ZSkKICAgIC8vIGRlZiBjcmVhdGVfbWFya2V0X2Nvc3Qoc2VsZikgLT4gYXJjNC5VSW50NjQ6CiAgICAvLyAgICAgcmV0dXJuIGFyYzQuVUludDY0KHNlbGYuX2NyZWF0ZV9tYXJrZXRfY29zdCgpKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9jcmVhdGVfbWFya2V0X2Nvc3Qoc2VsZikgLT4gVUludDY0OgogICAgLy8gICAgIHJldHVybiBVSW50NjQoMV8wMDBfMDAwKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QocmVhZG9ubHk9VHJ1ZSkKICAgIC8vIGRlZiBnZXRfbWFya2V0KHNlbGYsIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCkgLT4gTWFya2V0RGF0YToKICAgIC8vICAgICByZXR1cm4gc2VsZi5fZ2V0X21hcmtldCh0b2tlbl9pZC5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2dldF9tYXJrZXQoc2VsZiwgdG9rZW5faWQ6IFVJbnQ2NCkgLT4gTWFya2V0RGF0YToKICAgIC8vICAgICByZXR1cm4gc2VsZi5tYXJrZXRzLmdldCgKICAgIC8vICAgICAgICAgdG9rZW5faWQsCiAgICAvLyAgICAgICAgIGRlZmF1bHQ9TWFya2V0RGF0YSgKICAgIC8vICAgICAgICAgICAgIHBhdXNlZD1hcmM0LkJvb2woVHJ1ZSksCiAgICAvLyAgICAgICAgICAgICBtYXhfdG90YWxfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgbWF4X3RvdGFsX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgbGlxdWlkYXRpb25fYm9udXM9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICBjb2xsYXRlcmFsX2ZhY3Rvcj1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIGxpcXVpZGF0aW9uX3RocmVzaG9sZD1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIHJlc2VydmVfZmFjdG9yPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgYm9ycm93X3JhdGU9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICBzbG9wZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIHRvdGFsX3NjYWxlZF9kZXBvc2l0cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICB0b3RhbF9zY2FsZWRfYm9ycm93cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBkZXBvc2l0X2luZGV4PWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGJvcnJvd19pbmRleD1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBsYXN0X3VwZGF0ZV90aW1lPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgcmVzZXJ2ZXM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgcHJpY2U9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgbnRva2VuX2lkPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgY2xvc2VfZmFjdG9yPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICApLAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgZ2V0X21hcmtldF9wcmljZShzZWxmLCB0b2tlbl9pZDogYXJjNC5VSW50NjQpIC0+IGFyYzQuVUludDI1NjoKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KHRva2VuX2lkLm5hdGl2ZSkKICAgIC8vICAgICByZXR1cm4gbWFya2V0LnByaWNlCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF9tYXJrZXRfbnRva2VuX2lkKHNlbGYsIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCkgLT4gYXJjNC5VSW50NjQ6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldCh0b2tlbl9pZC5uYXRpdmUpCiAgICAvLyAgICAgcmV0dXJuIG1hcmtldC5udG9rZW5faWQKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgc2V0X21hcmtldF9wcmljZShzZWxmLCB0b2tlbl9pZDogYXJjNC5VSW50NjQsIHByaWNlOiBhcmM0LlVJbnQyNTYpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgYXNzZXJ0IG5vdCBzZWxmLl9pc19wYXVzZWQoKSwgIlByb3RvY29sIGlzIHBhdXNlZCIKICAgIC8vICAgICBzZWxmLl9zZXRfbWFya2V0X3ByaWNlKHRva2VuX2lkLm5hdGl2ZSwgcHJpY2UubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9zZXRfbWFya2V0X3ByaWNlKHNlbGYsIHRva2VuX2lkOiBVSW50NjQsIHByaWNlOiBCaWdVSW50KSAtPiBOb25lOgogICAgLy8gICAgIGFzc2VydCB0b2tlbl9pZCBpbiBzZWxmLm1hcmtldHMsICJNYXJrZXQgZG9lcyBub3QgZXhpc3QiCiAgICAvLyAgICAgYXNzZXJ0IHByaWNlID4gMCwgIlByaWNlIG11c3QgYmUgcG9zaXRpdmUiCiAgICAvLyAKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLm1hcmtldHNbdG9rZW5faWRdLmNvcHkoKQogICAgLy8gCiAgICAvLyAgICAgIyBVbnBhdXNlIHRoZSBtYXJrZXQgb24gZmlyc3QgcHJpY2Ugc2V0CiAgICAvLyAgICAgaWYgbWFya2V0LnBhdXNlZCBhbmQgbWFya2V0LnByaWNlID09IDA6CiAgICAvLyAgICAgICAgIG1hcmtldC5wYXVzZWQgPSBhcmM0LkJvb2woRmFsc2UpCiAgICAvLyAKICAgIC8vICAgICAjIFNjYWxlIHRoZSBwcmljZSBieSBTQ0FMRSBpbnRlcm5hbGx5IGZvciBzdG9yYWdlCiAgICAvLyAgICAgbWFya2V0LnByaWNlID0gYXJjNC5VSW50MjU2KHByaWNlICogU0NBTEUpCiAgICAvLyAKICAgIC8vICAgICBzZWxmLm1hcmtldHNbdG9rZW5faWRdID0gbWFya2V0LmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9pbmNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9kZXBvc2l0cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cyA9IGFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKyBhbW91bnQKICAgIC8vICAgICApCiAgICAvLyAgICAgbWFya2V0Lmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vICAgICBzZWxmLm1hcmtldHNbbWFya2V0X2lkXSA9IG1hcmtldC5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZGVjcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfZGVwb3NpdHMoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlID49IGFtb3VudAogICAgLy8gICAgICksICJJbnN1ZmZpY2llbnQgYmFsYW5jZSB0byB3aXRoZHJhdyB0aGlzIGFtb3VudCIKICAgIC8vICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSAtIGFtb3VudAogICAgLy8gICAgICkKICAgIC8vICAgICBzZWxmLm1hcmtldHNbbWFya2V0X2lkXSA9IG1hcmtldC5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaW5jcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfYm9ycm93cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlICsgYW1vdW50CiAgICAvLyAgICAgKQogICAgLy8gICAgIG1hcmtldC5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApCiAgICAvLyAgICAgc2VsZi5tYXJrZXRzW21hcmtldF9pZF0gPSBtYXJrZXQuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2RlY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2JvcnJvd3MoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUgPj0gYW1vdW50CiAgICAvLyAgICAgKSwgIkluc3VmZmljaWVudCBiYWxhbmNlIHRvIHdpdGhkcmF3IHRoaXMgYW1vdW50IgogICAgLy8gICAgIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cyA9IGFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAtIGFtb3VudAogICAgLy8gICAgICkKICAgIC8vICAgICBzZWxmLm1hcmtldHNbbWFya2V0X2lkXSA9IG1hcmtldC5jb3B5KCkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgcGF1c2VfbWFya2V0KHNlbGYsIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCwgcGF1c2U6IGFyYzQuVUludDY0KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX29ubHlfb3duZXIoKQogICAgLy8gICAgIHNlbGYuX3BhdXNlX21hcmtldCh0b2tlbl9pZC5uYXRpdmUsIHBhdXNlLm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfcGF1c2VfbWFya2V0KHNlbGYsIHRva2VuX2lkOiBVSW50NjQsIHBhdXNlOiBVSW50NjQpIC0+IE5vbmU6CiAgICAvLyAgICAgYXNzZXJ0IHRva2VuX2lkIGluIHNlbGYubWFya2V0cywgIk1hcmtldCBkb2VzIG5vdCBleGlzdCIKICAgIC8vICAgICBzZWxmLm1hcmtldHNbdG9rZW5faWRdLnBhdXNlZCA9IGFyYzQuQm9vbChwYXVzZSA9PSBVSW50NjQoMSkpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2lzX21hcmtldF9wYXVzZWQoc2VsZiwgdG9rZW5faWQ6IFVJbnQ2NCkgLT4gYm9vbDoKICAgIC8vICAgICByZXR1cm4gc2VsZi5fZ2V0X21hcmtldCh0b2tlbl9pZCkucGF1c2VkLm5hdGl2ZSA9PSBVSW50NjQoMSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfYWNjcnVlX2ludGVyZXN0KHNlbGYsIG1hcmtldF9pZDogVUludDY0KSAtPiBNYXJrZXREYXRhOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIGlmIG1hcmtldC5wYXVzZWQ6CiAgICAvLyAgICAgICAgIHJldHVybiBtYXJrZXQKICAgIC8vIAogICAgLy8gICAgIGN1cnJlbnRfdGltZSA9IEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wCiAgICAvLyAgICAgdGltZV9kZWx0YSA9IGN1cnJlbnRfdGltZSAtIG1hcmtldC5sYXN0X3VwZGF0ZV90aW1lLm5hdGl2ZQogICAgLy8gICAgIGlmIHRpbWVfZGVsdGEgPD0gMDoKICAgIC8vICAgICAgICAgcmV0dXJuIG1hcmtldAogICAgLy8gCiAgICAvLyAgICAgIyBGb3Igc3Rva2VuIG1hcmtldCAoYm9ycm93LW9ubHkpLCB1c2UgYSBmaXhlZCB1dGlsaXphdGlvbiByYXRlIHNpbmNlIHRoZXJlIGFyZSBubyBkZXBvc2l0cwogICAgLy8gICAgIGlmIG1hcmtldF9pZCA9PSBzZWxmLnN0b2tlbl9hcHBfaWQ6CiAgICAvLyAgICAgICAgIHV0aWxpemF0aW9uID0gQmlnVUludCgxMDAwMCkgICMgMTAwJSB1dGlsaXphdGlvbiBmb3IgYm9ycm93LW9ubHkgbWFya2V0CiAgICAvLyAgICAgZWxpZiBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSA9PSAwOgogICAgLy8gICAgICAgICByZXR1cm4gbWFya2V0CiAgICAvLyAgICAgZWxzZToKICAgIC8vICAgICAgICAgdXRpbGl6YXRpb24gPSAoCiAgICAvLyAgICAgICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlICogMTAwMDAKICAgIC8vICAgICAgICAgKSAvLyBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZQogICAgLy8gICAgIHJhdGUgPSBtYXJrZXQuYm9ycm93X3JhdGUubmF0aXZlICsgKG1hcmtldC5zbG9wZS5uYXRpdmUgKiB1dGlsaXphdGlvbikgLy8gMTAwMDAKICAgIC8vICAgICBpbnRlcmVzdCA9IChyYXRlICogbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAqIHRpbWVfZGVsdGEpIC8vICgKICAgIC8vICAgICAgICAgc2VsZi5zZWNvbmRzX3Blcl95ZWFyICogMTAwMDAKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vICAgICAjIFNwZWNpYWwgaGFuZGxpbmcgZm9yIHN0b2tlbiBtYXJrZXQgLSBhbGwgaW50ZXJlc3QgZ29lcyB0byByZXNlcnZlcwogICAgLy8gICAgIGlmIG1hcmtldF9pZCA9PSBzZWxmLnN0b2tlbl9hcHBfaWQ6CiAgICAvLyAgICAgICAgIHByb3RvY29sX3BvcnRpb24gPSBpbnRlcmVzdAogICAgLy8gICAgICAgICBkZXBvc2l0b3JfcG9ydGlvbiA9IEJpZ1VJbnQoMCkKICAgIC8vICAgICBlbHNlOgogICAgLy8gICAgICAgICBwcm90b2NvbF9wb3J0aW9uID0gKAogICAgLy8gICAgICAgICAgICAgaW50ZXJlc3QgKiBhcmM0LlVJbnQyNTYuZnJvbV9ieXRlcyhtYXJrZXQucmVzZXJ2ZV9mYWN0b3IuYnl0ZXMpLm5hdGl2ZQogICAgLy8gICAgICAgICApIC8vIDEwMDAwCiAgICAvLyAgICAgICAgIGlmIHByb3RvY29sX3BvcnRpb24gPiBpbnRlcmVzdDoKICAgIC8vICAgICAgICAgICAgIHByb3RvY29sX3BvcnRpb24gPSBpbnRlcmVzdAogICAgLy8gICAgICAgICBkZXBvc2l0b3JfcG9ydGlvbiA9IGludGVyZXN0IC0gcHJvdG9jb2xfcG9ydGlvbgogICAgLy8gCiAgICAvLyAgICAgaWYgbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cyA+IDA6CiAgICAvLyAgICAgICAgIG1hcmtldC5kZXBvc2l0X2luZGV4ID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICAgICAgbWFya2V0LmRlcG9zaXRfaW5kZXgubmF0aXZlCiAgICAvLyAgICAgICAgICAgICArIChkZXBvc2l0b3JfcG9ydGlvbiAqIFNDQUxFKSAvLyBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZQogICAgLy8gICAgICAgICApCiAgICAvLyAgICAgaWYgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzID4gMDoKICAgIC8vICAgICAgICAgbWFya2V0LmJvcnJvd19pbmRleCA9IGFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgICAgIG1hcmtldC5ib3Jyb3dfaW5kZXgubmF0aXZlCiAgICAvLyAgICAgICAgICAgICArIChpbnRlcmVzdCAqIFNDQUxFKSAvLyBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlCiAgICAvLyAgICAgICAgICkKICAgIC8vIAogICAgLy8gICAgIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cyA9IGFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzLm5hdGl2ZSArIGludGVyZXN0CiAgICAvLyAgICAgKQogICAgLy8gICAgIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMgPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlICsgZGVwb3NpdG9yX3BvcnRpb24KICAgIC8vICAgICApCiAgICAvLyAgICAgbWFya2V0LnJlc2VydmVzID0gYXJjNC5VSW50MjU2KG1hcmtldC5yZXNlcnZlcy5uYXRpdmUgKyBwcm90b2NvbF9wb3J0aW9uKQogICAgLy8gICAgIG1hcmtldC5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoY3VycmVudF90aW1lKQogICAgLy8gCiAgICAvLyAgICAgc2VsZi5tYXJrZXRzW21hcmtldF9pZF0gPSBtYXJrZXQuY29weSgpCiAgICAvLyAgICAgcmV0dXJuIG1hcmtldC5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfdmFsaWRhdGVfbWFya2V0X29wZXJhdGlvbigKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50LCBndWFyZF9zdG9rZW46IGJvb2wKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBhc3NlcnQgbm90IHNlbGYuX2lzX3BhdXNlZCgpLCAiUHJvdG9jb2wgaXMgcGF1c2VkIgogICAgLy8gICAgIGFzc2VydCBtYXJrZXRfaWQgaW4gc2VsZi5tYXJrZXRzLCAiTWFya2V0IGRvZXMgbm90IGV4aXN0IgogICAgZnJhbWVfZGlnIC0zCiAgICBpdG9iCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjUxMAogICAgLy8gc2VsZi5tYXJrZXRzID0gQm94TWFwKFVJbnQ2NCwgTWFya2V0RGF0YSkgICMgTWFya2V0IHN0YXRlCiAgICBieXRlICJtYXJrZXRzIgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1MTAtOTU1CiAgICAvLyAgICAgc2VsZi5tYXJrZXRzID0gQm94TWFwKFVJbnQ2NCwgTWFya2V0RGF0YSkgICMgTWFya2V0IHN0YXRlCiAgICAvLyAgICAgc2VsZi51c2VycyA9IEJveE1hcChCeXRlczQwLCBVc2VyRGF0YSkgICMgUGVyLW1hcmtldCB1c2VyIHN0YXRlCiAgICAvLyAgICAgc2VsZi5nbG9iYWxfdXNlcnMgPSBCb3hNYXAoQWNjb3VudCwgR2xvYmFsVXNlckRhdGEpICAjIEdsb2JhbCB1c2VyIHN0YXRlCiAgICAvLyAKICAgIC8vICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gIyBPd25hYmxlCiAgICAvLyAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfb25seV9vd25lcihzZWxmKSAtPiBOb25lOgogICAgLy8gICAgIGFzc2VydCBUeG4uc2VuZGVyID09IHNlbGYub3duZXIsICJvbmx5IHRoZSBvd25lciBjYW4gY2FsbCB0aGlzIGZ1bmN0aW9uIgogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QocmVhZG9ubHk9VHJ1ZSkKICAgIC8vIGRlZiBnZXRfb3duZXIoc2VsZikgLT4gYXJjNC5BZGRyZXNzOgogICAgLy8gICAgIHJldHVybiBhcmM0LkFkZHJlc3Moc2VsZi5vd25lcikKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgdHJhbnNmZXJfb3duZXJzaGlwKHNlbGYsIG5ld19vd25lcjogYXJjNC5BZGRyZXNzKSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX29ubHlfb3duZXIoKQogICAgLy8gICAgIHNlbGYuX3RyYW5zZmVyX293bmVyc2hpcChuZXdfb3duZXIubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF90cmFuc2Zlcl9vd25lcnNoaXAoc2VsZiwgbmV3X293bmVyOiBBY2NvdW50KSAtPiBOb25lOgogICAgLy8gICAgIHByZXZpb3VzX293bmVyID0gc2VsZi5vd25lcgogICAgLy8gICAgIHNlbGYub3duZXIgPSBuZXdfb3duZXIKICAgIC8vICAgICBhcmM0LmVtaXQoCiAgICAvLyAgICAgICAgIE93bmVyc2hpcFRyYW5zZmVycmVkKGFyYzQuQWRkcmVzcyhwcmV2aW91c19vd25lciksIGFyYzQuQWRkcmVzcyhuZXdfb3duZXIpKQogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAKICAgIC8vICMgUkVNIGhhdmluZyBpc3N1ZXMgd2l0aCB0aGUgaW5oZXJpdGFuY2UgaGVyZQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBpc19wYXVzZWQoc2VsZikgLT4gYXJjNC5Cb29sOgogICAgLy8gICAgIHJldHVybiBhcmM0LkJvb2woc2VsZi5faXNfcGF1c2VkKCkpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2lzX3BhdXNlZChzZWxmKSAtPiBib29sOgogICAgLy8gICAgIHJldHVybiBzZWxmLnBhdXNlZCA9PSBVSW50NjQoMSkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgcGF1c2Uoc2VsZiwgcGF1c2U6IGFyYzQuVUludDY0KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX29ubHlfb3duZXIoKQogICAgLy8gICAgIHNlbGYuX3BhdXNlKHBhdXNlLm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfcGF1c2Uoc2VsZiwgcGF1c2U6IFVJbnQ2NCkgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLnBhdXNlZCA9IHBhdXNlCiAgICAvLyAKICAgIC8vICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBnZXRfc3Rva2VuX2FwcF9pZChzZWxmKSAtPiBhcmM0LlVJbnQ2NDoKICAgIC8vICAgICByZXR1cm4gYXJjNC5VSW50NjQoc2VsZi5fZ2V0X3N0b2tlbl9hcHBfaWQoKSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X3N0b2tlbl9hcHBfaWQoc2VsZikgLT4gVUludDY0OgogICAgLy8gICAgIHJldHVybiBzZWxmLnN0b2tlbl9hcHBfaWQKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgc2V0X3N0b2tlbl9hcHBfaWQoc2VsZiwgc3Rva2VuX2FwcF9pZDogYXJjNC5VSW50NjQpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgc2VsZi5zdG9rZW5fYXBwX2lkID0gc3Rva2VuX2FwcF9pZC5uYXRpdmUKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X3VzZXJfa2V5KHNlbGYsIHVzZXJfaWQ6IEFjY291bnQsIG1hcmtldF9pZDogVUludDY0KSAtPiBCeXRlczQwOgogICAgLy8gICAgIHJldHVybiBCeXRlczQwLmZyb21fYnl0ZXMoCiAgICAvLyAgICAgICAgIGFyYzQuQWRkcmVzcyh1c2VyX2lkKS5ieXRlcyArIGFyYzQuVUludDY0KG1hcmtldF9pZCkuYnl0ZXMKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF91c2VyKHNlbGYsIHVzZXJfaWQ6IGFyYzQuQWRkcmVzcywgbWFya2V0X2lkOiBhcmM0LlVJbnQ2NCkgLT4gVXNlckRhdGE6CiAgICAvLyAgICAgcmV0dXJuIHNlbGYuX2dldF91c2VyKHVzZXJfaWQubmF0aXZlLCBtYXJrZXRfaWQubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9nZXRfdXNlcihzZWxmLCB1c2VyX2lkOiBBY2NvdW50LCBtYXJrZXRfaWQ6IFVJbnQ2NCkgLT4gVXNlckRhdGE6CiAgICAvLyAgICAgdXNlcl9rZXkgPSBzZWxmLl9nZXRfdXNlcl9rZXkodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHJldHVybiBzZWxmLnVzZXJzLmdldCgKICAgIC8vICAgICAgICAgdXNlcl9rZXksCiAgICAvLyAgICAgICAgIGRlZmF1bHQ9VXNlckRhdGEoCiAgICAvLyAgICAgICAgICAgICBzY2FsZWRfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgc2NhbGVkX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgZGVwb3NpdF9pbmRleD1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBib3Jyb3dfaW5kZXg9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgbGFzdF91cGRhdGVfdGltZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIGxhc3RfcHJpY2U9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICApLAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaGFzX3Bvc2l0aW9uKHNlbGYsIHVzZXJfaWQ6IEFjY291bnQsIG1hcmtldF9pZDogVUludDY0KSAtPiBib29sOgogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgcmV0dXJuIHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSA+IDAKICAgIC8vIAogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAKICAgIC8vICMgUkVNIGNvbnNpZGVyIHJlbW92aW5nIGFuZCBjYWxjdWxhdGluZyBpbiB0aGUgY2xpZW50CiAgICAvLyAjIFJFTSB0cnlpbmcgdG8gY3V0IGJhY2sgb24gZXh0cmEgcGFnZXMKICAgIC8vIAogICAgLy8gIyBAYXJjNC5hYmltZXRob2QKICAgIC8vICMgZGVmIGdldF91c2VyX2RlcG9zaXRfdW5kZXJseWluZ19hbW91bnQoCiAgICAvLyAjICAgICBzZWxmLCB1c2VyX2lkOiBhcmM0LkFkZHJlc3MsIG1hcmtldF9pZDogYXJjNC5VSW50NjQKICAgIC8vICMgKSAtPiBhcmM0LlVJbnQyNTY6CiAgICAvLyAjICAgICByZXR1cm4gYXJjNC5VSW50MjU2KAogICAgLy8gIyAgICAgICAgIHNlbGYuX2dldF91c2VyX2RlcG9zaXRfdW5kZXJseWluZ19hbW91bnQodXNlcl9pZC5uYXRpdmUsIG1hcmtldF9pZC5uYXRpdmUpCiAgICAvLyAjICAgICApCiAgICAvLyAKICAgIC8vICMgQHN1YnJvdXRpbmUKICAgIC8vICMgZGVmIF9nZXRfdXNlcl9kZXBvc2l0X3VuZGVybHlpbmdfYW1vdW50KAogICAgLy8gIyAgICAgc2VsZiwgdXNlcl9pZDogQWNjb3VudCwgbWFya2V0X2lkOiBVSW50NjQKICAgIC8vICMgKSAtPiBCaWdVSW50OgogICAgLy8gIyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICMgICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKSAgIyBBZGQgdGhpcyBsaW5lCiAgICAvLyAjICAgICByZXR1cm4gKHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSAqIG1hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZSkgLy8gU0NBTEUKICAgIC8vIAogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2luY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfZGVwb3NpdHMoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIHVzZXJfaWQ6IEFjY291bnQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlcl9rZXkgPSBzZWxmLl9nZXRfdXNlcl9rZXkodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIuc2NhbGVkX2RlcG9zaXRzID0gYXJjNC5VSW50MjU2KHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSArIGFtb3VudCkKICAgIC8vICAgICB1c2VyLmRlcG9zaXRfaW5kZXggPSBtYXJrZXQuZGVwb3NpdF9pbmRleAogICAgLy8gICAgIHVzZXIubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gICAgIHVzZXIubGFzdF9wcmljZSA9IG1hcmtldC5wcmljZSAgIyBVcGRhdGUgdXNlcidzIGxhc3Qga25vd24gcHJpY2UKICAgIC8vICAgICBzZWxmLnVzZXJzW3VzZXJfa2V5XSA9IHVzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2luY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfYm9ycm93cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgdXNlcl9pZDogQWNjb3VudCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyX2tleSA9IHNlbGYuX2dldF91c2VyX2tleSh1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlci5zY2FsZWRfYm9ycm93cyA9IGFyYzQuVUludDI1Nih1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSArIGFtb3VudCkKICAgIC8vICAgICB1c2VyLmJvcnJvd19pbmRleCA9IG1hcmtldC5ib3Jyb3dfaW5kZXgKICAgIC8vICAgICB1c2VyLmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vICAgICB1c2VyLmxhc3RfcHJpY2UgPSBtYXJrZXQucHJpY2UgICMgVXBkYXRlIHVzZXIncyBsYXN0IGtub3duIHByaWNlCiAgICAvLyAgICAgc2VsZi51c2Vyc1t1c2VyX2tleV0gPSB1c2VyLmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9kZWNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2RlcG9zaXRzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCB1c2VyX2lkOiBBY2NvdW50LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICB1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgPj0gYW1vdW50CiAgICAvLyAgICAgKSwgIkluc3VmZmljaWVudCBiYWxhbmNlIHRvIHdpdGhkcmF3IHRoaXMgYW1vdW50IgogICAgLy8gICAgIHVzZXIuc2NhbGVkX2RlcG9zaXRzID0gYXJjNC5VSW50MjU2KHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSAtIGFtb3VudCkKICAgIC8vICAgICB1c2VyLmRlcG9zaXRfaW5kZXggPSBtYXJrZXQuZGVwb3NpdF9pbmRleAogICAgLy8gICAgIHVzZXIubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gICAgIHVzZXIubGFzdF9wcmljZSA9IG1hcmtldC5wcmljZSAgIyBVcGRhdGUgdXNlcidzIGxhc3Qga25vd24gcHJpY2UKICAgIC8vICAgICBzZWxmLnVzZXJzW3VzZXJfa2V5XSA9IHVzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2RlY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfYm9ycm93cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgdXNlcl9pZDogQWNjb3VudCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyX2tleSA9IHNlbGYuX2dldF91c2VyX2tleSh1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgYXNzZXJ0ICgKICAgIC8vICAgICAgICAgdXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgPj0gYW1vdW50CiAgICAvLyAgICAgKSwgIkluc3VmZmljaWVudCBiYWxhbmNlIHRvIHJlcGF5IHRoaXMgYW1vdW50IgogICAgLy8gICAgIHVzZXIuc2NhbGVkX2JvcnJvd3MgPSBhcmM0LlVJbnQyNTYodXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgLSBhbW91bnQpCiAgICAvLyAgICAgdXNlci5ib3Jyb3dfaW5kZXggPSBtYXJrZXQuYm9ycm93X2luZGV4CiAgICAvLyAgICAgdXNlci5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApCiAgICAvLyAgICAgdXNlci5sYXN0X3ByaWNlID0gbWFya2V0LnByaWNlICAjIFVwZGF0ZSB1c2VyJ3MgbGFzdCBrbm93biBwcmljZQogICAgLy8gICAgIHNlbGYudXNlcnNbdXNlcl9rZXldID0gdXNlci5jb3B5KCkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgY3JlYXRlX21hcmtldCgKICAgIC8vICAgICBzZWxmLAogICAgLy8gICAgIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBjb2xsYXRlcmFsX2ZhY3RvcjogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgbGlxdWlkYXRpb25fdGhyZXNob2xkOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICByZXNlcnZlX2ZhY3RvcjogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgYm9ycm93X3JhdGU6IGFyYzQuVUludDY0LAogICAgLy8gICAgIHNsb3BlOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBtYXhfdG90YWxfZGVwb3NpdHM6IGFyYzQuVUludDI1NiwKICAgIC8vICAgICBtYXhfdG90YWxfYm9ycm93czogYXJjNC5VSW50MjU2LAogICAgLy8gICAgIGxpcXVpZGF0aW9uX2JvbnVzOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBjbG9zZV9mYWN0b3I6IGFyYzQuVUludDY0LAogICAgLy8gKSAtPiBhcmM0LlVJbnQ2NDoKICAgIC8vICAgICBzZWxmLl9vbmx5X293bmVyKCkKICAgIC8vICAgICBhc3NlcnQgbm90IHNlbGYuX2lzX3BhdXNlZCgpLCAiUHJvdG9jb2wgaXMgcGF1c2VkIgogICAgLy8gICAgIHJldHVybiBhcmM0LlVJbnQ2NCgKICAgIC8vICAgICAgICAgc2VsZi5fY3JlYXRlX21hcmtldCgKICAgIC8vICAgICAgICAgICAgIHRva2VuX2lkLm5hdGl2ZSwKICAgIC8vICAgICAgICAgICAgIE1hcmtldERhdGEoCiAgICAvLyAgICAgICAgICAgICAgICAgcGF1c2VkPWFyYzQuQm9vbChUcnVlKSwgICMgU3RhcnQgcGF1c2VkIHVudGlsIHByaWNlIGlzIHNldAogICAgLy8gICAgICAgICAgICAgICAgIG1heF90b3RhbF9kZXBvc2l0cz1tYXhfdG90YWxfZGVwb3NpdHMsCiAgICAvLyAgICAgICAgICAgICAgICAgbWF4X3RvdGFsX2JvcnJvd3M9bWF4X3RvdGFsX2JvcnJvd3MsCiAgICAvLyAgICAgICAgICAgICAgICAgbGlxdWlkYXRpb25fYm9udXM9bGlxdWlkYXRpb25fYm9udXMsCiAgICAvLyAgICAgICAgICAgICAgICAgY29sbGF0ZXJhbF9mYWN0b3I9Y29sbGF0ZXJhbF9mYWN0b3IsCiAgICAvLyAgICAgICAgICAgICAgICAgbGlxdWlkYXRpb25fdGhyZXNob2xkPWxpcXVpZGF0aW9uX3RocmVzaG9sZCwKICAgIC8vICAgICAgICAgICAgICAgICByZXNlcnZlX2ZhY3Rvcj1yZXNlcnZlX2ZhY3RvciwKICAgIC8vICAgICAgICAgICAgICAgICBib3Jyb3dfcmF0ZT1ib3Jyb3dfcmF0ZSwKICAgIC8vICAgICAgICAgICAgICAgICBzbG9wZT1zbG9wZSwKICAgIC8vICAgICAgICAgICAgICAgICB0b3RhbF9zY2FsZWRfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgICAgIHRvdGFsX3NjYWxlZF9ib3Jyb3dzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgICAgICBkZXBvc2l0X2luZGV4PWFyYzQuVUludDI1NihTQ0FMRSksICAjIFN0YXJ0IGF0IFNDQUxFICgxLjApCiAgICAvLyAgICAgICAgICAgICAgICAgYm9ycm93X2luZGV4PWFyYzQuVUludDI1NihTQ0FMRSksICAjIFN0YXJ0IGF0IFNDQUxFICgxLjApCiAgICAvLyAgICAgICAgICAgICAgICAgbGFzdF91cGRhdGVfdGltZT1hcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCksCiAgICAvLyAgICAgICAgICAgICAgICAgcmVzZXJ2ZXM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgICAgIHByaWNlPWFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgICAgICAgICAgICAgMAogICAgLy8gICAgICAgICAgICAgICAgICksICAjIFByaWNlIG11c3QgYmUgc2V0IGJlZm9yZSBtYXJrZXQgY2FuIGJlIHVzZWQKICAgIC8vICAgICAgICAgICAgICAgICBudG9rZW5faWQ9YXJjNC5VSW50NjQoMCksICAjIFdpbGwgYmUgc2V0IGR1cmluZyB0b2tlbiBpbml0aWFsaXphdGlvbgogICAgLy8gICAgICAgICAgICAgICAgIGNsb3NlX2ZhY3Rvcj1jbG9zZV9mYWN0b3IsCiAgICAvLyAgICAgICAgICAgICApLAogICAgLy8gICAgICAgICApCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9jcmVhdGVfbWFya2V0KHNlbGYsIHRva2VuX2lkOiBVSW50NjQsIG1hcmtldF9kYXRhOiBNYXJrZXREYXRhKSAtPiBVSW50NjQ6CiAgICAvLyAgICAgYXNzZXJ0IG5vdCB0b2tlbl9pZCBpbiBzZWxmLm1hcmtldHMsICJNYXJrZXQgYWxyZWFkeSBleGlzdHMiCiAgICAvLyAgICAgcGF5bWVudCA9IHJlcXVpcmVfcGF5bWVudChUeG4uc2VuZGVyKQogICAgLy8gICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgIHBheW1lbnQgPj0gc2VsZi5fY3JlYXRlX21hcmtldF9jb3N0KCkKICAgIC8vICAgICApLCAiaW5zdWZmaWNpZW50IHBheW1lbnQgZm9yIGNyZWF0ZSBtYXJrZXQiCiAgICAvLyAgICAgY29tcGlsZWQgPSBjb21waWxlX2NvbnRyYWN0KE5Ub2tlbiwgZXh0cmFfcHJvZ3JhbV9wYWdlcz0wKSAgIyBubyBleHRyYSBwYWdlcwogICAgLy8gICAgIGJhc2VfYXBwID0gYXJjNC5hcmM0X2NyZWF0ZShOVG9rZW4sIGNvbXBpbGVkPWNvbXBpbGVkKS5jcmVhdGVkX2FwcAogICAgLy8gICAgIGJvb3RzdHJhcDY0X2Nvc3QsIHR4bjEgPSBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgICAgICBOVG9rZW4uYm9vdHN0cmFwNjRfY29zdCwKICAgIC8vICAgICAgICAgYXBwX2lkPWJhc2VfYXBwLAogICAgLy8gICAgICkKICAgIC8vICAgICBpdHhuLlBheW1lbnQoCiAgICAvLyAgICAgICAgIHJlY2VpdmVyPWJhc2VfYXBwLmFkZHJlc3MsIGFtb3VudD1ib290c3RyYXA2NF9jb3N0Lm5hdGl2ZSwgZmVlPTAKICAgIC8vICAgICApLnN1Ym1pdCgpCiAgICAvLyAgICAgYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICAgICAgTlRva2VuLmJvb3RzdHJhcDY0LAogICAgLy8gICAgICAgICBhcmM0LlVJbnQ2NCh0b2tlbl9pZCksCiAgICAvLyAgICAgICAgIGFwcF9pZD1iYXNlX2FwcCwKICAgIC8vICAgICApCiAgICAvLyAgICAgbWFya2V0X2RhdGEubnRva2VuX2lkID0gYXJjNC5VSW50NjQoYmFzZV9hcHAuaWQpCiAgICAvLyAgICAgc2VsZi5tYXJrZXRzW3Rva2VuX2lkXSA9IG1hcmtldF9kYXRhLmNvcHkoKQogICAgLy8gICAgIGFyYzQuZW1pdCgKICAgIC8vICAgICAgICAgTWFya2V0Q3JlYXRlZChhcmM0LlVJbnQ2NCh0b2tlbl9pZCksIGFyYzQuVUludDY0KGJhc2VfYXBwLmlkKSwgbWFya2V0X2RhdGEpCiAgICAvLyAgICAgKQogICAgLy8gICAgIHJldHVybiBiYXNlX2FwcC5pZAogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QocmVhZG9ubHk9VHJ1ZSkKICAgIC8vIGRlZiBjcmVhdGVfbWFya2V0X2Nvc3Qoc2VsZikgLT4gYXJjNC5VSW50NjQ6CiAgICAvLyAgICAgcmV0dXJuIGFyYzQuVUludDY0KHNlbGYuX2NyZWF0ZV9tYXJrZXRfY29zdCgpKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9jcmVhdGVfbWFya2V0X2Nvc3Qoc2VsZikgLT4gVUludDY0OgogICAgLy8gICAgIHJldHVybiBVSW50NjQoMV8wMDBfMDAwKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QocmVhZG9ubHk9VHJ1ZSkKICAgIC8vIGRlZiBnZXRfbWFya2V0KHNlbGYsIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCkgLT4gTWFya2V0RGF0YToKICAgIC8vICAgICByZXR1cm4gc2VsZi5fZ2V0X21hcmtldCh0b2tlbl9pZC5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2dldF9tYXJrZXQoc2VsZiwgdG9rZW5faWQ6IFVJbnQ2NCkgLT4gTWFya2V0RGF0YToKICAgIC8vICAgICByZXR1cm4gc2VsZi5tYXJrZXRzLmdldCgKICAgIC8vICAgICAgICAgdG9rZW5faWQsCiAgICAvLyAgICAgICAgIGRlZmF1bHQ9TWFya2V0RGF0YSgKICAgIC8vICAgICAgICAgICAgIHBhdXNlZD1hcmM0LkJvb2woVHJ1ZSksCiAgICAvLyAgICAgICAgICAgICBtYXhfdG90YWxfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgbWF4X3RvdGFsX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgbGlxdWlkYXRpb25fYm9udXM9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICBjb2xsYXRlcmFsX2ZhY3Rvcj1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIGxpcXVpZGF0aW9uX3RocmVzaG9sZD1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIHJlc2VydmVfZmFjdG9yPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgYm9ycm93X3JhdGU9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICBzbG9wZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIHRvdGFsX3NjYWxlZF9kZXBvc2l0cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICB0b3RhbF9zY2FsZWRfYm9ycm93cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBkZXBvc2l0X2luZGV4PWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGJvcnJvd19pbmRleD1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBsYXN0X3VwZGF0ZV90aW1lPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgcmVzZXJ2ZXM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgcHJpY2U9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgbnRva2VuX2lkPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgY2xvc2VfZmFjdG9yPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICApLAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgZ2V0X21hcmtldF9wcmljZShzZWxmLCB0b2tlbl9pZDogYXJjNC5VSW50NjQpIC0+IGFyYzQuVUludDI1NjoKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KHRva2VuX2lkLm5hdGl2ZSkKICAgIC8vICAgICByZXR1cm4gbWFya2V0LnByaWNlCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF9tYXJrZXRfbnRva2VuX2lkKHNlbGYsIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCkgLT4gYXJjNC5VSW50NjQ6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldCh0b2tlbl9pZC5uYXRpdmUpCiAgICAvLyAgICAgcmV0dXJuIG1hcmtldC5udG9rZW5faWQKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgc2V0X21hcmtldF9wcmljZShzZWxmLCB0b2tlbl9pZDogYXJjNC5VSW50NjQsIHByaWNlOiBhcmM0LlVJbnQyNTYpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgYXNzZXJ0IG5vdCBzZWxmLl9pc19wYXVzZWQoKSwgIlByb3RvY29sIGlzIHBhdXNlZCIKICAgIC8vICAgICBzZWxmLl9zZXRfbWFya2V0X3ByaWNlKHRva2VuX2lkLm5hdGl2ZSwgcHJpY2UubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9zZXRfbWFya2V0X3ByaWNlKHNlbGYsIHRva2VuX2lkOiBVSW50NjQsIHByaWNlOiBCaWdVSW50KSAtPiBOb25lOgogICAgLy8gICAgIGFzc2VydCB0b2tlbl9pZCBpbiBzZWxmLm1hcmtldHMsICJNYXJrZXQgZG9lcyBub3QgZXhpc3QiCiAgICAvLyAgICAgYXNzZXJ0IHByaWNlID4gMCwgIlByaWNlIG11c3QgYmUgcG9zaXRpdmUiCiAgICAvLyAKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLm1hcmtldHNbdG9rZW5faWRdLmNvcHkoKQogICAgLy8gCiAgICAvLyAgICAgIyBVbnBhdXNlIHRoZSBtYXJrZXQgb24gZmlyc3QgcHJpY2Ugc2V0CiAgICAvLyAgICAgaWYgbWFya2V0LnBhdXNlZCBhbmQgbWFya2V0LnByaWNlID09IDA6CiAgICAvLyAgICAgICAgIG1hcmtldC5wYXVzZWQgPSBhcmM0LkJvb2woRmFsc2UpCiAgICAvLyAKICAgIC8vICAgICAjIFNjYWxlIHRoZSBwcmljZSBieSBTQ0FMRSBpbnRlcm5hbGx5IGZvciBzdG9yYWdlCiAgICAvLyAgICAgbWFya2V0LnByaWNlID0gYXJjNC5VSW50MjU2KHByaWNlICogU0NBTEUpCiAgICAvLyAKICAgIC8vICAgICBzZWxmLm1hcmtldHNbdG9rZW5faWRdID0gbWFya2V0LmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9pbmNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9kZXBvc2l0cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cyA9IGFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKyBhbW91bnQKICAgIC8vICAgICApCiAgICAvLyAgICAgbWFya2V0Lmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vICAgICBzZWxmLm1hcmtldHNbbWFya2V0X2lkXSA9IG1hcmtldC5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZGVjcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfZGVwb3NpdHMoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlID49IGFtb3VudAogICAgLy8gICAgICksICJJbnN1ZmZpY2llbnQgYmFsYW5jZSB0byB3aXRoZHJhdyB0aGlzIGFtb3VudCIKICAgIC8vICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSAtIGFtb3VudAogICAgLy8gICAgICkKICAgIC8vICAgICBzZWxmLm1hcmtldHNbbWFya2V0X2lkXSA9IG1hcmtldC5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaW5jcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfYm9ycm93cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlICsgYW1vdW50CiAgICAvLyAgICAgKQogICAgLy8gICAgIG1hcmtldC5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApCiAgICAvLyAgICAgc2VsZi5tYXJrZXRzW21hcmtldF9pZF0gPSBtYXJrZXQuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2RlY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2JvcnJvd3MoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUgPj0gYW1vdW50CiAgICAvLyAgICAgKSwgIkluc3VmZmljaWVudCBiYWxhbmNlIHRvIHdpdGhkcmF3IHRoaXMgYW1vdW50IgogICAgLy8gICAgIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cyA9IGFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAtIGFtb3VudAogICAgLy8gICAgICkKICAgIC8vICAgICBzZWxmLm1hcmtldHNbbWFya2V0X2lkXSA9IG1hcmtldC5jb3B5KCkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgcGF1c2VfbWFya2V0KHNlbGYsIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCwgcGF1c2U6IGFyYzQuVUludDY0KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX29ubHlfb3duZXIoKQogICAgLy8gICAgIHNlbGYuX3BhdXNlX21hcmtldCh0b2tlbl9pZC5uYXRpdmUsIHBhdXNlLm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfcGF1c2VfbWFya2V0KHNlbGYsIHRva2VuX2lkOiBVSW50NjQsIHBhdXNlOiBVSW50NjQpIC0+IE5vbmU6CiAgICAvLyAgICAgYXNzZXJ0IHRva2VuX2lkIGluIHNlbGYubWFya2V0cywgIk1hcmtldCBkb2VzIG5vdCBleGlzdCIKICAgIC8vICAgICBzZWxmLm1hcmtldHNbdG9rZW5faWRdLnBhdXNlZCA9IGFyYzQuQm9vbChwYXVzZSA9PSBVSW50NjQoMSkpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2lzX21hcmtldF9wYXVzZWQoc2VsZiwgdG9rZW5faWQ6IFVJbnQ2NCkgLT4gYm9vbDoKICAgIC8vICAgICByZXR1cm4gc2VsZi5fZ2V0X21hcmtldCh0b2tlbl9pZCkucGF1c2VkLm5hdGl2ZSA9PSBVSW50NjQoMSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfYWNjcnVlX2ludGVyZXN0KHNlbGYsIG1hcmtldF9pZDogVUludDY0KSAtPiBNYXJrZXREYXRhOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIGlmIG1hcmtldC5wYXVzZWQ6CiAgICAvLyAgICAgICAgIHJldHVybiBtYXJrZXQKICAgIC8vIAogICAgLy8gICAgIGN1cnJlbnRfdGltZSA9IEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wCiAgICAvLyAgICAgdGltZV9kZWx0YSA9IGN1cnJlbnRfdGltZSAtIG1hcmtldC5sYXN0X3VwZGF0ZV90aW1lLm5hdGl2ZQogICAgLy8gICAgIGlmIHRpbWVfZGVsdGEgPD0gMDoKICAgIC8vICAgICAgICAgcmV0dXJuIG1hcmtldAogICAgLy8gCiAgICAvLyAgICAgIyBGb3Igc3Rva2VuIG1hcmtldCAoYm9ycm93LW9ubHkpLCB1c2UgYSBmaXhlZCB1dGlsaXphdGlvbiByYXRlIHNpbmNlIHRoZXJlIGFyZSBubyBkZXBvc2l0cwogICAgLy8gICAgIGlmIG1hcmtldF9pZCA9PSBzZWxmLnN0b2tlbl9hcHBfaWQ6CiAgICAvLyAgICAgICAgIHV0aWxpemF0aW9uID0gQmlnVUludCgxMDAwMCkgICMgMTAwJSB1dGlsaXphdGlvbiBmb3IgYm9ycm93LW9ubHkgbWFya2V0CiAgICAvLyAgICAgZWxpZiBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSA9PSAwOgogICAgLy8gICAgICAgICByZXR1cm4gbWFya2V0CiAgICAvLyAgICAgZWxzZToKICAgIC8vICAgICAgICAgdXRpbGl6YXRpb24gPSAoCiAgICAvLyAgICAgICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlICogMTAwMDAKICAgIC8vICAgICAgICAgKSAvLyBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZQogICAgLy8gICAgIHJhdGUgPSBtYXJrZXQuYm9ycm93X3JhdGUubmF0aXZlICsgKG1hcmtldC5zbG9wZS5uYXRpdmUgKiB1dGlsaXphdGlvbikgLy8gMTAwMDAKICAgIC8vICAgICBpbnRlcmVzdCA9IChyYXRlICogbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAqIHRpbWVfZGVsdGEpIC8vICgKICAgIC8vICAgICAgICAgc2VsZi5zZWNvbmRzX3Blcl95ZWFyICogMTAwMDAKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vICAgICAjIFNwZWNpYWwgaGFuZGxpbmcgZm9yIHN0b2tlbiBtYXJrZXQgLSBhbGwgaW50ZXJlc3QgZ29lcyB0byByZXNlcnZlcwogICAgLy8gICAgIGlmIG1hcmtldF9pZCA9PSBzZWxmLnN0b2tlbl9hcHBfaWQ6CiAgICAvLyAgICAgICAgIHByb3RvY29sX3BvcnRpb24gPSBpbnRlcmVzdAogICAgLy8gICAgICAgICBkZXBvc2l0b3JfcG9ydGlvbiA9IEJpZ1VJbnQoMCkKICAgIC8vICAgICBlbHNlOgogICAgLy8gICAgICAgICBwcm90b2NvbF9wb3J0aW9uID0gKAogICAgLy8gICAgICAgICAgICAgaW50ZXJlc3QgKiBhcmM0LlVJbnQyNTYuZnJvbV9ieXRlcyhtYXJrZXQucmVzZXJ2ZV9mYWN0b3IuYnl0ZXMpLm5hdGl2ZQogICAgLy8gICAgICAgICApIC8vIDEwMDAwCiAgICAvLyAgICAgICAgIGlmIHByb3RvY29sX3BvcnRpb24gPiBpbnRlcmVzdDoKICAgIC8vICAgICAgICAgICAgIHByb3RvY29sX3BvcnRpb24gPSBpbnRlcmVzdAogICAgLy8gICAgICAgICBkZXBvc2l0b3JfcG9ydGlvbiA9IGludGVyZXN0IC0gcHJvdG9jb2xfcG9ydGlvbgogICAgLy8gCiAgICAvLyAgICAgaWYgbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cyA+IDA6CiAgICAvLyAgICAgICAgIG1hcmtldC5kZXBvc2l0X2luZGV4ID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICAgICAgbWFya2V0LmRlcG9zaXRfaW5kZXgubmF0aXZlCiAgICAvLyAgICAgICAgICAgICArIChkZXBvc2l0b3JfcG9ydGlvbiAqIFNDQUxFKSAvLyBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZQogICAgLy8gICAgICAgICApCiAgICAvLyAgICAgaWYgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzID4gMDoKICAgIC8vICAgICAgICAgbWFya2V0LmJvcnJvd19pbmRleCA9IGFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgICAgIG1hcmtldC5ib3Jyb3dfaW5kZXgubmF0aXZlCiAgICAvLyAgICAgICAgICAgICArIChpbnRlcmVzdCAqIFNDQUxFKSAvLyBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlCiAgICAvLyAgICAgICAgICkKICAgIC8vIAogICAgLy8gICAgIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cyA9IGFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzLm5hdGl2ZSArIGludGVyZXN0CiAgICAvLyAgICAgKQogICAgLy8gICAgIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMgPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlICsgZGVwb3NpdG9yX3BvcnRpb24KICAgIC8vICAgICApCiAgICAvLyAgICAgbWFya2V0LnJlc2VydmVzID0gYXJjNC5VSW50MjU2KG1hcmtldC5yZXNlcnZlcy5uYXRpdmUgKyBwcm90b2NvbF9wb3J0aW9uKQogICAgLy8gICAgIG1hcmtldC5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoY3VycmVudF90aW1lKQogICAgLy8gCiAgICAvLyAgICAgc2VsZi5tYXJrZXRzW21hcmtldF9pZF0gPSBtYXJrZXQuY29weSgpCiAgICAvLyAgICAgcmV0dXJuIG1hcmtldC5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfdmFsaWRhdGVfbWFya2V0X29wZXJhdGlvbigKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50LCBndWFyZF9zdG9rZW46IGJvb2wKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBhc3NlcnQgbm90IHNlbGYuX2lzX3BhdXNlZCgpLCAiUHJvdG9jb2wgaXMgcGF1c2VkIgogICAgLy8gICAgIGFzc2VydCBtYXJrZXRfaWQgaW4gc2VsZi5tYXJrZXRzLCAiTWFya2V0IGRvZXMgbm90IGV4aXN0IgogICAgc3dhcAogICAgY29uY2F0CiAgICBib3hfbGVuCiAgICBidXJ5IDEKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6OTU1CiAgICAvLyBhc3NlcnQgbWFya2V0X2lkIGluIHNlbGYubWFya2V0cywgIk1hcmtldCBkb2VzIG5vdCBleGlzdCIKICAgIGFzc2VydCAvLyBNYXJrZXQgZG9lcyBub3QgZXhpc3QKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6OTU2CiAgICAvLyBhc3NlcnQgYW1vdW50ID4gMCwgIkFtb3VudCBtdXN0IGJlID4gMCIKICAgIGZyYW1lX2RpZyAtMgogICAgYnl0ZSAweAogICAgYj4KICAgIGFzc2VydCAvLyBBbW91bnQgbXVzdCBiZSA+IDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6OTU3CiAgICAvLyBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIGZyYW1lX2RpZyAtMwogICAgY2FsbHN1YiBfZ2V0X21hcmtldAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5NTgKICAgIC8vIGFzc2VydCBub3QgbWFya2V0LnBhdXNlZCwgIk1hcmtldCBpcyBwYXVzZWQiCiAgICBpbnQgMAogICAgZ2V0Yml0CiAgICBieXRlIDB4MDAKICAgIGludCAwCiAgICB1bmNvdmVyIDIKICAgIHNldGJpdAogICAgYnl0ZSAweDAwCiAgICA9PQogICAgYXNzZXJ0IC8vIE1hcmtldCBpcyBwYXVzZWQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6OTU5CiAgICAvLyBpZiBndWFyZF9zdG9rZW46CiAgICBmcmFtZV9kaWcgLTEKICAgIGJ6IF92YWxpZGF0ZV9tYXJrZXRfb3BlcmF0aW9uX2FmdGVyX2lmX2Vsc2VAMgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5NjEKICAgIC8vIHNlbGYuc3Rva2VuX2FwcF9pZCAhPSBtYXJrZXRfaWQKICAgIGludCAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjUwOAogICAgLy8gc2VsZi5zdG9rZW5fYXBwX2lkID0gVUludDY0KCkgICMgc3RhYmxlIG1hcmtldAogICAgYnl0ZSAic3Rva2VuX2FwcF9pZCIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6OTYxCiAgICAvLyBzZWxmLnN0b2tlbl9hcHBfaWQgIT0gbWFya2V0X2lkCiAgICBhcHBfZ2xvYmFsX2dldF9leAogICAgYXNzZXJ0IC8vIGNoZWNrIHNlbGYuc3Rva2VuX2FwcF9pZCBleGlzdHMKICAgIGZyYW1lX2RpZyAtMwogICAgIT0KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6OTYwLTk2MgogICAgLy8gYXNzZXJ0ICgKICAgIC8vICAgICBzZWxmLnN0b2tlbl9hcHBfaWQgIT0gbWFya2V0X2lkCiAgICAvLyApLCAiQ2Fubm90IHVzZSBzdG9rZW4gbWFya2V0IGZvciB0aGlzIG9wZXJhdGlvbiIKICAgIGFzc2VydCAvLyBDYW5ub3QgdXNlIHN0b2tlbiBtYXJrZXQgZm9yIHRoaXMgb3BlcmF0aW9uCgpfdmFsaWRhdGVfbWFya2V0X29wZXJhdGlvbl9hZnRlcl9pZl9lbHNlQDI6CiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5fYWNjcnVlX2ludGVyZXN0KG1hcmtldF9pZDogdWludDY0KSAtPiBieXRlczoKX2FjY3J1ZV9pbnRlcmVzdDoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODkwLTg5MQogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfYWNjcnVlX2ludGVyZXN0KHNlbGYsIG1hcmtldF9pZDogVUludDY0KSAtPiBNYXJrZXREYXRhOgogICAgcHJvdG8gMSAxCiAgICBpbnQgMAogICAgZHVwbiA2CiAgICBieXRlICIiCiAgICBkdXAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODkyCiAgICAvLyBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIGZyYW1lX2RpZyAtMQogICAgY2FsbHN1YiBfZ2V0X21hcmtldAogICAgZHVwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojg5MwogICAgLy8gaWYgbWFya2V0LnBhdXNlZDoKICAgIGludCAwCiAgICBnZXRiaXQKICAgIGJ5dGUgMHgwMAogICAgaW50IDAKICAgIHVuY292ZXIgMgogICAgc2V0Yml0CiAgICBieXRlIDB4MDAKICAgICE9CiAgICBieiBfYWNjcnVlX2ludGVyZXN0X2FmdGVyX2lmX2Vsc2VAMgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo4OTQKICAgIC8vIHJldHVybiBtYXJrZXQKICAgIGZyYW1lX2RpZyA5CiAgICBmcmFtZV9idXJ5IDAKICAgIHJldHN1YgoKX2FjY3J1ZV9pbnRlcmVzdF9hZnRlcl9pZl9lbHNlQDI6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojg5NgogICAgLy8gY3VycmVudF90aW1lID0gR2xvYmFsLmxhdGVzdF90aW1lc3RhbXAKICAgIGdsb2JhbCBMYXRlc3RUaW1lc3RhbXAKICAgIGR1cAogICAgZnJhbWVfYnVyeSA3CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojg5NwogICAgLy8gdGltZV9kZWx0YSA9IGN1cnJlbnRfdGltZSAtIG1hcmtldC5sYXN0X3VwZGF0ZV90aW1lLm5hdGl2ZQogICAgZnJhbWVfZGlnIDkKICAgIGV4dHJhY3QgMjQxIDggLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBidG9pCiAgICAtCiAgICBkdXAKICAgIGZyYW1lX2J1cnkgOAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo4OTgKICAgIC8vIGlmIHRpbWVfZGVsdGEgPD0gMDoKICAgIGludCAwCiAgICA8PQogICAgYnogX2FjY3J1ZV9pbnRlcmVzdF9hZnRlcl9pZl9lbHNlQDQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODk5CiAgICAvLyByZXR1cm4gbWFya2V0CiAgICBmcmFtZV9kaWcgOQogICAgZnJhbWVfYnVyeSAwCiAgICByZXRzdWIKCl9hY2NydWVfaW50ZXJlc3RfYWZ0ZXJfaWZfZWxzZUA0OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5MDEtOTAyCiAgICAvLyAjIEZvciBzdG9rZW4gbWFya2V0IChib3Jyb3ctb25seSksIHVzZSBhIGZpeGVkIHV0aWxpemF0aW9uIHJhdGUgc2luY2UgdGhlcmUgYXJlIG5vIGRlcG9zaXRzCiAgICAvLyBpZiBtYXJrZXRfaWQgPT0gc2VsZi5zdG9rZW5fYXBwX2lkOgogICAgaW50IDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTA4CiAgICAvLyBzZWxmLnN0b2tlbl9hcHBfaWQgPSBVSW50NjQoKSAgIyBzdGFibGUgbWFya2V0CiAgICBieXRlICJzdG9rZW5fYXBwX2lkIgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5MDEtOTAyCiAgICAvLyAjIEZvciBzdG9rZW4gbWFya2V0IChib3Jyb3ctb25seSksIHVzZSBhIGZpeGVkIHV0aWxpemF0aW9uIHJhdGUgc2luY2UgdGhlcmUgYXJlIG5vIGRlcG9zaXRzCiAgICAvLyBpZiBtYXJrZXRfaWQgPT0gc2VsZi5zdG9rZW5fYXBwX2lkOgogICAgYXBwX2dsb2JhbF9nZXRfZXgKICAgIGFzc2VydCAvLyBjaGVjayBzZWxmLnN0b2tlbl9hcHBfaWQgZXhpc3RzCiAgICBmcmFtZV9kaWcgLTEKICAgID09CiAgICBieiBfYWNjcnVlX2ludGVyZXN0X2Vsc2VfYm9keUA2CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjkwMwogICAgLy8gdXRpbGl6YXRpb24gPSBCaWdVSW50KDEwMDAwKSAgIyAxMDAlIHV0aWxpemF0aW9uIGZvciBib3Jyb3ctb25seSBtYXJrZXQKICAgIGJ5dGUgMHgyNzEwCiAgICBiIF9hY2NydWVfaW50ZXJlc3RfYWZ0ZXJfaWZfZWxzZUAxMAoKX2FjY3J1ZV9pbnRlcmVzdF9lbHNlX2JvZHlANjoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6OTA0CiAgICAvLyBlbGlmIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlID09IDA6CiAgICBmcmFtZV9kaWcgOQogICAgZXh0cmFjdCAxMTMgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBkdXAKICAgIGZyYW1lX2J1cnkgNgogICAgYnl0ZSAweAogICAgYj09CiAgICBieiBfYWNjcnVlX2ludGVyZXN0X2Vsc2VfYm9keUA4CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjkwNQogICAgLy8gcmV0dXJuIG1hcmtldAogICAgZnJhbWVfZGlnIDkKICAgIGZyYW1lX2J1cnkgMAogICAgcmV0c3ViCgpfYWNjcnVlX2ludGVyZXN0X2Vsc2VfYm9keUA4OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5MDgKICAgIC8vIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUgKiAxMDAwMAogICAgZnJhbWVfZGlnIDkKICAgIGV4dHJhY3QgMTQ1IDMyIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgYnl0ZSAweDI3MTAKICAgIGIqCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjkwNy05MDkKICAgIC8vIHV0aWxpemF0aW9uID0gKAogICAgLy8gICAgIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUgKiAxMDAwMAogICAgLy8gKSAvLyBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZQogICAgZnJhbWVfZGlnIDYKICAgIGIvCgpfYWNjcnVlX2ludGVyZXN0X2FmdGVyX2lmX2Vsc2VAMTA6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjkxMAogICAgLy8gcmF0ZSA9IG1hcmtldC5ib3Jyb3dfcmF0ZS5uYXRpdmUgKyAobWFya2V0LnNsb3BlLm5hdGl2ZSAqIHV0aWxpemF0aW9uKSAvLyAxMDAwMAogICAgZnJhbWVfZGlnIDkKICAgIGR1cAogICAgZXh0cmFjdCA5NyA4IC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgYnRvaQogICAgaXRvYgogICAgc3dhcAogICAgZHVwCiAgICBleHRyYWN0IDEwNSA4IC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgYnRvaQogICAgaXRvYgogICAgdW5jb3ZlciAzCiAgICBiKgogICAgYnl0ZSAweDI3MTAKICAgIGIvCiAgICB1bmNvdmVyIDIKICAgIGIrCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjkxMQogICAgLy8gaW50ZXJlc3QgPSAocmF0ZSAqIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUgKiB0aW1lX2RlbHRhKSAvLyAoCiAgICBzd2FwCiAgICBleHRyYWN0IDE0NSAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIGIqCiAgICBmcmFtZV9kaWcgOAogICAgaXRvYgogICAgYioKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6OTEyCiAgICAvLyBzZWxmLnNlY29uZHNfcGVyX3llYXIgKiAxMDAwMAogICAgaW50IDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTA5CiAgICAvLyBzZWxmLnNlY29uZHNfcGVyX3llYXIgPSBVSW50NjQoKSAgIyBzZWNvbmRzIHBlciB5ZWFyCiAgICBieXRlICJzZWNvbmRzX3Blcl95ZWFyIgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5MTIKICAgIC8vIHNlbGYuc2Vjb25kc19wZXJfeWVhciAqIDEwMDAwCiAgICBhcHBfZ2xvYmFsX2dldF9leAogICAgYXNzZXJ0IC8vIGNoZWNrIHNlbGYuc2Vjb25kc19wZXJfeWVhciBleGlzdHMKICAgIGludCAxMDAwMAogICAgKgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5MTEtOTEzCiAgICAvLyBpbnRlcmVzdCA9IChyYXRlICogbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAqIHRpbWVfZGVsdGEpIC8vICgKICAgIC8vICAgICBzZWxmLnNlY29uZHNfcGVyX3llYXIgKiAxMDAwMAogICAgLy8gKQogICAgaXRvYgogICAgYi8KICAgIGZyYW1lX2J1cnkgMQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5MTUtOTE2CiAgICAvLyAjIFNwZWNpYWwgaGFuZGxpbmcgZm9yIHN0b2tlbiBtYXJrZXQgLSBhbGwgaW50ZXJlc3QgZ29lcyB0byByZXNlcnZlcwogICAgLy8gaWYgbWFya2V0X2lkID09IHNlbGYuc3Rva2VuX2FwcF9pZDoKICAgIGludCAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjUwOAogICAgLy8gc2VsZi5zdG9rZW5fYXBwX2lkID0gVUludDY0KCkgICMgc3RhYmxlIG1hcmtldAogICAgYnl0ZSAic3Rva2VuX2FwcF9pZCIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6OTE1LTkxNgogICAgLy8gIyBTcGVjaWFsIGhhbmRsaW5nIGZvciBzdG9rZW4gbWFya2V0IC0gYWxsIGludGVyZXN0IGdvZXMgdG8gcmVzZXJ2ZXMKICAgIC8vIGlmIG1hcmtldF9pZCA9PSBzZWxmLnN0b2tlbl9hcHBfaWQ6CiAgICBhcHBfZ2xvYmFsX2dldF9leAogICAgYXNzZXJ0IC8vIGNoZWNrIHNlbGYuc3Rva2VuX2FwcF9pZCBleGlzdHMKICAgIGZyYW1lX2RpZyAtMQogICAgPT0KICAgIGJ6IF9hY2NydWVfaW50ZXJlc3RfZWxzZV9ib2R5QDEyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjkxOAogICAgLy8gZGVwb3NpdG9yX3BvcnRpb24gPSBCaWdVSW50KDApCiAgICBieXRlIDB4CiAgICBmcmFtZV9idXJ5IDAKICAgIGZyYW1lX2RpZyAxCiAgICBmcmFtZV9idXJ5IDMKICAgIGIgX2FjY3J1ZV9pbnRlcmVzdF9hZnRlcl9pZl9lbHNlQDE1CgpfYWNjcnVlX2ludGVyZXN0X2Vsc2VfYm9keUAxMjoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6OTIxCiAgICAvLyBpbnRlcmVzdCAqIGFyYzQuVUludDI1Ni5mcm9tX2J5dGVzKG1hcmtldC5yZXNlcnZlX2ZhY3Rvci5ieXRlcykubmF0aXZlCiAgICBmcmFtZV9kaWcgOQogICAgZXh0cmFjdCA4OSA4IC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgZnJhbWVfZGlnIDEKICAgIGR1cAogICAgdW5jb3ZlciAyCiAgICBiKgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5MjIKICAgIC8vICkgLy8gMTAwMDAKICAgIGJ5dGUgMHgyNzEwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjkyMC05MjIKICAgIC8vIHByb3RvY29sX3BvcnRpb24gPSAoCiAgICAvLyAgICAgaW50ZXJlc3QgKiBhcmM0LlVJbnQyNTYuZnJvbV9ieXRlcyhtYXJrZXQucmVzZXJ2ZV9mYWN0b3IuYnl0ZXMpLm5hdGl2ZQogICAgLy8gKSAvLyAxMDAwMAogICAgYi8KICAgIGR1cAogICAgZnJhbWVfYnVyeSAzCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjkyMwogICAgLy8gaWYgcHJvdG9jb2xfcG9ydGlvbiA+IGludGVyZXN0OgogICAgYjwKICAgIGJ6IF9hY2NydWVfaW50ZXJlc3RfYWZ0ZXJfaWZfZWxzZUAxNAogICAgZnJhbWVfZGlnIDEKICAgIGZyYW1lX2J1cnkgMwoKX2FjY3J1ZV9pbnRlcmVzdF9hZnRlcl9pZl9lbHNlQDE0OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5MjUKICAgIC8vIGRlcG9zaXRvcl9wb3J0aW9uID0gaW50ZXJlc3QgLSBwcm90b2NvbF9wb3J0aW9uCiAgICBmcmFtZV9kaWcgMQogICAgZnJhbWVfZGlnIDMKICAgIGItCiAgICBmcmFtZV9idXJ5IDAKCl9hY2NydWVfaW50ZXJlc3RfYWZ0ZXJfaWZfZWxzZUAxNToKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6OTI3CiAgICAvLyBpZiBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzID4gMDoKICAgIGZyYW1lX2RpZyA5CiAgICBkdXAKICAgIGV4dHJhY3QgMTEzIDMyIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgZHVwCiAgICBmcmFtZV9idXJ5IDQKICAgIGJ5dGUgMHgwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwCiAgICBiPgogICAgc3dhcAogICAgZnJhbWVfYnVyeSAyCiAgICBieiBfYWNjcnVlX2ludGVyZXN0X2FmdGVyX2lmX2Vsc2VAMTcKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6OTI5CiAgICAvLyBtYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUKICAgIGZyYW1lX2RpZyA5CiAgICBkdXAKICAgIGV4dHJhY3QgMTc3IDMyIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5MzAKICAgIC8vICsgKGRlcG9zaXRvcl9wb3J0aW9uICogU0NBTEUpIC8vIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlCiAgICBmcmFtZV9kaWcgMAogICAgYnl0ZSAweDBkZTBiNmIzYTc2NDAwMDAKICAgIGIqCiAgICBmcmFtZV9kaWcgNAogICAgYi8KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6OTI5LTkzMAogICAgLy8gbWFya2V0LmRlcG9zaXRfaW5kZXgubmF0aXZlCiAgICAvLyArIChkZXBvc2l0b3JfcG9ydGlvbiAqIFNDQUxFKSAvLyBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZQogICAgYisKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6OTI4LTkzMQogICAgLy8gbWFya2V0LmRlcG9zaXRfaW5kZXggPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgbWFya2V0LmRlcG9zaXRfaW5kZXgubmF0aXZlCiAgICAvLyAgICAgKyAoZGVwb3NpdG9yX3BvcnRpb24gKiBTQ0FMRSkgLy8gbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cy5uYXRpdmUKICAgIC8vICkKICAgIGR1cAogICAgbGVuCiAgICBpbnQgMzIKICAgIDw9CiAgICBhc3NlcnQgLy8gb3ZlcmZsb3cKICAgIGludCAzMgogICAgYnplcm8KICAgIGJ8CiAgICByZXBsYWNlMiAxNzcKICAgIGZyYW1lX2J1cnkgMgoKX2FjY3J1ZV9pbnRlcmVzdF9hZnRlcl9pZl9lbHNlQDE3OgogICAgZnJhbWVfZGlnIDIKICAgIGR1cAogICAgZnJhbWVfYnVyeSA5CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjkzMgogICAgLy8gaWYgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzID4gMDoKICAgIGR1cAogICAgZXh0cmFjdCAxNDUgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBkdXAKICAgIGZyYW1lX2J1cnkgNQogICAgYnl0ZSAweDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAKICAgIGI+CiAgICBzd2FwCiAgICBmcmFtZV9idXJ5IDIKICAgIGJ6IF9hY2NydWVfaW50ZXJlc3RfYWZ0ZXJfaWZfZWxzZUAxOQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5MzQKICAgIC8vIG1hcmtldC5ib3Jyb3dfaW5kZXgubmF0aXZlCiAgICBmcmFtZV9kaWcgOQogICAgZHVwCiAgICBleHRyYWN0IDIwOSAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6OTM1CiAgICAvLyArIChpbnRlcmVzdCAqIFNDQUxFKSAvLyBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlCiAgICBmcmFtZV9kaWcgMQogICAgYnl0ZSAweDBkZTBiNmIzYTc2NDAwMDAKICAgIGIqCiAgICBmcmFtZV9kaWcgNQogICAgYi8KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6OTM0LTkzNQogICAgLy8gbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUKICAgIC8vICsgKGludGVyZXN0ICogU0NBTEUpIC8vIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUKICAgIGIrCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjkzMy05MzYKICAgIC8vIG1hcmtldC5ib3Jyb3dfaW5kZXggPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUKICAgIC8vICAgICArIChpbnRlcmVzdCAqIFNDQUxFKSAvLyBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlCiAgICAvLyApCiAgICBkdXAKICAgIGxlbgogICAgaW50IDMyCiAgICA8PQogICAgYXNzZXJ0IC8vIG92ZXJmbG93CiAgICBpbnQgMzIKICAgIGJ6ZXJvCiAgICBifAogICAgcmVwbGFjZTIgMjA5CiAgICBmcmFtZV9idXJ5IDIKCl9hY2NydWVfaW50ZXJlc3RfYWZ0ZXJfaWZfZWxzZUAxOToKICAgIGZyYW1lX2RpZyAyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjkzOQogICAgLy8gbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzLm5hdGl2ZSArIGludGVyZXN0CiAgICBkdXAKICAgIGV4dHJhY3QgMTQ1IDMyIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgZnJhbWVfZGlnIDEKICAgIGIrCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjkzOC05NDAKICAgIC8vIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cyA9IGFyYzQuVUludDI1NigKICAgIC8vICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlICsgaW50ZXJlc3QKICAgIC8vICkKICAgIGR1cAogICAgbGVuCiAgICBpbnQgMzIKICAgIDw9CiAgICBhc3NlcnQgLy8gb3ZlcmZsb3cKICAgIGludCAzMgogICAgYnplcm8KICAgIGR1cAogICAgY292ZXIgMwogICAgYnwKICAgIHJlcGxhY2UyIDE0NQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5NDIKICAgIC8vIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlICsgZGVwb3NpdG9yX3BvcnRpb24KICAgIGR1cAogICAgZXh0cmFjdCAxMTMgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBmcmFtZV9kaWcgMAogICAgYisKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6OTQxLTk0MwogICAgLy8gbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cyA9IGFyYzQuVUludDI1NigKICAgIC8vICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSArIGRlcG9zaXRvcl9wb3J0aW9uCiAgICAvLyApCiAgICBkdXAKICAgIGxlbgogICAgaW50IDMyCiAgICA8PQogICAgYXNzZXJ0IC8vIG92ZXJmbG93CiAgICBkaWcgMgogICAgYnwKICAgIHJlcGxhY2UyIDExMwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5NDQKICAgIC8vIG1hcmtldC5yZXNlcnZlcyA9IGFyYzQuVUludDI1NihtYXJrZXQucmVzZXJ2ZXMubmF0aXZlICsgcHJvdG9jb2xfcG9ydGlvbikKICAgIGR1cAogICAgZXh0cmFjdCAyNDkgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBmcmFtZV9kaWcgMwogICAgYisKICAgIGR1cAogICAgbGVuCiAgICBpbnQgMzIKICAgIDw9CiAgICBhc3NlcnQgLy8gb3ZlcmZsb3cKICAgIHVuY292ZXIgMgogICAgYnwKICAgIHJlcGxhY2UyIDI0OQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5NDUKICAgIC8vIG1hcmtldC5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoY3VycmVudF90aW1lKQogICAgZnJhbWVfZGlnIDcKICAgIGl0b2IKICAgIHJlcGxhY2UyIDI0MQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5NDcKICAgIC8vIHNlbGYubWFya2V0c1ttYXJrZXRfaWRdID0gbWFya2V0LmNvcHkoKQogICAgZnJhbWVfZGlnIC0xCiAgICBpdG9iCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjUxMAogICAgLy8gc2VsZi5tYXJrZXRzID0gQm94TWFwKFVJbnQ2NCwgTWFya2V0RGF0YSkgICMgTWFya2V0IHN0YXRlCiAgICBieXRlICJtYXJrZXRzIgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5NDcKICAgIC8vIHNlbGYubWFya2V0c1ttYXJrZXRfaWRdID0gbWFya2V0LmNvcHkoKQogICAgc3dhcAogICAgY29uY2F0CiAgICBkaWcgMQogICAgYm94X3B1dAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo5NDgKICAgIC8vIHJldHVybiBtYXJrZXQuY29weSgpCiAgICBmcmFtZV9idXJ5IDAKICAgIHJldHN1YgoKCi8vIGNvbnRyYWN0LkxlbmRpbmdQb29sLl9pbmNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2RlcG9zaXRzKG1hcmtldF9pZDogdWludDY0LCB1c2VyX2lkOiBieXRlcywgYW1vdW50OiBieXRlcykgLT4gdm9pZDoKX2luY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfZGVwb3NpdHM6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjYyOC02MzEKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2luY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfZGVwb3NpdHMoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIHVzZXJfaWQ6IEFjY291bnQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgcHJvdG8gMyAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjYzMgogICAgLy8gbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICBmcmFtZV9kaWcgLTMKICAgIGNhbGxzdWIgX2dldF9tYXJrZXQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NjMzCiAgICAvLyB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgZnJhbWVfZGlnIC0yCiAgICBmcmFtZV9kaWcgLTMKICAgIGNhbGxzdWIgX2dldF91c2VyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjYzNAogICAgLy8gdXNlcl9rZXkgPSBzZWxmLl9nZXRfdXNlcl9rZXkodXNlcl9pZCwgbWFya2V0X2lkKQogICAgZnJhbWVfZGlnIC0yCiAgICBmcmFtZV9kaWcgLTMKICAgIGNhbGxzdWIgX2dldF91c2VyX2tleQogICAgY292ZXIgMgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo2MzUKICAgIC8vIHVzZXIuc2NhbGVkX2RlcG9zaXRzID0gYXJjNC5VSW50MjU2KHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSArIGFtb3VudCkKICAgIGR1cAogICAgZXh0cmFjdCAwIDMyIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgZnJhbWVfZGlnIC0xCiAgICBiKwogICAgZHVwCiAgICBsZW4KICAgIGludCAzMgogICAgPD0KICAgIGFzc2VydCAvLyBvdmVyZmxvdwogICAgaW50IDMyCiAgICBiemVybwogICAgYnwKICAgIHJlcGxhY2UyIDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NjM2CiAgICAvLyB1c2VyLmRlcG9zaXRfaW5kZXggPSBtYXJrZXQuZGVwb3NpdF9pbmRleAogICAgZGlnIDEKICAgIGV4dHJhY3QgMTc3IDMyIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgcmVwbGFjZTIgNjQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NjM3CiAgICAvLyB1c2VyLmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIGdsb2JhbCBMYXRlc3RUaW1lc3RhbXAKICAgIGl0b2IKICAgIHJlcGxhY2UyIDEyOAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo2MzgKICAgIC8vIHVzZXIubGFzdF9wcmljZSA9IG1hcmtldC5wcmljZSAgIyBVcGRhdGUgdXNlcidzIGxhc3Qga25vd24gcHJpY2UKICAgIHN3YXAKICAgIGludCAyODEKICAgIGludCAzMgogICAgZXh0cmFjdDMgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICByZXBsYWNlMiAxMzYKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTExCiAgICAvLyBzZWxmLnVzZXJzID0gQm94TWFwKEJ5dGVzNDAsIFVzZXJEYXRhKSAgIyBQZXItbWFya2V0IHVzZXIgc3RhdGUKICAgIGJ5dGUgInVzZXJzIgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo2MzkKICAgIC8vIHNlbGYudXNlcnNbdXNlcl9rZXldID0gdXNlci5jb3B5KCkKICAgIHVuY292ZXIgMgogICAgY29uY2F0CiAgICBzd2FwCiAgICBib3hfcHV0CiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5faW5jcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfZGVwb3NpdHMobWFya2V0X2lkOiB1aW50NjQsIGFtb3VudDogYnl0ZXMpIC0+IHZvaWQ6Cl9pbmNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9kZXBvc2l0czoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODI4LTgzMQogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaW5jcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfZGVwb3NpdHMoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgcHJvdG8gMiAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjgzMgogICAgLy8gbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICBmcmFtZV9kaWcgLTIKICAgIGNhbGxzdWIgX2dldF9tYXJrZXQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODM0CiAgICAvLyBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSArIGFtb3VudAogICAgZHVwCiAgICBleHRyYWN0IDExMyAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIGZyYW1lX2RpZyAtMQogICAgYisKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODMzLTgzNQogICAgLy8gbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cyA9IGFyYzQuVUludDI1NigKICAgIC8vICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSArIGFtb3VudAogICAgLy8gKQogICAgZHVwCiAgICBsZW4KICAgIGludCAzMgogICAgPD0KICAgIGFzc2VydCAvLyBvdmVyZmxvdwogICAgaW50IDMyCiAgICBiemVybwogICAgYnwKICAgIHJlcGxhY2UyIDExMwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo4MzYKICAgIC8vIG1hcmtldC5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApCiAgICBnbG9iYWwgTGF0ZXN0VGltZXN0YW1wCiAgICBpdG9iCiAgICByZXBsYWNlMiAyNDEKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODM3CiAgICAvLyBzZWxmLm1hcmtldHNbbWFya2V0X2lkXSA9IG1hcmtldC5jb3B5KCkKICAgIGZyYW1lX2RpZyAtMgogICAgaXRvYgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1MTAKICAgIC8vIHNlbGYubWFya2V0cyA9IEJveE1hcChVSW50NjQsIE1hcmtldERhdGEpICAjIE1hcmtldCBzdGF0ZQogICAgYnl0ZSAibWFya2V0cyIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODM3CiAgICAvLyBzZWxmLm1hcmtldHNbbWFya2V0X2lkXSA9IG1hcmtldC5jb3B5KCkKICAgIHN3YXAKICAgIGNvbmNhdAogICAgc3dhcAogICAgYm94X3B1dAogICAgcmV0c3ViCgoKLy8gY29udHJhY3QuTGVuZGluZ1Bvb2wuX3VwZGF0ZV9nbG9iYWxfY29sbGF0ZXJhbCh1c2VyX2lkOiBieXRlcywgbWFya2V0X2lkOiB1aW50NjQsIG9sZF92YWx1ZTogYnl0ZXMsIG5ld192YWx1ZTogYnl0ZXMpIC0+IHZvaWQ6Cl91cGRhdGVfZ2xvYmFsX2NvbGxhdGVyYWw6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE0MjMtMTQzMAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfdXBkYXRlX2dsb2JhbF9jb2xsYXRlcmFsKAogICAgLy8gICAgIHNlbGYsCiAgICAvLyAgICAgdXNlcl9pZDogQWNjb3VudCwKICAgIC8vICAgICBtYXJrZXRfaWQ6IFVJbnQ2NCwKICAgIC8vICAgICBvbGRfdmFsdWU6IEJpZ1VJbnQsCiAgICAvLyAgICAgbmV3X3ZhbHVlOiBCaWdVSW50LAogICAgLy8gKSAtPiBOb25lOgogICAgcHJvdG8gNCAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE0MzEKICAgIC8vIGdsb2JhbF91c2VyID0gc2VsZi5fZ2V0X2dsb2JhbF91c2VyKHVzZXJfaWQpCiAgICBmcmFtZV9kaWcgLTQKICAgIGNhbGxzdWIgX2dldF9nbG9iYWxfdXNlcgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNDM0CiAgICAvLyBnbG9iYWxfdXNlci50b3RhbF9jb2xsYXRlcmFsX3ZhbHVlLm5hdGl2ZSAtIG9sZF92YWx1ZSArIG5ld192YWx1ZQogICAgZHVwCiAgICBleHRyYWN0IDAgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBmcmFtZV9kaWcgLTIKICAgIGItCiAgICBmcmFtZV9kaWcgLTEKICAgIGIrCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE0MzMtMTQzNQogICAgLy8gZ2xvYmFsX3VzZXIudG90YWxfY29sbGF0ZXJhbF92YWx1ZSA9IGFyYzQuVUludDI1NigKICAgIC8vICAgICBnbG9iYWxfdXNlci50b3RhbF9jb2xsYXRlcmFsX3ZhbHVlLm5hdGl2ZSAtIG9sZF92YWx1ZSArIG5ld192YWx1ZQogICAgLy8gKQogICAgZHVwCiAgICBsZW4KICAgIGludCAzMgogICAgPD0KICAgIGFzc2VydCAvLyBvdmVyZmxvdwogICAgaW50IDMyCiAgICBiemVybwogICAgYnwKICAgIHJlcGxhY2UyIDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTQzNgogICAgLy8gZ2xvYmFsX3VzZXIubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgZ2xvYmFsIExhdGVzdFRpbWVzdGFtcAogICAgaXRvYgogICAgcmVwbGFjZTIgNjQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTEyCiAgICAvLyBzZWxmLmdsb2JhbF91c2VycyA9IEJveE1hcChBY2NvdW50LCBHbG9iYWxVc2VyRGF0YSkgICMgR2xvYmFsIHVzZXIgc3RhdGUKICAgIGJ5dGUgImdsb2JhbF91c2VycyIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTQzOAogICAgLy8gc2VsZi5nbG9iYWxfdXNlcnNbdXNlcl9pZF0gPSBnbG9iYWxfdXNlci5jb3B5KCkKICAgIGZyYW1lX2RpZyAtNAogICAgY29uY2F0CiAgICBzd2FwCiAgICBib3hfcHV0CiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5fZ2V0X2dsb2JhbF91c2VyKHVzZXJfaWQ6IGJ5dGVzKSAtPiBieXRlczoKX2dldF9nbG9iYWxfdXNlcjoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTQxMS0xNDEyCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9nZXRfZ2xvYmFsX3VzZXIoc2VsZiwgdXNlcl9pZDogQWNjb3VudCkgLT4gR2xvYmFsVXNlckRhdGE6CiAgICBwcm90byAxIDEKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTEyCiAgICAvLyBzZWxmLmdsb2JhbF91c2VycyA9IEJveE1hcChBY2NvdW50LCBHbG9iYWxVc2VyRGF0YSkgICMgR2xvYmFsIHVzZXIgc3RhdGUKICAgIGJ5dGUgImdsb2JhbF91c2VycyIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTQxNC0xNDIxCiAgICAvLyByZXR1cm4gc2VsZi5nbG9iYWxfdXNlcnMuZ2V0KAogICAgLy8gICAgIHVzZXJfaWQsCiAgICAvLyAgICAgZGVmYXVsdD1HbG9iYWxVc2VyRGF0YSgKICAgIC8vICAgICAgICAgdG90YWxfY29sbGF0ZXJhbF92YWx1ZT1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgIHRvdGFsX2JvcnJvd192YWx1ZT1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgIGxhc3RfdXBkYXRlX3RpbWU9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgKSwKICAgIC8vICkKICAgIGZyYW1lX2RpZyAtMQogICAgY29uY2F0CiAgICBib3hfZ2V0CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE0MTYtMTQyMAogICAgLy8gZGVmYXVsdD1HbG9iYWxVc2VyRGF0YSgKICAgIC8vICAgICB0b3RhbF9jb2xsYXRlcmFsX3ZhbHVlPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICB0b3RhbF9ib3Jyb3dfdmFsdWU9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgIGxhc3RfdXBkYXRlX3RpbWU9YXJjNC5VSW50NjQoMCksCiAgICAvLyApLAogICAgYnl0ZSAweDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNDE0LTE0MjEKICAgIC8vIHJldHVybiBzZWxmLmdsb2JhbF91c2Vycy5nZXQoCiAgICAvLyAgICAgdXNlcl9pZCwKICAgIC8vICAgICBkZWZhdWx0PUdsb2JhbFVzZXJEYXRhKAogICAgLy8gICAgICAgICB0b3RhbF9jb2xsYXRlcmFsX3ZhbHVlPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgdG90YWxfYm9ycm93X3ZhbHVlPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgbGFzdF91cGRhdGVfdGltZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICApLAogICAgLy8gKQogICAgY292ZXIgMgogICAgc2VsZWN0CiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC53aXRoZHJhdyhtYXJrZXRfaWQ6IGJ5dGVzLCBhbW91bnQ6IGJ5dGVzKSAtPiB2b2lkOgp3aXRoZHJhdzoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTAyNy0xMDI4CiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiB3aXRoZHJhdyhzZWxmLCBtYXJrZXRfaWQ6IGFyYzQuVUludDY0LCBhbW91bnQ6IGFyYzQuVUludDI1NikgLT4gTm9uZToKICAgIHByb3RvIDIgMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDMwCiAgICAvLyBzZWxmLnN0b2tlbl9hcHBfaWQgIT0gbWFya2V0X2lkLm5hdGl2ZQogICAgaW50IDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTA4CiAgICAvLyBzZWxmLnN0b2tlbl9hcHBfaWQgPSBVSW50NjQoKSAgIyBzdGFibGUgbWFya2V0CiAgICBieXRlICJzdG9rZW5fYXBwX2lkIgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDMwCiAgICAvLyBzZWxmLnN0b2tlbl9hcHBfaWQgIT0gbWFya2V0X2lkLm5hdGl2ZQogICAgYXBwX2dsb2JhbF9nZXRfZXgKICAgIGFzc2VydCAvLyBjaGVjayBzZWxmLnN0b2tlbl9hcHBfaWQgZXhpc3RzCiAgICBmcmFtZV9kaWcgLTIKICAgIGJ0b2kKICAgIGR1cAogICAgY292ZXIgMgogICAgIT0KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTAyOS0xMDMxCiAgICAvLyBhc3NlcnQgKAogICAgLy8gICAgIHNlbGYuc3Rva2VuX2FwcF9pZCAhPSBtYXJrZXRfaWQubmF0aXZlCiAgICAvLyApLCAiQ2Fubm90IGRlcG9zaXQgaW50byBzdG9rZW4gbWFya2V0IgogICAgYXNzZXJ0IC8vIENhbm5vdCBkZXBvc2l0IGludG8gc3Rva2VuIG1hcmtldAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDMyCiAgICAvLyBlbnN1cmVfYnVkZ2V0KDcwMCwgT3BVcEZlZVNvdXJjZS5Hcm91cENyZWRpdCkKICAgIGludCA3MDAKICAgIGludCAwCiAgICBjYWxsc3ViIGVuc3VyZV9idWRnZXQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTAzMwogICAgLy8gc2VsZi5fd2l0aGRyYXcobWFya2V0X2lkLm5hdGl2ZSwgYW1vdW50Lm5hdGl2ZSkKICAgIGZyYW1lX2RpZyAtMQogICAgY2FsbHN1YiBfd2l0aGRyYXcKICAgIHJldHN1YgoKCi8vIGFsZ29weS5lbnN1cmVfYnVkZ2V0KHJlcXVpcmVkX2J1ZGdldDogdWludDY0LCBmZWVfc291cmNlOiB1aW50NjQpIC0+IHZvaWQ6CmVuc3VyZV9idWRnZXQ6CiAgICAvLyA8YWxnb3B5Pi9hbGdvcHkucHk6MTEtMTcKICAgIHByb3RvIDIgMAogICAgLy8gPGFsZ29weT4vYWxnb3B5LnB5OjE4CiAgICBmcmFtZV9kaWcgLTIKICAgIGludCAxMAogICAgKwoKZW5zdXJlX2J1ZGdldF93aGlsZV90b3BAMToKICAgIC8vIDxhbGdvcHk+L2FsZ29weS5weToxOQogICAgZnJhbWVfZGlnIDAKICAgIGdsb2JhbCBPcGNvZGVCdWRnZXQKICAgID4KICAgIGJ6IGVuc3VyZV9idWRnZXRfYWZ0ZXJfd2hpbGVANwogICAgLy8gPGFsZ29weT4vYWxnb3B5LnB5OjIwCiAgICBpdHhuX2JlZ2luCiAgICAvLyA8YWxnb3B5Pi9hbGdvcHkucHk6MjEKICAgIGludCBhcHBsCiAgICBpdHhuX2ZpZWxkIFR5cGVFbnVtCiAgICAvLyA8YWxnb3B5Pi9hbGdvcHkucHk6MjIKICAgIGludCBEZWxldGVBcHBsaWNhdGlvbgogICAgaXR4bl9maWVsZCBPbkNvbXBsZXRpb24KICAgIC8vIDxhbGdvcHk+L2FsZ29weS5weToyMwogICAgYnl0ZSAweDA2ODEwMQogICAgaXR4bl9maWVsZCBBcHByb3ZhbFByb2dyYW0KICAgIC8vIDxhbGdvcHk+L2FsZ29weS5weToyNAogICAgYnl0ZSAweDA2ODEwMQogICAgaXR4bl9maWVsZCBDbGVhclN0YXRlUHJvZ3JhbQogICAgLy8gPGFsZ29weT4vYWxnb3B5LnB5OjI1LTI5CiAgICBmcmFtZV9kaWcgLTEKICAgIHN3aXRjaCBlbnN1cmVfYnVkZ2V0X3N3aXRjaF9jYXNlXzBAMyBlbnN1cmVfYnVkZ2V0X3N3aXRjaF9jYXNlXzFANAogICAgYiBlbnN1cmVfYnVkZ2V0X3N3aXRjaF9jYXNlX25leHRANgoKZW5zdXJlX2J1ZGdldF9zd2l0Y2hfY2FzZV8wQDM6CiAgICAvLyA8YWxnb3B5Pi9hbGdvcHkucHk6MjcKICAgIGludCAwCiAgICBpdHhuX2ZpZWxkIEZlZQogICAgYiBlbnN1cmVfYnVkZ2V0X3N3aXRjaF9jYXNlX25leHRANgoKZW5zdXJlX2J1ZGdldF9zd2l0Y2hfY2FzZV8xQDQ6CiAgICAvLyA8YWxnb3B5Pi9hbGdvcHkucHk6MjkKICAgIGdsb2JhbCBNaW5UeG5GZWUKICAgIGl0eG5fZmllbGQgRmVlCgplbnN1cmVfYnVkZ2V0X3N3aXRjaF9jYXNlX25leHRANjoKICAgIC8vIDxhbGdvcHk+L2FsZ29weS5weTozMAogICAgaXR4bl9zdWJtaXQKICAgIGIgZW5zdXJlX2J1ZGdldF93aGlsZV90b3BAMQoKZW5zdXJlX2J1ZGdldF9hZnRlcl93aGlsZUA3OgogICAgcmV0c3ViCgoKLy8gY29udHJhY3QuTGVuZGluZ1Bvb2wuX3dpdGhkcmF3KG1hcmtldF9pZDogdWludDY0LCBhbW91bnQ6IGJ5dGVzKSAtPiB2b2lkOgpfd2l0aGRyYXc6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwMzUtMTAzNgogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfd2l0aGRyYXcoc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIGFtb3VudDogQmlnVUludCkgLT4gTm9uZToKICAgIHByb3RvIDIgMAogICAgaW50IDAKICAgIGR1cG4gMgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDM3CiAgICAvLyBzZWxmLl92YWxpZGF0ZV9tYXJrZXRfb3BlcmF0aW9uKG1hcmtldF9pZCwgYW1vdW50LCBUcnVlKQogICAgZnJhbWVfZGlnIC0yCiAgICBmcmFtZV9kaWcgLTEKICAgIGludCAxCiAgICBjYWxsc3ViIF92YWxpZGF0ZV9tYXJrZXRfb3BlcmF0aW9uCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwMzkKICAgIC8vIG5ld19tYXJrZXQgPSBzZWxmLl9hY2NydWVfaW50ZXJlc3QobWFya2V0X2lkKQogICAgZnJhbWVfZGlnIC0yCiAgICBjYWxsc3ViIF9hY2NydWVfaW50ZXJlc3QKICAgIGR1cAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDQwCiAgICAvLyB1c2VyID0gc2VsZi5fZ2V0X3VzZXIoVHhuLnNlbmRlciwgbWFya2V0X2lkKQogICAgdHhuIFNlbmRlcgogICAgZnJhbWVfZGlnIC0yCiAgICBjYWxsc3ViIF9nZXRfdXNlcgogICAgZHVwCiAgICB1bmNvdmVyIDIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTA0MgogICAgLy8gc2NhbGVkX2Ftb3VudCA9IChhbW91bnQgKiBTQ0FMRSkgLy8gbmV3X21hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZQogICAgZnJhbWVfZGlnIC0xCiAgICBieXRlIDB4MGRlMGI2YjNhNzY0MDAwMAogICAgYioKICAgIGRpZyAxCiAgICBleHRyYWN0IDE3NyAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIGR1cAogICAgY292ZXIgNAogICAgZHVwCiAgICBjb3ZlciAzCiAgICBiLwogICAgZHVwCiAgICBjb3ZlciA0CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwNDQKICAgIC8vIHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSA+PSBzY2FsZWRfYW1vdW50CiAgICB1bmNvdmVyIDMKICAgIGV4dHJhY3QgMCAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIGR1cAogICAgY292ZXIgNAogICAgZGlnIDEKICAgIGI+PQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDQzLTEwNDUKICAgIC8vIGFzc2VydCAoCiAgICAvLyAgICAgdXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlID49IHNjYWxlZF9hbW91bnQKICAgIC8vICksICJJbnN1ZmZpY2llbnQgYmFsYW5jZSB0byB3aXRoZHJhdyB0aGlzIGFtb3VudCIKICAgIGFzc2VydCAvLyBJbnN1ZmZpY2llbnQgYmFsYW5jZSB0byB3aXRoZHJhdyB0aGlzIGFtb3VudAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDQ2CiAgICAvLyB1bmRlcmx5aW5nX2Ftb3VudCA9IChzY2FsZWRfYW1vdW50ICogbmV3X21hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZSkgLy8gU0NBTEUKICAgIHVuY292ZXIgMgogICAgYioKICAgIGJ5dGUgMHgwZGUwYjZiM2E3NjQwMDAwCiAgICBiLwogICAgZHVwCiAgICBjb3ZlciAyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwNDgKICAgIC8vIGdsb2JhbF91c2VyID0gc2VsZi5fZ2V0X2dsb2JhbF91c2VyKFR4bi5zZW5kZXIpCiAgICB0eG4gU2VuZGVyCiAgICBjYWxsc3ViIF9nZXRfZ2xvYmFsX3VzZXIKICAgIGR1cAogICAgY292ZXIgMgogICAgY292ZXIgMwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDUwCiAgICAvLyB1bmRlcmx5aW5nX2Ftb3VudCAqIG5ld19tYXJrZXQucHJpY2UubmF0aXZlCiAgICB1bmNvdmVyIDIKICAgIGludCAyODEKICAgIGludCAzMgogICAgZXh0cmFjdDMgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBkdXAKICAgIGNvdmVyIDMKICAgIGIqCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwNTEKICAgIC8vICkgLy8gU0NBTEUgICMgVXNlIHVuZGVybHlpbmdfYW1vdW50IGFuZCBuZXdfbWFya2V0IHByaWNlCiAgICBieXRlIDB4MGRlMGI2YjNhNzY0MDAwMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDQ5LTEwNTEKICAgIC8vIHdpdGhkcmF3X3ZhbHVlID0gKAogICAgLy8gICAgIHVuZGVybHlpbmdfYW1vdW50ICogbmV3X21hcmtldC5wcmljZS5uYXRpdmUKICAgIC8vICkgLy8gU0NBTEUgICMgVXNlIHVuZGVybHlpbmdfYW1vdW50IGFuZCBuZXdfbWFya2V0IHByaWNlCiAgICBiLwogICAgc3dhcAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDUzCiAgICAvLyBpZiBnbG9iYWxfdXNlci50b3RhbF9ib3Jyb3dfdmFsdWUgPiAwOgogICAgZXh0cmFjdCAzMiAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIGR1cAogICAgYnl0ZSAweDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAKICAgIGI+CiAgICBieiBfd2l0aGRyYXdfYWZ0ZXJfaWZfZWxzZUAyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwNTUKICAgIC8vIGdsb2JhbF91c2VyLnRvdGFsX2NvbGxhdGVyYWxfdmFsdWUubmF0aXZlIC0gd2l0aGRyYXdfdmFsdWUKICAgIGZyYW1lX2RpZyA5CiAgICBleHRyYWN0IDAgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwNTQtMTA1NgogICAgLy8gcmVtYWluaW5nX2NvbGxhdGVyYWwgPSAoCiAgICAvLyAgICAgZ2xvYmFsX3VzZXIudG90YWxfY29sbGF0ZXJhbF92YWx1ZS5uYXRpdmUgLSB3aXRoZHJhd192YWx1ZQogICAgLy8gKQogICAgZnJhbWVfZGlnIDExCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwNTUKICAgIC8vIGdsb2JhbF91c2VyLnRvdGFsX2NvbGxhdGVyYWxfdmFsdWUubmF0aXZlIC0gd2l0aGRyYXdfdmFsdWUKICAgIGItCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwNTgKICAgIC8vIHJlbWFpbmluZ19jb2xsYXRlcmFsICogQmlnVUludChuZXdfbWFya2V0LmNvbGxhdGVyYWxfZmFjdG9yLm5hdGl2ZSkKICAgIGZyYW1lX2RpZyAzCiAgICBleHRyYWN0IDczIDggLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBidG9pCiAgICBpdG9iCiAgICBiKgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDU5CiAgICAvLyApIC8vIEJpZ1VJbnQoMTAwMDApLCAiV2l0aGRyYXdhbCB3b3VsZCBwdXQgYm9ycm93cyBhdCByaXNrIgogICAgYnl0ZSAweDI3MTAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTA1Ny0xMDU5CiAgICAvLyBhc3NlcnQgZ2xvYmFsX3VzZXIudG90YWxfYm9ycm93X3ZhbHVlLm5hdGl2ZSA8PSAoCiAgICAvLyAgICAgcmVtYWluaW5nX2NvbGxhdGVyYWwgKiBCaWdVSW50KG5ld19tYXJrZXQuY29sbGF0ZXJhbF9mYWN0b3IubmF0aXZlKQogICAgLy8gKSAvLyBCaWdVSW50KDEwMDAwKSwgIldpdGhkcmF3YWwgd291bGQgcHV0IGJvcnJvd3MgYXQgcmlzayIKICAgIGIvCiAgICBmcmFtZV9kaWcgMTIKICAgIGI+PQogICAgYXNzZXJ0IC8vIFdpdGhkcmF3YWwgd291bGQgcHV0IGJvcnJvd3MgYXQgcmlzawoKX3dpdGhkcmF3X2FmdGVyX2lmX2Vsc2VAMjoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTA2MS0xMDYzCiAgICAvLyBzZWxmLl9kZWNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2RlcG9zaXRzKAogICAgLy8gICAgIG1hcmtldF9pZCwgVHhuLnNlbmRlciwgc2NhbGVkX2Ftb3VudAogICAgLy8gKQogICAgZnJhbWVfZGlnIC0yCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwNjIKICAgIC8vIG1hcmtldF9pZCwgVHhuLnNlbmRlciwgc2NhbGVkX2Ftb3VudAogICAgdHhuIFNlbmRlcgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDYxLTEwNjMKICAgIC8vIHNlbGYuX2RlY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfZGVwb3NpdHMoCiAgICAvLyAgICAgbWFya2V0X2lkLCBUeG4uc2VuZGVyLCBzY2FsZWRfYW1vdW50CiAgICAvLyApCiAgICBmcmFtZV9kaWcgNgogICAgZHVwCiAgICBjb3ZlciAzCiAgICBjYWxsc3ViIF9kZWNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2RlcG9zaXRzCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwNjQKICAgIC8vIHNlbGYuX2RlY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2RlcG9zaXRzKG1hcmtldF9pZCwgc2NhbGVkX2Ftb3VudCkKICAgIGZyYW1lX2RpZyAtMgogICAgc3dhcAogICAgY2FsbHN1YiBfZGVjcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfZGVwb3NpdHMKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTA2Ni0xMDcxCiAgICAvLyBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgIE5Ub2tlbi5idXJuX2Zyb20sCiAgICAvLyAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgIGFyYzQuVUludDI1NihhbW91bnQpLAogICAgLy8gICAgIGFwcF9pZD1BcHBsaWNhdGlvbihuZXdfbWFya2V0Lm50b2tlbl9pZC5uYXRpdmUpLAogICAgLy8gKQogICAgaXR4bl9iZWdpbgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDY4CiAgICAvLyBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICB0eG4gU2VuZGVyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwNjkKICAgIC8vIGFyYzQuVUludDI1NihhbW91bnQpLAogICAgZnJhbWVfZGlnIC0xCiAgICBsZW4KICAgIGludCAzMgogICAgPD0KICAgIGFzc2VydCAvLyBvdmVyZmxvdwogICAgaW50IDMyCiAgICBiemVybwogICAgZnJhbWVfZGlnIC0xCiAgICBkaWcgMQogICAgYnwKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTA3MAogICAgLy8gYXBwX2lkPUFwcGxpY2F0aW9uKG5ld19tYXJrZXQubnRva2VuX2lkLm5hdGl2ZSksCiAgICBmcmFtZV9kaWcgMwogICAgaW50IDMxMwogICAgaW50IDgKICAgIGV4dHJhY3QzIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgYnRvaQogICAgaXR4bl9maWVsZCBBcHBsaWNhdGlvbklECiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwNjYtMTA3MQogICAgLy8gYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICBOVG9rZW4uYnVybl9mcm9tLAogICAgLy8gICAgIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIC8vICAgICBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIC8vICAgICBhcHBfaWQ9QXBwbGljYXRpb24obmV3X21hcmtldC5udG9rZW5faWQubmF0aXZlKSwKICAgIC8vICkKICAgIG1ldGhvZCAiYnVybl9mcm9tKGFkZHJlc3MsdWludDI1Nil2b2lkIgogICAgaXR4bl9maWVsZCBBcHBsaWNhdGlvbkFyZ3MKICAgIHVuY292ZXIgMgogICAgaXR4bl9maWVsZCBBcHBsaWNhdGlvbkFyZ3MKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICBpbnQgYXBwbAogICAgaXR4bl9maWVsZCBUeXBlRW51bQogICAgaW50IDAKICAgIGl0eG5fZmllbGQgRmVlCiAgICBpdHhuX3N1Ym1pdAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDczLTEwODAKICAgIC8vIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgQVJDMjAwVG9rZW5JbnRlcmZhY2UuYXJjMjAwX3RyYW5zZmVyLAogICAgLy8gICAgIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIC8vICAgICBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgIHVuZGVybHlpbmdfYW1vdW50CiAgICAvLyAgICAgKSwgICMgVXNlIHVuZGVybHlpbmdfYW1vdW50IHdoaWNoIGluY2x1ZGVzIGludGVyZXN0CiAgICAvLyAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldF9pZCksICAjIFRyYW5zZmVyIGZyb20gdW5kZXJseWluZyB0b2tlbiBjb250cmFjdAogICAgLy8gKQogICAgaXR4bl9iZWdpbgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDc1CiAgICAvLyBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICB0eG4gU2VuZGVyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwNzYtMTA3OAogICAgLy8gYXJjNC5VSW50MjU2KAogICAgLy8gICAgIHVuZGVybHlpbmdfYW1vdW50CiAgICAvLyApLCAgIyBVc2UgdW5kZXJseWluZ19hbW91bnQgd2hpY2ggaW5jbHVkZXMgaW50ZXJlc3QKICAgIGZyYW1lX2RpZyA4CiAgICBkdXAKICAgIGxlbgogICAgaW50IDMyCiAgICA8PQogICAgYXNzZXJ0IC8vIG92ZXJmbG93CiAgICBkdXAKICAgIHVuY292ZXIgMwogICAgYnwKICAgIGZyYW1lX2RpZyAtMgogICAgaXR4bl9maWVsZCBBcHBsaWNhdGlvbklECiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwNzMtMTA4MAogICAgLy8gYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICBBUkMyMDBUb2tlbkludGVyZmFjZS5hcmMyMDBfdHJhbnNmZXIsCiAgICAvLyAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgIGFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgdW5kZXJseWluZ19hbW91bnQKICAgIC8vICAgICApLCAgIyBVc2UgdW5kZXJseWluZ19hbW91bnQgd2hpY2ggaW5jbHVkZXMgaW50ZXJlc3QKICAgIC8vICAgICBhcHBfaWQ9QXBwbGljYXRpb24obWFya2V0X2lkKSwgICMgVHJhbnNmZXIgZnJvbSB1bmRlcmx5aW5nIHRva2VuIGNvbnRyYWN0CiAgICAvLyApCiAgICBtZXRob2QgImFyYzIwMF90cmFuc2ZlcihhZGRyZXNzLHVpbnQyNTYpYm9vbCIKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICB1bmNvdmVyIDIKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICBpdHhuX2ZpZWxkIEFwcGxpY2F0aW9uQXJncwogICAgaW50IGFwcGwKICAgIGl0eG5fZmllbGQgVHlwZUVudW0KICAgIGludCAwCiAgICBpdHhuX2ZpZWxkIEZlZQogICAgaXR4bl9zdWJtaXQKICAgIGl0eG4gTGFzdExvZwogICAgZXh0cmFjdCAwIDQKICAgIGJ5dGUgMHgxNTFmN2M3NQogICAgPT0KICAgIGFzc2VydCAvLyBBUkM0IHByZWZpeCBpcyB2YWxpZAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDgzCiAgICAvLyB1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKiBuZXdfbWFya2V0LmRlcG9zaXRfaW5kZXgubmF0aXZlCiAgICBmcmFtZV9kaWcgNwogICAgZnJhbWVfZGlnIDUKICAgIGIqCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwODQKICAgIC8vICkgLy8gU0NBTEUKICAgIGJ5dGUgMHgwZGUwYjZiM2E3NjQwMDAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwODItMTA4NAogICAgLy8gb2xkX2RlcG9zaXRfYW1vdW50ID0gKAogICAgLy8gICAgIHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSAqIG5ld19tYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUKICAgIC8vICkgLy8gU0NBTEUKICAgIGIvCiAgICBkdXAKICAgIGZyYW1lX2J1cnkgMQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDg1CiAgICAvLyBuZXdfZGVwb3NpdF9hbW91bnQgPSBvbGRfZGVwb3NpdF9hbW91bnQgLSB1bmRlcmx5aW5nX2Ftb3VudAogICAgc3dhcAogICAgYi0KICAgIGZyYW1lX2J1cnkgMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDkwCiAgICAvLyBpZiB1c2VyLmxhc3RfcHJpY2UubmF0aXZlID4gMAogICAgZnJhbWVfZGlnIDQKICAgIGV4dHJhY3QgMTM2IDMyIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgZHVwCiAgICBmcmFtZV9idXJ5IDIKICAgIGJ5dGUgMHgKICAgIGI+CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwODktMTA5MQogICAgLy8gdXNlci5sYXN0X3ByaWNlLm5hdGl2ZQogICAgLy8gaWYgdXNlci5sYXN0X3ByaWNlLm5hdGl2ZSA+IDAKICAgIC8vIGVsc2UgbmV3X21hcmtldC5wcmljZS5uYXRpdmUKICAgIGJ6IF93aXRoZHJhd190ZXJuYXJ5X2ZhbHNlQDYKICAgIGZyYW1lX2RpZyAyCiAgICBiIF93aXRoZHJhd190ZXJuYXJ5X21lcmdlQDcKCl93aXRoZHJhd190ZXJuYXJ5X2ZhbHNlQDY6CiAgICBmcmFtZV9kaWcgMTAKCl93aXRoZHJhd190ZXJuYXJ5X21lcmdlQDc6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwOTYKICAgIC8vIG9sZF9kZXBvc2l0X2Ftb3VudCAqIHByaWNlX2Zvcl9vbGQKICAgIGZyYW1lX2RpZyAxCiAgICBiKgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDk3CiAgICAvLyApIC8vIFNDQUxFICAjIFVzZSB1c2VyJ3MgbGFzdCBrbm93biBwcmljZSBvciBjdXJyZW50IHByaWNlCiAgICBieXRlIDB4MGRlMGI2YjNhNzY0MDAwMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDk1LTEwOTcKICAgIC8vIG9sZF92YWx1ZSA9ICgKICAgIC8vICAgICBvbGRfZGVwb3NpdF9hbW91bnQgKiBwcmljZV9mb3Jfb2xkCiAgICAvLyApIC8vIFNDQUxFICAjIFVzZSB1c2VyJ3MgbGFzdCBrbm93biBwcmljZSBvciBjdXJyZW50IHByaWNlCiAgICBiLwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDk5CiAgICAvLyBuZXdfZGVwb3NpdF9hbW91bnQgKiBwcmljZV9mb3JfbmV3CiAgICBmcmFtZV9kaWcgMAogICAgZnJhbWVfZGlnIDEwCiAgICBiKgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMTAwCiAgICAvLyApIC8vIFNDQUxFICAjIFVzZSBjdXJyZW50IG1hcmtldCBwcmljZQogICAgYnl0ZSAweDBkZTBiNmIzYTc2NDAwMDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTA5OC0xMTAwCiAgICAvLyBuZXdfdmFsdWUgPSAoCiAgICAvLyAgICAgbmV3X2RlcG9zaXRfYW1vdW50ICogcHJpY2VfZm9yX25ldwogICAgLy8gKSAvLyBTQ0FMRSAgIyBVc2UgY3VycmVudCBtYXJrZXQgcHJpY2UKICAgIGIvCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExMDIKICAgIC8vIFR4bi5zZW5kZXIsCiAgICB0eG4gU2VuZGVyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExMDEtMTEwNgogICAgLy8gc2VsZi5fdXBkYXRlX2dsb2JhbF9jb2xsYXRlcmFsKAogICAgLy8gICAgIFR4bi5zZW5kZXIsCiAgICAvLyAgICAgbWFya2V0X2lkLAogICAgLy8gICAgIG9sZF92YWx1ZSwgICMgb2xkIFVTRCB2YWx1ZQogICAgLy8gICAgIG5ld192YWx1ZSwgICMgbmV3IFVTRCB2YWx1ZQogICAgLy8gKQogICAgZnJhbWVfZGlnIC0yCiAgICB1bmNvdmVyIDMKICAgIHVuY292ZXIgMwogICAgY2FsbHN1YiBfdXBkYXRlX2dsb2JhbF9jb2xsYXRlcmFsCiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5fZGVjcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9kZXBvc2l0cyhtYXJrZXRfaWQ6IHVpbnQ2NCwgdXNlcl9pZDogYnl0ZXMsIGFtb3VudDogYnl0ZXMpIC0+IHZvaWQ6Cl9kZWNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2RlcG9zaXRzOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo2NTQtNjU3CiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9kZWNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2RlcG9zaXRzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCB1c2VyX2lkOiBBY2NvdW50LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIHByb3RvIDMgMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo2NTgKICAgIC8vIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgZnJhbWVfZGlnIC0zCiAgICBjYWxsc3ViIF9nZXRfbWFya2V0CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjY1OQogICAgLy8gdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIGZyYW1lX2RpZyAtMgogICAgZnJhbWVfZGlnIC0zCiAgICBjYWxsc3ViIF9nZXRfdXNlcgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo2NjAKICAgIC8vIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIGZyYW1lX2RpZyAtMgogICAgZnJhbWVfZGlnIC0zCiAgICBjYWxsc3ViIF9nZXRfdXNlcl9rZXkKICAgIGNvdmVyIDIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NjYyCiAgICAvLyB1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgPj0gYW1vdW50CiAgICBkdXAKICAgIGV4dHJhY3QgMCAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIGR1cAogICAgZnJhbWVfZGlnIC0xCiAgICBiPj0KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NjYxLTY2MwogICAgLy8gYXNzZXJ0ICgKICAgIC8vICAgICB1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgPj0gYW1vdW50CiAgICAvLyApLCAiSW5zdWZmaWNpZW50IGJhbGFuY2UgdG8gd2l0aGRyYXcgdGhpcyBhbW91bnQiCiAgICBhc3NlcnQgLy8gSW5zdWZmaWNpZW50IGJhbGFuY2UgdG8gd2l0aGRyYXcgdGhpcyBhbW91bnQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NjY0CiAgICAvLyB1c2VyLnNjYWxlZF9kZXBvc2l0cyA9IGFyYzQuVUludDI1Nih1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgLSBhbW91bnQpCiAgICBmcmFtZV9kaWcgLTEKICAgIGItCiAgICBkdXAKICAgIGxlbgogICAgaW50IDMyCiAgICA8PQogICAgYXNzZXJ0IC8vIG92ZXJmbG93CiAgICBpbnQgMzIKICAgIGJ6ZXJvCiAgICBifAogICAgcmVwbGFjZTIgMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo2NjUKICAgIC8vIHVzZXIuZGVwb3NpdF9pbmRleCA9IG1hcmtldC5kZXBvc2l0X2luZGV4CiAgICBkaWcgMQogICAgZXh0cmFjdCAxNzcgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICByZXBsYWNlMiA2NAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo2NjYKICAgIC8vIHVzZXIubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgZ2xvYmFsIExhdGVzdFRpbWVzdGFtcAogICAgaXRvYgogICAgcmVwbGFjZTIgMTI4CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjY2NwogICAgLy8gdXNlci5sYXN0X3ByaWNlID0gbWFya2V0LnByaWNlICAjIFVwZGF0ZSB1c2VyJ3MgbGFzdCBrbm93biBwcmljZQogICAgc3dhcAogICAgaW50IDI4MQogICAgaW50IDMyCiAgICBleHRyYWN0MyAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIHJlcGxhY2UyIDEzNgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1MTEKICAgIC8vIHNlbGYudXNlcnMgPSBCb3hNYXAoQnl0ZXM0MCwgVXNlckRhdGEpICAjIFBlci1tYXJrZXQgdXNlciBzdGF0ZQogICAgYnl0ZSAidXNlcnMiCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjY2OAogICAgLy8gc2VsZi51c2Vyc1t1c2VyX2tleV0gPSB1c2VyLmNvcHkoKQogICAgdW5jb3ZlciAyCiAgICBjb25jYXQKICAgIHN3YXAKICAgIGJveF9wdXQKICAgIHJldHN1YgoKCi8vIGNvbnRyYWN0LkxlbmRpbmdQb29sLl9kZWNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9kZXBvc2l0cyhtYXJrZXRfaWQ6IHVpbnQ2NCwgYW1vdW50OiBieXRlcykgLT4gdm9pZDoKX2RlY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2RlcG9zaXRzOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo4MzktODQyCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9kZWNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9kZXBvc2l0cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICBwcm90byAyIDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODQzCiAgICAvLyBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIGZyYW1lX2RpZyAtMgogICAgY2FsbHN1YiBfZ2V0X21hcmtldAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo4NDUKICAgIC8vIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlID49IGFtb3VudAogICAgZHVwCiAgICBleHRyYWN0IDExMyAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIGR1cAogICAgZnJhbWVfZGlnIC0xCiAgICBiPj0KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODQ0LTg0NgogICAgLy8gYXNzZXJ0ICgKICAgIC8vICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSA+PSBhbW91bnQKICAgIC8vICksICJJbnN1ZmZpY2llbnQgYmFsYW5jZSB0byB3aXRoZHJhdyB0aGlzIGFtb3VudCIKICAgIGFzc2VydCAvLyBJbnN1ZmZpY2llbnQgYmFsYW5jZSB0byB3aXRoZHJhdyB0aGlzIGFtb3VudAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo4NDgKICAgIC8vIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlIC0gYW1vdW50CiAgICBmcmFtZV9kaWcgLTEKICAgIGItCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojg0Ny04NDkKICAgIC8vIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMgPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cy5uYXRpdmUgLSBhbW91bnQKICAgIC8vICkKICAgIGR1cAogICAgbGVuCiAgICBpbnQgMzIKICAgIDw9CiAgICBhc3NlcnQgLy8gb3ZlcmZsb3cKICAgIGludCAzMgogICAgYnplcm8KICAgIGJ8CiAgICByZXBsYWNlMiAxMTMKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODUwCiAgICAvLyBzZWxmLm1hcmtldHNbbWFya2V0X2lkXSA9IG1hcmtldC5jb3B5KCkKICAgIGZyYW1lX2RpZyAtMgogICAgaXRvYgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1MTAKICAgIC8vIHNlbGYubWFya2V0cyA9IEJveE1hcChVSW50NjQsIE1hcmtldERhdGEpICAjIE1hcmtldCBzdGF0ZQogICAgYnl0ZSAibWFya2V0cyIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODUwCiAgICAvLyBzZWxmLm1hcmtldHNbbWFya2V0X2lkXSA9IG1hcmtldC5jb3B5KCkKICAgIHN3YXAKICAgIGNvbmNhdAogICAgc3dhcAogICAgYm94X3B1dAogICAgcmV0c3ViCgoKLy8gY29udHJhY3QuTGVuZGluZ1Bvb2wuYm9ycm93KG1hcmtldF9pZDogYnl0ZXMsIGFtb3VudDogYnl0ZXMpIC0+IHZvaWQ6CmJvcnJvdzoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTExMC0xMTExCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBib3Jyb3coc2VsZiwgbWFya2V0X2lkOiBhcmM0LlVJbnQ2NCwgYW1vdW50OiBhcmM0LlVJbnQyNTYpIC0+IE5vbmU6CiAgICBwcm90byAyIDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTExMgogICAgLy8gZW5zdXJlX2J1ZGdldCgxNDAwLCBPcFVwRmVlU291cmNlLkdyb3VwQ3JlZGl0KQogICAgaW50IDE0MDAKICAgIGludCAwCiAgICBjYWxsc3ViIGVuc3VyZV9idWRnZXQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTExMwogICAgLy8gc2VsZi5fYm9ycm93KG1hcmtldF9pZC5uYXRpdmUsIGFtb3VudC5uYXRpdmUpCiAgICBmcmFtZV9kaWcgLTIKICAgIGJ0b2kKICAgIGZyYW1lX2RpZyAtMQogICAgY2FsbHN1YiBfYm9ycm93CiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5fYm9ycm93KG1hcmtldF9pZDogdWludDY0LCBhbW91bnQ6IGJ5dGVzKSAtPiB2b2lkOgpfYm9ycm93OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMTE1LTExMTYKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2JvcnJvdyhzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50KSAtPiBOb25lOgogICAgcHJvdG8gMiAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExMTcKICAgIC8vIHNlbGYuX3ZhbGlkYXRlX21hcmtldF9vcGVyYXRpb24obWFya2V0X2lkLCBhbW91bnQsIEZhbHNlKQogICAgZnJhbWVfZGlnIC0yCiAgICBmcmFtZV9kaWcgLTEKICAgIGludCAwCiAgICBjYWxsc3ViIF92YWxpZGF0ZV9tYXJrZXRfb3BlcmF0aW9uCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExMTkKICAgIC8vIHVzZXIgPSBzZWxmLl9nZXRfdXNlcihUeG4uc2VuZGVyLCBtYXJrZXRfaWQpCiAgICB0eG4gU2VuZGVyCiAgICBmcmFtZV9kaWcgLTIKICAgIGNhbGxzdWIgX2dldF91c2VyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExMjAKICAgIC8vIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgZnJhbWVfZGlnIC0yCiAgICBjYWxsc3ViIF9nZXRfbWFya2V0CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExMjIKICAgIC8vIHBheW1lbnQgPSByZXF1aXJlX3BheW1lbnQoVHhuLnNlbmRlcikKICAgIHR4biBTZW5kZXIKICAgIGNhbGxzdWIgcmVxdWlyZV9wYXltZW50CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExMjMKICAgIC8vIGFzc2VydCBwYXltZW50ID49IFVJbnQ2NCgxMDAwMDApLCAiUGF5bWVudCBhbW91bnQgbXVzdCBiZSA+PSAwLjEiCiAgICBpbnQgMTAwMDAwCiAgICA+PQogICAgYXNzZXJ0IC8vIFBheW1lbnQgYW1vdW50IG11c3QgYmUgPj0gMC4xCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExMjYKICAgIC8vIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUgKiBtYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZQogICAgZHVwCiAgICBleHRyYWN0IDE0NSAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIHN3YXAKICAgIGR1cAogICAgZXh0cmFjdCAyMDkgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICB1bmNvdmVyIDIKICAgIGRpZyAxCiAgICBiKgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMTI3CiAgICAvLyApIC8vIFNDQUxFCiAgICBieXRlIDB4MGRlMGI2YjNhNzY0MDAwMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMTI1LTExMjcKICAgIC8vIHRvdGFsX2JvcnJvd3MgPSAoCiAgICAvLyAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAqIG1hcmtldC5ib3Jyb3dfaW5kZXgubmF0aXZlCiAgICAvLyApIC8vIFNDQUxFCiAgICBiLwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMTI4CiAgICAvLyBhc3NlcnQgbWFya2V0Lm1heF90b3RhbF9ib3Jyb3dzLm5hdGl2ZSA+PSB0b3RhbF9ib3Jyb3dzICsgYW1vdW50LCAiQm9ycm93IGNhcCIKICAgIGRpZyAyCiAgICBleHRyYWN0IDMzIDMyIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgc3dhcAogICAgZnJhbWVfZGlnIC0xCiAgICBiKwogICAgYj49CiAgICBhc3NlcnQgLy8gQm9ycm93IGNhcAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMTMwCiAgICAvLyBnbG9iYWxfdXNlciA9IHNlbGYuX2dldF9nbG9iYWxfdXNlcihUeG4uc2VuZGVyKQogICAgdHhuIFNlbmRlcgogICAgY2FsbHN1YiBfZ2V0X2dsb2JhbF91c2VyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExMzEKICAgIC8vIG5ld19ib3Jyb3dfdmFsdWUgPSAoYW1vdW50ICogbWFya2V0LnByaWNlLm5hdGl2ZSkgLy8gU0NBTEUKICAgIGRpZyAyCiAgICBpbnQgMjgxCiAgICBpbnQgMzIKICAgIGV4dHJhY3QzIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgZHVwCiAgICBjb3ZlciA1CiAgICBmcmFtZV9kaWcgLTEKICAgIGIqCiAgICBieXRlIDB4MGRlMGI2YjNhNzY0MDAwMAogICAgYi8KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTEzMgogICAgLy8gdG90YWxfYm9ycm93X3ZhbHVlID0gZ2xvYmFsX3VzZXIudG90YWxfYm9ycm93X3ZhbHVlLm5hdGl2ZSArIG5ld19ib3Jyb3dfdmFsdWUKICAgIGRpZyAxCiAgICBleHRyYWN0IDMyIDMyIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgYisKICAgIHN3YXAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTEzNQogICAgLy8gZ2xvYmFsX3VzZXIudG90YWxfY29sbGF0ZXJhbF92YWx1ZS5uYXRpdmUKICAgIGV4dHJhY3QgMCAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTEzNgogICAgLy8gKiBCaWdVSW50KG1hcmtldC5jb2xsYXRlcmFsX2ZhY3Rvci5uYXRpdmUpCiAgICB1bmNvdmVyIDMKICAgIGV4dHJhY3QgNzMgOCAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIGJ0b2kKICAgIGl0b2IKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTEzNS0xMTM2CiAgICAvLyBnbG9iYWxfdXNlci50b3RhbF9jb2xsYXRlcmFsX3ZhbHVlLm5hdGl2ZQogICAgLy8gKiBCaWdVSW50KG1hcmtldC5jb2xsYXRlcmFsX2ZhY3Rvci5uYXRpdmUpCiAgICBiKgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMTM3CiAgICAvLyApIC8vIEJpZ1VJbnQoMTAwMDApLCAiSW5zdWZmaWNpZW50IGNvbGxhdGVyYWwgYWNyb3NzIG1hcmtldHMiCiAgICBieXRlIDB4MjcxMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMTM0LTExMzcKICAgIC8vIGFzc2VydCB0b3RhbF9ib3Jyb3dfdmFsdWUgPD0gKAogICAgLy8gICAgIGdsb2JhbF91c2VyLnRvdGFsX2NvbGxhdGVyYWxfdmFsdWUubmF0aXZlCiAgICAvLyAgICAgKiBCaWdVSW50KG1hcmtldC5jb2xsYXRlcmFsX2ZhY3Rvci5uYXRpdmUpCiAgICAvLyApIC8vIEJpZ1VJbnQoMTAwMDApLCAiSW5zdWZmaWNpZW50IGNvbGxhdGVyYWwgYWNyb3NzIG1hcmtldHMiCiAgICBiLwogICAgYjw9CiAgICBhc3NlcnQgLy8gSW5zdWZmaWNpZW50IGNvbGxhdGVyYWwgYWNyb3NzIG1hcmtldHMKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTEzOQogICAgLy8gbmV3X21hcmtldCA9IHNlbGYuX2FjY3J1ZV9pbnRlcmVzdChtYXJrZXRfaWQpCiAgICBmcmFtZV9kaWcgLTIKICAgIGNhbGxzdWIgX2FjY3J1ZV9pbnRlcmVzdAogICAgZHVwCiAgICBjb3ZlciAzCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExNDAKICAgIC8vIHNjYWxlZF9hbW91bnQgPSAoYW1vdW50ICogU0NBTEUpIC8vIG5ld19tYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZQogICAgZnJhbWVfZGlnIC0xCiAgICBieXRlIDB4MGRlMGI2YjNhNzY0MDAwMAogICAgYioKICAgIHN3YXAKICAgIGV4dHJhY3QgMjA5IDMyIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgZHVwCiAgICBjb3ZlciAyCiAgICBiLwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMTQyCiAgICAvLyBzZWxmLl9pbmNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2JvcnJvd3MobWFya2V0X2lkLCBUeG4uc2VuZGVyLCBzY2FsZWRfYW1vdW50KQogICAgZnJhbWVfZGlnIC0yCiAgICB0eG4gU2VuZGVyCiAgICBkaWcgMgogICAgY2FsbHN1YiBfaW5jcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9ib3Jyb3dzCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExNDMKICAgIC8vIHNlbGYuX2luY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2JvcnJvd3MobWFya2V0X2lkLCBzY2FsZWRfYW1vdW50KQogICAgZnJhbWVfZGlnIC0yCiAgICBkaWcgMQogICAgY2FsbHN1YiBfaW5jcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfYm9ycm93cwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMTQ2CiAgICAvLyB1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAqIG1hcmtldC5ib3Jyb3dfaW5kZXgubmF0aXZlIC8vIFNDQUxFCiAgICBkaWcgMwogICAgZXh0cmFjdCAzMiAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIGR1cAogICAgdW5jb3ZlciA0CiAgICBiKgogICAgYnl0ZSAweDBkZTBiNmIzYTc2NDAwMDAKICAgIGIvCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExNDUtMTE0NwogICAgLy8gb2xkX2JvcnJvd19hbW91bnQgPSAoCiAgICAvLyAgICAgdXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgKiBtYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZSAvLyBTQ0FMRQogICAgLy8gKQogICAgY292ZXIgNAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMTQ5CiAgICAvLyAodXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgKyBzY2FsZWRfYW1vdW50KQogICAgYisKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTE0OS0xMTUwCiAgICAvLyAodXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgKyBzY2FsZWRfYW1vdW50KQogICAgLy8gKiBuZXdfbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUKICAgIGIqCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExNTEKICAgIC8vIC8vIFNDQUxFCiAgICBieXRlIDB4MGRlMGI2YjNhNzY0MDAwMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMTQ5LTExNTEKICAgIC8vICh1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSArIHNjYWxlZF9hbW91bnQpCiAgICAvLyAqIG5ld19tYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZQogICAgLy8gLy8gU0NBTEUKICAgIGIvCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExNDgtMTE1MgogICAgLy8gbmV3X2JvcnJvd19hbW91bnQgPSAoCiAgICAvLyAgICAgKHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlICsgc2NhbGVkX2Ftb3VudCkKICAgIC8vICAgICAqIG5ld19tYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZQogICAgLy8gICAgIC8vIFNDQUxFCiAgICAvLyApCiAgICBzd2FwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExNTcKICAgIC8vIGlmIHVzZXIubGFzdF9wcmljZS5uYXRpdmUgPiAwCiAgICBleHRyYWN0IDEzNiAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIGR1cAogICAgYnl0ZSAweAogICAgYj4KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTE1Ni0xMTU4CiAgICAvLyB1c2VyLmxhc3RfcHJpY2UubmF0aXZlCiAgICAvLyBpZiB1c2VyLmxhc3RfcHJpY2UubmF0aXZlID4gMAogICAgLy8gZWxzZSBtYXJrZXQucHJpY2UubmF0aXZlCiAgICBieiBfYm9ycm93X3Rlcm5hcnlfZmFsc2VAMgogICAgZnJhbWVfZGlnIDQKICAgIGIgX2JvcnJvd190ZXJuYXJ5X21lcmdlQDMKCl9ib3Jyb3dfdGVybmFyeV9mYWxzZUAyOgogICAgZnJhbWVfZGlnIDAKCl9ib3Jyb3dfdGVybmFyeV9tZXJnZUAzOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMTYwCiAgICAvLyBwcmljZV9mb3JfbmV3ID0gbmV3X21hcmtldC5wcmljZS5uYXRpdmUKICAgIGZyYW1lX2RpZyAxCiAgICBpbnQgMjgxCiAgICBpbnQgMzIKICAgIGV4dHJhY3QzIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMTYyCiAgICAvLyBvbGRfdmFsdWUgPSAob2xkX2JvcnJvd19hbW91bnQgKiBwcmljZV9mb3Jfb2xkKSAvLyBTQ0FMRQogICAgZnJhbWVfZGlnIDIKICAgIHVuY292ZXIgMgogICAgYioKICAgIGJ5dGUgMHgwZGUwYjZiM2E3NjQwMDAwCiAgICBiLwogICAgc3dhcAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMTYzCiAgICAvLyBuZXdfdmFsdWUgPSAobmV3X2JvcnJvd19hbW91bnQgKiBwcmljZV9mb3JfbmV3KSAvLyBTQ0FMRQogICAgZnJhbWVfZGlnIDMKICAgIGIqCiAgICBieXRlIDB4MGRlMGI2YjNhNzY0MDAwMAogICAgYi8KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTE2NQogICAgLy8gVHhuLnNlbmRlciwKICAgIHR4biBTZW5kZXIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTE2NC0xMTY5CiAgICAvLyBzZWxmLl91cGRhdGVfZ2xvYmFsX2JvcnJvd3MoCiAgICAvLyAgICAgVHhuLnNlbmRlciwKICAgIC8vICAgICBtYXJrZXRfaWQsCiAgICAvLyAgICAgb2xkX3ZhbHVlLCAgIyBvbGQgVVNEIHZhbHVlCiAgICAvLyAgICAgbmV3X3ZhbHVlLCAgIyBuZXcgVVNEIHZhbHVlCiAgICAvLyApCiAgICBmcmFtZV9kaWcgLTIKICAgIHVuY292ZXIgMwogICAgdW5jb3ZlciAzCiAgICBjYWxsc3ViIF91cGRhdGVfZ2xvYmFsX2JvcnJvd3MKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTE3MS0xMTcyCiAgICAvLyAjIGlmIHN0b2tlbiwgbWludCBzdG9rZW4KICAgIC8vIGlmIG1hcmtldF9pZCA9PSBzZWxmLnN0b2tlbl9hcHBfaWQ6CiAgICBpbnQgMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1MDgKICAgIC8vIHNlbGYuc3Rva2VuX2FwcF9pZCA9IFVJbnQ2NCgpICAjIHN0YWJsZSBtYXJrZXQKICAgIGJ5dGUgInN0b2tlbl9hcHBfaWQiCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExNzEtMTE3MgogICAgLy8gIyBpZiBzdG9rZW4sIG1pbnQgc3Rva2VuCiAgICAvLyBpZiBtYXJrZXRfaWQgPT0gc2VsZi5zdG9rZW5fYXBwX2lkOgogICAgYXBwX2dsb2JhbF9nZXRfZXgKICAgIGFzc2VydCAvLyBjaGVjayBzZWxmLnN0b2tlbl9hcHBfaWQgZXhpc3RzCiAgICBmcmFtZV9kaWcgLTIKICAgID09CiAgICBieiBfYm9ycm93X2Vsc2VfYm9keUA3CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExNzMtMTE3OAogICAgLy8gYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICBTVG9rZW4ubWludCwKICAgIC8vICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldF9pZCksCiAgICAvLyApCiAgICBpdHhuX2JlZ2luCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExNzUKICAgIC8vIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIHR4biBTZW5kZXIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTE3NgogICAgLy8gYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICBmcmFtZV9kaWcgLTEKICAgIGxlbgogICAgaW50IDMyCiAgICA8PQogICAgYXNzZXJ0IC8vIG92ZXJmbG93CiAgICBpbnQgMzIKICAgIGJ6ZXJvCiAgICBmcmFtZV9kaWcgLTEKICAgIGJ8CiAgICBmcmFtZV9kaWcgLTIKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25JRAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMTczLTExNzgKICAgIC8vIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgU1Rva2VuLm1pbnQsCiAgICAvLyAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgIGFyYzQuVUludDI1NihhbW91bnQpLAogICAgLy8gICAgIGFwcF9pZD1BcHBsaWNhdGlvbihtYXJrZXRfaWQpLAogICAgLy8gKQogICAgbWV0aG9kICJtaW50KGFkZHJlc3MsdWludDI1Nil2b2lkIgogICAgaXR4bl9maWVsZCBBcHBsaWNhdGlvbkFyZ3MKICAgIHN3YXAKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICBpdHhuX2ZpZWxkIEFwcGxpY2F0aW9uQXJncwogICAgaW50IGFwcGwKICAgIGl0eG5fZmllbGQgVHlwZUVudW0KICAgIGludCAwCiAgICBpdHhuX2ZpZWxkIEZlZQogICAgaXR4bl9zdWJtaXQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTE3OS0xMTgxCiAgICAvLyBpdHhuLlBheW1lbnQoCiAgICAvLyAgICAgcmVjZWl2ZXI9QXBwbGljYXRpb24obWFya2V0X2lkKS5hZGRyZXNzLCBhbW91bnQ9MTAwMDAwLCBmZWU9MAogICAgLy8gKS5zdWJtaXQoKQogICAgaXR4bl9iZWdpbgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMTgwCiAgICAvLyByZWNlaXZlcj1BcHBsaWNhdGlvbihtYXJrZXRfaWQpLmFkZHJlc3MsIGFtb3VudD0xMDAwMDAsIGZlZT0wCiAgICBmcmFtZV9kaWcgLTIKICAgIGFwcF9wYXJhbXNfZ2V0IEFwcEFkZHJlc3MKICAgIGFzc2VydCAvLyBhcHBsaWNhdGlvbiBleGlzdHMKICAgIGludCAxMDAwMDAKICAgIGl0eG5fZmllbGQgQW1vdW50CiAgICBpdHhuX2ZpZWxkIFJlY2VpdmVyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExNzkKICAgIC8vIGl0eG4uUGF5bWVudCgKICAgIGludCBwYXkKICAgIGl0eG5fZmllbGQgVHlwZUVudW0KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTE4MAogICAgLy8gcmVjZWl2ZXI9QXBwbGljYXRpb24obWFya2V0X2lkKS5hZGRyZXNzLCBhbW91bnQ9MTAwMDAwLCBmZWU9MAogICAgaW50IDAKICAgIGl0eG5fZmllbGQgRmVlCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExNzktMTE4MQogICAgLy8gaXR4bi5QYXltZW50KAogICAgLy8gICAgIHJlY2VpdmVyPUFwcGxpY2F0aW9uKG1hcmtldF9pZCkuYWRkcmVzcywgYW1vdW50PTEwMDAwMCwgZmVlPTAKICAgIC8vICkuc3VibWl0KCkKICAgIGl0eG5fc3VibWl0CiAgICBiIF9ib3Jyb3dfYWZ0ZXJfaWZfZWxzZUA5CgpfYm9ycm93X2Vsc2VfYm9keUA3OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMTg0LTExODkKICAgIC8vIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgQVJDMjAwVG9rZW5JbnRlcmZhY2UuYXJjMjAwX3RyYW5zZmVyLAogICAgLy8gICAgIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIC8vICAgICBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIC8vICAgICBhcHBfaWQ9QXBwbGljYXRpb24obWFya2V0X2lkKSwKICAgIC8vICkKICAgIGl0eG5fYmVnaW4KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTE4NgogICAgLy8gYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgdHhuIFNlbmRlcgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMTg3CiAgICAvLyBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIGZyYW1lX2RpZyAtMQogICAgbGVuCiAgICBpbnQgMzIKICAgIDw9CiAgICBhc3NlcnQgLy8gb3ZlcmZsb3cKICAgIGludCAzMgogICAgYnplcm8KICAgIGZyYW1lX2RpZyAtMQogICAgYnwKICAgIGZyYW1lX2RpZyAtMgogICAgaXR4bl9maWVsZCBBcHBsaWNhdGlvbklECiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExODQtMTE4OQogICAgLy8gYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICBBUkMyMDBUb2tlbkludGVyZmFjZS5hcmMyMDBfdHJhbnNmZXIsCiAgICAvLyAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgIGFyYzQuVUludDI1NihhbW91bnQpLAogICAgLy8gICAgIGFwcF9pZD1BcHBsaWNhdGlvbihtYXJrZXRfaWQpLAogICAgLy8gKQogICAgbWV0aG9kICJhcmMyMDBfdHJhbnNmZXIoYWRkcmVzcyx1aW50MjU2KWJvb2wiCiAgICBpdHhuX2ZpZWxkIEFwcGxpY2F0aW9uQXJncwogICAgc3dhcAogICAgaXR4bl9maWVsZCBBcHBsaWNhdGlvbkFyZ3MKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICBpbnQgYXBwbAogICAgaXR4bl9maWVsZCBUeXBlRW51bQogICAgaW50IDAKICAgIGl0eG5fZmllbGQgRmVlCiAgICBpdHhuX3N1Ym1pdAogICAgaXR4biBMYXN0TG9nCiAgICBleHRyYWN0IDAgNAogICAgYnl0ZSAweDE1MWY3Yzc1CiAgICA9PQogICAgYXNzZXJ0IC8vIEFSQzQgcHJlZml4IGlzIHZhbGlkCgpfYm9ycm93X2FmdGVyX2lmX2Vsc2VAOToKICAgIHJldHN1YgoKCi8vIGNvbnRyYWN0LkxlbmRpbmdQb29sLl9pbmNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2JvcnJvd3MobWFya2V0X2lkOiB1aW50NjQsIHVzZXJfaWQ6IGJ5dGVzLCBhbW91bnQ6IGJ5dGVzKSAtPiB2b2lkOgpfaW5jcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9ib3Jyb3dzOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo2NDEtNjQ0CiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9pbmNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2JvcnJvd3MoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIHVzZXJfaWQ6IEFjY291bnQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgcHJvdG8gMyAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjY0NQogICAgLy8gbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICBmcmFtZV9kaWcgLTMKICAgIGNhbGxzdWIgX2dldF9tYXJrZXQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NjQ2CiAgICAvLyB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgZnJhbWVfZGlnIC0yCiAgICBmcmFtZV9kaWcgLTMKICAgIGNhbGxzdWIgX2dldF91c2VyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjY0NwogICAgLy8gdXNlcl9rZXkgPSBzZWxmLl9nZXRfdXNlcl9rZXkodXNlcl9pZCwgbWFya2V0X2lkKQogICAgZnJhbWVfZGlnIC0yCiAgICBmcmFtZV9kaWcgLTMKICAgIGNhbGxzdWIgX2dldF91c2VyX2tleQogICAgY292ZXIgMgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo2NDgKICAgIC8vIHVzZXIuc2NhbGVkX2JvcnJvd3MgPSBhcmM0LlVJbnQyNTYodXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgKyBhbW91bnQpCiAgICBkdXAKICAgIGV4dHJhY3QgMzIgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBmcmFtZV9kaWcgLTEKICAgIGIrCiAgICBkdXAKICAgIGxlbgogICAgaW50IDMyCiAgICA8PQogICAgYXNzZXJ0IC8vIG92ZXJmbG93CiAgICBpbnQgMzIKICAgIGJ6ZXJvCiAgICBifAogICAgcmVwbGFjZTIgMzIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NjQ5CiAgICAvLyB1c2VyLmJvcnJvd19pbmRleCA9IG1hcmtldC5ib3Jyb3dfaW5kZXgKICAgIGRpZyAxCiAgICBleHRyYWN0IDIwOSAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIHJlcGxhY2UyIDk2CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjY1MAogICAgLy8gdXNlci5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApCiAgICBnbG9iYWwgTGF0ZXN0VGltZXN0YW1wCiAgICBpdG9iCiAgICByZXBsYWNlMiAxMjgKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NjUxCiAgICAvLyB1c2VyLmxhc3RfcHJpY2UgPSBtYXJrZXQucHJpY2UgICMgVXBkYXRlIHVzZXIncyBsYXN0IGtub3duIHByaWNlCiAgICBzd2FwCiAgICBpbnQgMjgxCiAgICBpbnQgMzIKICAgIGV4dHJhY3QzIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgcmVwbGFjZTIgMTM2CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjUxMQogICAgLy8gc2VsZi51c2VycyA9IEJveE1hcChCeXRlczQwLCBVc2VyRGF0YSkgICMgUGVyLW1hcmtldCB1c2VyIHN0YXRlCiAgICBieXRlICJ1c2VycyIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NjUyCiAgICAvLyBzZWxmLnVzZXJzW3VzZXJfa2V5XSA9IHVzZXIuY29weSgpCiAgICB1bmNvdmVyIDIKICAgIGNvbmNhdAogICAgc3dhcAogICAgYm94X3B1dAogICAgcmV0c3ViCgoKLy8gY29udHJhY3QuTGVuZGluZ1Bvb2wuX2luY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2JvcnJvd3MobWFya2V0X2lkOiB1aW50NjQsIGFtb3VudDogYnl0ZXMpIC0+IHZvaWQ6Cl9pbmNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9ib3Jyb3dzOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo4NTItODU1CiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9pbmNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9ib3Jyb3dzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIHByb3RvIDIgMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo4NTYKICAgIC8vIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgZnJhbWVfZGlnIC0yCiAgICBjYWxsc3ViIF9nZXRfbWFya2V0CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojg1OAogICAgLy8gbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzLm5hdGl2ZSArIGFtb3VudAogICAgZHVwCiAgICBleHRyYWN0IDE0NSAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIGZyYW1lX2RpZyAtMQogICAgYisKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODU3LTg1OQogICAgLy8gbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUgKyBhbW91bnQKICAgIC8vICkKICAgIGR1cAogICAgbGVuCiAgICBpbnQgMzIKICAgIDw9CiAgICBhc3NlcnQgLy8gb3ZlcmZsb3cKICAgIGludCAzMgogICAgYnplcm8KICAgIGJ8CiAgICByZXBsYWNlMiAxNDUKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODYwCiAgICAvLyBtYXJrZXQubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgZ2xvYmFsIExhdGVzdFRpbWVzdGFtcAogICAgaXRvYgogICAgcmVwbGFjZTIgMjQxCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojg2MQogICAgLy8gc2VsZi5tYXJrZXRzW21hcmtldF9pZF0gPSBtYXJrZXQuY29weSgpCiAgICBmcmFtZV9kaWcgLTIKICAgIGl0b2IKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTEwCiAgICAvLyBzZWxmLm1hcmtldHMgPSBCb3hNYXAoVUludDY0LCBNYXJrZXREYXRhKSAgIyBNYXJrZXQgc3RhdGUKICAgIGJ5dGUgIm1hcmtldHMiCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojg2MQogICAgLy8gc2VsZi5tYXJrZXRzW21hcmtldF9pZF0gPSBtYXJrZXQuY29weSgpCiAgICBzd2FwCiAgICBjb25jYXQKICAgIHN3YXAKICAgIGJveF9wdXQKICAgIHJldHN1YgoKCi8vIGNvbnRyYWN0LkxlbmRpbmdQb29sLl91cGRhdGVfZ2xvYmFsX2JvcnJvd3ModXNlcl9pZDogYnl0ZXMsIG1hcmtldF9pZDogdWludDY0LCBvbGRfdmFsdWU6IGJ5dGVzLCBuZXdfdmFsdWU6IGJ5dGVzKSAtPiB2b2lkOgpfdXBkYXRlX2dsb2JhbF9ib3Jyb3dzOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNDQwLTE0NDcKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3VwZGF0ZV9nbG9iYWxfYm9ycm93cygKICAgIC8vICAgICBzZWxmLAogICAgLy8gICAgIHVzZXJfaWQ6IEFjY291bnQsCiAgICAvLyAgICAgbWFya2V0X2lkOiBVSW50NjQsCiAgICAvLyAgICAgb2xkX3ZhbHVlOiBCaWdVSW50LAogICAgLy8gICAgIG5ld192YWx1ZTogQmlnVUludCwKICAgIC8vICkgLT4gTm9uZToKICAgIHByb3RvIDQgMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNDQ4CiAgICAvLyBnbG9iYWxfdXNlciA9IHNlbGYuX2dldF9nbG9iYWxfdXNlcih1c2VyX2lkKQogICAgZnJhbWVfZGlnIC00CiAgICBjYWxsc3ViIF9nZXRfZ2xvYmFsX3VzZXIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTQ1MQogICAgLy8gZ2xvYmFsX3VzZXIudG90YWxfYm9ycm93X3ZhbHVlLm5hdGl2ZSAtIG9sZF92YWx1ZSArIG5ld192YWx1ZQogICAgZHVwCiAgICBleHRyYWN0IDMyIDMyIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgZnJhbWVfZGlnIC0yCiAgICBiLQogICAgZnJhbWVfZGlnIC0xCiAgICBiKwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNDUwLTE0NTIKICAgIC8vIGdsb2JhbF91c2VyLnRvdGFsX2JvcnJvd192YWx1ZSA9IGFyYzQuVUludDI1NigKICAgIC8vICAgICBnbG9iYWxfdXNlci50b3RhbF9ib3Jyb3dfdmFsdWUubmF0aXZlIC0gb2xkX3ZhbHVlICsgbmV3X3ZhbHVlCiAgICAvLyApCiAgICBkdXAKICAgIGxlbgogICAgaW50IDMyCiAgICA8PQogICAgYXNzZXJ0IC8vIG92ZXJmbG93CiAgICBpbnQgMzIKICAgIGJ6ZXJvCiAgICBifAogICAgcmVwbGFjZTIgMzIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTQ1MwogICAgLy8gZ2xvYmFsX3VzZXIubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgZ2xvYmFsIExhdGVzdFRpbWVzdGFtcAogICAgaXRvYgogICAgcmVwbGFjZTIgNjQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTEyCiAgICAvLyBzZWxmLmdsb2JhbF91c2VycyA9IEJveE1hcChBY2NvdW50LCBHbG9iYWxVc2VyRGF0YSkgICMgR2xvYmFsIHVzZXIgc3RhdGUKICAgIGJ5dGUgImdsb2JhbF91c2VycyIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTQ1NQogICAgLy8gc2VsZi5nbG9iYWxfdXNlcnNbdXNlcl9pZF0gPSBnbG9iYWxfdXNlci5jb3B5KCkKICAgIGZyYW1lX2RpZyAtNAogICAgY29uY2F0CiAgICBzd2FwCiAgICBib3hfcHV0CiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5nZXRfc2NhbGVkX3JlcGF5X2Ftb3VudChtYXJrZXRfaWQ6IGJ5dGVzLCBhbW91bnQ6IGJ5dGVzKSAtPiBieXRlczoKZ2V0X3NjYWxlZF9yZXBheV9hbW91bnQ6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExOTEtMTE5NAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgZ2V0X3NjYWxlZF9yZXBheV9hbW91bnQoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBhcmM0LlVJbnQ2NCwgYW1vdW50OiBhcmM0LlVJbnQyNTYKICAgIC8vICkgLT4gYXJjNC5VSW50MjU2OgogICAgcHJvdG8gMiAxCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExOTYKICAgIC8vIHNlbGYuX2dldF9zY2FsZWRfcmVwYXlfYW1vdW50KG1hcmtldF9pZC5uYXRpdmUsIGFtb3VudC5uYXRpdmUpCiAgICBmcmFtZV9kaWcgLTIKICAgIGJ0b2kKICAgIGZyYW1lX2RpZyAtMQogICAgY2FsbHN1YiBfZ2V0X3NjYWxlZF9yZXBheV9hbW91bnQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTE5NS0xMTk3CiAgICAvLyByZXR1cm4gYXJjNC5VSW50MjU2KAogICAgLy8gICAgIHNlbGYuX2dldF9zY2FsZWRfcmVwYXlfYW1vdW50KG1hcmtldF9pZC5uYXRpdmUsIGFtb3VudC5uYXRpdmUpCiAgICAvLyApCiAgICBkdXAKICAgIGxlbgogICAgaW50IDMyCiAgICA8PQogICAgYXNzZXJ0IC8vIG92ZXJmbG93CiAgICBpbnQgMzIKICAgIGJ6ZXJvCiAgICBifAogICAgcmV0c3ViCgoKLy8gY29udHJhY3QuTGVuZGluZ1Bvb2wuX2dldF9zY2FsZWRfcmVwYXlfYW1vdW50KG1hcmtldF9pZDogdWludDY0LCBhbW91bnQ6IGJ5dGVzKSAtPiBieXRlczoKX2dldF9zY2FsZWRfcmVwYXlfYW1vdW50OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMTk5LTEyMDAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2dldF9zY2FsZWRfcmVwYXlfYW1vdW50KHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQpIC0+IEJpZ1VJbnQ6CiAgICBwcm90byAyIDEKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTIwMQogICAgLy8gbmV3X21hcmtldCA9IHNlbGYuX2FjY3J1ZV9pbnRlcmVzdChtYXJrZXRfaWQpCiAgICBmcmFtZV9kaWcgLTIKICAgIGNhbGxzdWIgX2FjY3J1ZV9pbnRlcmVzdAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjAyCiAgICAvLyByZXR1cm4gKGFtb3VudCAqIFNDQUxFKSAvLyBuZXdfbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUKICAgIGZyYW1lX2RpZyAtMQogICAgYnl0ZSAweDBkZTBiNmIzYTc2NDAwMDAKICAgIGIqCiAgICBzd2FwCiAgICBleHRyYWN0IDIwOSAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIGIvCiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5yZXBheShtYXJrZXRfaWQ6IGJ5dGVzLCBhbW91bnQ6IGJ5dGVzKSAtPiB2b2lkOgpyZXBheToKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTIwNC0xMjA1CiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiByZXBheShzZWxmLCBtYXJrZXRfaWQ6IGFyYzQuVUludDY0LCBhbW91bnQ6IGFyYzQuVUludDI1NikgLT4gTm9uZToKICAgIHByb3RvIDIgMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjA2CiAgICAvLyBlbnN1cmVfYnVkZ2V0KDE0MDAsIE9wVXBGZWVTb3VyY2UuR3JvdXBDcmVkaXQpCiAgICBpbnQgMTQwMAogICAgaW50IDAKICAgIGNhbGxzdWIgZW5zdXJlX2J1ZGdldAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjA3CiAgICAvLyBzZWxmLl9yZXBheShtYXJrZXRfaWQubmF0aXZlLCBhbW91bnQubmF0aXZlKQogICAgZnJhbWVfZGlnIC0yCiAgICBidG9pCiAgICBmcmFtZV9kaWcgLTEKICAgIGNhbGxzdWIgX3JlcGF5CiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5fcmVwYXkobWFya2V0X2lkOiB1aW50NjQsIGFtb3VudDogYnl0ZXMpIC0+IHZvaWQ6Cl9yZXBheToKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTIwOS0xMjEwCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9yZXBheShzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50KSAtPiBOb25lOgogICAgcHJvdG8gMiAwCiAgICBpbnQgMAogICAgZHVwbiAyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyMTEKICAgIC8vIHNlbGYuX3ZhbGlkYXRlX21hcmtldF9vcGVyYXRpb24obWFya2V0X2lkLCBhbW91bnQsIEZhbHNlKQogICAgZnJhbWVfZGlnIC0yCiAgICBmcmFtZV9kaWcgLTEKICAgIGludCAwCiAgICBjYWxsc3ViIF92YWxpZGF0ZV9tYXJrZXRfb3BlcmF0aW9uCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyMTMKICAgIC8vIHVzZXIgPSBzZWxmLl9nZXRfdXNlcihUeG4uc2VuZGVyLCBtYXJrZXRfaWQpCiAgICB0eG4gU2VuZGVyCiAgICBmcmFtZV9kaWcgLTIKICAgIGNhbGxzdWIgX2dldF91c2VyCiAgICBkdXAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTIxNAogICAgLy8gbmV3X21hcmtldCA9IHNlbGYuX2FjY3J1ZV9pbnRlcmVzdChtYXJrZXRfaWQpCiAgICBmcmFtZV9kaWcgLTIKICAgIGNhbGxzdWIgX2FjY3J1ZV9pbnRlcmVzdAogICAgZHVwCiAgICBjb3ZlciAyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyMTYKICAgIC8vIHNjYWxlZF9hbW91bnQgPSAoYW1vdW50ICogU0NBTEUpIC8vIG5ld19tYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZQogICAgZnJhbWVfZGlnIC0xCiAgICBieXRlIDB4MGRlMGI2YjNhNzY0MDAwMAogICAgYioKICAgIHN3YXAKICAgIGV4dHJhY3QgMjA5IDMyIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgZHVwCiAgICBjb3ZlciAzCiAgICBiLwogICAgZHVwCiAgICB1bmNvdmVyIDIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTIxNwogICAgLy8gYXNzZXJ0IHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlID49IHNjYWxlZF9hbW91bnQsICJSZXBheSBhbW91bnQgZXhjZWVkcyBkZWJ0IgogICAgZXh0cmFjdCAzMiAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIGR1cAogICAgdW5jb3ZlciAyCiAgICBiPj0KICAgIGFzc2VydCAvLyBSZXBheSBhbW91bnQgZXhjZWVkcyBkZWJ0CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyMTkKICAgIC8vIGlmIG1hcmtldF9pZCA9PSBzZWxmLnN0b2tlbl9hcHBfaWQ6CiAgICBpbnQgMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1MDgKICAgIC8vIHNlbGYuc3Rva2VuX2FwcF9pZCA9IFVJbnQ2NCgpICAjIHN0YWJsZSBtYXJrZXQKICAgIGJ5dGUgInN0b2tlbl9hcHBfaWQiCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyMTkKICAgIC8vIGlmIG1hcmtldF9pZCA9PSBzZWxmLnN0b2tlbl9hcHBfaWQ6CiAgICBhcHBfZ2xvYmFsX2dldF9leAogICAgYXNzZXJ0IC8vIGNoZWNrIHNlbGYuc3Rva2VuX2FwcF9pZCBleGlzdHMKICAgIGZyYW1lX2RpZyAtMgogICAgPT0KICAgIGJ6IF9yZXBheV9lbHNlX2JvZHlAMwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjIwLTEyMjUKICAgIC8vIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgU1Rva2VuLmJ1cm5fZnJvbSwKICAgIC8vICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldF9pZCksCiAgICAvLyApCiAgICBpdHhuX2JlZ2luCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyMjIKICAgIC8vIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIHR4biBTZW5kZXIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTIyMwogICAgLy8gYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICBmcmFtZV9kaWcgLTEKICAgIGxlbgogICAgaW50IDMyCiAgICA8PQogICAgYXNzZXJ0IC8vIG92ZXJmbG93CiAgICBpbnQgMzIKICAgIGJ6ZXJvCiAgICBmcmFtZV9kaWcgLTEKICAgIGJ8CiAgICBmcmFtZV9kaWcgLTIKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25JRAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjIwLTEyMjUKICAgIC8vIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgU1Rva2VuLmJ1cm5fZnJvbSwKICAgIC8vICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldF9pZCksCiAgICAvLyApCiAgICBtZXRob2QgImJ1cm5fZnJvbShhZGRyZXNzLHVpbnQyNTYpdm9pZCIKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICBzd2FwCiAgICBpdHhuX2ZpZWxkIEFwcGxpY2F0aW9uQXJncwogICAgaXR4bl9maWVsZCBBcHBsaWNhdGlvbkFyZ3MKICAgIGludCBhcHBsCiAgICBpdHhuX2ZpZWxkIFR5cGVFbnVtCiAgICBpbnQgMAogICAgaXR4bl9maWVsZCBGZWUKICAgIGl0eG5fc3VibWl0CiAgICBiIF9yZXBheV9hZnRlcl9pZl9lbHNlQDUKCl9yZXBheV9lbHNlX2JvZHlAMzoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTIyNy0xMjMzCiAgICAvLyBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgIEFSQzIwMFRva2VuSW50ZXJmYWNlLmFyYzIwMF90cmFuc2ZlckZyb20sCiAgICAvLyAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgIGFyYzQuQWRkcmVzcyhHbG9iYWwuY3VycmVudF9hcHBsaWNhdGlvbl9hZGRyZXNzKSwKICAgIC8vICAgICBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIC8vICAgICBhcHBfaWQ9QXBwbGljYXRpb24obWFya2V0X2lkKSwKICAgIC8vICkKICAgIGl0eG5fYmVnaW4KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTIzMAogICAgLy8gYXJjNC5BZGRyZXNzKEdsb2JhbC5jdXJyZW50X2FwcGxpY2F0aW9uX2FkZHJlc3MpLAogICAgZ2xvYmFsIEN1cnJlbnRBcHBsaWNhdGlvbkFkZHJlc3MKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTIyOQogICAgLy8gYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgdHhuIFNlbmRlcgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjMxCiAgICAvLyBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIGZyYW1lX2RpZyAtMQogICAgbGVuCiAgICBpbnQgMzIKICAgIDw9CiAgICBhc3NlcnQgLy8gb3ZlcmZsb3cKICAgIGludCAzMgogICAgYnplcm8KICAgIGZyYW1lX2RpZyAtMQogICAgYnwKICAgIGZyYW1lX2RpZyAtMgogICAgaXR4bl9maWVsZCBBcHBsaWNhdGlvbklECiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyMjctMTIzMwogICAgLy8gYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICBBUkMyMDBUb2tlbkludGVyZmFjZS5hcmMyMDBfdHJhbnNmZXJGcm9tLAogICAgLy8gICAgIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIC8vICAgICBhcmM0LkFkZHJlc3MoR2xvYmFsLmN1cnJlbnRfYXBwbGljYXRpb25fYWRkcmVzcyksCiAgICAvLyAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldF9pZCksCiAgICAvLyApCiAgICBtZXRob2QgImFyYzIwMF90cmFuc2ZlckZyb20oYWRkcmVzcyxhZGRyZXNzLHVpbnQyNTYpYm9vbCIKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICBzd2FwCiAgICBpdHhuX2ZpZWxkIEFwcGxpY2F0aW9uQXJncwogICAgc3dhcAogICAgaXR4bl9maWVsZCBBcHBsaWNhdGlvbkFyZ3MKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICBpbnQgYXBwbAogICAgaXR4bl9maWVsZCBUeXBlRW51bQogICAgaW50IDAKICAgIGl0eG5fZmllbGQgRmVlCiAgICBpdHhuX3N1Ym1pdAogICAgaXR4biBMYXN0TG9nCiAgICBleHRyYWN0IDAgNAogICAgYnl0ZSAweDE1MWY3Yzc1CiAgICA9PQogICAgYXNzZXJ0IC8vIEFSQzQgcHJlZml4IGlzIHZhbGlkCgpfcmVwYXlfYWZ0ZXJfaWZfZWxzZUA1OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjM1CiAgICAvLyBzZWxmLl9kZWNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2JvcnJvd3MobWFya2V0X2lkLCBUeG4uc2VuZGVyLCBzY2FsZWRfYW1vdW50KQogICAgZnJhbWVfZGlnIC0yCiAgICB0eG4gU2VuZGVyCiAgICBmcmFtZV9kaWcgNgogICAgZHVwCiAgICBjb3ZlciAzCiAgICBjYWxsc3ViIF9kZWNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2JvcnJvd3MKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTIzNgogICAgLy8gc2VsZi5fZGVjcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfYm9ycm93cyhtYXJrZXRfaWQsIHNjYWxlZF9hbW91bnQpCiAgICBmcmFtZV9kaWcgLTIKICAgIGRpZyAxCiAgICBjYWxsc3ViIF9kZWNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9ib3Jyb3dzCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyMzkKICAgIC8vIHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlICogbmV3X21hcmtldC5ib3Jyb3dfaW5kZXgubmF0aXZlIC8vIFNDQUxFCiAgICBmcmFtZV9kaWcgNwogICAgZHVwCiAgICBmcmFtZV9kaWcgNQogICAgZHVwCiAgICBjb3ZlciA0CiAgICBiKgogICAgYnl0ZSAweDBkZTBiNmIzYTc2NDAwMDAKICAgIGIvCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyMzgtMTI0MAogICAgLy8gb2xkX2JvcnJvd19hbW91bnQgPSAoCiAgICAvLyAgICAgdXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgKiBuZXdfbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUgLy8gU0NBTEUKICAgIC8vICkKICAgIGZyYW1lX2J1cnkgMQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjQyCiAgICAvLyAodXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgLSBzY2FsZWRfYW1vdW50KQogICAgc3dhcAogICAgYi0KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTI0Mi0xMjQzCiAgICAvLyAodXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgLSBzY2FsZWRfYW1vdW50KQogICAgLy8gKiBuZXdfbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUKICAgIGIqCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyNDQKICAgIC8vIC8vIFNDQUxFCiAgICBieXRlIDB4MGRlMGI2YjNhNzY0MDAwMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjQyLTEyNDQKICAgIC8vICh1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAtIHNjYWxlZF9hbW91bnQpCiAgICAvLyAqIG5ld19tYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZQogICAgLy8gLy8gU0NBTEUKICAgIGIvCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyNDEtMTI0NQogICAgLy8gbmV3X2JvcnJvd19hbW91bnQgPSAoCiAgICAvLyAgICAgKHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlIC0gc2NhbGVkX2Ftb3VudCkKICAgIC8vICAgICAqIG5ld19tYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZQogICAgLy8gICAgIC8vIFNDQUxFCiAgICAvLyApCiAgICBmcmFtZV9idXJ5IDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTI1MAogICAgLy8gaWYgdXNlci5sYXN0X3ByaWNlLm5hdGl2ZSA+IDAKICAgIGZyYW1lX2RpZyAzCiAgICBleHRyYWN0IDEzNiAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIGR1cAogICAgZnJhbWVfYnVyeSAyCiAgICBieXRlIDB4CiAgICBiPgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjQ5LTEyNTEKICAgIC8vIHVzZXIubGFzdF9wcmljZS5uYXRpdmUKICAgIC8vIGlmIHVzZXIubGFzdF9wcmljZS5uYXRpdmUgPiAwCiAgICAvLyBlbHNlIG5ld19tYXJrZXQucHJpY2UubmF0aXZlCiAgICBieiBfcmVwYXlfdGVybmFyeV9mYWxzZUA3CiAgICBmcmFtZV9kaWcgMgogICAgYiBfcmVwYXlfdGVybmFyeV9tZXJnZUA4CgpfcmVwYXlfdGVybmFyeV9mYWxzZUA3OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjUxCiAgICAvLyBlbHNlIG5ld19tYXJrZXQucHJpY2UubmF0aXZlCiAgICBmcmFtZV9kaWcgNAogICAgaW50IDI4MQogICAgaW50IDMyCiAgICBleHRyYWN0MyAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKCl9yZXBheV90ZXJuYXJ5X21lcmdlQDg6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyNTMKICAgIC8vIHByaWNlX2Zvcl9uZXcgPSBuZXdfbWFya2V0LnByaWNlLm5hdGl2ZQogICAgZnJhbWVfZGlnIDQKICAgIGludCAyODEKICAgIGludCAzMgogICAgZXh0cmFjdDMgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyNTUKICAgIC8vIG9sZF92YWx1ZSA9IChvbGRfYm9ycm93X2Ftb3VudCAqIHByaWNlX2Zvcl9vbGQpIC8vIFNDQUxFCiAgICBmcmFtZV9kaWcgMQogICAgdW5jb3ZlciAyCiAgICBiKgogICAgYnl0ZSAweDBkZTBiNmIzYTc2NDAwMDAKICAgIGIvCiAgICBzd2FwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyNTYKICAgIC8vIG5ld192YWx1ZSA9IChuZXdfYm9ycm93X2Ftb3VudCAqIHByaWNlX2Zvcl9uZXcpIC8vIFNDQUxFCiAgICBmcmFtZV9kaWcgMAogICAgYioKICAgIGJ5dGUgMHgwZGUwYjZiM2E3NjQwMDAwCiAgICBiLwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjU4CiAgICAvLyBUeG4uc2VuZGVyLAogICAgdHhuIFNlbmRlcgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjU3LTEyNjIKICAgIC8vIHNlbGYuX3VwZGF0ZV9nbG9iYWxfYm9ycm93cygKICAgIC8vICAgICBUeG4uc2VuZGVyLAogICAgLy8gICAgIG1hcmtldF9pZCwKICAgIC8vICAgICBvbGRfdmFsdWUsICAjIG9sZCBVU0QgdmFsdWUKICAgIC8vICAgICBuZXdfdmFsdWUsICAjIG5ldyBVU0QgdmFsdWUKICAgIC8vICkKICAgIGZyYW1lX2RpZyAtMgogICAgdW5jb3ZlciAzCiAgICB1bmNvdmVyIDMKICAgIGNhbGxzdWIgX3VwZGF0ZV9nbG9iYWxfYm9ycm93cwogICAgcmV0c3ViCgoKLy8gY29udHJhY3QuTGVuZGluZ1Bvb2wuX2RlY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfYm9ycm93cyhtYXJrZXRfaWQ6IHVpbnQ2NCwgdXNlcl9pZDogYnl0ZXMsIGFtb3VudDogYnl0ZXMpIC0+IHZvaWQ6Cl9kZWNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2JvcnJvd3M6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjY3MC02NzMKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2RlY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfYm9ycm93cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgdXNlcl9pZDogQWNjb3VudCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICBwcm90byAzIDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6Njc0CiAgICAvLyBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIGZyYW1lX2RpZyAtMwogICAgY2FsbHN1YiBfZ2V0X21hcmtldAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo2NzUKICAgIC8vIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICBmcmFtZV9kaWcgLTIKICAgIGZyYW1lX2RpZyAtMwogICAgY2FsbHN1YiBfZ2V0X3VzZXIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6Njc2CiAgICAvLyB1c2VyX2tleSA9IHNlbGYuX2dldF91c2VyX2tleSh1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICBmcmFtZV9kaWcgLTIKICAgIGZyYW1lX2RpZyAtMwogICAgY2FsbHN1YiBfZ2V0X3VzZXJfa2V5CiAgICBjb3ZlciAyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjY3OAogICAgLy8gdXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgPj0gYW1vdW50CiAgICBkdXAKICAgIGV4dHJhY3QgMzIgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBkdXAKICAgIGZyYW1lX2RpZyAtMQogICAgYj49CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjY3Ny02NzkKICAgIC8vIGFzc2VydCAoCiAgICAvLyAgICAgdXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgPj0gYW1vdW50CiAgICAvLyApLCAiSW5zdWZmaWNpZW50IGJhbGFuY2UgdG8gcmVwYXkgdGhpcyBhbW91bnQiCiAgICBhc3NlcnQgLy8gSW5zdWZmaWNpZW50IGJhbGFuY2UgdG8gcmVwYXkgdGhpcyBhbW91bnQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NjgwCiAgICAvLyB1c2VyLnNjYWxlZF9ib3Jyb3dzID0gYXJjNC5VSW50MjU2KHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlIC0gYW1vdW50KQogICAgZnJhbWVfZGlnIC0xCiAgICBiLQogICAgZHVwCiAgICBsZW4KICAgIGludCAzMgogICAgPD0KICAgIGFzc2VydCAvLyBvdmVyZmxvdwogICAgaW50IDMyCiAgICBiemVybwogICAgYnwKICAgIHJlcGxhY2UyIDMyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjY4MQogICAgLy8gdXNlci5ib3Jyb3dfaW5kZXggPSBtYXJrZXQuYm9ycm93X2luZGV4CiAgICBkaWcgMQogICAgZXh0cmFjdCAyMDkgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICByZXBsYWNlMiA5NgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo2ODIKICAgIC8vIHVzZXIubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgZ2xvYmFsIExhdGVzdFRpbWVzdGFtcAogICAgaXRvYgogICAgcmVwbGFjZTIgMTI4CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjY4MwogICAgLy8gdXNlci5sYXN0X3ByaWNlID0gbWFya2V0LnByaWNlICAjIFVwZGF0ZSB1c2VyJ3MgbGFzdCBrbm93biBwcmljZQogICAgc3dhcAogICAgaW50IDI4MQogICAgaW50IDMyCiAgICBleHRyYWN0MyAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIHJlcGxhY2UyIDEzNgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1MTEKICAgIC8vIHNlbGYudXNlcnMgPSBCb3hNYXAoQnl0ZXM0MCwgVXNlckRhdGEpICAjIFBlci1tYXJrZXQgdXNlciBzdGF0ZQogICAgYnl0ZSAidXNlcnMiCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjY4NAogICAgLy8gc2VsZi51c2Vyc1t1c2VyX2tleV0gPSB1c2VyLmNvcHkoKQogICAgdW5jb3ZlciAyCiAgICBjb25jYXQKICAgIHN3YXAKICAgIGJveF9wdXQKICAgIHJldHN1YgoKCi8vIGNvbnRyYWN0LkxlbmRpbmdQb29sLl9kZWNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9ib3Jyb3dzKG1hcmtldF9pZDogdWludDY0LCBhbW91bnQ6IGJ5dGVzKSAtPiB2b2lkOgpfZGVjcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfYm9ycm93czoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODYzLTg2NgogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZGVjcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfYm9ycm93cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICBwcm90byAyIDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODY3CiAgICAvLyBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIGZyYW1lX2RpZyAtMgogICAgY2FsbHN1YiBfZ2V0X21hcmtldAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo4NjkKICAgIC8vIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUgPj0gYW1vdW50CiAgICBkdXAKICAgIGV4dHJhY3QgMTQ1IDMyIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgZHVwCiAgICBmcmFtZV9kaWcgLTEKICAgIGI+PQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo4NjgtODcwCiAgICAvLyBhc3NlcnQgKAogICAgLy8gICAgIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUgPj0gYW1vdW50CiAgICAvLyApLCAiSW5zdWZmaWNpZW50IGJhbGFuY2UgdG8gd2l0aGRyYXcgdGhpcyBhbW91bnQiCiAgICBhc3NlcnQgLy8gSW5zdWZmaWNpZW50IGJhbGFuY2UgdG8gd2l0aGRyYXcgdGhpcyBhbW91bnQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6ODcyCiAgICAvLyBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlIC0gYW1vdW50CiAgICBmcmFtZV9kaWcgLTEKICAgIGItCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojg3MS04NzMKICAgIC8vIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cyA9IGFyYzQuVUludDI1NigKICAgIC8vICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlIC0gYW1vdW50CiAgICAvLyApCiAgICBkdXAKICAgIGxlbgogICAgaW50IDMyCiAgICA8PQogICAgYXNzZXJ0IC8vIG92ZXJmbG93CiAgICBpbnQgMzIKICAgIGJ6ZXJvCiAgICBifAogICAgcmVwbGFjZTIgMTQ1CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojg3NAogICAgLy8gc2VsZi5tYXJrZXRzW21hcmtldF9pZF0gPSBtYXJrZXQuY29weSgpCiAgICBmcmFtZV9kaWcgLTIKICAgIGl0b2IKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTEwCiAgICAvLyBzZWxmLm1hcmtldHMgPSBCb3hNYXAoVUludDY0LCBNYXJrZXREYXRhKSAgIyBNYXJrZXQgc3RhdGUKICAgIGJ5dGUgIm1hcmtldHMiCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5Ojg3NAogICAgLy8gc2VsZi5tYXJrZXRzW21hcmtldF9pZF0gPSBtYXJrZXQuY29weSgpCiAgICBzd2FwCiAgICBjb25jYXQKICAgIHN3YXAKICAgIGJveF9wdXQKICAgIHJldHN1YgoKCi8vIGNvbnRyYWN0LkxlbmRpbmdQb29sLnJlZGVlbShtYXJrZXRfaWQ6IGJ5dGVzLCBhbW91bnQ6IGJ5dGVzKSAtPiB2b2lkOgpyZWRlZW06CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyNjQtMTI2NQogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgcmVkZWVtKHNlbGYsIG1hcmtldF9pZDogYXJjNC5VSW50NjQsIGFtb3VudDogYXJjNC5VSW50MjU2KSAtPiBOb25lOgogICAgcHJvdG8gMiAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyNjYKICAgIC8vIGVuc3VyZV9idWRnZXQoMTQwMCwgT3BVcEZlZVNvdXJjZS5Hcm91cENyZWRpdCkKICAgIGludCAxNDAwCiAgICBpbnQgMAogICAgY2FsbHN1YiBlbnN1cmVfYnVkZ2V0CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyNjcKICAgIC8vIHNlbGYuX3JlZGVlbShtYXJrZXRfaWQubmF0aXZlLCBhbW91bnQubmF0aXZlKQogICAgZnJhbWVfZGlnIC0yCiAgICBidG9pCiAgICBmcmFtZV9kaWcgLTEKICAgIGNhbGxzdWIgX3JlZGVlbQogICAgcmV0c3ViCgoKLy8gY29udHJhY3QuTGVuZGluZ1Bvb2wuX3JlZGVlbShtYXJrZXRfaWQ6IHVpbnQ2NCwgYW1vdW50OiBieXRlcykgLT4gdm9pZDoKX3JlZGVlbToKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTI2OS0xMjcwCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9yZWRlZW0oc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIGFtb3VudDogQmlnVUludCkgLT4gTm9uZToKICAgIHByb3RvIDIgMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjcxCiAgICAvLyBzZWxmLl92YWxpZGF0ZV9tYXJrZXRfb3BlcmF0aW9uKG1hcmtldF9pZCwgYW1vdW50LCBUcnVlKQogICAgZnJhbWVfZGlnIC0yCiAgICBmcmFtZV9kaWcgLTEKICAgIGludCAxCiAgICBjYWxsc3ViIF92YWxpZGF0ZV9tYXJrZXRfb3BlcmF0aW9uCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyNzQKICAgIC8vIFR4bi5zZW5kZXIsIG1hcmtldF9pZAogICAgdHhuIFNlbmRlcgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjczLTEyNzUKICAgIC8vIGFzc2VydCBub3Qgc2VsZi5faGFzX3Bvc2l0aW9uKAogICAgLy8gICAgIFR4bi5zZW5kZXIsIG1hcmtldF9pZAogICAgLy8gKSwgIkNhbm5vdCBtaW50L3JlZGVlbSB3aGVuIHVzZXIgaGFzIHRyYWNrZWQgZGVwb3NpdCBwb3NpdGlvbiIKICAgIGZyYW1lX2RpZyAtMgogICAgY2FsbHN1YiBfaGFzX3Bvc2l0aW9uCiAgICAhCiAgICBhc3NlcnQgLy8gQ2Fubm90IG1pbnQvcmVkZWVtIHdoZW4gdXNlciBoYXMgdHJhY2tlZCBkZXBvc2l0IHBvc2l0aW9uCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyNzcKICAgIC8vIG1hcmtldCA9IHNlbGYuX2FjY3J1ZV9pbnRlcmVzdChtYXJrZXRfaWQpCiAgICBmcmFtZV9kaWcgLTIKICAgIGNhbGxzdWIgX2FjY3J1ZV9pbnRlcmVzdAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjc5LTEyODQKICAgIC8vIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgTlRva2VuLmJ1cm5fZnJvbSwKICAgIC8vICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldC5udG9rZW5faWQubmF0aXZlKSwKICAgIC8vICkKICAgIGl0eG5fYmVnaW4KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTI4MQogICAgLy8gYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgdHhuIFNlbmRlcgogICAgc3dhcAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjgyCiAgICAvLyBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIGZyYW1lX2RpZyAtMQogICAgbGVuCiAgICBpbnQgMzIKICAgIDw9CiAgICBhc3NlcnQgLy8gb3ZlcmZsb3cKICAgIGludCAzMgogICAgYnplcm8KICAgIGZyYW1lX2RpZyAtMQogICAgYnwKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTI4MwogICAgLy8gYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldC5udG9rZW5faWQubmF0aXZlKSwKICAgIGRpZyAxCiAgICBpbnQgMzEzCiAgICBpbnQgOAogICAgZXh0cmFjdDMgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBidG9pCiAgICBpdHhuX2ZpZWxkIEFwcGxpY2F0aW9uSUQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTI3OS0xMjg0CiAgICAvLyBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgIE5Ub2tlbi5idXJuX2Zyb20sCiAgICAvLyAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgIGFyYzQuVUludDI1NihhbW91bnQpLAogICAgLy8gICAgIGFwcF9pZD1BcHBsaWNhdGlvbihtYXJrZXQubnRva2VuX2lkLm5hdGl2ZSksCiAgICAvLyApCiAgICBtZXRob2QgImJ1cm5fZnJvbShhZGRyZXNzLHVpbnQyNTYpdm9pZCIKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICB1bmNvdmVyIDIKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICBkdXAKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICBpbnQgYXBwbAogICAgaXR4bl9maWVsZCBUeXBlRW51bQogICAgaW50IDAKICAgIGl0eG5fZmllbGQgRmVlCiAgICBpdHhuX3N1Ym1pdAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjg2CiAgICAvLyBzY2FsZWRfYW1vdW50ID0gKGFtb3VudCAqIFNDQUxFKSAvLyBtYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUKICAgIGZyYW1lX2RpZyAtMQogICAgYnl0ZSAweDBkZTBiNmIzYTc2NDAwMDAKICAgIGIqCiAgICBkaWcgMgogICAgZXh0cmFjdCAxNzcgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBiLwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjg4CiAgICAvLyBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSA+PSBzY2FsZWRfYW1vdW50CiAgICB1bmNvdmVyIDIKICAgIGV4dHJhY3QgMTEzIDMyIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgZGlnIDEKICAgIGI+PQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjg3LTEyODkKICAgIC8vIGFzc2VydCAoCiAgICAvLyAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cy5uYXRpdmUgPj0gc2NhbGVkX2Ftb3VudAogICAgLy8gKSwgIkluc3VmZmljaWVudCBtYXJrZXQgZGVwb3NpdHMgdG8gcmVkZWVtIgogICAgYXNzZXJ0IC8vIEluc3VmZmljaWVudCBtYXJrZXQgZGVwb3NpdHMgdG8gcmVkZWVtCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyOTAKICAgIC8vIHNlbGYuX2RlY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2RlcG9zaXRzKG1hcmtldF9pZCwgc2NhbGVkX2Ftb3VudCkKICAgIGZyYW1lX2RpZyAtMgogICAgc3dhcAogICAgY2FsbHN1YiBfZGVjcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfZGVwb3NpdHMKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTI5Mi0xMjk3CiAgICAvLyBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgIEFSQzIwMFRva2VuSW50ZXJmYWNlLmFyYzIwMF90cmFuc2ZlciwKICAgIC8vICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldF9pZCksCiAgICAvLyApCiAgICBpdHhuX2JlZ2luCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyOTQKICAgIC8vIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIHR4biBTZW5kZXIKICAgIGZyYW1lX2RpZyAtMgogICAgaXR4bl9maWVsZCBBcHBsaWNhdGlvbklECiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyOTItMTI5NwogICAgLy8gYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICBBUkMyMDBUb2tlbkludGVyZmFjZS5hcmMyMDBfdHJhbnNmZXIsCiAgICAvLyAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgIGFyYzQuVUludDI1NihhbW91bnQpLAogICAgLy8gICAgIGFwcF9pZD1BcHBsaWNhdGlvbihtYXJrZXRfaWQpLAogICAgLy8gKQogICAgbWV0aG9kICJhcmMyMDBfdHJhbnNmZXIoYWRkcmVzcyx1aW50MjU2KWJvb2wiCiAgICBpdHhuX2ZpZWxkIEFwcGxpY2F0aW9uQXJncwogICAgaXR4bl9maWVsZCBBcHBsaWNhdGlvbkFyZ3MKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICBpbnQgYXBwbAogICAgaXR4bl9maWVsZCBUeXBlRW51bQogICAgaW50IDAKICAgIGl0eG5fZmllbGQgRmVlCiAgICBpdHhuX3N1Ym1pdAogICAgaXR4biBMYXN0TG9nCiAgICBleHRyYWN0IDAgNAogICAgYnl0ZSAweDE1MWY3Yzc1CiAgICA9PQogICAgYXNzZXJ0IC8vIEFSQzQgcHJlZml4IGlzIHZhbGlkCiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5faGFzX3Bvc2l0aW9uKHVzZXJfaWQ6IGJ5dGVzLCBtYXJrZXRfaWQ6IHVpbnQ2NCkgLT4gdWludDY0OgpfaGFzX3Bvc2l0aW9uOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo2MDAtNjAxCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9oYXNfcG9zaXRpb24oc2VsZiwgdXNlcl9pZDogQWNjb3VudCwgbWFya2V0X2lkOiBVSW50NjQpIC0+IGJvb2w6CiAgICBwcm90byAyIDEKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NjAyCiAgICAvLyB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgZnJhbWVfZGlnIC0yCiAgICBmcmFtZV9kaWcgLTEKICAgIGNhbGxzdWIgX2dldF91c2VyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjYwMwogICAgLy8gcmV0dXJuIHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSA+IDAKICAgIGV4dHJhY3QgMCAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIGJ5dGUgMHgKICAgIGI+CiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5taW50KG1hcmtldF9pZDogYnl0ZXMsIGFtb3VudDogYnl0ZXMpIC0+IHZvaWQ6Cm1pbnQ6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyOTktMTMwMAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgbWludChzZWxmLCBtYXJrZXRfaWQ6IGFyYzQuVUludDY0LCBhbW91bnQ6IGFyYzQuVUludDI1NikgLT4gTm9uZToKICAgIHByb3RvIDIgMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMzAxCiAgICAvLyBzZWxmLl9taW50KG1hcmtldF9pZC5uYXRpdmUsIGFtb3VudC5uYXRpdmUpCiAgICBmcmFtZV9kaWcgLTIKICAgIGJ0b2kKICAgIGZyYW1lX2RpZyAtMQogICAgY2FsbHN1YiBfbWludAogICAgcmV0c3ViCgoKLy8gY29udHJhY3QuTGVuZGluZ1Bvb2wuX21pbnQobWFya2V0X2lkOiB1aW50NjQsIGFtb3VudDogYnl0ZXMpIC0+IHZvaWQ6Cl9taW50OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMzAzLTEzMDQKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX21pbnQoc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIGFtb3VudDogQmlnVUludCkgLT4gTm9uZToKICAgIHByb3RvIDIgMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMzA1CiAgICAvLyBzZWxmLl92YWxpZGF0ZV9tYXJrZXRfb3BlcmF0aW9uKG1hcmtldF9pZCwgYW1vdW50LCBUcnVlKQogICAgZnJhbWVfZGlnIC0yCiAgICBmcmFtZV9kaWcgLTEKICAgIGludCAxCiAgICBjYWxsc3ViIF92YWxpZGF0ZV9tYXJrZXRfb3BlcmF0aW9uCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEzMDgKICAgIC8vIFR4bi5zZW5kZXIsIG1hcmtldF9pZAogICAgdHhuIFNlbmRlcgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMzA3LTEzMDkKICAgIC8vIGFzc2VydCBub3Qgc2VsZi5faGFzX3Bvc2l0aW9uKAogICAgLy8gICAgIFR4bi5zZW5kZXIsIG1hcmtldF9pZAogICAgLy8gKSwgIkNhbm5vdCBtaW50L3JlZGVlbSB3aGVuIHVzZXIgaGFzIHRyYWNrZWQgZGVwb3NpdCBwb3NpdGlvbiIKICAgIGZyYW1lX2RpZyAtMgogICAgY2FsbHN1YiBfaGFzX3Bvc2l0aW9uCiAgICAhCiAgICBhc3NlcnQgLy8gQ2Fubm90IG1pbnQvcmVkZWVtIHdoZW4gdXNlciBoYXMgdHJhY2tlZCBkZXBvc2l0IHBvc2l0aW9uCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEzMTEtMTMxNwogICAgLy8gYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICBBUkMyMDBUb2tlbkludGVyZmFjZS5hcmMyMDBfdHJhbnNmZXJGcm9tLAogICAgLy8gICAgIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIC8vICAgICBhcmM0LkFkZHJlc3MoR2xvYmFsLmN1cnJlbnRfYXBwbGljYXRpb25fYWRkcmVzcyksCiAgICAvLyAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldF9pZCksCiAgICAvLyApCiAgICBpdHhuX2JlZ2luCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEzMTQKICAgIC8vIGFyYzQuQWRkcmVzcyhHbG9iYWwuY3VycmVudF9hcHBsaWNhdGlvbl9hZGRyZXNzKSwKICAgIGdsb2JhbCBDdXJyZW50QXBwbGljYXRpb25BZGRyZXNzCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEzMTMKICAgIC8vIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIHR4biBTZW5kZXIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTMxNQogICAgLy8gYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICBmcmFtZV9kaWcgLTEKICAgIGxlbgogICAgaW50IDMyCiAgICA8PQogICAgYXNzZXJ0IC8vIG92ZXJmbG93CiAgICBpbnQgMzIKICAgIGJ6ZXJvCiAgICBmcmFtZV9kaWcgLTEKICAgIGJ8CiAgICBmcmFtZV9kaWcgLTIKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25JRAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMzExLTEzMTcKICAgIC8vIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgQVJDMjAwVG9rZW5JbnRlcmZhY2UuYXJjMjAwX3RyYW5zZmVyRnJvbSwKICAgIC8vICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgYXJjNC5BZGRyZXNzKEdsb2JhbC5jdXJyZW50X2FwcGxpY2F0aW9uX2FkZHJlc3MpLAogICAgLy8gICAgIGFyYzQuVUludDI1NihhbW91bnQpLAogICAgLy8gICAgIGFwcF9pZD1BcHBsaWNhdGlvbihtYXJrZXRfaWQpLAogICAgLy8gKQogICAgbWV0aG9kICJhcmMyMDBfdHJhbnNmZXJGcm9tKGFkZHJlc3MsYWRkcmVzcyx1aW50MjU2KWJvb2wiCiAgICBpdHhuX2ZpZWxkIEFwcGxpY2F0aW9uQXJncwogICAgc3dhcAogICAgaXR4bl9maWVsZCBBcHBsaWNhdGlvbkFyZ3MKICAgIHN3YXAKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICBkdXAKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICBpbnQgYXBwbAogICAgaXR4bl9maWVsZCBUeXBlRW51bQogICAgaW50IDAKICAgIGl0eG5fZmllbGQgRmVlCiAgICBpdHhuX3N1Ym1pdAogICAgaXR4biBMYXN0TG9nCiAgICBleHRyYWN0IDAgNAogICAgYnl0ZSAweDE1MWY3Yzc1CiAgICA9PQogICAgYXNzZXJ0IC8vIEFSQzQgcHJlZml4IGlzIHZhbGlkCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEzMTktMTMyMQogICAgLy8gbmV3X21hcmtldCA9IHNlbGYuX2FjY3J1ZV9pbnRlcmVzdCgKICAgIC8vICAgICBtYXJrZXRfaWQKICAgIC8vICkgICMgR2V0IHVwZGF0ZWQgbWFya2V0IHdpdGggYWNjcnVlZCBpbnRlcmVzdAogICAgZnJhbWVfZGlnIC0yCiAgICBjYWxsc3ViIF9hY2NydWVfaW50ZXJlc3QKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTMyMwogICAgLy8gYW1vdW50ICogU0NBTEUKICAgIGZyYW1lX2RpZyAtMQogICAgYnl0ZSAweDBkZTBiNmIzYTc2NDAwMDAKICAgIGIqCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEzMjQKICAgIC8vICkgLy8gbmV3X21hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZSAgIyBDYWxjdWxhdGUgd2l0aCBuZXcgaW5kZXgKICAgIGRpZyAxCiAgICBleHRyYWN0IDE3NyAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTMyMi0xMzI0CiAgICAvLyBzY2FsZWRfYW1vdW50ID0gKAogICAgLy8gICAgIGFtb3VudCAqIFNDQUxFCiAgICAvLyApIC8vIG5ld19tYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUgICMgQ2FsY3VsYXRlIHdpdGggbmV3IGluZGV4CiAgICBiLwogICAgc3dhcAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMzI3CiAgICAvLyBuZXdfbWFya2V0Lm1heF90b3RhbF9kZXBvc2l0cy5uYXRpdmUKICAgIGR1cAogICAgZXh0cmFjdCAxIDMyIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgY292ZXIgMgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMzI4CiAgICAvLyA+PSBuZXdfbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKyBzY2FsZWRfYW1vdW50CiAgICBkdXAKICAgIGV4dHJhY3QgMTEzIDMyIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgZGlnIDIKICAgIGIrCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEzMjctMTMyOAogICAgLy8gbmV3X21hcmtldC5tYXhfdG90YWxfZGVwb3NpdHMubmF0aXZlCiAgICAvLyA+PSBuZXdfbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKyBzY2FsZWRfYW1vdW50CiAgICB1bmNvdmVyIDMKICAgIGI8PQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMzI2LTEzMjkKICAgIC8vIGFzc2VydCAoCiAgICAvLyAgICAgbmV3X21hcmtldC5tYXhfdG90YWxfZGVwb3NpdHMubmF0aXZlCiAgICAvLyAgICAgPj0gbmV3X21hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlICsgc2NhbGVkX2Ftb3VudAogICAgLy8gKSwgIkRlcG9zaXQgY2FwIGV4Y2VlZGVkIgogICAgYXNzZXJ0IC8vIERlcG9zaXQgY2FwIGV4Y2VlZGVkCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEzMzEtMTMzMgogICAgLy8gIyBPbmx5IGluY3JlbWVudCBtYXJrZXQgdG90YWwgZGVwb3NpdHMsIG5vdCB1c2VyIGRlcG9zaXRzIHNpbmNlIHBvc2l0aW9uIGlzIG5vdCB0cmFja2VkCiAgICAvLyBzZWxmLl9pbmNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9kZXBvc2l0cyhtYXJrZXRfaWQsIHNjYWxlZF9hbW91bnQpCiAgICBmcmFtZV9kaWcgLTIKICAgIHVuY292ZXIgMgogICAgY2FsbHN1YiBfaW5jcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfZGVwb3NpdHMKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTMzNC0xMzM5CiAgICAvLyBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgIE5Ub2tlbi5taW50LAogICAgLy8gICAgIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIC8vICAgICBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIC8vICAgICBhcHBfaWQ9QXBwbGljYXRpb24obmV3X21hcmtldC5udG9rZW5faWQubmF0aXZlKSwKICAgIC8vICkKICAgIGl0eG5fYmVnaW4KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTMzNgogICAgLy8gYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgdHhuIFNlbmRlcgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMzM4CiAgICAvLyBhcHBfaWQ9QXBwbGljYXRpb24obmV3X21hcmtldC5udG9rZW5faWQubmF0aXZlKSwKICAgIHN3YXAKICAgIGludCAzMTMKICAgIGludCA4CiAgICBleHRyYWN0MyAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIGJ0b2kKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25JRAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMzM0LTEzMzkKICAgIC8vIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgTlRva2VuLm1pbnQsCiAgICAvLyAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgIGFyYzQuVUludDI1NihhbW91bnQpLAogICAgLy8gICAgIGFwcF9pZD1BcHBsaWNhdGlvbihuZXdfbWFya2V0Lm50b2tlbl9pZC5uYXRpdmUpLAogICAgLy8gKQogICAgbWV0aG9kICJtaW50KGFkZHJlc3MsdWludDI1Nil2b2lkIgogICAgaXR4bl9maWVsZCBBcHBsaWNhdGlvbkFyZ3MKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICBkdXAKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICBpbnQgYXBwbAogICAgaXR4bl9maWVsZCBUeXBlRW51bQogICAgaW50IDAKICAgIGl0eG5fZmllbGQgRmVlCiAgICBpdHhuX3N1Ym1pdAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMzQzCiAgICAvLyBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksIGFyYzQuVUludDI1NihhbW91bnQpLCBhcmM0LlVJbnQ2NChtYXJrZXRfaWQpCiAgICB0eG4gU2VuZGVyCiAgICBmcmFtZV9kaWcgLTIKICAgIGl0b2IKICAgIHN3YXAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTM0Mi0xMzQ0CiAgICAvLyBNaW50RXZlbnQoCiAgICAvLyAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLCBhcmM0LlVJbnQyNTYoYW1vdW50KSwgYXJjNC5VSW50NjQobWFya2V0X2lkKQogICAgLy8gKQogICAgdW5jb3ZlciAyCiAgICBjb25jYXQKICAgIHN3YXAKICAgIGNvbmNhdAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMzQxLTEzNDUKICAgIC8vIGFyYzQuZW1pdCgKICAgIC8vICAgICBNaW50RXZlbnQoCiAgICAvLyAgICAgICAgIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwgYXJjNC5VSW50MjU2KGFtb3VudCksIGFyYzQuVUludDY0KG1hcmtldF9pZCkKICAgIC8vICAgICApCiAgICAvLyApCiAgICBtZXRob2QgIk1pbnRFdmVudChhZGRyZXNzLHVpbnQyNTYsdWludDY0KSIKICAgIHN3YXAKICAgIGNvbmNhdAogICAgbG9nCiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5zeW5jX3VzZXJfbWFya2V0X2Zvcl9wcmljZV9jaGFuZ2UodXNlcl9pZDogYnl0ZXMsIG1hcmtldF9pZDogYnl0ZXMpIC0+IHZvaWQ6CnN5bmNfdXNlcl9tYXJrZXRfZm9yX3ByaWNlX2NoYW5nZToKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTM0Ny0xMzUwCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBzeW5jX3VzZXJfbWFya2V0X2Zvcl9wcmljZV9jaGFuZ2UoCiAgICAvLyAgICAgc2VsZiwgdXNlcl9pZDogYXJjNC5BZGRyZXNzLCBtYXJrZXRfaWQ6IGFyYzQuVUludDY0CiAgICAvLyApIC0+IE5vbmU6CiAgICBwcm90byAyIDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTM1MQogICAgLy8gZW5zdXJlX2J1ZGdldCgxNDAwLCBPcFVwRmVlU291cmNlLkdyb3VwQ3JlZGl0KQogICAgaW50IDE0MDAKICAgIGludCAwCiAgICBjYWxsc3ViIGVuc3VyZV9idWRnZXQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTM1MwogICAgLy8gdXNlcl9pZC5uYXRpdmUsIG1hcmtldF9pZC5uYXRpdmUKICAgIGZyYW1lX2RpZyAtMQogICAgYnRvaQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMzUyLTEzNTQKICAgIC8vIHNlbGYuX3VwZGF0ZV91c2VyX2dsb2JhbF92YWx1ZXNfZm9yX3ByaWNlX2NoYW5nZSgKICAgIC8vICAgICB1c2VyX2lkLm5hdGl2ZSwgbWFya2V0X2lkLm5hdGl2ZQogICAgLy8gKQogICAgZnJhbWVfZGlnIC0yCiAgICBzd2FwCiAgICBjYWxsc3ViIF91cGRhdGVfdXNlcl9nbG9iYWxfdmFsdWVzX2Zvcl9wcmljZV9jaGFuZ2UKICAgIHJldHN1YgoKCi8vIGNvbnRyYWN0LkxlbmRpbmdQb29sLl91cGRhdGVfdXNlcl9nbG9iYWxfdmFsdWVzX2Zvcl9wcmljZV9jaGFuZ2UodXNlcl9pZDogYnl0ZXMsIG1hcmtldF9pZDogdWludDY0KSAtPiB2b2lkOgpfdXBkYXRlX3VzZXJfZ2xvYmFsX3ZhbHVlc19mb3JfcHJpY2VfY2hhbmdlOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMzU2LTEzNTkKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3VwZGF0ZV91c2VyX2dsb2JhbF92YWx1ZXNfZm9yX3ByaWNlX2NoYW5nZSgKICAgIC8vICAgICBzZWxmLCB1c2VyX2lkOiBBY2NvdW50LCBtYXJrZXRfaWQ6IFVJbnQ2NAogICAgLy8gKSAtPiBOb25lOgogICAgcHJvdG8gMiAwCiAgICBpbnQgMAogICAgZHVwbiA1CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEzNjEKICAgIC8vIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpLmNvcHkoKQogICAgZnJhbWVfZGlnIC0yCiAgICBmcmFtZV9kaWcgLTEKICAgIGNhbGxzdWIgX2dldF91c2VyCiAgICBkdXAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTM2MgogICAgLy8gaWYgdXNlci5zY2FsZWRfZGVwb3NpdHMgPT0gMCBhbmQgdXNlci5zY2FsZWRfYm9ycm93cyA9PSAwOgogICAgZXh0cmFjdCAwIDMyIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgZHVwCiAgICBieXRlIDB4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMAogICAgYj09CiAgICBieiBfdXBkYXRlX3VzZXJfZ2xvYmFsX3ZhbHVlc19mb3JfcHJpY2VfY2hhbmdlX2FmdGVyX2lmX2Vsc2VAMwogICAgZnJhbWVfZGlnIDYKICAgIGV4dHJhY3QgMzIgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBieXRlIDB4MDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMAogICAgYj09CiAgICBieiBfdXBkYXRlX3VzZXJfZ2xvYmFsX3ZhbHVlc19mb3JfcHJpY2VfY2hhbmdlX2FmdGVyX2lmX2Vsc2VAMwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMzYzCiAgICAvLyByZXR1cm4KICAgIHJldHN1YgoKX3VwZGF0ZV91c2VyX2dsb2JhbF92YWx1ZXNfZm9yX3ByaWNlX2NoYW5nZV9hZnRlcl9pZl9lbHNlQDM6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEzNjUKICAgIC8vIG1hcmtldCA9IHNlbGYuX2FjY3J1ZV9pbnRlcmVzdChtYXJrZXRfaWQpCiAgICBmcmFtZV9kaWcgLTEKICAgIGNhbGxzdWIgX2FjY3J1ZV9pbnRlcmVzdAogICAgZnJhbWVfYnVyeSAyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEzNjcKICAgIC8vIGlmIHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSA+IDA6CiAgICBmcmFtZV9kaWcgNwogICAgYnl0ZSAweAogICAgYj4KICAgIGJ6IF91cGRhdGVfdXNlcl9nbG9iYWxfdmFsdWVzX2Zvcl9wcmljZV9jaGFuZ2VfYWZ0ZXJfaWZfZWxzZUA4CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEzNjkKICAgIC8vIHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSAqIG1hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZQogICAgZnJhbWVfZGlnIDIKICAgIGV4dHJhY3QgMTc3IDMyIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgZnJhbWVfZGlnIDcKICAgIGIqCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEzNzAKICAgIC8vICkgLy8gU0NBTEUKICAgIGJ5dGUgMHgwZGUwYjZiM2E3NjQwMDAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEzNjgtMTM3MAogICAgLy8gZGVwb3NpdF9hbW91bnQgPSAoCiAgICAvLyAgICAgdXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlICogbWFya2V0LmRlcG9zaXRfaW5kZXgubmF0aXZlCiAgICAvLyApIC8vIFNDQUxFCiAgICBiLwogICAgZnJhbWVfYnVyeSAxCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEzNzQKICAgIC8vIGlmIHVzZXIubGFzdF9wcmljZS5uYXRpdmUgPiAwCiAgICBmcmFtZV9kaWcgNgogICAgZXh0cmFjdCAxMzYgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBkdXAKICAgIGZyYW1lX2J1cnkgNQogICAgYnl0ZSAweAogICAgYj4KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTM3My0xMzc1CiAgICAvLyB1c2VyLmxhc3RfcHJpY2UubmF0aXZlCiAgICAvLyBpZiB1c2VyLmxhc3RfcHJpY2UubmF0aXZlID4gMAogICAgLy8gZWxzZSBtYXJrZXQucHJpY2UubmF0aXZlCiAgICBieiBfdXBkYXRlX3VzZXJfZ2xvYmFsX3ZhbHVlc19mb3JfcHJpY2VfY2hhbmdlX3Rlcm5hcnlfZmFsc2VANgogICAgZnJhbWVfZGlnIDUKICAgIGIgX3VwZGF0ZV91c2VyX2dsb2JhbF92YWx1ZXNfZm9yX3ByaWNlX2NoYW5nZV90ZXJuYXJ5X21lcmdlQDcKCl91cGRhdGVfdXNlcl9nbG9iYWxfdmFsdWVzX2Zvcl9wcmljZV9jaGFuZ2VfdGVybmFyeV9mYWxzZUA2OgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMzc1CiAgICAvLyBlbHNlIG1hcmtldC5wcmljZS5uYXRpdmUKICAgIGZyYW1lX2RpZyAyCiAgICBpbnQgMjgxCiAgICBpbnQgMzIKICAgIGV4dHJhY3QzIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwoKX3VwZGF0ZV91c2VyX2dsb2JhbF92YWx1ZXNfZm9yX3ByaWNlX2NoYW5nZV90ZXJuYXJ5X21lcmdlQDc6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEzNzcKICAgIC8vIG9sZF9kZXBvc2l0X3ZhbHVlID0gKGRlcG9zaXRfYW1vdW50ICogcHJpY2VfZm9yX29sZCkgLy8gU0NBTEUKICAgIGZyYW1lX2RpZyAxCiAgICBkdXAKICAgIHVuY292ZXIgMgogICAgYioKICAgIGJ5dGUgMHgwZGUwYjZiM2E3NjQwMDAwCiAgICBiLwogICAgc3dhcAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMzc4CiAgICAvLyBuZXdfZGVwb3NpdF92YWx1ZSA9IChkZXBvc2l0X2Ftb3VudCAqIG1hcmtldC5wcmljZS5uYXRpdmUpIC8vIFNDQUxFCiAgICBmcmFtZV9kaWcgMgogICAgaW50IDI4MQogICAgaW50IDMyCiAgICBleHRyYWN0MyAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIGIqCiAgICBieXRlIDB4MGRlMGI2YjNhNzY0MDAwMAogICAgYi8KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTM3OS0xMzgxCiAgICAvLyBzZWxmLl91cGRhdGVfZ2xvYmFsX2NvbGxhdGVyYWwoCiAgICAvLyAgICAgdXNlcl9pZCwgbWFya2V0X2lkLCBvbGRfZGVwb3NpdF92YWx1ZSwgbmV3X2RlcG9zaXRfdmFsdWUKICAgIC8vICkKICAgIGZyYW1lX2RpZyAtMgogICAgZnJhbWVfZGlnIC0xCiAgICB1bmNvdmVyIDMKICAgIHVuY292ZXIgMwogICAgY2FsbHN1YiBfdXBkYXRlX2dsb2JhbF9jb2xsYXRlcmFsCgpfdXBkYXRlX3VzZXJfZ2xvYmFsX3ZhbHVlc19mb3JfcHJpY2VfY2hhbmdlX2FmdGVyX2lmX2Vsc2VAODoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTM4MwogICAgLy8gaWYgdXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgPiAwOgogICAgZnJhbWVfZGlnIDYKICAgIGV4dHJhY3QgMzIgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBkdXAKICAgIGZyYW1lX2J1cnkgMwogICAgYnl0ZSAweAogICAgYj4KICAgIGJ6IF91cGRhdGVfdXNlcl9nbG9iYWxfdmFsdWVzX2Zvcl9wcmljZV9jaGFuZ2VfYWZ0ZXJfaWZfZWxzZUAxMwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMzg1CiAgICAvLyB1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAqIG1hcmtldC5ib3Jyb3dfaW5kZXgubmF0aXZlCiAgICBmcmFtZV9kaWcgMgogICAgZXh0cmFjdCAyMDkgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBmcmFtZV9kaWcgMwogICAgYioKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTM4NgogICAgLy8gKSAvLyBTQ0FMRQogICAgYnl0ZSAweDBkZTBiNmIzYTc2NDAwMDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTM4NC0xMzg2CiAgICAvLyBib3Jyb3dfYW1vdW50ID0gKAogICAgLy8gICAgIHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlICogbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUKICAgIC8vICkgLy8gU0NBTEUKICAgIGIvCiAgICBmcmFtZV9idXJ5IDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTM5MAogICAgLy8gaWYgdXNlci5sYXN0X3ByaWNlLm5hdGl2ZSA+IDAKICAgIGZyYW1lX2RpZyA2CiAgICBleHRyYWN0IDEzNiAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIGR1cAogICAgZnJhbWVfYnVyeSA0CiAgICBieXRlIDB4CiAgICBiPgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMzg5LTEzOTEKICAgIC8vIHVzZXIubGFzdF9wcmljZS5uYXRpdmUKICAgIC8vIGlmIHVzZXIubGFzdF9wcmljZS5uYXRpdmUgPiAwCiAgICAvLyBlbHNlIG1hcmtldC5wcmljZS5uYXRpdmUKICAgIGJ6IF91cGRhdGVfdXNlcl9nbG9iYWxfdmFsdWVzX2Zvcl9wcmljZV9jaGFuZ2VfdGVybmFyeV9mYWxzZUAxMQogICAgZnJhbWVfZGlnIDQKICAgIGIgX3VwZGF0ZV91c2VyX2dsb2JhbF92YWx1ZXNfZm9yX3ByaWNlX2NoYW5nZV90ZXJuYXJ5X21lcmdlQDEyCgpfdXBkYXRlX3VzZXJfZ2xvYmFsX3ZhbHVlc19mb3JfcHJpY2VfY2hhbmdlX3Rlcm5hcnlfZmFsc2VAMTE6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEzOTEKICAgIC8vIGVsc2UgbWFya2V0LnByaWNlLm5hdGl2ZQogICAgZnJhbWVfZGlnIDIKICAgIGludCAyODEKICAgIGludCAzMgogICAgZXh0cmFjdDMgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCgpfdXBkYXRlX3VzZXJfZ2xvYmFsX3ZhbHVlc19mb3JfcHJpY2VfY2hhbmdlX3Rlcm5hcnlfbWVyZ2VAMTI6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEzOTMKICAgIC8vIG9sZF9ib3Jyb3dfdmFsdWUgPSAoYm9ycm93X2Ftb3VudCAqIHByaWNlX2Zvcl9vbGQpIC8vIFNDQUxFCiAgICBmcmFtZV9kaWcgMAogICAgZHVwCiAgICB1bmNvdmVyIDIKICAgIGIqCiAgICBieXRlIDB4MGRlMGI2YjNhNzY0MDAwMAogICAgYi8KICAgIHN3YXAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTM5NAogICAgLy8gbmV3X2JvcnJvd192YWx1ZSA9IChib3Jyb3dfYW1vdW50ICogbWFya2V0LnByaWNlLm5hdGl2ZSkgLy8gU0NBTEUKICAgIGZyYW1lX2RpZyAyCiAgICBpbnQgMjgxCiAgICBpbnQgMzIKICAgIGV4dHJhY3QzIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgYioKICAgIGJ5dGUgMHgwZGUwYjZiM2E3NjQwMDAwCiAgICBiLwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMzk1LTEzOTcKICAgIC8vIHNlbGYuX3VwZGF0ZV9nbG9iYWxfYm9ycm93cygKICAgIC8vICAgICB1c2VyX2lkLCBtYXJrZXRfaWQsIG9sZF9ib3Jyb3dfdmFsdWUsIG5ld19ib3Jyb3dfdmFsdWUKICAgIC8vICkKICAgIGZyYW1lX2RpZyAtMgogICAgZnJhbWVfZGlnIC0xCiAgICB1bmNvdmVyIDMKICAgIHVuY292ZXIgMwogICAgY2FsbHN1YiBfdXBkYXRlX2dsb2JhbF9ib3Jyb3dzCgpfdXBkYXRlX3VzZXJfZ2xvYmFsX3ZhbHVlc19mb3JfcHJpY2VfY2hhbmdlX2FmdGVyX2lmX2Vsc2VAMTM6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEzOTkKICAgIC8vIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIGZyYW1lX2RpZyAtMgogICAgZnJhbWVfZGlnIC0xCiAgICBjYWxsc3ViIF9nZXRfdXNlcl9rZXkKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTQwMAogICAgLy8gdXNlci5sYXN0X3ByaWNlID0gbWFya2V0LnByaWNlCiAgICBmcmFtZV9kaWcgMgogICAgaW50IDI4MQogICAgaW50IDMyCiAgICBleHRyYWN0MyAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIGZyYW1lX2RpZyA2CiAgICBzd2FwCiAgICByZXBsYWNlMiAxMzYKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTExCiAgICAvLyBzZWxmLnVzZXJzID0gQm94TWFwKEJ5dGVzNDAsIFVzZXJEYXRhKSAgIyBQZXItbWFya2V0IHVzZXIgc3RhdGUKICAgIGJ5dGUgInVzZXJzIgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNDAxCiAgICAvLyBzZWxmLnVzZXJzW3VzZXJfa2V5XSA9IHVzZXIuY29weSgpCiAgICB1bmNvdmVyIDIKICAgIGNvbmNhdAogICAgc3dhcAogICAgYm94X3B1dAogICAgcmV0c3ViCgoKLy8gY29udHJhY3QuTGVuZGluZ1Bvb2wuZ2V0X2dsb2JhbF91c2VyKHVzZXJfaWQ6IGJ5dGVzKSAtPiBieXRlczoKZ2V0X2dsb2JhbF91c2VyOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNDAzLTE0MDQKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF9nbG9iYWxfdXNlcihzZWxmLCB1c2VyX2lkOiBhcmM0LkFkZHJlc3MpIC0+IEdsb2JhbFVzZXJEYXRhOgogICAgcHJvdG8gMSAxCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE0MDUKICAgIC8vIHJldHVybiBzZWxmLl9nZXRfZ2xvYmFsX3VzZXIodXNlcl9pZC5uYXRpdmUpCiAgICBmcmFtZV9kaWcgLTEKICAgIGNhbGxzdWIgX2dldF9nbG9iYWxfdXNlcgogICAgcmV0c3ViCgoKLy8gY29udHJhY3QuTGVuZGluZ1Bvb2wuZ2V0X2dsb2JhbF91c2VyX2NvbGxhdGVyYWwodXNlcl9pZDogYnl0ZXMpIC0+IGJ5dGVzOgpnZXRfZ2xvYmFsX3VzZXJfY29sbGF0ZXJhbDoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTQwNy0xNDA4CiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBnZXRfZ2xvYmFsX3VzZXJfY29sbGF0ZXJhbChzZWxmLCB1c2VyX2lkOiBhcmM0LkFkZHJlc3MpIC0+IGFyYzQuVUludDI1NjoKICAgIHByb3RvIDEgMQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNDA5CiAgICAvLyByZXR1cm4gc2VsZi5fZ2V0X2dsb2JhbF91c2VyKHVzZXJfaWQubmF0aXZlKS50b3RhbF9jb2xsYXRlcmFsX3ZhbHVlCiAgICBmcmFtZV9kaWcgLTEKICAgIGNhbGxzdWIgX2dldF9nbG9iYWxfdXNlcgogICAgZXh0cmFjdCAwIDMyIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgcmV0c3ViCgoKLy8gY29udHJhY3QuTGVuZGluZ1Bvb2wuZ2V0X2dsb2JhbF91c2VyX2hlYWx0aCh1c2VyX2lkOiBieXRlcywgbGlxdWlkYXRpb25fdGhyZXNob2xkOiBieXRlcykgLT4gYnl0ZXM6CmdldF9nbG9iYWxfdXNlcl9oZWFsdGg6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE0NTctMTQ2MAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgZ2V0X2dsb2JhbF91c2VyX2hlYWx0aCgKICAgIC8vICAgICBzZWxmLCB1c2VyX2lkOiBhcmM0LkFkZHJlc3MsIGxpcXVpZGF0aW9uX3RocmVzaG9sZDogYXJjNC5VSW50NjQKICAgIC8vICkgLT4gYXJjNC5VSW50MjU2OgogICAgcHJvdG8gMiAxCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE0NjIKICAgIC8vIHNlbGYuX2dldF9nbG9iYWxfdXNlcl9oZWFsdGgodXNlcl9pZC5uYXRpdmUsIGxpcXVpZGF0aW9uX3RocmVzaG9sZC5uYXRpdmUpCiAgICBmcmFtZV9kaWcgLTEKICAgIGJ0b2kKICAgIGZyYW1lX2RpZyAtMgogICAgc3dhcAogICAgY2FsbHN1YiBfZ2V0X2dsb2JhbF91c2VyX2hlYWx0aAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNDYxLTE0NjMKICAgIC8vIHJldHVybiBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgc2VsZi5fZ2V0X2dsb2JhbF91c2VyX2hlYWx0aCh1c2VyX2lkLm5hdGl2ZSwgbGlxdWlkYXRpb25fdGhyZXNob2xkLm5hdGl2ZSkKICAgIC8vICkKICAgIGR1cAogICAgbGVuCiAgICBpbnQgMzIKICAgIDw9CiAgICBhc3NlcnQgLy8gb3ZlcmZsb3cKICAgIGludCAzMgogICAgYnplcm8KICAgIGJ8CiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5fZ2V0X2dsb2JhbF91c2VyX2hlYWx0aCh1c2VyX2lkOiBieXRlcywgbGlxdWlkYXRpb25fdGhyZXNob2xkOiB1aW50NjQpIC0+IGJ5dGVzOgpfZ2V0X2dsb2JhbF91c2VyX2hlYWx0aDoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTQ2NS0xNDY4CiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9nZXRfZ2xvYmFsX3VzZXJfaGVhbHRoKAogICAgLy8gICAgIHNlbGYsIHVzZXJfaWQ6IEFjY291bnQsIGxpcXVpZGF0aW9uX3RocmVzaG9sZDogVUludDY0CiAgICAvLyApIC0+IEJpZ1VJbnQ6CiAgICBwcm90byAyIDEKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTQ2OQogICAgLy8gZ2xvYmFsX3VzZXIgPSBzZWxmLl9nZXRfZ2xvYmFsX3VzZXIodXNlcl9pZCkKICAgIGZyYW1lX2RpZyAtMgogICAgY2FsbHN1YiBfZ2V0X2dsb2JhbF91c2VyCiAgICBkdXAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTQ3MQogICAgLy8gaWYgZ2xvYmFsX3VzZXIudG90YWxfYm9ycm93X3ZhbHVlLm5hdGl2ZSA9PSAwOgogICAgZXh0cmFjdCAzMiAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIGR1cAogICAgYnl0ZSAweAogICAgYj09CiAgICBieiBfZ2V0X2dsb2JhbF91c2VyX2hlYWx0aF9hZnRlcl9pZl9lbHNlQDIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTQ3MgogICAgLy8gcmV0dXJuIEJpZ1VJbnQoMCkgICMgTm8gZGVidCA9IGluZmluaXRlIGhlYWx0aAogICAgYnl0ZSAweAogICAgZnJhbWVfYnVyeSAwCiAgICByZXRzdWIKCl9nZXRfZ2xvYmFsX3VzZXJfaGVhbHRoX2FmdGVyX2lmX2Vsc2VAMjoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTQ3NQogICAgLy8gZ2xvYmFsX3VzZXIudG90YWxfY29sbGF0ZXJhbF92YWx1ZS5uYXRpdmUKICAgIGZyYW1lX2RpZyAwCiAgICBleHRyYWN0IDAgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE0NzYKICAgIC8vICogQmlnVUludChsaXF1aWRhdGlvbl90aHJlc2hvbGQpCiAgICBmcmFtZV9kaWcgLTEKICAgIGl0b2IKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTQ3NS0xNDc2CiAgICAvLyBnbG9iYWxfdXNlci50b3RhbF9jb2xsYXRlcmFsX3ZhbHVlLm5hdGl2ZQogICAgLy8gKiBCaWdVSW50KGxpcXVpZGF0aW9uX3RocmVzaG9sZCkKICAgIGIqCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE0NzcKICAgIC8vICogQmlnVUludCgxMDAwMCkKICAgIGJ5dGUgMHgyNzEwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE0NzUtMTQ3NwogICAgLy8gZ2xvYmFsX3VzZXIudG90YWxfY29sbGF0ZXJhbF92YWx1ZS5uYXRpdmUKICAgIC8vICogQmlnVUludChsaXF1aWRhdGlvbl90aHJlc2hvbGQpCiAgICAvLyAqIEJpZ1VJbnQoMTAwMDApCiAgICBiKgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNDc4CiAgICAvLyApIC8vIChnbG9iYWxfdXNlci50b3RhbF9ib3Jyb3dfdmFsdWUubmF0aXZlICogQmlnVUludCgxMDAwMCkpCiAgICBmcmFtZV9kaWcgMQogICAgYnl0ZSAweDI3MTAKICAgIGIqCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE0NzQtMTQ3OAogICAgLy8gaGVhbHRoID0gKAogICAgLy8gICAgIGdsb2JhbF91c2VyLnRvdGFsX2NvbGxhdGVyYWxfdmFsdWUubmF0aXZlCiAgICAvLyAgICAgKiBCaWdVSW50KGxpcXVpZGF0aW9uX3RocmVzaG9sZCkKICAgIC8vICAgICAqIEJpZ1VJbnQoMTAwMDApCiAgICAvLyApIC8vIChnbG9iYWxfdXNlci50b3RhbF9ib3Jyb3dfdmFsdWUubmF0aXZlICogQmlnVUludCgxMDAwMCkpCiAgICBiLwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNDc5CiAgICAvLyByZXR1cm4gaGVhbHRoCiAgICBmcmFtZV9idXJ5IDAKICAgIHJldHN1YgoKCi8vIGNvbnRyYWN0LkxlbmRpbmdQb29sLmxpcXVpZGF0ZV9jcm9zc19tYXJrZXQoZGVidF9tYXJrZXRfaWQ6IGJ5dGVzLCBjb2xsYXRlcmFsX21hcmtldF9pZDogYnl0ZXMsIHVzZXI6IGJ5dGVzLCBkZWJ0X2Ftb3VudDogYnl0ZXMpIC0+IHZvaWQ6CmxpcXVpZGF0ZV9jcm9zc19tYXJrZXQ6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE0ODUtMTQ5MgogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgbGlxdWlkYXRlX2Nyb3NzX21hcmtldCgKICAgIC8vICAgICBzZWxmLAogICAgLy8gICAgIGRlYnRfbWFya2V0X2lkOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBjb2xsYXRlcmFsX21hcmtldF9pZDogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgdXNlcjogYXJjNC5BZGRyZXNzLAogICAgLy8gICAgIGRlYnRfYW1vdW50OiBhcmM0LlVJbnQyNTYsCiAgICAvLyApIC0+IE5vbmU6CiAgICBwcm90byA0IDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTQ5MwogICAgLy8gZW5zdXJlX2J1ZGdldCgyMTAwLCBPcFVwRmVlU291cmNlLkdyb3VwQ3JlZGl0KQogICAgaW50IDIxMDAKICAgIGludCAwCiAgICBjYWxsc3ViIGVuc3VyZV9idWRnZXQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTQ5NAogICAgLy8gYXNzZXJ0IG5vdCBzZWxmLl9pc19wYXVzZWQoKSwgIlByb3RvY29sIGlzIHBhdXNlZCIKICAgIGNhbGxzdWIgX2lzX3BhdXNlZAogICAgIQogICAgYXNzZXJ0IC8vIFByb3RvY29sIGlzIHBhdXNlZAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNDk2CiAgICAvLyBkZWJ0X21hcmtldF9pZC5uYXRpdmUsCiAgICBmcmFtZV9kaWcgLTQKICAgIGJ0b2kKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTQ5NwogICAgLy8gY29sbGF0ZXJhbF9tYXJrZXRfaWQubmF0aXZlLAogICAgZnJhbWVfZGlnIC0zCiAgICBidG9pCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE0OTUtMTUwMAogICAgLy8gc2VsZi5fbGlxdWlkYXRlX2Nyb3NzX21hcmtldCgKICAgIC8vICAgICBkZWJ0X21hcmtldF9pZC5uYXRpdmUsCiAgICAvLyAgICAgY29sbGF0ZXJhbF9tYXJrZXRfaWQubmF0aXZlLAogICAgLy8gICAgIHVzZXIubmF0aXZlLAogICAgLy8gICAgIGRlYnRfYW1vdW50Lm5hdGl2ZSwKICAgIC8vICkKICAgIGZyYW1lX2RpZyAtMgogICAgZnJhbWVfZGlnIC0xCiAgICBjYWxsc3ViIF9saXF1aWRhdGVfY3Jvc3NfbWFya2V0CiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5fbGlxdWlkYXRlX2Nyb3NzX21hcmtldChkZWJ0X21hcmtldF9pZDogdWludDY0LCBjb2xsYXRlcmFsX21hcmtldF9pZDogdWludDY0LCB1c2VyX2lkOiBieXRlcywgZGVidF9hbW91bnQ6IGJ5dGVzKSAtPiB2b2lkOgpfbGlxdWlkYXRlX2Nyb3NzX21hcmtldDoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTUwMi0xNTA5CiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9saXF1aWRhdGVfY3Jvc3NfbWFya2V0KAogICAgLy8gICAgIHNlbGYsCiAgICAvLyAgICAgZGVidF9tYXJrZXRfaWQ6IFVJbnQ2NCwKICAgIC8vICAgICBjb2xsYXRlcmFsX21hcmtldF9pZDogVUludDY0LAogICAgLy8gICAgIHVzZXJfaWQ6IEFjY291bnQsCiAgICAvLyAgICAgZGVidF9hbW91bnQ6IEJpZ1VJbnQsCiAgICAvLyApIC0+IE5vbmU6CiAgICBwcm90byA0IDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTEwLTE1MTAKICAgIC8vICAgICBzZWxmLm1hcmtldHMgPSBCb3hNYXAoVUludDY0LCBNYXJrZXREYXRhKSAgIyBNYXJrZXQgc3RhdGUKICAgIC8vICAgICBzZWxmLnVzZXJzID0gQm94TWFwKEJ5dGVzNDAsIFVzZXJEYXRhKSAgIyBQZXItbWFya2V0IHVzZXIgc3RhdGUKICAgIC8vICAgICBzZWxmLmdsb2JhbF91c2VycyA9IEJveE1hcChBY2NvdW50LCBHbG9iYWxVc2VyRGF0YSkgICMgR2xvYmFsIHVzZXIgc3RhdGUKICAgIC8vIAogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAjIE93bmFibGUKICAgIC8vICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9vbmx5X293bmVyKHNlbGYpIC0+IE5vbmU6CiAgICAvLyAgICAgYXNzZXJ0IFR4bi5zZW5kZXIgPT0gc2VsZi5vd25lciwgIm9ubHkgdGhlIG93bmVyIGNhbiBjYWxsIHRoaXMgZnVuY3Rpb24iCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZChyZWFkb25seT1UcnVlKQogICAgLy8gZGVmIGdldF9vd25lcihzZWxmKSAtPiBhcmM0LkFkZHJlc3M6CiAgICAvLyAgICAgcmV0dXJuIGFyYzQuQWRkcmVzcyhzZWxmLm93bmVyKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiB0cmFuc2Zlcl9vd25lcnNoaXAoc2VsZiwgbmV3X293bmVyOiBhcmM0LkFkZHJlc3MpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgc2VsZi5fdHJhbnNmZXJfb3duZXJzaGlwKG5ld19vd25lci5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3RyYW5zZmVyX293bmVyc2hpcChzZWxmLCBuZXdfb3duZXI6IEFjY291bnQpIC0+IE5vbmU6CiAgICAvLyAgICAgcHJldmlvdXNfb3duZXIgPSBzZWxmLm93bmVyCiAgICAvLyAgICAgc2VsZi5vd25lciA9IG5ld19vd25lcgogICAgLy8gICAgIGFyYzQuZW1pdCgKICAgIC8vICAgICAgICAgT3duZXJzaGlwVHJhbnNmZXJyZWQoYXJjNC5BZGRyZXNzKHByZXZpb3VzX293bmVyKSwgYXJjNC5BZGRyZXNzKG5ld19vd25lcikpCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIAogICAgLy8gIyBSRU0gaGF2aW5nIGlzc3VlcyB3aXRoIHRoZSBpbmhlcml0YW5jZSBoZXJlCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGlzX3BhdXNlZChzZWxmKSAtPiBhcmM0LkJvb2w6CiAgICAvLyAgICAgcmV0dXJuIGFyYzQuQm9vbChzZWxmLl9pc19wYXVzZWQoKSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaXNfcGF1c2VkKHNlbGYpIC0+IGJvb2w6CiAgICAvLyAgICAgcmV0dXJuIHNlbGYucGF1c2VkID09IFVJbnQ2NCgxKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBwYXVzZShzZWxmLCBwYXVzZTogYXJjNC5VSW50NjQpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgc2VsZi5fcGF1c2UocGF1c2UubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9wYXVzZShzZWxmLCBwYXVzZTogVUludDY0KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYucGF1c2VkID0gcGF1c2UKICAgIC8vIAogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF9zdG9rZW5fYXBwX2lkKHNlbGYpIC0+IGFyYzQuVUludDY0OgogICAgLy8gICAgIHJldHVybiBhcmM0LlVJbnQ2NChzZWxmLl9nZXRfc3Rva2VuX2FwcF9pZCgpKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9nZXRfc3Rva2VuX2FwcF9pZChzZWxmKSAtPiBVSW50NjQ6CiAgICAvLyAgICAgcmV0dXJuIHNlbGYuc3Rva2VuX2FwcF9pZAogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBzZXRfc3Rva2VuX2FwcF9pZChzZWxmLCBzdG9rZW5fYXBwX2lkOiBhcmM0LlVJbnQ2NCkgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLl9vbmx5X293bmVyKCkKICAgIC8vICAgICBzZWxmLnN0b2tlbl9hcHBfaWQgPSBzdG9rZW5fYXBwX2lkLm5hdGl2ZQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9nZXRfdXNlcl9rZXkoc2VsZiwgdXNlcl9pZDogQWNjb3VudCwgbWFya2V0X2lkOiBVSW50NjQpIC0+IEJ5dGVzNDA6CiAgICAvLyAgICAgcmV0dXJuIEJ5dGVzNDAuZnJvbV9ieXRlcygKICAgIC8vICAgICAgICAgYXJjNC5BZGRyZXNzKHVzZXJfaWQpLmJ5dGVzICsgYXJjNC5VSW50NjQobWFya2V0X2lkKS5ieXRlcwogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgZ2V0X3VzZXIoc2VsZiwgdXNlcl9pZDogYXJjNC5BZGRyZXNzLCBtYXJrZXRfaWQ6IGFyYzQuVUludDY0KSAtPiBVc2VyRGF0YToKICAgIC8vICAgICByZXR1cm4gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZC5uYXRpdmUsIG1hcmtldF9pZC5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2dldF91c2VyKHNlbGYsIHVzZXJfaWQ6IEFjY291bnQsIG1hcmtldF9pZDogVUludDY0KSAtPiBVc2VyRGF0YToKICAgIC8vICAgICB1c2VyX2tleSA9IHNlbGYuX2dldF91c2VyX2tleSh1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgcmV0dXJuIHNlbGYudXNlcnMuZ2V0KAogICAgLy8gICAgICAgICB1c2VyX2tleSwKICAgIC8vICAgICAgICAgZGVmYXVsdD1Vc2VyRGF0YSgKICAgIC8vICAgICAgICAgICAgIHNjYWxlZF9kZXBvc2l0cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBzY2FsZWRfYm9ycm93cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBkZXBvc2l0X2luZGV4PWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGJvcnJvd19pbmRleD1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBsYXN0X3VwZGF0ZV90aW1lPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgbGFzdF9wcmljZT1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICksCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9oYXNfcG9zaXRpb24oc2VsZiwgdXNlcl9pZDogQWNjb3VudCwgbWFya2V0X2lkOiBVSW50NjQpIC0+IGJvb2w6CiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICByZXR1cm4gdXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlID4gMAogICAgLy8gCiAgICAvLyAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIAogICAgLy8gIyBSRU0gY29uc2lkZXIgcmVtb3ZpbmcgYW5kIGNhbGN1bGF0aW5nIGluIHRoZSBjbGllbnQKICAgIC8vICMgUkVNIHRyeWluZyB0byBjdXQgYmFjayBvbiBleHRyYSBwYWdlcwogICAgLy8gCiAgICAvLyAjIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gIyBkZWYgZ2V0X3VzZXJfZGVwb3NpdF91bmRlcmx5aW5nX2Ftb3VudCgKICAgIC8vICMgICAgIHNlbGYsIHVzZXJfaWQ6IGFyYzQuQWRkcmVzcywgbWFya2V0X2lkOiBhcmM0LlVJbnQ2NAogICAgLy8gIyApIC0+IGFyYzQuVUludDI1NjoKICAgIC8vICMgICAgIHJldHVybiBhcmM0LlVJbnQyNTYoCiAgICAvLyAjICAgICAgICAgc2VsZi5fZ2V0X3VzZXJfZGVwb3NpdF91bmRlcmx5aW5nX2Ftb3VudCh1c2VyX2lkLm5hdGl2ZSwgbWFya2V0X2lkLm5hdGl2ZSkKICAgIC8vICMgICAgICkKICAgIC8vIAogICAgLy8gIyBAc3Vicm91dGluZQogICAgLy8gIyBkZWYgX2dldF91c2VyX2RlcG9zaXRfdW5kZXJseWluZ19hbW91bnQoCiAgICAvLyAjICAgICBzZWxmLCB1c2VyX2lkOiBBY2NvdW50LCBtYXJrZXRfaWQ6IFVJbnQ2NAogICAgLy8gIyApIC0+IEJpZ1VJbnQ6CiAgICAvLyAjICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gIyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpICAjIEFkZCB0aGlzIGxpbmUKICAgIC8vICMgICAgIHJldHVybiAodXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlICogbWFya2V0LmRlcG9zaXRfaW5kZXgubmF0aXZlKSAvLyBTQ0FMRQogICAgLy8gCiAgICAvLyAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaW5jcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9kZXBvc2l0cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgdXNlcl9pZDogQWNjb3VudCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyX2tleSA9IHNlbGYuX2dldF91c2VyX2tleSh1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlci5zY2FsZWRfZGVwb3NpdHMgPSBhcmM0LlVJbnQyNTYodXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlICsgYW1vdW50KQogICAgLy8gICAgIHVzZXIuZGVwb3NpdF9pbmRleCA9IG1hcmtldC5kZXBvc2l0X2luZGV4CiAgICAvLyAgICAgdXNlci5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApCiAgICAvLyAgICAgdXNlci5sYXN0X3ByaWNlID0gbWFya2V0LnByaWNlICAjIFVwZGF0ZSB1c2VyJ3MgbGFzdCBrbm93biBwcmljZQogICAgLy8gICAgIHNlbGYudXNlcnNbdXNlcl9rZXldID0gdXNlci5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaW5jcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9ib3Jyb3dzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCB1c2VyX2lkOiBBY2NvdW50LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyLnNjYWxlZF9ib3Jyb3dzID0gYXJjNC5VSW50MjU2KHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlICsgYW1vdW50KQogICAgLy8gICAgIHVzZXIuYm9ycm93X2luZGV4ID0gbWFya2V0LmJvcnJvd19pbmRleAogICAgLy8gICAgIHVzZXIubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gICAgIHVzZXIubGFzdF9wcmljZSA9IG1hcmtldC5wcmljZSAgIyBVcGRhdGUgdXNlcidzIGxhc3Qga25vd24gcHJpY2UKICAgIC8vICAgICBzZWxmLnVzZXJzW3VzZXJfa2V5XSA9IHVzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2RlY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfZGVwb3NpdHMoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIHVzZXJfaWQ6IEFjY291bnQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlcl9rZXkgPSBzZWxmLl9nZXRfdXNlcl9rZXkodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgIHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSA+PSBhbW91bnQKICAgIC8vICAgICApLCAiSW5zdWZmaWNpZW50IGJhbGFuY2UgdG8gd2l0aGRyYXcgdGhpcyBhbW91bnQiCiAgICAvLyAgICAgdXNlci5zY2FsZWRfZGVwb3NpdHMgPSBhcmM0LlVJbnQyNTYodXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlIC0gYW1vdW50KQogICAgLy8gICAgIHVzZXIuZGVwb3NpdF9pbmRleCA9IG1hcmtldC5kZXBvc2l0X2luZGV4CiAgICAvLyAgICAgdXNlci5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApCiAgICAvLyAgICAgdXNlci5sYXN0X3ByaWNlID0gbWFya2V0LnByaWNlICAjIFVwZGF0ZSB1c2VyJ3MgbGFzdCBrbm93biBwcmljZQogICAgLy8gICAgIHNlbGYudXNlcnNbdXNlcl9rZXldID0gdXNlci5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZGVjcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9ib3Jyb3dzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCB1c2VyX2lkOiBBY2NvdW50LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICB1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSA+PSBhbW91bnQKICAgIC8vICAgICApLCAiSW5zdWZmaWNpZW50IGJhbGFuY2UgdG8gcmVwYXkgdGhpcyBhbW91bnQiCiAgICAvLyAgICAgdXNlci5zY2FsZWRfYm9ycm93cyA9IGFyYzQuVUludDI1Nih1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAtIGFtb3VudCkKICAgIC8vICAgICB1c2VyLmJvcnJvd19pbmRleCA9IG1hcmtldC5ib3Jyb3dfaW5kZXgKICAgIC8vICAgICB1c2VyLmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vICAgICB1c2VyLmxhc3RfcHJpY2UgPSBtYXJrZXQucHJpY2UgICMgVXBkYXRlIHVzZXIncyBsYXN0IGtub3duIHByaWNlCiAgICAvLyAgICAgc2VsZi51c2Vyc1t1c2VyX2tleV0gPSB1c2VyLmNvcHkoKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBjcmVhdGVfbWFya2V0KAogICAgLy8gICAgIHNlbGYsCiAgICAvLyAgICAgdG9rZW5faWQ6IGFyYzQuVUludDY0LAogICAgLy8gICAgIGNvbGxhdGVyYWxfZmFjdG9yOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBsaXF1aWRhdGlvbl90aHJlc2hvbGQ6IGFyYzQuVUludDY0LAogICAgLy8gICAgIHJlc2VydmVfZmFjdG9yOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBib3Jyb3dfcmF0ZTogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgc2xvcGU6IGFyYzQuVUludDY0LAogICAgLy8gICAgIG1heF90b3RhbF9kZXBvc2l0czogYXJjNC5VSW50MjU2LAogICAgLy8gICAgIG1heF90b3RhbF9ib3Jyb3dzOiBhcmM0LlVJbnQyNTYsCiAgICAvLyAgICAgbGlxdWlkYXRpb25fYm9udXM6IGFyYzQuVUludDY0LAogICAgLy8gICAgIGNsb3NlX2ZhY3RvcjogYXJjNC5VSW50NjQsCiAgICAvLyApIC0+IGFyYzQuVUludDY0OgogICAgLy8gICAgIHNlbGYuX29ubHlfb3duZXIoKQogICAgLy8gICAgIGFzc2VydCBub3Qgc2VsZi5faXNfcGF1c2VkKCksICJQcm90b2NvbCBpcyBwYXVzZWQiCiAgICAvLyAgICAgcmV0dXJuIGFyYzQuVUludDY0KAogICAgLy8gICAgICAgICBzZWxmLl9jcmVhdGVfbWFya2V0KAogICAgLy8gICAgICAgICAgICAgdG9rZW5faWQubmF0aXZlLAogICAgLy8gICAgICAgICAgICAgTWFya2V0RGF0YSgKICAgIC8vICAgICAgICAgICAgICAgICBwYXVzZWQ9YXJjNC5Cb29sKFRydWUpLCAgIyBTdGFydCBwYXVzZWQgdW50aWwgcHJpY2UgaXMgc2V0CiAgICAvLyAgICAgICAgICAgICAgICAgbWF4X3RvdGFsX2RlcG9zaXRzPW1heF90b3RhbF9kZXBvc2l0cywKICAgIC8vICAgICAgICAgICAgICAgICBtYXhfdG90YWxfYm9ycm93cz1tYXhfdG90YWxfYm9ycm93cywKICAgIC8vICAgICAgICAgICAgICAgICBsaXF1aWRhdGlvbl9ib251cz1saXF1aWRhdGlvbl9ib251cywKICAgIC8vICAgICAgICAgICAgICAgICBjb2xsYXRlcmFsX2ZhY3Rvcj1jb2xsYXRlcmFsX2ZhY3RvciwKICAgIC8vICAgICAgICAgICAgICAgICBsaXF1aWRhdGlvbl90aHJlc2hvbGQ9bGlxdWlkYXRpb25fdGhyZXNob2xkLAogICAgLy8gICAgICAgICAgICAgICAgIHJlc2VydmVfZmFjdG9yPXJlc2VydmVfZmFjdG9yLAogICAgLy8gICAgICAgICAgICAgICAgIGJvcnJvd19yYXRlPWJvcnJvd19yYXRlLAogICAgLy8gICAgICAgICAgICAgICAgIHNsb3BlPXNsb3BlLAogICAgLy8gICAgICAgICAgICAgICAgIHRvdGFsX3NjYWxlZF9kZXBvc2l0cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICAgICAgdG90YWxfc2NhbGVkX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgICAgIGRlcG9zaXRfaW5kZXg9YXJjNC5VSW50MjU2KFNDQUxFKSwgICMgU3RhcnQgYXQgU0NBTEUgKDEuMCkKICAgIC8vICAgICAgICAgICAgICAgICBib3Jyb3dfaW5kZXg9YXJjNC5VSW50MjU2KFNDQUxFKSwgICMgU3RhcnQgYXQgU0NBTEUgKDEuMCkKICAgIC8vICAgICAgICAgICAgICAgICBsYXN0X3VwZGF0ZV90aW1lPWFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKSwKICAgIC8vICAgICAgICAgICAgICAgICByZXNlcnZlcz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICAgICAgcHJpY2U9YXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICAgICAgICAgICAgICAwCiAgICAvLyAgICAgICAgICAgICAgICAgKSwgICMgUHJpY2UgbXVzdCBiZSBzZXQgYmVmb3JlIG1hcmtldCBjYW4gYmUgdXNlZAogICAgLy8gICAgICAgICAgICAgICAgIG50b2tlbl9pZD1hcmM0LlVJbnQ2NCgwKSwgICMgV2lsbCBiZSBzZXQgZHVyaW5nIHRva2VuIGluaXRpYWxpemF0aW9uCiAgICAvLyAgICAgICAgICAgICAgICAgY2xvc2VfZmFjdG9yPWNsb3NlX2ZhY3RvciwKICAgIC8vICAgICAgICAgICAgICksCiAgICAvLyAgICAgICAgICkKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2NyZWF0ZV9tYXJrZXQoc2VsZiwgdG9rZW5faWQ6IFVJbnQ2NCwgbWFya2V0X2RhdGE6IE1hcmtldERhdGEpIC0+IFVJbnQ2NDoKICAgIC8vICAgICBhc3NlcnQgbm90IHRva2VuX2lkIGluIHNlbGYubWFya2V0cywgIk1hcmtldCBhbHJlYWR5IGV4aXN0cyIKICAgIC8vICAgICBwYXltZW50ID0gcmVxdWlyZV9wYXltZW50KFR4bi5zZW5kZXIpCiAgICAvLyAgICAgYXNzZXJ0ICgKICAgIC8vICAgICAgICAgcGF5bWVudCA+PSBzZWxmLl9jcmVhdGVfbWFya2V0X2Nvc3QoKQogICAgLy8gICAgICksICJpbnN1ZmZpY2llbnQgcGF5bWVudCBmb3IgY3JlYXRlIG1hcmtldCIKICAgIC8vICAgICBjb21waWxlZCA9IGNvbXBpbGVfY29udHJhY3QoTlRva2VuLCBleHRyYV9wcm9ncmFtX3BhZ2VzPTApICAjIG5vIGV4dHJhIHBhZ2VzCiAgICAvLyAgICAgYmFzZV9hcHAgPSBhcmM0LmFyYzRfY3JlYXRlKE5Ub2tlbiwgY29tcGlsZWQ9Y29tcGlsZWQpLmNyZWF0ZWRfYXBwCiAgICAvLyAgICAgYm9vdHN0cmFwNjRfY29zdCwgdHhuMSA9IGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIE5Ub2tlbi5ib290c3RyYXA2NF9jb3N0LAogICAgLy8gICAgICAgICBhcHBfaWQ9YmFzZV9hcHAsCiAgICAvLyAgICAgKQogICAgLy8gICAgIGl0eG4uUGF5bWVudCgKICAgIC8vICAgICAgICAgcmVjZWl2ZXI9YmFzZV9hcHAuYWRkcmVzcywgYW1vdW50PWJvb3RzdHJhcDY0X2Nvc3QubmF0aXZlLCBmZWU9MAogICAgLy8gICAgICkuc3VibWl0KCkKICAgIC8vICAgICBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgICAgICBOVG9rZW4uYm9vdHN0cmFwNjQsCiAgICAvLyAgICAgICAgIGFyYzQuVUludDY0KHRva2VuX2lkKSwKICAgIC8vICAgICAgICAgYXBwX2lkPWJhc2VfYXBwLAogICAgLy8gICAgICkKICAgIC8vICAgICBtYXJrZXRfZGF0YS5udG9rZW5faWQgPSBhcmM0LlVJbnQ2NChiYXNlX2FwcC5pZCkKICAgIC8vICAgICBzZWxmLm1hcmtldHNbdG9rZW5faWRdID0gbWFya2V0X2RhdGEuY29weSgpCiAgICAvLyAgICAgYXJjNC5lbWl0KAogICAgLy8gICAgICAgICBNYXJrZXRDcmVhdGVkKGFyYzQuVUludDY0KHRva2VuX2lkKSwgYXJjNC5VSW50NjQoYmFzZV9hcHAuaWQpLCBtYXJrZXRfZGF0YSkKICAgIC8vICAgICApCiAgICAvLyAgICAgcmV0dXJuIGJhc2VfYXBwLmlkCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZChyZWFkb25seT1UcnVlKQogICAgLy8gZGVmIGNyZWF0ZV9tYXJrZXRfY29zdChzZWxmKSAtPiBhcmM0LlVJbnQ2NDoKICAgIC8vICAgICByZXR1cm4gYXJjNC5VSW50NjQoc2VsZi5fY3JlYXRlX21hcmtldF9jb3N0KCkpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2NyZWF0ZV9tYXJrZXRfY29zdChzZWxmKSAtPiBVSW50NjQ6CiAgICAvLyAgICAgcmV0dXJuIFVJbnQ2NCgxXzAwMF8wMDApCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZChyZWFkb25seT1UcnVlKQogICAgLy8gZGVmIGdldF9tYXJrZXQoc2VsZiwgdG9rZW5faWQ6IGFyYzQuVUludDY0KSAtPiBNYXJrZXREYXRhOgogICAgLy8gICAgIHJldHVybiBzZWxmLl9nZXRfbWFya2V0KHRva2VuX2lkLm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X21hcmtldChzZWxmLCB0b2tlbl9pZDogVUludDY0KSAtPiBNYXJrZXREYXRhOgogICAgLy8gICAgIHJldHVybiBzZWxmLm1hcmtldHMuZ2V0KAogICAgLy8gICAgICAgICB0b2tlbl9pZCwKICAgIC8vICAgICAgICAgZGVmYXVsdD1NYXJrZXREYXRhKAogICAgLy8gICAgICAgICAgICAgcGF1c2VkPWFyYzQuQm9vbChUcnVlKSwKICAgIC8vICAgICAgICAgICAgIG1heF90b3RhbF9kZXBvc2l0cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBtYXhfdG90YWxfYm9ycm93cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBsaXF1aWRhdGlvbl9ib251cz1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIGNvbGxhdGVyYWxfZmFjdG9yPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgbGlxdWlkYXRpb25fdGhyZXNob2xkPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgcmVzZXJ2ZV9mYWN0b3I9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICBib3Jyb3dfcmF0ZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIHNsb3BlPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgdG90YWxfc2NhbGVkX2RlcG9zaXRzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIHRvdGFsX3NjYWxlZF9ib3Jyb3dzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGRlcG9zaXRfaW5kZXg9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgYm9ycm93X2luZGV4PWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGxhc3RfdXBkYXRlX3RpbWU9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICByZXNlcnZlcz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBwcmljZT1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBudG9rZW5faWQ9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICBjbG9zZV9mYWN0b3I9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICksCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBnZXRfbWFya2V0X3ByaWNlKHNlbGYsIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCkgLT4gYXJjNC5VSW50MjU2OgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQodG9rZW5faWQubmF0aXZlKQogICAgLy8gICAgIHJldHVybiBtYXJrZXQucHJpY2UKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgZ2V0X21hcmtldF9udG9rZW5faWQoc2VsZiwgdG9rZW5faWQ6IGFyYzQuVUludDY0KSAtPiBhcmM0LlVJbnQ2NDoKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KHRva2VuX2lkLm5hdGl2ZSkKICAgIC8vICAgICByZXR1cm4gbWFya2V0Lm50b2tlbl9pZAogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBzZXRfbWFya2V0X3ByaWNlKHNlbGYsIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCwgcHJpY2U6IGFyYzQuVUludDI1NikgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLl9vbmx5X293bmVyKCkKICAgIC8vICAgICBhc3NlcnQgbm90IHNlbGYuX2lzX3BhdXNlZCgpLCAiUHJvdG9jb2wgaXMgcGF1c2VkIgogICAgLy8gICAgIHNlbGYuX3NldF9tYXJrZXRfcHJpY2UodG9rZW5faWQubmF0aXZlLCBwcmljZS5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3NldF9tYXJrZXRfcHJpY2Uoc2VsZiwgdG9rZW5faWQ6IFVJbnQ2NCwgcHJpY2U6IEJpZ1VJbnQpIC0+IE5vbmU6CiAgICAvLyAgICAgYXNzZXJ0IHRva2VuX2lkIGluIHNlbGYubWFya2V0cywgIk1hcmtldCBkb2VzIG5vdCBleGlzdCIKICAgIC8vICAgICBhc3NlcnQgcHJpY2UgPiAwLCAiUHJpY2UgbXVzdCBiZSBwb3NpdGl2ZSIKICAgIC8vIAogICAgLy8gICAgIG1hcmtldCA9IHNlbGYubWFya2V0c1t0b2tlbl9pZF0uY29weSgpCiAgICAvLyAKICAgIC8vICAgICAjIFVucGF1c2UgdGhlIG1hcmtldCBvbiBmaXJzdCBwcmljZSBzZXQKICAgIC8vICAgICBpZiBtYXJrZXQucGF1c2VkIGFuZCBtYXJrZXQucHJpY2UgPT0gMDoKICAgIC8vICAgICAgICAgbWFya2V0LnBhdXNlZCA9IGFyYzQuQm9vbChGYWxzZSkKICAgIC8vIAogICAgLy8gICAgICMgU2NhbGUgdGhlIHByaWNlIGJ5IFNDQUxFIGludGVybmFsbHkgZm9yIHN0b3JhZ2UKICAgIC8vICAgICBtYXJrZXQucHJpY2UgPSBhcmM0LlVJbnQyNTYocHJpY2UgKiBTQ0FMRSkKICAgIC8vIAogICAgLy8gICAgIHNlbGYubWFya2V0c1t0b2tlbl9pZF0gPSBtYXJrZXQuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2luY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2RlcG9zaXRzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSArIGFtb3VudAogICAgLy8gICAgICkKICAgIC8vICAgICBtYXJrZXQubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gICAgIHNlbGYubWFya2V0c1ttYXJrZXRfaWRdID0gbWFya2V0LmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9kZWNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9kZXBvc2l0cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgYXNzZXJ0ICgKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cy5uYXRpdmUgPj0gYW1vdW50CiAgICAvLyAgICAgKSwgIkluc3VmZmljaWVudCBiYWxhbmNlIHRvIHdpdGhkcmF3IHRoaXMgYW1vdW50IgogICAgLy8gICAgIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMgPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlIC0gYW1vdW50CiAgICAvLyAgICAgKQogICAgLy8gICAgIHNlbGYubWFya2V0c1ttYXJrZXRfaWRdID0gbWFya2V0LmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9pbmNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9ib3Jyb3dzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MgPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUgKyBhbW91bnQKICAgIC8vICAgICApCiAgICAvLyAgICAgbWFya2V0Lmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vICAgICBzZWxmLm1hcmtldHNbbWFya2V0X2lkXSA9IG1hcmtldC5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZGVjcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfYm9ycm93cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgYXNzZXJ0ICgKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzLm5hdGl2ZSA+PSBhbW91bnQKICAgIC8vICAgICApLCAiSW5zdWZmaWNpZW50IGJhbGFuY2UgdG8gd2l0aGRyYXcgdGhpcyBhbW91bnQiCiAgICAvLyAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlIC0gYW1vdW50CiAgICAvLyAgICAgKQogICAgLy8gICAgIHNlbGYubWFya2V0c1ttYXJrZXRfaWRdID0gbWFya2V0LmNvcHkoKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBwYXVzZV9tYXJrZXQoc2VsZiwgdG9rZW5faWQ6IGFyYzQuVUludDY0LCBwYXVzZTogYXJjNC5VSW50NjQpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgc2VsZi5fcGF1c2VfbWFya2V0KHRva2VuX2lkLm5hdGl2ZSwgcGF1c2UubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9wYXVzZV9tYXJrZXQoc2VsZiwgdG9rZW5faWQ6IFVJbnQ2NCwgcGF1c2U6IFVJbnQ2NCkgLT4gTm9uZToKICAgIC8vICAgICBhc3NlcnQgdG9rZW5faWQgaW4gc2VsZi5tYXJrZXRzLCAiTWFya2V0IGRvZXMgbm90IGV4aXN0IgogICAgLy8gICAgIHNlbGYubWFya2V0c1t0b2tlbl9pZF0ucGF1c2VkID0gYXJjNC5Cb29sKHBhdXNlID09IFVJbnQ2NCgxKSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaXNfbWFya2V0X3BhdXNlZChzZWxmLCB0b2tlbl9pZDogVUludDY0KSAtPiBib29sOgogICAgLy8gICAgIHJldHVybiBzZWxmLl9nZXRfbWFya2V0KHRva2VuX2lkKS5wYXVzZWQubmF0aXZlID09IFVJbnQ2NCgxKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9hY2NydWVfaW50ZXJlc3Qoc2VsZiwgbWFya2V0X2lkOiBVSW50NjQpIC0+IE1hcmtldERhdGE6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgaWYgbWFya2V0LnBhdXNlZDoKICAgIC8vICAgICAgICAgcmV0dXJuIG1hcmtldAogICAgLy8gCiAgICAvLyAgICAgY3VycmVudF90aW1lID0gR2xvYmFsLmxhdGVzdF90aW1lc3RhbXAKICAgIC8vICAgICB0aW1lX2RlbHRhID0gY3VycmVudF90aW1lIC0gbWFya2V0Lmxhc3RfdXBkYXRlX3RpbWUubmF0aXZlCiAgICAvLyAgICAgaWYgdGltZV9kZWx0YSA8PSAwOgogICAgLy8gICAgICAgICByZXR1cm4gbWFya2V0CiAgICAvLyAKICAgIC8vICAgICAjIEZvciBzdG9rZW4gbWFya2V0IChib3Jyb3ctb25seSksIHVzZSBhIGZpeGVkIHV0aWxpemF0aW9uIHJhdGUgc2luY2UgdGhlcmUgYXJlIG5vIGRlcG9zaXRzCiAgICAvLyAgICAgaWYgbWFya2V0X2lkID09IHNlbGYuc3Rva2VuX2FwcF9pZDoKICAgIC8vICAgICAgICAgdXRpbGl6YXRpb24gPSBCaWdVSW50KDEwMDAwKSAgIyAxMDAlIHV0aWxpemF0aW9uIGZvciBib3Jyb3ctb25seSBtYXJrZXQKICAgIC8vICAgICBlbGlmIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlID09IDA6CiAgICAvLyAgICAgICAgIHJldHVybiBtYXJrZXQKICAgIC8vICAgICBlbHNlOgogICAgLy8gICAgICAgICB1dGlsaXphdGlvbiA9ICgKICAgIC8vICAgICAgICAgICAgIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUgKiAxMDAwMAogICAgLy8gICAgICAgICApIC8vIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlCiAgICAvLyAgICAgcmF0ZSA9IG1hcmtldC5ib3Jyb3dfcmF0ZS5uYXRpdmUgKyAobWFya2V0LnNsb3BlLm5hdGl2ZSAqIHV0aWxpemF0aW9uKSAvLyAxMDAwMAogICAgLy8gICAgIGludGVyZXN0ID0gKHJhdGUgKiBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlICogdGltZV9kZWx0YSkgLy8gKAogICAgLy8gICAgICAgICBzZWxmLnNlY29uZHNfcGVyX3llYXIgKiAxMDAwMAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gICAgICMgU3BlY2lhbCBoYW5kbGluZyBmb3Igc3Rva2VuIG1hcmtldCAtIGFsbCBpbnRlcmVzdCBnb2VzIHRvIHJlc2VydmVzCiAgICAvLyAgICAgaWYgbWFya2V0X2lkID09IHNlbGYuc3Rva2VuX2FwcF9pZDoKICAgIC8vICAgICAgICAgcHJvdG9jb2xfcG9ydGlvbiA9IGludGVyZXN0CiAgICAvLyAgICAgICAgIGRlcG9zaXRvcl9wb3J0aW9uID0gQmlnVUludCgwKQogICAgLy8gICAgIGVsc2U6CiAgICAvLyAgICAgICAgIHByb3RvY29sX3BvcnRpb24gPSAoCiAgICAvLyAgICAgICAgICAgICBpbnRlcmVzdCAqIGFyYzQuVUludDI1Ni5mcm9tX2J5dGVzKG1hcmtldC5yZXNlcnZlX2ZhY3Rvci5ieXRlcykubmF0aXZlCiAgICAvLyAgICAgICAgICkgLy8gMTAwMDAKICAgIC8vICAgICAgICAgaWYgcHJvdG9jb2xfcG9ydGlvbiA+IGludGVyZXN0OgogICAgLy8gICAgICAgICAgICAgcHJvdG9jb2xfcG9ydGlvbiA9IGludGVyZXN0CiAgICAvLyAgICAgICAgIGRlcG9zaXRvcl9wb3J0aW9uID0gaW50ZXJlc3QgLSBwcm90b2NvbF9wb3J0aW9uCiAgICAvLyAKICAgIC8vICAgICBpZiBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzID4gMDoKICAgIC8vICAgICAgICAgbWFya2V0LmRlcG9zaXRfaW5kZXggPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgICAgICBtYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUKICAgIC8vICAgICAgICAgICAgICsgKGRlcG9zaXRvcl9wb3J0aW9uICogU0NBTEUpIC8vIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlCiAgICAvLyAgICAgICAgICkKICAgIC8vICAgICBpZiBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MgPiAwOgogICAgLy8gICAgICAgICBtYXJrZXQuYm9ycm93X2luZGV4ID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICAgICAgbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUKICAgIC8vICAgICAgICAgICAgICsgKGludGVyZXN0ICogU0NBTEUpIC8vIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUKICAgIC8vICAgICAgICAgKQogICAgLy8gCiAgICAvLyAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlICsgaW50ZXJlc3QKICAgIC8vICAgICApCiAgICAvLyAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cyA9IGFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKyBkZXBvc2l0b3JfcG9ydGlvbgogICAgLy8gICAgICkKICAgIC8vICAgICBtYXJrZXQucmVzZXJ2ZXMgPSBhcmM0LlVJbnQyNTYobWFya2V0LnJlc2VydmVzLm5hdGl2ZSArIHByb3RvY29sX3BvcnRpb24pCiAgICAvLyAgICAgbWFya2V0Lmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChjdXJyZW50X3RpbWUpCiAgICAvLyAKICAgIC8vICAgICBzZWxmLm1hcmtldHNbbWFya2V0X2lkXSA9IG1hcmtldC5jb3B5KCkKICAgIC8vICAgICByZXR1cm4gbWFya2V0LmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF92YWxpZGF0ZV9tYXJrZXRfb3BlcmF0aW9uKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQsIGd1YXJkX3N0b2tlbjogYm9vbAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIGFzc2VydCBub3Qgc2VsZi5faXNfcGF1c2VkKCksICJQcm90b2NvbCBpcyBwYXVzZWQiCiAgICAvLyAgICAgYXNzZXJ0IG1hcmtldF9pZCBpbiBzZWxmLm1hcmtldHMsICJNYXJrZXQgZG9lcyBub3QgZXhpc3QiCiAgICAvLyAgICAgYXNzZXJ0IGFtb3VudCA+IDAsICJBbW91bnQgbXVzdCBiZSA+IDAiCiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgYXNzZXJ0IG5vdCBtYXJrZXQucGF1c2VkLCAiTWFya2V0IGlzIHBhdXNlZCIKICAgIC8vICAgICBpZiBndWFyZF9zdG9rZW46CiAgICAvLyAgICAgICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgICAgICBzZWxmLnN0b2tlbl9hcHBfaWQgIT0gbWFya2V0X2lkCiAgICAvLyAgICAgICAgICksICJDYW5ub3QgdXNlIHN0b2tlbiBtYXJrZXQgZm9yIHRoaXMgb3BlcmF0aW9uIgogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBkZXBvc2l0KHNlbGYsIG1hcmtldF9pZDogYXJjNC5VSW50NjQsIGFtb3VudDogYXJjNC5VSW50MjU2KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX2RlcG9zaXQobWFya2V0X2lkLm5hdGl2ZSwgYW1vdW50Lm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZGVwb3NpdChzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX3ZhbGlkYXRlX21hcmtldF9vcGVyYXRpb24obWFya2V0X2lkLCBhbW91bnQsIFRydWUpCiAgICAvLyAKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICBzY2FsZWRfYW1vdW50ID0gKGFtb3VudCAqIFNDQUxFKSAvLyBtYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICBtYXJrZXQubWF4X3RvdGFsX2RlcG9zaXRzLm5hdGl2ZQogICAgLy8gICAgICAgICA+PSBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSArIHNjYWxlZF9hbW91bnQKICAgIC8vICAgICApLCAiRGVwb3NpdCBjYXAgZXhjZWVkZWQiCiAgICAvLyAKICAgIC8vICAgICBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgICAgICBBUkMyMDBUb2tlbkludGVyZmFjZS5hcmMyMDBfdHJhbnNmZXJGcm9tLAogICAgLy8gICAgICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgICAgIGFyYzQuQWRkcmVzcyhHbG9iYWwuY3VycmVudF9hcHBsaWNhdGlvbl9hZGRyZXNzKSwKICAgIC8vICAgICAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgICAgIGFwcF9pZD1BcHBsaWNhdGlvbihtYXJrZXRfaWQpLAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcihUeG4uc2VuZGVyLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgbmV3X21hcmtldCA9IHNlbGYuX2FjY3J1ZV9pbnRlcmVzdCgKICAgIC8vICAgICAgICAgbWFya2V0X2lkCiAgICAvLyAgICAgKSAgIyBHZXQgdXBkYXRlZCBtYXJrZXQgd2l0aCBhY2NydWVkIGludGVyZXN0CiAgICAvLyAgICAgc2NhbGVkX2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgYW1vdW50ICogU0NBTEUKICAgIC8vICAgICApIC8vIG5ld19tYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUgICMgQ2FsY3VsYXRlIHdpdGggbmV3IGluZGV4CiAgICAvLyAKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICBuZXdfbWFya2V0Lm1heF90b3RhbF9kZXBvc2l0cy5uYXRpdmUKICAgIC8vICAgICAgICAgPj0gbmV3X21hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlICsgc2NhbGVkX2Ftb3VudAogICAgLy8gICAgICksICJEZXBvc2l0IGNhcCBleGNlZWRlZCIKICAgIC8vIAogICAgLy8gICAgIHNlbGYuX2luY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfZGVwb3NpdHMoCiAgICAvLyAgICAgICAgIG1hcmtldF9pZCwgVHhuLnNlbmRlciwgc2NhbGVkX2Ftb3VudAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gICAgIHNlbGYuX2luY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2RlcG9zaXRzKG1hcmtldF9pZCwgc2NhbGVkX2Ftb3VudCkKICAgIC8vIAogICAgLy8gICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIE5Ub2tlbi5taW50LAogICAgLy8gICAgICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgICAgIGFyYzQuVUludDI1NihhbW91bnQpLAogICAgLy8gICAgICAgICBhcHBfaWQ9QXBwbGljYXRpb24obWFya2V0Lm50b2tlbl9pZC5uYXRpdmUpLAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gICAgIG9sZF9kZXBvc2l0X2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgdXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlICogbmV3X21hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZQogICAgLy8gICAgICkgLy8gU0NBTEUKICAgIC8vICAgICBuZXdfZGVwb3NpdF9hbW91bnQgPSBvbGRfZGVwb3NpdF9hbW91bnQgKyBhbW91bnQKICAgIC8vIAogICAgLy8gICAgIGlmIHVzZXIubGFzdF9wcmljZS5uYXRpdmUgPT0gMDoKICAgIC8vICAgICAgICAgb2xkX3ZhbHVlID0gKG9sZF9kZXBvc2l0X2Ftb3VudCAqIG5ld19tYXJrZXQucHJpY2UubmF0aXZlKSAvLyBTQ0FMRQogICAgLy8gICAgICAgICBuZXdfdmFsdWUgPSAobmV3X2RlcG9zaXRfYW1vdW50ICogbmV3X21hcmtldC5wcmljZS5uYXRpdmUpIC8vIFNDQUxFCiAgICAvLyAgICAgZWxzZToKICAgIC8vICAgICAgICAgb2xkX3ZhbHVlID0gKG9sZF9kZXBvc2l0X2Ftb3VudCAqIHVzZXIubGFzdF9wcmljZS5uYXRpdmUpIC8vIFNDQUxFCiAgICAvLyAgICAgICAgIG5ld192YWx1ZSA9IChuZXdfZGVwb3NpdF9hbW91bnQgKiBuZXdfbWFya2V0LnByaWNlLm5hdGl2ZSkgLy8gU0NBTEUKICAgIC8vIAogICAgLy8gICAgIHNlbGYuX3VwZGF0ZV9nbG9iYWxfY29sbGF0ZXJhbChUeG4uc2VuZGVyLCBtYXJrZXRfaWQsIG9sZF92YWx1ZSwgbmV3X3ZhbHVlKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiB3aXRoZHJhdyhzZWxmLCBtYXJrZXRfaWQ6IGFyYzQuVUludDY0LCBhbW91bnQ6IGFyYzQuVUludDI1NikgLT4gTm9uZToKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICBzZWxmLnN0b2tlbl9hcHBfaWQgIT0gbWFya2V0X2lkLm5hdGl2ZQogICAgLy8gICAgICksICJDYW5ub3QgZGVwb3NpdCBpbnRvIHN0b2tlbiBtYXJrZXQiCiAgICAvLyAgICAgZW5zdXJlX2J1ZGdldCg3MDAsIE9wVXBGZWVTb3VyY2UuR3JvdXBDcmVkaXQpCiAgICAvLyAgICAgc2VsZi5fd2l0aGRyYXcobWFya2V0X2lkLm5hdGl2ZSwgYW1vdW50Lm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfd2l0aGRyYXcoc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIGFtb3VudDogQmlnVUludCkgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLl92YWxpZGF0ZV9tYXJrZXRfb3BlcmF0aW9uKG1hcmtldF9pZCwgYW1vdW50LCBUcnVlKQogICAgLy8gCiAgICAvLyAgICAgbmV3X21hcmtldCA9IHNlbGYuX2FjY3J1ZV9pbnRlcmVzdChtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKFR4bi5zZW5kZXIsIG1hcmtldF9pZCkKICAgIC8vIAogICAgLy8gICAgIHNjYWxlZF9hbW91bnQgPSAoYW1vdW50ICogU0NBTEUpIC8vIG5ld19tYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICB1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgPj0gc2NhbGVkX2Ftb3VudAogICAgLy8gICAgICksICJJbnN1ZmZpY2llbnQgYmFsYW5jZSB0byB3aXRoZHJhdyB0aGlzIGFtb3VudCIKICAgIC8vICAgICB1bmRlcmx5aW5nX2Ftb3VudCA9IChzY2FsZWRfYW1vdW50ICogbmV3X21hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZSkgLy8gU0NBTEUKICAgIC8vIAogICAgLy8gICAgIGdsb2JhbF91c2VyID0gc2VsZi5fZ2V0X2dsb2JhbF91c2VyKFR4bi5zZW5kZXIpCiAgICAvLyAgICAgd2l0aGRyYXdfdmFsdWUgPSAoCiAgICAvLyAgICAgICAgIHVuZGVybHlpbmdfYW1vdW50ICogbmV3X21hcmtldC5wcmljZS5uYXRpdmUKICAgIC8vICAgICApIC8vIFNDQUxFICAjIFVzZSB1bmRlcmx5aW5nX2Ftb3VudCBhbmQgbmV3X21hcmtldCBwcmljZQogICAgLy8gCiAgICAvLyAgICAgaWYgZ2xvYmFsX3VzZXIudG90YWxfYm9ycm93X3ZhbHVlID4gMDoKICAgIC8vICAgICAgICAgcmVtYWluaW5nX2NvbGxhdGVyYWwgPSAoCiAgICAvLyAgICAgICAgICAgICBnbG9iYWxfdXNlci50b3RhbF9jb2xsYXRlcmFsX3ZhbHVlLm5hdGl2ZSAtIHdpdGhkcmF3X3ZhbHVlCiAgICAvLyAgICAgICAgICkKICAgIC8vICAgICAgICAgYXNzZXJ0IGdsb2JhbF91c2VyLnRvdGFsX2JvcnJvd192YWx1ZS5uYXRpdmUgPD0gKAogICAgLy8gICAgICAgICAgICAgcmVtYWluaW5nX2NvbGxhdGVyYWwgKiBCaWdVSW50KG5ld19tYXJrZXQuY29sbGF0ZXJhbF9mYWN0b3IubmF0aXZlKQogICAgLy8gICAgICAgICApIC8vIEJpZ1VJbnQoMTAwMDApLCAiV2l0aGRyYXdhbCB3b3VsZCBwdXQgYm9ycm93cyBhdCByaXNrIgogICAgLy8gCiAgICAvLyAgICAgc2VsZi5fZGVjcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9kZXBvc2l0cygKICAgIC8vICAgICAgICAgbWFya2V0X2lkLCBUeG4uc2VuZGVyLCBzY2FsZWRfYW1vdW50CiAgICAvLyAgICAgKQogICAgLy8gICAgIHNlbGYuX2RlY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2RlcG9zaXRzKG1hcmtldF9pZCwgc2NhbGVkX2Ftb3VudCkKICAgIC8vIAogICAgLy8gICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIE5Ub2tlbi5idXJuX2Zyb20sCiAgICAvLyAgICAgICAgIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIC8vICAgICAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgICAgIGFwcF9pZD1BcHBsaWNhdGlvbihuZXdfbWFya2V0Lm50b2tlbl9pZC5uYXRpdmUpLAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIEFSQzIwMFRva2VuSW50ZXJmYWNlLmFyYzIwMF90cmFuc2ZlciwKICAgIC8vICAgICAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgICAgICBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgICAgICB1bmRlcmx5aW5nX2Ftb3VudAogICAgLy8gICAgICAgICApLCAgIyBVc2UgdW5kZXJseWluZ19hbW91bnQgd2hpY2ggaW5jbHVkZXMgaW50ZXJlc3QKICAgIC8vICAgICAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldF9pZCksICAjIFRyYW5zZmVyIGZyb20gdW5kZXJseWluZyB0b2tlbiBjb250cmFjdAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gICAgIG9sZF9kZXBvc2l0X2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgdXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlICogbmV3X21hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZQogICAgLy8gICAgICkgLy8gU0NBTEUKICAgIC8vICAgICBuZXdfZGVwb3NpdF9hbW91bnQgPSBvbGRfZGVwb3NpdF9hbW91bnQgLSB1bmRlcmx5aW5nX2Ftb3VudAogICAgLy8gCiAgICAvLyAgICAgIyBVc2UgY3VycmVudCBtYXJrZXQgcHJpY2UgaWYgdXNlciBkb2Vzbid0IGhhdmUgYSBwcmV2aW91cyBwcmljZQogICAgLy8gICAgIHByaWNlX2Zvcl9vbGQgPSAoCiAgICAvLyAgICAgICAgIHVzZXIubGFzdF9wcmljZS5uYXRpdmUKICAgIC8vICAgICAgICAgaWYgdXNlci5sYXN0X3ByaWNlLm5hdGl2ZSA+IDAKICAgIC8vICAgICAgICAgZWxzZSBuZXdfbWFya2V0LnByaWNlLm5hdGl2ZQogICAgLy8gICAgICkKICAgIC8vICAgICBwcmljZV9mb3JfbmV3ID0gbmV3X21hcmtldC5wcmljZS5uYXRpdmUKICAgIC8vIAogICAgLy8gICAgIG9sZF92YWx1ZSA9ICgKICAgIC8vICAgICAgICAgb2xkX2RlcG9zaXRfYW1vdW50ICogcHJpY2VfZm9yX29sZAogICAgLy8gICAgICkgLy8gU0NBTEUgICMgVXNlIHVzZXIncyBsYXN0IGtub3duIHByaWNlIG9yIGN1cnJlbnQgcHJpY2UKICAgIC8vICAgICBuZXdfdmFsdWUgPSAoCiAgICAvLyAgICAgICAgIG5ld19kZXBvc2l0X2Ftb3VudCAqIHByaWNlX2Zvcl9uZXcKICAgIC8vICAgICApIC8vIFNDQUxFICAjIFVzZSBjdXJyZW50IG1hcmtldCBwcmljZQogICAgLy8gICAgIHNlbGYuX3VwZGF0ZV9nbG9iYWxfY29sbGF0ZXJhbCgKICAgIC8vICAgICAgICAgVHhuLnNlbmRlciwKICAgIC8vICAgICAgICAgbWFya2V0X2lkLAogICAgLy8gICAgICAgICBvbGRfdmFsdWUsICAjIG9sZCBVU0QgdmFsdWUKICAgIC8vICAgICAgICAgbmV3X3ZhbHVlLCAgIyBuZXcgVVNEIHZhbHVlCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyAjIHdpdGhkcmF3IGNvc3QgOTAwMDAwCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGJvcnJvdyhzZWxmLCBtYXJrZXRfaWQ6IGFyYzQuVUludDY0LCBhbW91bnQ6IGFyYzQuVUludDI1NikgLT4gTm9uZToKICAgIC8vICAgICBlbnN1cmVfYnVkZ2V0KDE0MDAsIE9wVXBGZWVTb3VyY2UuR3JvdXBDcmVkaXQpCiAgICAvLyAgICAgc2VsZi5fYm9ycm93KG1hcmtldF9pZC5uYXRpdmUsIGFtb3VudC5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2JvcnJvdyhzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX3ZhbGlkYXRlX21hcmtldF9vcGVyYXRpb24obWFya2V0X2lkLCBhbW91bnQsIEZhbHNlKQogICAgLy8gCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKFR4bi5zZW5kZXIsIG1hcmtldF9pZCkKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vIAogICAgLy8gICAgIHBheW1lbnQgPSByZXF1aXJlX3BheW1lbnQoVHhuLnNlbmRlcikKICAgIC8vICAgICBhc3NlcnQgcGF5bWVudCA+PSBVSW50NjQoMTAwMDAwKSwgIlBheW1lbnQgYW1vdW50IG11c3QgYmUgPj0gMC4xIgogICAgLy8gCiAgICAvLyAgICAgdG90YWxfYm9ycm93cyA9ICgKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAqIG1hcmtldC5ib3Jyb3dfaW5kZXgubmF0aXZlCiAgICAvLyAgICAgKSAvLyBTQ0FMRQogICAgLy8gICAgIGFzc2VydCBtYXJrZXQubWF4X3RvdGFsX2JvcnJvd3MubmF0aXZlID49IHRvdGFsX2JvcnJvd3MgKyBhbW91bnQsICJCb3Jyb3cgY2FwIgogICAgLy8gCiAgICAvLyAgICAgZ2xvYmFsX3VzZXIgPSBzZWxmLl9nZXRfZ2xvYmFsX3VzZXIoVHhuLnNlbmRlcikKICAgIC8vICAgICBuZXdfYm9ycm93X3ZhbHVlID0gKGFtb3VudCAqIG1hcmtldC5wcmljZS5uYXRpdmUpIC8vIFNDQUxFCiAgICAvLyAgICAgdG90YWxfYm9ycm93X3ZhbHVlID0gZ2xvYmFsX3VzZXIudG90YWxfYm9ycm93X3ZhbHVlLm5hdGl2ZSArIG5ld19ib3Jyb3dfdmFsdWUKICAgIC8vIAogICAgLy8gICAgIGFzc2VydCB0b3RhbF9ib3Jyb3dfdmFsdWUgPD0gKAogICAgLy8gICAgICAgICBnbG9iYWxfdXNlci50b3RhbF9jb2xsYXRlcmFsX3ZhbHVlLm5hdGl2ZQogICAgLy8gICAgICAgICAqIEJpZ1VJbnQobWFya2V0LmNvbGxhdGVyYWxfZmFjdG9yLm5hdGl2ZSkKICAgIC8vICAgICApIC8vIEJpZ1VJbnQoMTAwMDApLCAiSW5zdWZmaWNpZW50IGNvbGxhdGVyYWwgYWNyb3NzIG1hcmtldHMiCiAgICAvLyAKICAgIC8vICAgICBuZXdfbWFya2V0ID0gc2VsZi5fYWNjcnVlX2ludGVyZXN0KG1hcmtldF9pZCkKICAgIC8vICAgICBzY2FsZWRfYW1vdW50ID0gKGFtb3VudCAqIFNDQUxFKSAvLyBuZXdfbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUKICAgIC8vIAogICAgLy8gICAgIHNlbGYuX2luY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfYm9ycm93cyhtYXJrZXRfaWQsIFR4bi5zZW5kZXIsIHNjYWxlZF9hbW91bnQpCiAgICAvLyAgICAgc2VsZi5faW5jcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfYm9ycm93cyhtYXJrZXRfaWQsIHNjYWxlZF9hbW91bnQpCiAgICAvLyAKICAgIC8vICAgICBvbGRfYm9ycm93X2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgdXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgKiBtYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZSAvLyBTQ0FMRQogICAgLy8gICAgICkKICAgIC8vICAgICBuZXdfYm9ycm93X2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgKHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlICsgc2NhbGVkX2Ftb3VudCkKICAgIC8vICAgICAgICAgKiBuZXdfbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUKICAgIC8vICAgICAgICAgLy8gU0NBTEUKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vICAgICAjIFVzZSBjdXJyZW50IG1hcmtldCBwcmljZSBpZiB1c2VyIGRvZXNuJ3QgaGF2ZSBhIHByZXZpb3VzIHByaWNlCiAgICAvLyAgICAgcHJpY2VfZm9yX29sZCA9ICgKICAgIC8vICAgICAgICAgdXNlci5sYXN0X3ByaWNlLm5hdGl2ZQogICAgLy8gICAgICAgICBpZiB1c2VyLmxhc3RfcHJpY2UubmF0aXZlID4gMAogICAgLy8gICAgICAgICBlbHNlIG1hcmtldC5wcmljZS5uYXRpdmUKICAgIC8vICAgICApCiAgICAvLyAgICAgcHJpY2VfZm9yX25ldyA9IG5ld19tYXJrZXQucHJpY2UubmF0aXZlCiAgICAvLyAKICAgIC8vICAgICBvbGRfdmFsdWUgPSAob2xkX2JvcnJvd19hbW91bnQgKiBwcmljZV9mb3Jfb2xkKSAvLyBTQ0FMRQogICAgLy8gICAgIG5ld192YWx1ZSA9IChuZXdfYm9ycm93X2Ftb3VudCAqIHByaWNlX2Zvcl9uZXcpIC8vIFNDQUxFCiAgICAvLyAgICAgc2VsZi5fdXBkYXRlX2dsb2JhbF9ib3Jyb3dzKAogICAgLy8gICAgICAgICBUeG4uc2VuZGVyLAogICAgLy8gICAgICAgICBtYXJrZXRfaWQsCiAgICAvLyAgICAgICAgIG9sZF92YWx1ZSwgICMgb2xkIFVTRCB2YWx1ZQogICAgLy8gICAgICAgICBuZXdfdmFsdWUsICAjIG5ldyBVU0QgdmFsdWUKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vICAgICAjIGlmIHN0b2tlbiwgbWludCBzdG9rZW4KICAgIC8vICAgICBpZiBtYXJrZXRfaWQgPT0gc2VsZi5zdG9rZW5fYXBwX2lkOgogICAgLy8gICAgICAgICBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgICAgICAgICAgU1Rva2VuLm1pbnQsCiAgICAvLyAgICAgICAgICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgICAgICAgICBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIC8vICAgICAgICAgICAgIGFwcF9pZD1BcHBsaWNhdGlvbihtYXJrZXRfaWQpLAogICAgLy8gICAgICAgICApCiAgICAvLyAgICAgICAgIGl0eG4uUGF5bWVudCgKICAgIC8vICAgICAgICAgICAgIHJlY2VpdmVyPUFwcGxpY2F0aW9uKG1hcmtldF9pZCkuYWRkcmVzcywgYW1vdW50PTEwMDAwMCwgZmVlPTAKICAgIC8vICAgICAgICAgKS5zdWJtaXQoKQogICAgLy8gICAgICMgaWYgYVRva2VuLCB0cmFuc2ZlciBhVG9rZW4KICAgIC8vICAgICBlbHNlOgogICAgLy8gICAgICAgICBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgICAgICAgICAgQVJDMjAwVG9rZW5JbnRlcmZhY2UuYXJjMjAwX3RyYW5zZmVyLAogICAgLy8gICAgICAgICAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgICAgICAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgICAgICAgICBhcHBfaWQ9QXBwbGljYXRpb24obWFya2V0X2lkKSwKICAgIC8vICAgICAgICAgKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBnZXRfc2NhbGVkX3JlcGF5X2Ftb3VudCgKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IGFyYzQuVUludDY0LCBhbW91bnQ6IGFyYzQuVUludDI1NgogICAgLy8gKSAtPiBhcmM0LlVJbnQyNTY6CiAgICAvLyAgICAgcmV0dXJuIGFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgc2VsZi5fZ2V0X3NjYWxlZF9yZXBheV9hbW91bnQobWFya2V0X2lkLm5hdGl2ZSwgYW1vdW50Lm5hdGl2ZSkKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2dldF9zY2FsZWRfcmVwYXlfYW1vdW50KHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQpIC0+IEJpZ1VJbnQ6CiAgICAvLyAgICAgbmV3X21hcmtldCA9IHNlbGYuX2FjY3J1ZV9pbnRlcmVzdChtYXJrZXRfaWQpCiAgICAvLyAgICAgcmV0dXJuIChhbW91bnQgKiBTQ0FMRSkgLy8gbmV3X21hcmtldC5ib3Jyb3dfaW5kZXgubmF0aXZlCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIHJlcGF5KHNlbGYsIG1hcmtldF9pZDogYXJjNC5VSW50NjQsIGFtb3VudDogYXJjNC5VSW50MjU2KSAtPiBOb25lOgogICAgLy8gICAgIGVuc3VyZV9idWRnZXQoMTQwMCwgT3BVcEZlZVNvdXJjZS5Hcm91cENyZWRpdCkKICAgIC8vICAgICBzZWxmLl9yZXBheShtYXJrZXRfaWQubmF0aXZlLCBhbW91bnQubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9yZXBheShzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX3ZhbGlkYXRlX21hcmtldF9vcGVyYXRpb24obWFya2V0X2lkLCBhbW91bnQsIEZhbHNlKQogICAgLy8gCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKFR4bi5zZW5kZXIsIG1hcmtldF9pZCkKICAgIC8vICAgICBuZXdfbWFya2V0ID0gc2VsZi5fYWNjcnVlX2ludGVyZXN0KG1hcmtldF9pZCkKICAgIC8vIAogICAgLy8gICAgIHNjYWxlZF9hbW91bnQgPSAoYW1vdW50ICogU0NBTEUpIC8vIG5ld19tYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZQogICAgLy8gICAgIGFzc2VydCB1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSA+PSBzY2FsZWRfYW1vdW50LCAiUmVwYXkgYW1vdW50IGV4Y2VlZHMgZGVidCIKICAgIC8vIAogICAgLy8gICAgIGlmIG1hcmtldF9pZCA9PSBzZWxmLnN0b2tlbl9hcHBfaWQ6CiAgICAvLyAgICAgICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgICAgICBTVG9rZW4uYnVybl9mcm9tLAogICAgLy8gICAgICAgICAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgICAgICAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgICAgICAgICBhcHBfaWQ9QXBwbGljYXRpb24obWFya2V0X2lkKSwKICAgIC8vICAgICAgICAgKQogICAgLy8gICAgIGVsc2U6CiAgICAvLyAgICAgICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgICAgICBBUkMyMDBUb2tlbkludGVyZmFjZS5hcmMyMDBfdHJhbnNmZXJGcm9tLAogICAgLy8gICAgICAgICAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgICAgICAgICAgYXJjNC5BZGRyZXNzKEdsb2JhbC5jdXJyZW50X2FwcGxpY2F0aW9uX2FkZHJlc3MpLAogICAgLy8gICAgICAgICAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgICAgICAgICBhcHBfaWQ9QXBwbGljYXRpb24obWFya2V0X2lkKSwKICAgIC8vICAgICAgICAgKQogICAgLy8gCiAgICAvLyAgICAgc2VsZi5fZGVjcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9ib3Jyb3dzKG1hcmtldF9pZCwgVHhuLnNlbmRlciwgc2NhbGVkX2Ftb3VudCkKICAgIC8vICAgICBzZWxmLl9kZWNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9ib3Jyb3dzKG1hcmtldF9pZCwgc2NhbGVkX2Ftb3VudCkKICAgIC8vIAogICAgLy8gICAgIG9sZF9ib3Jyb3dfYW1vdW50ID0gKAogICAgLy8gICAgICAgICB1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAqIG5ld19tYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZSAvLyBTQ0FMRQogICAgLy8gICAgICkKICAgIC8vICAgICBuZXdfYm9ycm93X2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgKHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlIC0gc2NhbGVkX2Ftb3VudCkKICAgIC8vICAgICAgICAgKiBuZXdfbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUKICAgIC8vICAgICAgICAgLy8gU0NBTEUKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vICAgICAjIFVzZSBjdXJyZW50IG1hcmtldCBwcmljZSBpZiB1c2VyIGRvZXNuJ3QgaGF2ZSBhIHByZXZpb3VzIHByaWNlCiAgICAvLyAgICAgcHJpY2VfZm9yX29sZCA9ICgKICAgIC8vICAgICAgICAgdXNlci5sYXN0X3ByaWNlLm5hdGl2ZQogICAgLy8gICAgICAgICBpZiB1c2VyLmxhc3RfcHJpY2UubmF0aXZlID4gMAogICAgLy8gICAgICAgICBlbHNlIG5ld19tYXJrZXQucHJpY2UubmF0aXZlCiAgICAvLyAgICAgKQogICAgLy8gICAgIHByaWNlX2Zvcl9uZXcgPSBuZXdfbWFya2V0LnByaWNlLm5hdGl2ZQogICAgLy8gCiAgICAvLyAgICAgb2xkX3ZhbHVlID0gKG9sZF9ib3Jyb3dfYW1vdW50ICogcHJpY2VfZm9yX29sZCkgLy8gU0NBTEUKICAgIC8vICAgICBuZXdfdmFsdWUgPSAobmV3X2JvcnJvd19hbW91bnQgKiBwcmljZV9mb3JfbmV3KSAvLyBTQ0FMRQogICAgLy8gICAgIHNlbGYuX3VwZGF0ZV9nbG9iYWxfYm9ycm93cygKICAgIC8vICAgICAgICAgVHhuLnNlbmRlciwKICAgIC8vICAgICAgICAgbWFya2V0X2lkLAogICAgLy8gICAgICAgICBvbGRfdmFsdWUsICAjIG9sZCBVU0QgdmFsdWUKICAgIC8vICAgICAgICAgbmV3X3ZhbHVlLCAgIyBuZXcgVVNEIHZhbHVlCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiByZWRlZW0oc2VsZiwgbWFya2V0X2lkOiBhcmM0LlVJbnQ2NCwgYW1vdW50OiBhcmM0LlVJbnQyNTYpIC0+IE5vbmU6CiAgICAvLyAgICAgZW5zdXJlX2J1ZGdldCgxNDAwLCBPcFVwRmVlU291cmNlLkdyb3VwQ3JlZGl0KQogICAgLy8gICAgIHNlbGYuX3JlZGVlbShtYXJrZXRfaWQubmF0aXZlLCBhbW91bnQubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9yZWRlZW0oc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIGFtb3VudDogQmlnVUludCkgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLl92YWxpZGF0ZV9tYXJrZXRfb3BlcmF0aW9uKG1hcmtldF9pZCwgYW1vdW50LCBUcnVlKQogICAgLy8gCiAgICAvLyAgICAgYXNzZXJ0IG5vdCBzZWxmLl9oYXNfcG9zaXRpb24oCiAgICAvLyAgICAgICAgIFR4bi5zZW5kZXIsIG1hcmtldF9pZAogICAgLy8gICAgICksICJDYW5ub3QgbWludC9yZWRlZW0gd2hlbiB1c2VyIGhhcyB0cmFja2VkIGRlcG9zaXQgcG9zaXRpb24iCiAgICAvLyAKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9hY2NydWVfaW50ZXJlc3QobWFya2V0X2lkKQogICAgLy8gCiAgICAvLyAgICAgYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICAgICAgTlRva2VuLmJ1cm5fZnJvbSwKICAgIC8vICAgICAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgICAgICBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIC8vICAgICAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldC5udG9rZW5faWQubmF0aXZlKSwKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vICAgICBzY2FsZWRfYW1vdW50ID0gKGFtb3VudCAqIFNDQUxFKSAvLyBtYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSA+PSBzY2FsZWRfYW1vdW50CiAgICAvLyAgICAgKSwgIkluc3VmZmljaWVudCBtYXJrZXQgZGVwb3NpdHMgdG8gcmVkZWVtIgogICAgLy8gICAgIHNlbGYuX2RlY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2RlcG9zaXRzKG1hcmtldF9pZCwgc2NhbGVkX2Ftb3VudCkKICAgIC8vIAogICAgLy8gICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIEFSQzIwMFRva2VuSW50ZXJmYWNlLmFyYzIwMF90cmFuc2ZlciwKICAgIC8vICAgICAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgICAgICBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIC8vICAgICAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldF9pZCksCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBtaW50KHNlbGYsIG1hcmtldF9pZDogYXJjNC5VSW50NjQsIGFtb3VudDogYXJjNC5VSW50MjU2KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX21pbnQobWFya2V0X2lkLm5hdGl2ZSwgYW1vdW50Lm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfbWludChzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX3ZhbGlkYXRlX21hcmtldF9vcGVyYXRpb24obWFya2V0X2lkLCBhbW91bnQsIFRydWUpCiAgICAvLyAKICAgIC8vICAgICBhc3NlcnQgbm90IHNlbGYuX2hhc19wb3NpdGlvbigKICAgIC8vICAgICAgICAgVHhuLnNlbmRlciwgbWFya2V0X2lkCiAgICAvLyAgICAgKSwgIkNhbm5vdCBtaW50L3JlZGVlbSB3aGVuIHVzZXIgaGFzIHRyYWNrZWQgZGVwb3NpdCBwb3NpdGlvbiIKICAgIC8vIAogICAgLy8gICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIEFSQzIwMFRva2VuSW50ZXJmYWNlLmFyYzIwMF90cmFuc2ZlckZyb20sCiAgICAvLyAgICAgICAgIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIC8vICAgICAgICAgYXJjNC5BZGRyZXNzKEdsb2JhbC5jdXJyZW50X2FwcGxpY2F0aW9uX2FkZHJlc3MpLAogICAgLy8gICAgICAgICBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIC8vICAgICAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldF9pZCksCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyAgICAgbmV3X21hcmtldCA9IHNlbGYuX2FjY3J1ZV9pbnRlcmVzdCgKICAgIC8vICAgICAgICAgbWFya2V0X2lkCiAgICAvLyAgICAgKSAgIyBHZXQgdXBkYXRlZCBtYXJrZXQgd2l0aCBhY2NydWVkIGludGVyZXN0CiAgICAvLyAgICAgc2NhbGVkX2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgYW1vdW50ICogU0NBTEUKICAgIC8vICAgICApIC8vIG5ld19tYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUgICMgQ2FsY3VsYXRlIHdpdGggbmV3IGluZGV4CiAgICAvLyAKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICBuZXdfbWFya2V0Lm1heF90b3RhbF9kZXBvc2l0cy5uYXRpdmUKICAgIC8vICAgICAgICAgPj0gbmV3X21hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlICsgc2NhbGVkX2Ftb3VudAogICAgLy8gICAgICksICJEZXBvc2l0IGNhcCBleGNlZWRlZCIKICAgIC8vIAogICAgLy8gICAgICMgT25seSBpbmNyZW1lbnQgbWFya2V0IHRvdGFsIGRlcG9zaXRzLCBub3QgdXNlciBkZXBvc2l0cyBzaW5jZSBwb3NpdGlvbiBpcyBub3QgdHJhY2tlZAogICAgLy8gICAgIHNlbGYuX2luY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2RlcG9zaXRzKG1hcmtldF9pZCwgc2NhbGVkX2Ftb3VudCkKICAgIC8vIAogICAgLy8gICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIE5Ub2tlbi5taW50LAogICAgLy8gICAgICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgICAgIGFyYzQuVUludDI1NihhbW91bnQpLAogICAgLy8gICAgICAgICBhcHBfaWQ9QXBwbGljYXRpb24obmV3X21hcmtldC5udG9rZW5faWQubmF0aXZlKSwKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vICAgICBhcmM0LmVtaXQoCiAgICAvLyAgICAgICAgIE1pbnRFdmVudCgKICAgIC8vICAgICAgICAgICAgIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwgYXJjNC5VSW50MjU2KGFtb3VudCksIGFyYzQuVUludDY0KG1hcmtldF9pZCkKICAgIC8vICAgICAgICAgKQogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgc3luY191c2VyX21hcmtldF9mb3JfcHJpY2VfY2hhbmdlKAogICAgLy8gICAgIHNlbGYsIHVzZXJfaWQ6IGFyYzQuQWRkcmVzcywgbWFya2V0X2lkOiBhcmM0LlVJbnQ2NAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIGVuc3VyZV9idWRnZXQoMTQwMCwgT3BVcEZlZVNvdXJjZS5Hcm91cENyZWRpdCkKICAgIC8vICAgICBzZWxmLl91cGRhdGVfdXNlcl9nbG9iYWxfdmFsdWVzX2Zvcl9wcmljZV9jaGFuZ2UoCiAgICAvLyAgICAgICAgIHVzZXJfaWQubmF0aXZlLCBtYXJrZXRfaWQubmF0aXZlCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF91cGRhdGVfdXNlcl9nbG9iYWxfdmFsdWVzX2Zvcl9wcmljZV9jaGFuZ2UoCiAgICAvLyAgICAgc2VsZiwgdXNlcl9pZDogQWNjb3VudCwgbWFya2V0X2lkOiBVSW50NjQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vIAogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpLmNvcHkoKQogICAgLy8gICAgIGlmIHVzZXIuc2NhbGVkX2RlcG9zaXRzID09IDAgYW5kIHVzZXIuc2NhbGVkX2JvcnJvd3MgPT0gMDoKICAgIC8vICAgICAgICAgcmV0dXJuCiAgICAvLyAKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9hY2NydWVfaW50ZXJlc3QobWFya2V0X2lkKQogICAgLy8gCiAgICAvLyAgICAgaWYgdXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlID4gMDoKICAgIC8vICAgICAgICAgZGVwb3NpdF9hbW91bnQgPSAoCiAgICAvLyAgICAgICAgICAgICB1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKiBtYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUKICAgIC8vICAgICAgICAgKSAvLyBTQ0FMRQogICAgLy8gICAgICAgICAjIFVzZSBjdXJyZW50IG1hcmtldCBwcmljZSBpZiB1c2VyIGRvZXNuJ3QgaGF2ZSBhIHByZXZpb3VzIHByaWNlCiAgICAvLyAgICAgICAgIHByaWNlX2Zvcl9vbGQgPSAoCiAgICAvLyAgICAgICAgICAgICB1c2VyLmxhc3RfcHJpY2UubmF0aXZlCiAgICAvLyAgICAgICAgICAgICBpZiB1c2VyLmxhc3RfcHJpY2UubmF0aXZlID4gMAogICAgLy8gICAgICAgICAgICAgZWxzZSBtYXJrZXQucHJpY2UubmF0aXZlCiAgICAvLyAgICAgICAgICkKICAgIC8vICAgICAgICAgb2xkX2RlcG9zaXRfdmFsdWUgPSAoZGVwb3NpdF9hbW91bnQgKiBwcmljZV9mb3Jfb2xkKSAvLyBTQ0FMRQogICAgLy8gICAgICAgICBuZXdfZGVwb3NpdF92YWx1ZSA9IChkZXBvc2l0X2Ftb3VudCAqIG1hcmtldC5wcmljZS5uYXRpdmUpIC8vIFNDQUxFCiAgICAvLyAgICAgICAgIHNlbGYuX3VwZGF0ZV9nbG9iYWxfY29sbGF0ZXJhbCgKICAgIC8vICAgICAgICAgICAgIHVzZXJfaWQsIG1hcmtldF9pZCwgb2xkX2RlcG9zaXRfdmFsdWUsIG5ld19kZXBvc2l0X3ZhbHVlCiAgICAvLyAgICAgICAgICkKICAgIC8vIAogICAgLy8gICAgIGlmIHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlID4gMDoKICAgIC8vICAgICAgICAgYm9ycm93X2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgICAgIHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlICogbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUKICAgIC8vICAgICAgICAgKSAvLyBTQ0FMRQogICAgLy8gICAgICAgICAjIFVzZSBjdXJyZW50IG1hcmtldCBwcmljZSBpZiB1c2VyIGRvZXNuJ3QgaGF2ZSBhIHByZXZpb3VzIHByaWNlCiAgICAvLyAgICAgICAgIHByaWNlX2Zvcl9vbGQgPSAoCiAgICAvLyAgICAgICAgICAgICB1c2VyLmxhc3RfcHJpY2UubmF0aXZlCiAgICAvLyAgICAgICAgICAgICBpZiB1c2VyLmxhc3RfcHJpY2UubmF0aXZlID4gMAogICAgLy8gICAgICAgICAgICAgZWxzZSBtYXJrZXQucHJpY2UubmF0aXZlCiAgICAvLyAgICAgICAgICkKICAgIC8vICAgICAgICAgb2xkX2JvcnJvd192YWx1ZSA9IChib3Jyb3dfYW1vdW50ICogcHJpY2VfZm9yX29sZCkgLy8gU0NBTEUKICAgIC8vICAgICAgICAgbmV3X2JvcnJvd192YWx1ZSA9IChib3Jyb3dfYW1vdW50ICogbWFya2V0LnByaWNlLm5hdGl2ZSkgLy8gU0NBTEUKICAgIC8vICAgICAgICAgc2VsZi5fdXBkYXRlX2dsb2JhbF9ib3Jyb3dzKAogICAgLy8gICAgICAgICAgICAgdXNlcl9pZCwgbWFya2V0X2lkLCBvbGRfYm9ycm93X3ZhbHVlLCBuZXdfYm9ycm93X3ZhbHVlCiAgICAvLyAgICAgICAgICkKICAgIC8vIAogICAgLy8gICAgIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyLmxhc3RfcHJpY2UgPSBtYXJrZXQucHJpY2UKICAgIC8vICAgICBzZWxmLnVzZXJzW3VzZXJfa2V5XSA9IHVzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF9nbG9iYWxfdXNlcihzZWxmLCB1c2VyX2lkOiBhcmM0LkFkZHJlc3MpIC0+IEdsb2JhbFVzZXJEYXRhOgogICAgLy8gICAgIHJldHVybiBzZWxmLl9nZXRfZ2xvYmFsX3VzZXIodXNlcl9pZC5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF9nbG9iYWxfdXNlcl9jb2xsYXRlcmFsKHNlbGYsIHVzZXJfaWQ6IGFyYzQuQWRkcmVzcykgLT4gYXJjNC5VSW50MjU2OgogICAgLy8gICAgIHJldHVybiBzZWxmLl9nZXRfZ2xvYmFsX3VzZXIodXNlcl9pZC5uYXRpdmUpLnRvdGFsX2NvbGxhdGVyYWxfdmFsdWUKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X2dsb2JhbF91c2VyKHNlbGYsIHVzZXJfaWQ6IEFjY291bnQpIC0+IEdsb2JhbFVzZXJEYXRhOgogICAgLy8gCiAgICAvLyAgICAgcmV0dXJuIHNlbGYuZ2xvYmFsX3VzZXJzLmdldCgKICAgIC8vICAgICAgICAgdXNlcl9pZCwKICAgIC8vICAgICAgICAgZGVmYXVsdD1HbG9iYWxVc2VyRGF0YSgKICAgIC8vICAgICAgICAgICAgIHRvdGFsX2NvbGxhdGVyYWxfdmFsdWU9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgdG90YWxfYm9ycm93X3ZhbHVlPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGxhc3RfdXBkYXRlX3RpbWU9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICksCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF91cGRhdGVfZ2xvYmFsX2NvbGxhdGVyYWwoCiAgICAvLyAgICAgc2VsZiwKICAgIC8vICAgICB1c2VyX2lkOiBBY2NvdW50LAogICAgLy8gICAgIG1hcmtldF9pZDogVUludDY0LAogICAgLy8gICAgIG9sZF92YWx1ZTogQmlnVUludCwKICAgIC8vICAgICBuZXdfdmFsdWU6IEJpZ1VJbnQsCiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgZ2xvYmFsX3VzZXIgPSBzZWxmLl9nZXRfZ2xvYmFsX3VzZXIodXNlcl9pZCkKICAgIC8vIAogICAgLy8gICAgIGdsb2JhbF91c2VyLnRvdGFsX2NvbGxhdGVyYWxfdmFsdWUgPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgIGdsb2JhbF91c2VyLnRvdGFsX2NvbGxhdGVyYWxfdmFsdWUubmF0aXZlIC0gb2xkX3ZhbHVlICsgbmV3X3ZhbHVlCiAgICAvLyAgICAgKQogICAgLy8gICAgIGdsb2JhbF91c2VyLmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vIAogICAgLy8gICAgIHNlbGYuZ2xvYmFsX3VzZXJzW3VzZXJfaWRdID0gZ2xvYmFsX3VzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3VwZGF0ZV9nbG9iYWxfYm9ycm93cygKICAgIC8vICAgICBzZWxmLAogICAgLy8gICAgIHVzZXJfaWQ6IEFjY291bnQsCiAgICAvLyAgICAgbWFya2V0X2lkOiBVSW50NjQsCiAgICAvLyAgICAgb2xkX3ZhbHVlOiBCaWdVSW50LAogICAgLy8gICAgIG5ld192YWx1ZTogQmlnVUludCwKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBnbG9iYWxfdXNlciA9IHNlbGYuX2dldF9nbG9iYWxfdXNlcih1c2VyX2lkKQogICAgLy8gCiAgICAvLyAgICAgZ2xvYmFsX3VzZXIudG90YWxfYm9ycm93X3ZhbHVlID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBnbG9iYWxfdXNlci50b3RhbF9ib3Jyb3dfdmFsdWUubmF0aXZlIC0gb2xkX3ZhbHVlICsgbmV3X3ZhbHVlCiAgICAvLyAgICAgKQogICAgLy8gICAgIGdsb2JhbF91c2VyLmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vIAogICAgLy8gICAgIHNlbGYuZ2xvYmFsX3VzZXJzW3VzZXJfaWRdID0gZ2xvYmFsX3VzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF9nbG9iYWxfdXNlcl9oZWFsdGgoCiAgICAvLyAgICAgc2VsZiwgdXNlcl9pZDogYXJjNC5BZGRyZXNzLCBsaXF1aWRhdGlvbl90aHJlc2hvbGQ6IGFyYzQuVUludDY0CiAgICAvLyApIC0+IGFyYzQuVUludDI1NjoKICAgIC8vICAgICByZXR1cm4gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBzZWxmLl9nZXRfZ2xvYmFsX3VzZXJfaGVhbHRoKHVzZXJfaWQubmF0aXZlLCBsaXF1aWRhdGlvbl90aHJlc2hvbGQubmF0aXZlKQogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X2dsb2JhbF91c2VyX2hlYWx0aCgKICAgIC8vICAgICBzZWxmLCB1c2VyX2lkOiBBY2NvdW50LCBsaXF1aWRhdGlvbl90aHJlc2hvbGQ6IFVJbnQ2NAogICAgLy8gKSAtPiBCaWdVSW50OgogICAgLy8gICAgIGdsb2JhbF91c2VyID0gc2VsZi5fZ2V0X2dsb2JhbF91c2VyKHVzZXJfaWQpCiAgICAvLyAKICAgIC8vICAgICBpZiBnbG9iYWxfdXNlci50b3RhbF9ib3Jyb3dfdmFsdWUubmF0aXZlID09IDA6CiAgICAvLyAgICAgICAgIHJldHVybiBCaWdVSW50KDApICAjIE5vIGRlYnQgPSBpbmZpbml0ZSBoZWFsdGgKICAgIC8vIAogICAgLy8gICAgIGhlYWx0aCA9ICgKICAgIC8vICAgICAgICAgZ2xvYmFsX3VzZXIudG90YWxfY29sbGF0ZXJhbF92YWx1ZS5uYXRpdmUKICAgIC8vICAgICAgICAgKiBCaWdVSW50KGxpcXVpZGF0aW9uX3RocmVzaG9sZCkKICAgIC8vICAgICAgICAgKiBCaWdVSW50KDEwMDAwKQogICAgLy8gICAgICkgLy8gKGdsb2JhbF91c2VyLnRvdGFsX2JvcnJvd192YWx1ZS5uYXRpdmUgKiBCaWdVSW50KDEwMDAwKSkKICAgIC8vICAgICByZXR1cm4gaGVhbHRoCiAgICAvLyAKICAgIC8vICMgUkVNIG5vIHNpbmdsZS1tYXJrZXQgbGlxdWlkYXRpb24sIGp1c3QgY3Jvc3MtbWFya2V0IGxpcXVpZGF0aW9uIHNpbmdsZSBtYXJrZXQKICAgIC8vIAogICAgLy8gIyBSRU0gY3Jvc3MtbWFya2V0IGxpcXVpZGF0aW9uCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGxpcXVpZGF0ZV9jcm9zc19tYXJrZXQoCiAgICAvLyAgICAgc2VsZiwKICAgIC8vICAgICBkZWJ0X21hcmtldF9pZDogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgY29sbGF0ZXJhbF9tYXJrZXRfaWQ6IGFyYzQuVUludDY0LAogICAgLy8gICAgIHVzZXI6IGFyYzQuQWRkcmVzcywKICAgIC8vICAgICBkZWJ0X2Ftb3VudDogYXJjNC5VSW50MjU2LAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIGVuc3VyZV9idWRnZXQoMjEwMCwgT3BVcEZlZVNvdXJjZS5Hcm91cENyZWRpdCkKICAgIC8vICAgICBhc3NlcnQgbm90IHNlbGYuX2lzX3BhdXNlZCgpLCAiUHJvdG9jb2wgaXMgcGF1c2VkIgogICAgLy8gICAgIHNlbGYuX2xpcXVpZGF0ZV9jcm9zc19tYXJrZXQoCiAgICAvLyAgICAgICAgIGRlYnRfbWFya2V0X2lkLm5hdGl2ZSwKICAgIC8vICAgICAgICAgY29sbGF0ZXJhbF9tYXJrZXRfaWQubmF0aXZlLAogICAgLy8gICAgICAgICB1c2VyLm5hdGl2ZSwKICAgIC8vICAgICAgICAgZGVidF9hbW91bnQubmF0aXZlLAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfbGlxdWlkYXRlX2Nyb3NzX21hcmtldCgKICAgIC8vICAgICBzZWxmLAogICAgLy8gICAgIGRlYnRfbWFya2V0X2lkOiBVSW50NjQsCiAgICAvLyAgICAgY29sbGF0ZXJhbF9tYXJrZXRfaWQ6IFVJbnQ2NCwKICAgIC8vICAgICB1c2VyX2lkOiBBY2NvdW50LAogICAgLy8gICAgIGRlYnRfYW1vdW50OiBCaWdVSW50LAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIGFzc2VydCBkZWJ0X21hcmtldF9pZCBpbiBzZWxmLm1hcmtldHMsICJEZWJ0IG1hcmtldCBkb2VzIG5vdCBleGlzdCIKICAgIGZyYW1lX2RpZyAtNAogICAgaXRvYgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1MTAKICAgIC8vIHNlbGYubWFya2V0cyA9IEJveE1hcChVSW50NjQsIE1hcmtldERhdGEpICAjIE1hcmtldCBzdGF0ZQogICAgYnl0ZSAibWFya2V0cyIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTEwLTE1MTAKICAgIC8vICAgICBzZWxmLm1hcmtldHMgPSBCb3hNYXAoVUludDY0LCBNYXJrZXREYXRhKSAgIyBNYXJrZXQgc3RhdGUKICAgIC8vICAgICBzZWxmLnVzZXJzID0gQm94TWFwKEJ5dGVzNDAsIFVzZXJEYXRhKSAgIyBQZXItbWFya2V0IHVzZXIgc3RhdGUKICAgIC8vICAgICBzZWxmLmdsb2JhbF91c2VycyA9IEJveE1hcChBY2NvdW50LCBHbG9iYWxVc2VyRGF0YSkgICMgR2xvYmFsIHVzZXIgc3RhdGUKICAgIC8vIAogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAjIE93bmFibGUKICAgIC8vICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9vbmx5X293bmVyKHNlbGYpIC0+IE5vbmU6CiAgICAvLyAgICAgYXNzZXJ0IFR4bi5zZW5kZXIgPT0gc2VsZi5vd25lciwgIm9ubHkgdGhlIG93bmVyIGNhbiBjYWxsIHRoaXMgZnVuY3Rpb24iCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZChyZWFkb25seT1UcnVlKQogICAgLy8gZGVmIGdldF9vd25lcihzZWxmKSAtPiBhcmM0LkFkZHJlc3M6CiAgICAvLyAgICAgcmV0dXJuIGFyYzQuQWRkcmVzcyhzZWxmLm93bmVyKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiB0cmFuc2Zlcl9vd25lcnNoaXAoc2VsZiwgbmV3X293bmVyOiBhcmM0LkFkZHJlc3MpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgc2VsZi5fdHJhbnNmZXJfb3duZXJzaGlwKG5ld19vd25lci5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3RyYW5zZmVyX293bmVyc2hpcChzZWxmLCBuZXdfb3duZXI6IEFjY291bnQpIC0+IE5vbmU6CiAgICAvLyAgICAgcHJldmlvdXNfb3duZXIgPSBzZWxmLm93bmVyCiAgICAvLyAgICAgc2VsZi5vd25lciA9IG5ld19vd25lcgogICAgLy8gICAgIGFyYzQuZW1pdCgKICAgIC8vICAgICAgICAgT3duZXJzaGlwVHJhbnNmZXJyZWQoYXJjNC5BZGRyZXNzKHByZXZpb3VzX293bmVyKSwgYXJjNC5BZGRyZXNzKG5ld19vd25lcikpCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIAogICAgLy8gIyBSRU0gaGF2aW5nIGlzc3VlcyB3aXRoIHRoZSBpbmhlcml0YW5jZSBoZXJlCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGlzX3BhdXNlZChzZWxmKSAtPiBhcmM0LkJvb2w6CiAgICAvLyAgICAgcmV0dXJuIGFyYzQuQm9vbChzZWxmLl9pc19wYXVzZWQoKSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaXNfcGF1c2VkKHNlbGYpIC0+IGJvb2w6CiAgICAvLyAgICAgcmV0dXJuIHNlbGYucGF1c2VkID09IFVJbnQ2NCgxKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBwYXVzZShzZWxmLCBwYXVzZTogYXJjNC5VSW50NjQpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgc2VsZi5fcGF1c2UocGF1c2UubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9wYXVzZShzZWxmLCBwYXVzZTogVUludDY0KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYucGF1c2VkID0gcGF1c2UKICAgIC8vIAogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF9zdG9rZW5fYXBwX2lkKHNlbGYpIC0+IGFyYzQuVUludDY0OgogICAgLy8gICAgIHJldHVybiBhcmM0LlVJbnQ2NChzZWxmLl9nZXRfc3Rva2VuX2FwcF9pZCgpKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9nZXRfc3Rva2VuX2FwcF9pZChzZWxmKSAtPiBVSW50NjQ6CiAgICAvLyAgICAgcmV0dXJuIHNlbGYuc3Rva2VuX2FwcF9pZAogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBzZXRfc3Rva2VuX2FwcF9pZChzZWxmLCBzdG9rZW5fYXBwX2lkOiBhcmM0LlVJbnQ2NCkgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLl9vbmx5X293bmVyKCkKICAgIC8vICAgICBzZWxmLnN0b2tlbl9hcHBfaWQgPSBzdG9rZW5fYXBwX2lkLm5hdGl2ZQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9nZXRfdXNlcl9rZXkoc2VsZiwgdXNlcl9pZDogQWNjb3VudCwgbWFya2V0X2lkOiBVSW50NjQpIC0+IEJ5dGVzNDA6CiAgICAvLyAgICAgcmV0dXJuIEJ5dGVzNDAuZnJvbV9ieXRlcygKICAgIC8vICAgICAgICAgYXJjNC5BZGRyZXNzKHVzZXJfaWQpLmJ5dGVzICsgYXJjNC5VSW50NjQobWFya2V0X2lkKS5ieXRlcwogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgZ2V0X3VzZXIoc2VsZiwgdXNlcl9pZDogYXJjNC5BZGRyZXNzLCBtYXJrZXRfaWQ6IGFyYzQuVUludDY0KSAtPiBVc2VyRGF0YToKICAgIC8vICAgICByZXR1cm4gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZC5uYXRpdmUsIG1hcmtldF9pZC5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2dldF91c2VyKHNlbGYsIHVzZXJfaWQ6IEFjY291bnQsIG1hcmtldF9pZDogVUludDY0KSAtPiBVc2VyRGF0YToKICAgIC8vICAgICB1c2VyX2tleSA9IHNlbGYuX2dldF91c2VyX2tleSh1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgcmV0dXJuIHNlbGYudXNlcnMuZ2V0KAogICAgLy8gICAgICAgICB1c2VyX2tleSwKICAgIC8vICAgICAgICAgZGVmYXVsdD1Vc2VyRGF0YSgKICAgIC8vICAgICAgICAgICAgIHNjYWxlZF9kZXBvc2l0cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBzY2FsZWRfYm9ycm93cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBkZXBvc2l0X2luZGV4PWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGJvcnJvd19pbmRleD1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBsYXN0X3VwZGF0ZV90aW1lPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgbGFzdF9wcmljZT1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICksCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9oYXNfcG9zaXRpb24oc2VsZiwgdXNlcl9pZDogQWNjb3VudCwgbWFya2V0X2lkOiBVSW50NjQpIC0+IGJvb2w6CiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICByZXR1cm4gdXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlID4gMAogICAgLy8gCiAgICAvLyAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIAogICAgLy8gIyBSRU0gY29uc2lkZXIgcmVtb3ZpbmcgYW5kIGNhbGN1bGF0aW5nIGluIHRoZSBjbGllbnQKICAgIC8vICMgUkVNIHRyeWluZyB0byBjdXQgYmFjayBvbiBleHRyYSBwYWdlcwogICAgLy8gCiAgICAvLyAjIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gIyBkZWYgZ2V0X3VzZXJfZGVwb3NpdF91bmRlcmx5aW5nX2Ftb3VudCgKICAgIC8vICMgICAgIHNlbGYsIHVzZXJfaWQ6IGFyYzQuQWRkcmVzcywgbWFya2V0X2lkOiBhcmM0LlVJbnQ2NAogICAgLy8gIyApIC0+IGFyYzQuVUludDI1NjoKICAgIC8vICMgICAgIHJldHVybiBhcmM0LlVJbnQyNTYoCiAgICAvLyAjICAgICAgICAgc2VsZi5fZ2V0X3VzZXJfZGVwb3NpdF91bmRlcmx5aW5nX2Ftb3VudCh1c2VyX2lkLm5hdGl2ZSwgbWFya2V0X2lkLm5hdGl2ZSkKICAgIC8vICMgICAgICkKICAgIC8vIAogICAgLy8gIyBAc3Vicm91dGluZQogICAgLy8gIyBkZWYgX2dldF91c2VyX2RlcG9zaXRfdW5kZXJseWluZ19hbW91bnQoCiAgICAvLyAjICAgICBzZWxmLCB1c2VyX2lkOiBBY2NvdW50LCBtYXJrZXRfaWQ6IFVJbnQ2NAogICAgLy8gIyApIC0+IEJpZ1VJbnQ6CiAgICAvLyAjICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gIyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpICAjIEFkZCB0aGlzIGxpbmUKICAgIC8vICMgICAgIHJldHVybiAodXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlICogbWFya2V0LmRlcG9zaXRfaW5kZXgubmF0aXZlKSAvLyBTQ0FMRQogICAgLy8gCiAgICAvLyAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaW5jcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9kZXBvc2l0cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgdXNlcl9pZDogQWNjb3VudCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyX2tleSA9IHNlbGYuX2dldF91c2VyX2tleSh1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlci5zY2FsZWRfZGVwb3NpdHMgPSBhcmM0LlVJbnQyNTYodXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlICsgYW1vdW50KQogICAgLy8gICAgIHVzZXIuZGVwb3NpdF9pbmRleCA9IG1hcmtldC5kZXBvc2l0X2luZGV4CiAgICAvLyAgICAgdXNlci5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApCiAgICAvLyAgICAgdXNlci5sYXN0X3ByaWNlID0gbWFya2V0LnByaWNlICAjIFVwZGF0ZSB1c2VyJ3MgbGFzdCBrbm93biBwcmljZQogICAgLy8gICAgIHNlbGYudXNlcnNbdXNlcl9rZXldID0gdXNlci5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaW5jcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9ib3Jyb3dzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCB1c2VyX2lkOiBBY2NvdW50LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyLnNjYWxlZF9ib3Jyb3dzID0gYXJjNC5VSW50MjU2KHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlICsgYW1vdW50KQogICAgLy8gICAgIHVzZXIuYm9ycm93X2luZGV4ID0gbWFya2V0LmJvcnJvd19pbmRleAogICAgLy8gICAgIHVzZXIubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gICAgIHVzZXIubGFzdF9wcmljZSA9IG1hcmtldC5wcmljZSAgIyBVcGRhdGUgdXNlcidzIGxhc3Qga25vd24gcHJpY2UKICAgIC8vICAgICBzZWxmLnVzZXJzW3VzZXJfa2V5XSA9IHVzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2RlY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfZGVwb3NpdHMoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIHVzZXJfaWQ6IEFjY291bnQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlcl9rZXkgPSBzZWxmLl9nZXRfdXNlcl9rZXkodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgIHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSA+PSBhbW91bnQKICAgIC8vICAgICApLCAiSW5zdWZmaWNpZW50IGJhbGFuY2UgdG8gd2l0aGRyYXcgdGhpcyBhbW91bnQiCiAgICAvLyAgICAgdXNlci5zY2FsZWRfZGVwb3NpdHMgPSBhcmM0LlVJbnQyNTYodXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlIC0gYW1vdW50KQogICAgLy8gICAgIHVzZXIuZGVwb3NpdF9pbmRleCA9IG1hcmtldC5kZXBvc2l0X2luZGV4CiAgICAvLyAgICAgdXNlci5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApCiAgICAvLyAgICAgdXNlci5sYXN0X3ByaWNlID0gbWFya2V0LnByaWNlICAjIFVwZGF0ZSB1c2VyJ3MgbGFzdCBrbm93biBwcmljZQogICAgLy8gICAgIHNlbGYudXNlcnNbdXNlcl9rZXldID0gdXNlci5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZGVjcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9ib3Jyb3dzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCB1c2VyX2lkOiBBY2NvdW50LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICB1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSA+PSBhbW91bnQKICAgIC8vICAgICApLCAiSW5zdWZmaWNpZW50IGJhbGFuY2UgdG8gcmVwYXkgdGhpcyBhbW91bnQiCiAgICAvLyAgICAgdXNlci5zY2FsZWRfYm9ycm93cyA9IGFyYzQuVUludDI1Nih1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAtIGFtb3VudCkKICAgIC8vICAgICB1c2VyLmJvcnJvd19pbmRleCA9IG1hcmtldC5ib3Jyb3dfaW5kZXgKICAgIC8vICAgICB1c2VyLmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vICAgICB1c2VyLmxhc3RfcHJpY2UgPSBtYXJrZXQucHJpY2UgICMgVXBkYXRlIHVzZXIncyBsYXN0IGtub3duIHByaWNlCiAgICAvLyAgICAgc2VsZi51c2Vyc1t1c2VyX2tleV0gPSB1c2VyLmNvcHkoKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBjcmVhdGVfbWFya2V0KAogICAgLy8gICAgIHNlbGYsCiAgICAvLyAgICAgdG9rZW5faWQ6IGFyYzQuVUludDY0LAogICAgLy8gICAgIGNvbGxhdGVyYWxfZmFjdG9yOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBsaXF1aWRhdGlvbl90aHJlc2hvbGQ6IGFyYzQuVUludDY0LAogICAgLy8gICAgIHJlc2VydmVfZmFjdG9yOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBib3Jyb3dfcmF0ZTogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgc2xvcGU6IGFyYzQuVUludDY0LAogICAgLy8gICAgIG1heF90b3RhbF9kZXBvc2l0czogYXJjNC5VSW50MjU2LAogICAgLy8gICAgIG1heF90b3RhbF9ib3Jyb3dzOiBhcmM0LlVJbnQyNTYsCiAgICAvLyAgICAgbGlxdWlkYXRpb25fYm9udXM6IGFyYzQuVUludDY0LAogICAgLy8gICAgIGNsb3NlX2ZhY3RvcjogYXJjNC5VSW50NjQsCiAgICAvLyApIC0+IGFyYzQuVUludDY0OgogICAgLy8gICAgIHNlbGYuX29ubHlfb3duZXIoKQogICAgLy8gICAgIGFzc2VydCBub3Qgc2VsZi5faXNfcGF1c2VkKCksICJQcm90b2NvbCBpcyBwYXVzZWQiCiAgICAvLyAgICAgcmV0dXJuIGFyYzQuVUludDY0KAogICAgLy8gICAgICAgICBzZWxmLl9jcmVhdGVfbWFya2V0KAogICAgLy8gICAgICAgICAgICAgdG9rZW5faWQubmF0aXZlLAogICAgLy8gICAgICAgICAgICAgTWFya2V0RGF0YSgKICAgIC8vICAgICAgICAgICAgICAgICBwYXVzZWQ9YXJjNC5Cb29sKFRydWUpLCAgIyBTdGFydCBwYXVzZWQgdW50aWwgcHJpY2UgaXMgc2V0CiAgICAvLyAgICAgICAgICAgICAgICAgbWF4X3RvdGFsX2RlcG9zaXRzPW1heF90b3RhbF9kZXBvc2l0cywKICAgIC8vICAgICAgICAgICAgICAgICBtYXhfdG90YWxfYm9ycm93cz1tYXhfdG90YWxfYm9ycm93cywKICAgIC8vICAgICAgICAgICAgICAgICBsaXF1aWRhdGlvbl9ib251cz1saXF1aWRhdGlvbl9ib251cywKICAgIC8vICAgICAgICAgICAgICAgICBjb2xsYXRlcmFsX2ZhY3Rvcj1jb2xsYXRlcmFsX2ZhY3RvciwKICAgIC8vICAgICAgICAgICAgICAgICBsaXF1aWRhdGlvbl90aHJlc2hvbGQ9bGlxdWlkYXRpb25fdGhyZXNob2xkLAogICAgLy8gICAgICAgICAgICAgICAgIHJlc2VydmVfZmFjdG9yPXJlc2VydmVfZmFjdG9yLAogICAgLy8gICAgICAgICAgICAgICAgIGJvcnJvd19yYXRlPWJvcnJvd19yYXRlLAogICAgLy8gICAgICAgICAgICAgICAgIHNsb3BlPXNsb3BlLAogICAgLy8gICAgICAgICAgICAgICAgIHRvdGFsX3NjYWxlZF9kZXBvc2l0cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICAgICAgdG90YWxfc2NhbGVkX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgICAgIGRlcG9zaXRfaW5kZXg9YXJjNC5VSW50MjU2KFNDQUxFKSwgICMgU3RhcnQgYXQgU0NBTEUgKDEuMCkKICAgIC8vICAgICAgICAgICAgICAgICBib3Jyb3dfaW5kZXg9YXJjNC5VSW50MjU2KFNDQUxFKSwgICMgU3RhcnQgYXQgU0NBTEUgKDEuMCkKICAgIC8vICAgICAgICAgICAgICAgICBsYXN0X3VwZGF0ZV90aW1lPWFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKSwKICAgIC8vICAgICAgICAgICAgICAgICByZXNlcnZlcz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICAgICAgcHJpY2U9YXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICAgICAgICAgICAgICAwCiAgICAvLyAgICAgICAgICAgICAgICAgKSwgICMgUHJpY2UgbXVzdCBiZSBzZXQgYmVmb3JlIG1hcmtldCBjYW4gYmUgdXNlZAogICAgLy8gICAgICAgICAgICAgICAgIG50b2tlbl9pZD1hcmM0LlVJbnQ2NCgwKSwgICMgV2lsbCBiZSBzZXQgZHVyaW5nIHRva2VuIGluaXRpYWxpemF0aW9uCiAgICAvLyAgICAgICAgICAgICAgICAgY2xvc2VfZmFjdG9yPWNsb3NlX2ZhY3RvciwKICAgIC8vICAgICAgICAgICAgICksCiAgICAvLyAgICAgICAgICkKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2NyZWF0ZV9tYXJrZXQoc2VsZiwgdG9rZW5faWQ6IFVJbnQ2NCwgbWFya2V0X2RhdGE6IE1hcmtldERhdGEpIC0+IFVJbnQ2NDoKICAgIC8vICAgICBhc3NlcnQgbm90IHRva2VuX2lkIGluIHNlbGYubWFya2V0cywgIk1hcmtldCBhbHJlYWR5IGV4aXN0cyIKICAgIC8vICAgICBwYXltZW50ID0gcmVxdWlyZV9wYXltZW50KFR4bi5zZW5kZXIpCiAgICAvLyAgICAgYXNzZXJ0ICgKICAgIC8vICAgICAgICAgcGF5bWVudCA+PSBzZWxmLl9jcmVhdGVfbWFya2V0X2Nvc3QoKQogICAgLy8gICAgICksICJpbnN1ZmZpY2llbnQgcGF5bWVudCBmb3IgY3JlYXRlIG1hcmtldCIKICAgIC8vICAgICBjb21waWxlZCA9IGNvbXBpbGVfY29udHJhY3QoTlRva2VuLCBleHRyYV9wcm9ncmFtX3BhZ2VzPTApICAjIG5vIGV4dHJhIHBhZ2VzCiAgICAvLyAgICAgYmFzZV9hcHAgPSBhcmM0LmFyYzRfY3JlYXRlKE5Ub2tlbiwgY29tcGlsZWQ9Y29tcGlsZWQpLmNyZWF0ZWRfYXBwCiAgICAvLyAgICAgYm9vdHN0cmFwNjRfY29zdCwgdHhuMSA9IGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIE5Ub2tlbi5ib290c3RyYXA2NF9jb3N0LAogICAgLy8gICAgICAgICBhcHBfaWQ9YmFzZV9hcHAsCiAgICAvLyAgICAgKQogICAgLy8gICAgIGl0eG4uUGF5bWVudCgKICAgIC8vICAgICAgICAgcmVjZWl2ZXI9YmFzZV9hcHAuYWRkcmVzcywgYW1vdW50PWJvb3RzdHJhcDY0X2Nvc3QubmF0aXZlLCBmZWU9MAogICAgLy8gICAgICkuc3VibWl0KCkKICAgIC8vICAgICBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgICAgICBOVG9rZW4uYm9vdHN0cmFwNjQsCiAgICAvLyAgICAgICAgIGFyYzQuVUludDY0KHRva2VuX2lkKSwKICAgIC8vICAgICAgICAgYXBwX2lkPWJhc2VfYXBwLAogICAgLy8gICAgICkKICAgIC8vICAgICBtYXJrZXRfZGF0YS5udG9rZW5faWQgPSBhcmM0LlVJbnQ2NChiYXNlX2FwcC5pZCkKICAgIC8vICAgICBzZWxmLm1hcmtldHNbdG9rZW5faWRdID0gbWFya2V0X2RhdGEuY29weSgpCiAgICAvLyAgICAgYXJjNC5lbWl0KAogICAgLy8gICAgICAgICBNYXJrZXRDcmVhdGVkKGFyYzQuVUludDY0KHRva2VuX2lkKSwgYXJjNC5VSW50NjQoYmFzZV9hcHAuaWQpLCBtYXJrZXRfZGF0YSkKICAgIC8vICAgICApCiAgICAvLyAgICAgcmV0dXJuIGJhc2VfYXBwLmlkCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZChyZWFkb25seT1UcnVlKQogICAgLy8gZGVmIGNyZWF0ZV9tYXJrZXRfY29zdChzZWxmKSAtPiBhcmM0LlVJbnQ2NDoKICAgIC8vICAgICByZXR1cm4gYXJjNC5VSW50NjQoc2VsZi5fY3JlYXRlX21hcmtldF9jb3N0KCkpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2NyZWF0ZV9tYXJrZXRfY29zdChzZWxmKSAtPiBVSW50NjQ6CiAgICAvLyAgICAgcmV0dXJuIFVJbnQ2NCgxXzAwMF8wMDApCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZChyZWFkb25seT1UcnVlKQogICAgLy8gZGVmIGdldF9tYXJrZXQoc2VsZiwgdG9rZW5faWQ6IGFyYzQuVUludDY0KSAtPiBNYXJrZXREYXRhOgogICAgLy8gICAgIHJldHVybiBzZWxmLl9nZXRfbWFya2V0KHRva2VuX2lkLm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X21hcmtldChzZWxmLCB0b2tlbl9pZDogVUludDY0KSAtPiBNYXJrZXREYXRhOgogICAgLy8gICAgIHJldHVybiBzZWxmLm1hcmtldHMuZ2V0KAogICAgLy8gICAgICAgICB0b2tlbl9pZCwKICAgIC8vICAgICAgICAgZGVmYXVsdD1NYXJrZXREYXRhKAogICAgLy8gICAgICAgICAgICAgcGF1c2VkPWFyYzQuQm9vbChUcnVlKSwKICAgIC8vICAgICAgICAgICAgIG1heF90b3RhbF9kZXBvc2l0cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBtYXhfdG90YWxfYm9ycm93cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBsaXF1aWRhdGlvbl9ib251cz1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIGNvbGxhdGVyYWxfZmFjdG9yPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgbGlxdWlkYXRpb25fdGhyZXNob2xkPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgcmVzZXJ2ZV9mYWN0b3I9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICBib3Jyb3dfcmF0ZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIHNsb3BlPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgdG90YWxfc2NhbGVkX2RlcG9zaXRzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIHRvdGFsX3NjYWxlZF9ib3Jyb3dzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGRlcG9zaXRfaW5kZXg9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgYm9ycm93X2luZGV4PWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGxhc3RfdXBkYXRlX3RpbWU9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICByZXNlcnZlcz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBwcmljZT1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBudG9rZW5faWQ9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICBjbG9zZV9mYWN0b3I9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICksCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBnZXRfbWFya2V0X3ByaWNlKHNlbGYsIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCkgLT4gYXJjNC5VSW50MjU2OgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQodG9rZW5faWQubmF0aXZlKQogICAgLy8gICAgIHJldHVybiBtYXJrZXQucHJpY2UKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgZ2V0X21hcmtldF9udG9rZW5faWQoc2VsZiwgdG9rZW5faWQ6IGFyYzQuVUludDY0KSAtPiBhcmM0LlVJbnQ2NDoKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KHRva2VuX2lkLm5hdGl2ZSkKICAgIC8vICAgICByZXR1cm4gbWFya2V0Lm50b2tlbl9pZAogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBzZXRfbWFya2V0X3ByaWNlKHNlbGYsIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCwgcHJpY2U6IGFyYzQuVUludDI1NikgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLl9vbmx5X293bmVyKCkKICAgIC8vICAgICBhc3NlcnQgbm90IHNlbGYuX2lzX3BhdXNlZCgpLCAiUHJvdG9jb2wgaXMgcGF1c2VkIgogICAgLy8gICAgIHNlbGYuX3NldF9tYXJrZXRfcHJpY2UodG9rZW5faWQubmF0aXZlLCBwcmljZS5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3NldF9tYXJrZXRfcHJpY2Uoc2VsZiwgdG9rZW5faWQ6IFVJbnQ2NCwgcHJpY2U6IEJpZ1VJbnQpIC0+IE5vbmU6CiAgICAvLyAgICAgYXNzZXJ0IHRva2VuX2lkIGluIHNlbGYubWFya2V0cywgIk1hcmtldCBkb2VzIG5vdCBleGlzdCIKICAgIC8vICAgICBhc3NlcnQgcHJpY2UgPiAwLCAiUHJpY2UgbXVzdCBiZSBwb3NpdGl2ZSIKICAgIC8vIAogICAgLy8gICAgIG1hcmtldCA9IHNlbGYubWFya2V0c1t0b2tlbl9pZF0uY29weSgpCiAgICAvLyAKICAgIC8vICAgICAjIFVucGF1c2UgdGhlIG1hcmtldCBvbiBmaXJzdCBwcmljZSBzZXQKICAgIC8vICAgICBpZiBtYXJrZXQucGF1c2VkIGFuZCBtYXJrZXQucHJpY2UgPT0gMDoKICAgIC8vICAgICAgICAgbWFya2V0LnBhdXNlZCA9IGFyYzQuQm9vbChGYWxzZSkKICAgIC8vIAogICAgLy8gICAgICMgU2NhbGUgdGhlIHByaWNlIGJ5IFNDQUxFIGludGVybmFsbHkgZm9yIHN0b3JhZ2UKICAgIC8vICAgICBtYXJrZXQucHJpY2UgPSBhcmM0LlVJbnQyNTYocHJpY2UgKiBTQ0FMRSkKICAgIC8vIAogICAgLy8gICAgIHNlbGYubWFya2V0c1t0b2tlbl9pZF0gPSBtYXJrZXQuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2luY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2RlcG9zaXRzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSArIGFtb3VudAogICAgLy8gICAgICkKICAgIC8vICAgICBtYXJrZXQubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gICAgIHNlbGYubWFya2V0c1ttYXJrZXRfaWRdID0gbWFya2V0LmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9kZWNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9kZXBvc2l0cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgYXNzZXJ0ICgKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cy5uYXRpdmUgPj0gYW1vdW50CiAgICAvLyAgICAgKSwgIkluc3VmZmljaWVudCBiYWxhbmNlIHRvIHdpdGhkcmF3IHRoaXMgYW1vdW50IgogICAgLy8gICAgIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMgPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlIC0gYW1vdW50CiAgICAvLyAgICAgKQogICAgLy8gICAgIHNlbGYubWFya2V0c1ttYXJrZXRfaWRdID0gbWFya2V0LmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9pbmNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9ib3Jyb3dzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MgPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUgKyBhbW91bnQKICAgIC8vICAgICApCiAgICAvLyAgICAgbWFya2V0Lmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vICAgICBzZWxmLm1hcmtldHNbbWFya2V0X2lkXSA9IG1hcmtldC5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZGVjcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfYm9ycm93cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgYXNzZXJ0ICgKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzLm5hdGl2ZSA+PSBhbW91bnQKICAgIC8vICAgICApLCAiSW5zdWZmaWNpZW50IGJhbGFuY2UgdG8gd2l0aGRyYXcgdGhpcyBhbW91bnQiCiAgICAvLyAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlIC0gYW1vdW50CiAgICAvLyAgICAgKQogICAgLy8gICAgIHNlbGYubWFya2V0c1ttYXJrZXRfaWRdID0gbWFya2V0LmNvcHkoKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBwYXVzZV9tYXJrZXQoc2VsZiwgdG9rZW5faWQ6IGFyYzQuVUludDY0LCBwYXVzZTogYXJjNC5VSW50NjQpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgc2VsZi5fcGF1c2VfbWFya2V0KHRva2VuX2lkLm5hdGl2ZSwgcGF1c2UubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9wYXVzZV9tYXJrZXQoc2VsZiwgdG9rZW5faWQ6IFVJbnQ2NCwgcGF1c2U6IFVJbnQ2NCkgLT4gTm9uZToKICAgIC8vICAgICBhc3NlcnQgdG9rZW5faWQgaW4gc2VsZi5tYXJrZXRzLCAiTWFya2V0IGRvZXMgbm90IGV4aXN0IgogICAgLy8gICAgIHNlbGYubWFya2V0c1t0b2tlbl9pZF0ucGF1c2VkID0gYXJjNC5Cb29sKHBhdXNlID09IFVJbnQ2NCgxKSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaXNfbWFya2V0X3BhdXNlZChzZWxmLCB0b2tlbl9pZDogVUludDY0KSAtPiBib29sOgogICAgLy8gICAgIHJldHVybiBzZWxmLl9nZXRfbWFya2V0KHRva2VuX2lkKS5wYXVzZWQubmF0aXZlID09IFVJbnQ2NCgxKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9hY2NydWVfaW50ZXJlc3Qoc2VsZiwgbWFya2V0X2lkOiBVSW50NjQpIC0+IE1hcmtldERhdGE6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgaWYgbWFya2V0LnBhdXNlZDoKICAgIC8vICAgICAgICAgcmV0dXJuIG1hcmtldAogICAgLy8gCiAgICAvLyAgICAgY3VycmVudF90aW1lID0gR2xvYmFsLmxhdGVzdF90aW1lc3RhbXAKICAgIC8vICAgICB0aW1lX2RlbHRhID0gY3VycmVudF90aW1lIC0gbWFya2V0Lmxhc3RfdXBkYXRlX3RpbWUubmF0aXZlCiAgICAvLyAgICAgaWYgdGltZV9kZWx0YSA8PSAwOgogICAgLy8gICAgICAgICByZXR1cm4gbWFya2V0CiAgICAvLyAKICAgIC8vICAgICAjIEZvciBzdG9rZW4gbWFya2V0IChib3Jyb3ctb25seSksIHVzZSBhIGZpeGVkIHV0aWxpemF0aW9uIHJhdGUgc2luY2UgdGhlcmUgYXJlIG5vIGRlcG9zaXRzCiAgICAvLyAgICAgaWYgbWFya2V0X2lkID09IHNlbGYuc3Rva2VuX2FwcF9pZDoKICAgIC8vICAgICAgICAgdXRpbGl6YXRpb24gPSBCaWdVSW50KDEwMDAwKSAgIyAxMDAlIHV0aWxpemF0aW9uIGZvciBib3Jyb3ctb25seSBtYXJrZXQKICAgIC8vICAgICBlbGlmIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlID09IDA6CiAgICAvLyAgICAgICAgIHJldHVybiBtYXJrZXQKICAgIC8vICAgICBlbHNlOgogICAgLy8gICAgICAgICB1dGlsaXphdGlvbiA9ICgKICAgIC8vICAgICAgICAgICAgIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUgKiAxMDAwMAogICAgLy8gICAgICAgICApIC8vIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlCiAgICAvLyAgICAgcmF0ZSA9IG1hcmtldC5ib3Jyb3dfcmF0ZS5uYXRpdmUgKyAobWFya2V0LnNsb3BlLm5hdGl2ZSAqIHV0aWxpemF0aW9uKSAvLyAxMDAwMAogICAgLy8gICAgIGludGVyZXN0ID0gKHJhdGUgKiBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlICogdGltZV9kZWx0YSkgLy8gKAogICAgLy8gICAgICAgICBzZWxmLnNlY29uZHNfcGVyX3llYXIgKiAxMDAwMAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gICAgICMgU3BlY2lhbCBoYW5kbGluZyBmb3Igc3Rva2VuIG1hcmtldCAtIGFsbCBpbnRlcmVzdCBnb2VzIHRvIHJlc2VydmVzCiAgICAvLyAgICAgaWYgbWFya2V0X2lkID09IHNlbGYuc3Rva2VuX2FwcF9pZDoKICAgIC8vICAgICAgICAgcHJvdG9jb2xfcG9ydGlvbiA9IGludGVyZXN0CiAgICAvLyAgICAgICAgIGRlcG9zaXRvcl9wb3J0aW9uID0gQmlnVUludCgwKQogICAgLy8gICAgIGVsc2U6CiAgICAvLyAgICAgICAgIHByb3RvY29sX3BvcnRpb24gPSAoCiAgICAvLyAgICAgICAgICAgICBpbnRlcmVzdCAqIGFyYzQuVUludDI1Ni5mcm9tX2J5dGVzKG1hcmtldC5yZXNlcnZlX2ZhY3Rvci5ieXRlcykubmF0aXZlCiAgICAvLyAgICAgICAgICkgLy8gMTAwMDAKICAgIC8vICAgICAgICAgaWYgcHJvdG9jb2xfcG9ydGlvbiA+IGludGVyZXN0OgogICAgLy8gICAgICAgICAgICAgcHJvdG9jb2xfcG9ydGlvbiA9IGludGVyZXN0CiAgICAvLyAgICAgICAgIGRlcG9zaXRvcl9wb3J0aW9uID0gaW50ZXJlc3QgLSBwcm90b2NvbF9wb3J0aW9uCiAgICAvLyAKICAgIC8vICAgICBpZiBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzID4gMDoKICAgIC8vICAgICAgICAgbWFya2V0LmRlcG9zaXRfaW5kZXggPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgICAgICBtYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUKICAgIC8vICAgICAgICAgICAgICsgKGRlcG9zaXRvcl9wb3J0aW9uICogU0NBTEUpIC8vIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlCiAgICAvLyAgICAgICAgICkKICAgIC8vICAgICBpZiBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MgPiAwOgogICAgLy8gICAgICAgICBtYXJrZXQuYm9ycm93X2luZGV4ID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICAgICAgbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUKICAgIC8vICAgICAgICAgICAgICsgKGludGVyZXN0ICogU0NBTEUpIC8vIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUKICAgIC8vICAgICAgICAgKQogICAgLy8gCiAgICAvLyAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlICsgaW50ZXJlc3QKICAgIC8vICAgICApCiAgICAvLyAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cyA9IGFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKyBkZXBvc2l0b3JfcG9ydGlvbgogICAgLy8gICAgICkKICAgIC8vICAgICBtYXJrZXQucmVzZXJ2ZXMgPSBhcmM0LlVJbnQyNTYobWFya2V0LnJlc2VydmVzLm5hdGl2ZSArIHByb3RvY29sX3BvcnRpb24pCiAgICAvLyAgICAgbWFya2V0Lmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChjdXJyZW50X3RpbWUpCiAgICAvLyAKICAgIC8vICAgICBzZWxmLm1hcmtldHNbbWFya2V0X2lkXSA9IG1hcmtldC5jb3B5KCkKICAgIC8vICAgICByZXR1cm4gbWFya2V0LmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF92YWxpZGF0ZV9tYXJrZXRfb3BlcmF0aW9uKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQsIGd1YXJkX3N0b2tlbjogYm9vbAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIGFzc2VydCBub3Qgc2VsZi5faXNfcGF1c2VkKCksICJQcm90b2NvbCBpcyBwYXVzZWQiCiAgICAvLyAgICAgYXNzZXJ0IG1hcmtldF9pZCBpbiBzZWxmLm1hcmtldHMsICJNYXJrZXQgZG9lcyBub3QgZXhpc3QiCiAgICAvLyAgICAgYXNzZXJ0IGFtb3VudCA+IDAsICJBbW91bnQgbXVzdCBiZSA+IDAiCiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgYXNzZXJ0IG5vdCBtYXJrZXQucGF1c2VkLCAiTWFya2V0IGlzIHBhdXNlZCIKICAgIC8vICAgICBpZiBndWFyZF9zdG9rZW46CiAgICAvLyAgICAgICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgICAgICBzZWxmLnN0b2tlbl9hcHBfaWQgIT0gbWFya2V0X2lkCiAgICAvLyAgICAgICAgICksICJDYW5ub3QgdXNlIHN0b2tlbiBtYXJrZXQgZm9yIHRoaXMgb3BlcmF0aW9uIgogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBkZXBvc2l0KHNlbGYsIG1hcmtldF9pZDogYXJjNC5VSW50NjQsIGFtb3VudDogYXJjNC5VSW50MjU2KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX2RlcG9zaXQobWFya2V0X2lkLm5hdGl2ZSwgYW1vdW50Lm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZGVwb3NpdChzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX3ZhbGlkYXRlX21hcmtldF9vcGVyYXRpb24obWFya2V0X2lkLCBhbW91bnQsIFRydWUpCiAgICAvLyAKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICBzY2FsZWRfYW1vdW50ID0gKGFtb3VudCAqIFNDQUxFKSAvLyBtYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICBtYXJrZXQubWF4X3RvdGFsX2RlcG9zaXRzLm5hdGl2ZQogICAgLy8gICAgICAgICA+PSBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSArIHNjYWxlZF9hbW91bnQKICAgIC8vICAgICApLCAiRGVwb3NpdCBjYXAgZXhjZWVkZWQiCiAgICAvLyAKICAgIC8vICAgICBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgICAgICBBUkMyMDBUb2tlbkludGVyZmFjZS5hcmMyMDBfdHJhbnNmZXJGcm9tLAogICAgLy8gICAgICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgICAgIGFyYzQuQWRkcmVzcyhHbG9iYWwuY3VycmVudF9hcHBsaWNhdGlvbl9hZGRyZXNzKSwKICAgIC8vICAgICAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgICAgIGFwcF9pZD1BcHBsaWNhdGlvbihtYXJrZXRfaWQpLAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcihUeG4uc2VuZGVyLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgbmV3X21hcmtldCA9IHNlbGYuX2FjY3J1ZV9pbnRlcmVzdCgKICAgIC8vICAgICAgICAgbWFya2V0X2lkCiAgICAvLyAgICAgKSAgIyBHZXQgdXBkYXRlZCBtYXJrZXQgd2l0aCBhY2NydWVkIGludGVyZXN0CiAgICAvLyAgICAgc2NhbGVkX2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgYW1vdW50ICogU0NBTEUKICAgIC8vICAgICApIC8vIG5ld19tYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUgICMgQ2FsY3VsYXRlIHdpdGggbmV3IGluZGV4CiAgICAvLyAKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICBuZXdfbWFya2V0Lm1heF90b3RhbF9kZXBvc2l0cy5uYXRpdmUKICAgIC8vICAgICAgICAgPj0gbmV3X21hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlICsgc2NhbGVkX2Ftb3VudAogICAgLy8gICAgICksICJEZXBvc2l0IGNhcCBleGNlZWRlZCIKICAgIC8vIAogICAgLy8gICAgIHNlbGYuX2luY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfZGVwb3NpdHMoCiAgICAvLyAgICAgICAgIG1hcmtldF9pZCwgVHhuLnNlbmRlciwgc2NhbGVkX2Ftb3VudAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gICAgIHNlbGYuX2luY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2RlcG9zaXRzKG1hcmtldF9pZCwgc2NhbGVkX2Ftb3VudCkKICAgIC8vIAogICAgLy8gICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIE5Ub2tlbi5taW50LAogICAgLy8gICAgICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgICAgIGFyYzQuVUludDI1NihhbW91bnQpLAogICAgLy8gICAgICAgICBhcHBfaWQ9QXBwbGljYXRpb24obWFya2V0Lm50b2tlbl9pZC5uYXRpdmUpLAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gICAgIG9sZF9kZXBvc2l0X2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgdXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlICogbmV3X21hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZQogICAgLy8gICAgICkgLy8gU0NBTEUKICAgIC8vICAgICBuZXdfZGVwb3NpdF9hbW91bnQgPSBvbGRfZGVwb3NpdF9hbW91bnQgKyBhbW91bnQKICAgIC8vIAogICAgLy8gICAgIGlmIHVzZXIubGFzdF9wcmljZS5uYXRpdmUgPT0gMDoKICAgIC8vICAgICAgICAgb2xkX3ZhbHVlID0gKG9sZF9kZXBvc2l0X2Ftb3VudCAqIG5ld19tYXJrZXQucHJpY2UubmF0aXZlKSAvLyBTQ0FMRQogICAgLy8gICAgICAgICBuZXdfdmFsdWUgPSAobmV3X2RlcG9zaXRfYW1vdW50ICogbmV3X21hcmtldC5wcmljZS5uYXRpdmUpIC8vIFNDQUxFCiAgICAvLyAgICAgZWxzZToKICAgIC8vICAgICAgICAgb2xkX3ZhbHVlID0gKG9sZF9kZXBvc2l0X2Ftb3VudCAqIHVzZXIubGFzdF9wcmljZS5uYXRpdmUpIC8vIFNDQUxFCiAgICAvLyAgICAgICAgIG5ld192YWx1ZSA9IChuZXdfZGVwb3NpdF9hbW91bnQgKiBuZXdfbWFya2V0LnByaWNlLm5hdGl2ZSkgLy8gU0NBTEUKICAgIC8vIAogICAgLy8gICAgIHNlbGYuX3VwZGF0ZV9nbG9iYWxfY29sbGF0ZXJhbChUeG4uc2VuZGVyLCBtYXJrZXRfaWQsIG9sZF92YWx1ZSwgbmV3X3ZhbHVlKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiB3aXRoZHJhdyhzZWxmLCBtYXJrZXRfaWQ6IGFyYzQuVUludDY0LCBhbW91bnQ6IGFyYzQuVUludDI1NikgLT4gTm9uZToKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICBzZWxmLnN0b2tlbl9hcHBfaWQgIT0gbWFya2V0X2lkLm5hdGl2ZQogICAgLy8gICAgICksICJDYW5ub3QgZGVwb3NpdCBpbnRvIHN0b2tlbiBtYXJrZXQiCiAgICAvLyAgICAgZW5zdXJlX2J1ZGdldCg3MDAsIE9wVXBGZWVTb3VyY2UuR3JvdXBDcmVkaXQpCiAgICAvLyAgICAgc2VsZi5fd2l0aGRyYXcobWFya2V0X2lkLm5hdGl2ZSwgYW1vdW50Lm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfd2l0aGRyYXcoc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIGFtb3VudDogQmlnVUludCkgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLl92YWxpZGF0ZV9tYXJrZXRfb3BlcmF0aW9uKG1hcmtldF9pZCwgYW1vdW50LCBUcnVlKQogICAgLy8gCiAgICAvLyAgICAgbmV3X21hcmtldCA9IHNlbGYuX2FjY3J1ZV9pbnRlcmVzdChtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKFR4bi5zZW5kZXIsIG1hcmtldF9pZCkKICAgIC8vIAogICAgLy8gICAgIHNjYWxlZF9hbW91bnQgPSAoYW1vdW50ICogU0NBTEUpIC8vIG5ld19tYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICB1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgPj0gc2NhbGVkX2Ftb3VudAogICAgLy8gICAgICksICJJbnN1ZmZpY2llbnQgYmFsYW5jZSB0byB3aXRoZHJhdyB0aGlzIGFtb3VudCIKICAgIC8vICAgICB1bmRlcmx5aW5nX2Ftb3VudCA9IChzY2FsZWRfYW1vdW50ICogbmV3X21hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZSkgLy8gU0NBTEUKICAgIC8vIAogICAgLy8gICAgIGdsb2JhbF91c2VyID0gc2VsZi5fZ2V0X2dsb2JhbF91c2VyKFR4bi5zZW5kZXIpCiAgICAvLyAgICAgd2l0aGRyYXdfdmFsdWUgPSAoCiAgICAvLyAgICAgICAgIHVuZGVybHlpbmdfYW1vdW50ICogbmV3X21hcmtldC5wcmljZS5uYXRpdmUKICAgIC8vICAgICApIC8vIFNDQUxFICAjIFVzZSB1bmRlcmx5aW5nX2Ftb3VudCBhbmQgbmV3X21hcmtldCBwcmljZQogICAgLy8gCiAgICAvLyAgICAgaWYgZ2xvYmFsX3VzZXIudG90YWxfYm9ycm93X3ZhbHVlID4gMDoKICAgIC8vICAgICAgICAgcmVtYWluaW5nX2NvbGxhdGVyYWwgPSAoCiAgICAvLyAgICAgICAgICAgICBnbG9iYWxfdXNlci50b3RhbF9jb2xsYXRlcmFsX3ZhbHVlLm5hdGl2ZSAtIHdpdGhkcmF3X3ZhbHVlCiAgICAvLyAgICAgICAgICkKICAgIC8vICAgICAgICAgYXNzZXJ0IGdsb2JhbF91c2VyLnRvdGFsX2JvcnJvd192YWx1ZS5uYXRpdmUgPD0gKAogICAgLy8gICAgICAgICAgICAgcmVtYWluaW5nX2NvbGxhdGVyYWwgKiBCaWdVSW50KG5ld19tYXJrZXQuY29sbGF0ZXJhbF9mYWN0b3IubmF0aXZlKQogICAgLy8gICAgICAgICApIC8vIEJpZ1VJbnQoMTAwMDApLCAiV2l0aGRyYXdhbCB3b3VsZCBwdXQgYm9ycm93cyBhdCByaXNrIgogICAgLy8gCiAgICAvLyAgICAgc2VsZi5fZGVjcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9kZXBvc2l0cygKICAgIC8vICAgICAgICAgbWFya2V0X2lkLCBUeG4uc2VuZGVyLCBzY2FsZWRfYW1vdW50CiAgICAvLyAgICAgKQogICAgLy8gICAgIHNlbGYuX2RlY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2RlcG9zaXRzKG1hcmtldF9pZCwgc2NhbGVkX2Ftb3VudCkKICAgIC8vIAogICAgLy8gICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIE5Ub2tlbi5idXJuX2Zyb20sCiAgICAvLyAgICAgICAgIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIC8vICAgICAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgICAgIGFwcF9pZD1BcHBsaWNhdGlvbihuZXdfbWFya2V0Lm50b2tlbl9pZC5uYXRpdmUpLAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIEFSQzIwMFRva2VuSW50ZXJmYWNlLmFyYzIwMF90cmFuc2ZlciwKICAgIC8vICAgICAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgICAgICBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgICAgICB1bmRlcmx5aW5nX2Ftb3VudAogICAgLy8gICAgICAgICApLCAgIyBVc2UgdW5kZXJseWluZ19hbW91bnQgd2hpY2ggaW5jbHVkZXMgaW50ZXJlc3QKICAgIC8vICAgICAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldF9pZCksICAjIFRyYW5zZmVyIGZyb20gdW5kZXJseWluZyB0b2tlbiBjb250cmFjdAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gICAgIG9sZF9kZXBvc2l0X2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgdXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlICogbmV3X21hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZQogICAgLy8gICAgICkgLy8gU0NBTEUKICAgIC8vICAgICBuZXdfZGVwb3NpdF9hbW91bnQgPSBvbGRfZGVwb3NpdF9hbW91bnQgLSB1bmRlcmx5aW5nX2Ftb3VudAogICAgLy8gCiAgICAvLyAgICAgIyBVc2UgY3VycmVudCBtYXJrZXQgcHJpY2UgaWYgdXNlciBkb2Vzbid0IGhhdmUgYSBwcmV2aW91cyBwcmljZQogICAgLy8gICAgIHByaWNlX2Zvcl9vbGQgPSAoCiAgICAvLyAgICAgICAgIHVzZXIubGFzdF9wcmljZS5uYXRpdmUKICAgIC8vICAgICAgICAgaWYgdXNlci5sYXN0X3ByaWNlLm5hdGl2ZSA+IDAKICAgIC8vICAgICAgICAgZWxzZSBuZXdfbWFya2V0LnByaWNlLm5hdGl2ZQogICAgLy8gICAgICkKICAgIC8vICAgICBwcmljZV9mb3JfbmV3ID0gbmV3X21hcmtldC5wcmljZS5uYXRpdmUKICAgIC8vIAogICAgLy8gICAgIG9sZF92YWx1ZSA9ICgKICAgIC8vICAgICAgICAgb2xkX2RlcG9zaXRfYW1vdW50ICogcHJpY2VfZm9yX29sZAogICAgLy8gICAgICkgLy8gU0NBTEUgICMgVXNlIHVzZXIncyBsYXN0IGtub3duIHByaWNlIG9yIGN1cnJlbnQgcHJpY2UKICAgIC8vICAgICBuZXdfdmFsdWUgPSAoCiAgICAvLyAgICAgICAgIG5ld19kZXBvc2l0X2Ftb3VudCAqIHByaWNlX2Zvcl9uZXcKICAgIC8vICAgICApIC8vIFNDQUxFICAjIFVzZSBjdXJyZW50IG1hcmtldCBwcmljZQogICAgLy8gICAgIHNlbGYuX3VwZGF0ZV9nbG9iYWxfY29sbGF0ZXJhbCgKICAgIC8vICAgICAgICAgVHhuLnNlbmRlciwKICAgIC8vICAgICAgICAgbWFya2V0X2lkLAogICAgLy8gICAgICAgICBvbGRfdmFsdWUsICAjIG9sZCBVU0QgdmFsdWUKICAgIC8vICAgICAgICAgbmV3X3ZhbHVlLCAgIyBuZXcgVVNEIHZhbHVlCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyAjIHdpdGhkcmF3IGNvc3QgOTAwMDAwCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGJvcnJvdyhzZWxmLCBtYXJrZXRfaWQ6IGFyYzQuVUludDY0LCBhbW91bnQ6IGFyYzQuVUludDI1NikgLT4gTm9uZToKICAgIC8vICAgICBlbnN1cmVfYnVkZ2V0KDE0MDAsIE9wVXBGZWVTb3VyY2UuR3JvdXBDcmVkaXQpCiAgICAvLyAgICAgc2VsZi5fYm9ycm93KG1hcmtldF9pZC5uYXRpdmUsIGFtb3VudC5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2JvcnJvdyhzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX3ZhbGlkYXRlX21hcmtldF9vcGVyYXRpb24obWFya2V0X2lkLCBhbW91bnQsIEZhbHNlKQogICAgLy8gCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKFR4bi5zZW5kZXIsIG1hcmtldF9pZCkKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vIAogICAgLy8gICAgIHBheW1lbnQgPSByZXF1aXJlX3BheW1lbnQoVHhuLnNlbmRlcikKICAgIC8vICAgICBhc3NlcnQgcGF5bWVudCA+PSBVSW50NjQoMTAwMDAwKSwgIlBheW1lbnQgYW1vdW50IG11c3QgYmUgPj0gMC4xIgogICAgLy8gCiAgICAvLyAgICAgdG90YWxfYm9ycm93cyA9ICgKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAqIG1hcmtldC5ib3Jyb3dfaW5kZXgubmF0aXZlCiAgICAvLyAgICAgKSAvLyBTQ0FMRQogICAgLy8gICAgIGFzc2VydCBtYXJrZXQubWF4X3RvdGFsX2JvcnJvd3MubmF0aXZlID49IHRvdGFsX2JvcnJvd3MgKyBhbW91bnQsICJCb3Jyb3cgY2FwIgogICAgLy8gCiAgICAvLyAgICAgZ2xvYmFsX3VzZXIgPSBzZWxmLl9nZXRfZ2xvYmFsX3VzZXIoVHhuLnNlbmRlcikKICAgIC8vICAgICBuZXdfYm9ycm93X3ZhbHVlID0gKGFtb3VudCAqIG1hcmtldC5wcmljZS5uYXRpdmUpIC8vIFNDQUxFCiAgICAvLyAgICAgdG90YWxfYm9ycm93X3ZhbHVlID0gZ2xvYmFsX3VzZXIudG90YWxfYm9ycm93X3ZhbHVlLm5hdGl2ZSArIG5ld19ib3Jyb3dfdmFsdWUKICAgIC8vIAogICAgLy8gICAgIGFzc2VydCB0b3RhbF9ib3Jyb3dfdmFsdWUgPD0gKAogICAgLy8gICAgICAgICBnbG9iYWxfdXNlci50b3RhbF9jb2xsYXRlcmFsX3ZhbHVlLm5hdGl2ZQogICAgLy8gICAgICAgICAqIEJpZ1VJbnQobWFya2V0LmNvbGxhdGVyYWxfZmFjdG9yLm5hdGl2ZSkKICAgIC8vICAgICApIC8vIEJpZ1VJbnQoMTAwMDApLCAiSW5zdWZmaWNpZW50IGNvbGxhdGVyYWwgYWNyb3NzIG1hcmtldHMiCiAgICAvLyAKICAgIC8vICAgICBuZXdfbWFya2V0ID0gc2VsZi5fYWNjcnVlX2ludGVyZXN0KG1hcmtldF9pZCkKICAgIC8vICAgICBzY2FsZWRfYW1vdW50ID0gKGFtb3VudCAqIFNDQUxFKSAvLyBuZXdfbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUKICAgIC8vIAogICAgLy8gICAgIHNlbGYuX2luY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfYm9ycm93cyhtYXJrZXRfaWQsIFR4bi5zZW5kZXIsIHNjYWxlZF9hbW91bnQpCiAgICAvLyAgICAgc2VsZi5faW5jcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfYm9ycm93cyhtYXJrZXRfaWQsIHNjYWxlZF9hbW91bnQpCiAgICAvLyAKICAgIC8vICAgICBvbGRfYm9ycm93X2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgdXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgKiBtYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZSAvLyBTQ0FMRQogICAgLy8gICAgICkKICAgIC8vICAgICBuZXdfYm9ycm93X2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgKHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlICsgc2NhbGVkX2Ftb3VudCkKICAgIC8vICAgICAgICAgKiBuZXdfbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUKICAgIC8vICAgICAgICAgLy8gU0NBTEUKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vICAgICAjIFVzZSBjdXJyZW50IG1hcmtldCBwcmljZSBpZiB1c2VyIGRvZXNuJ3QgaGF2ZSBhIHByZXZpb3VzIHByaWNlCiAgICAvLyAgICAgcHJpY2VfZm9yX29sZCA9ICgKICAgIC8vICAgICAgICAgdXNlci5sYXN0X3ByaWNlLm5hdGl2ZQogICAgLy8gICAgICAgICBpZiB1c2VyLmxhc3RfcHJpY2UubmF0aXZlID4gMAogICAgLy8gICAgICAgICBlbHNlIG1hcmtldC5wcmljZS5uYXRpdmUKICAgIC8vICAgICApCiAgICAvLyAgICAgcHJpY2VfZm9yX25ldyA9IG5ld19tYXJrZXQucHJpY2UubmF0aXZlCiAgICAvLyAKICAgIC8vICAgICBvbGRfdmFsdWUgPSAob2xkX2JvcnJvd19hbW91bnQgKiBwcmljZV9mb3Jfb2xkKSAvLyBTQ0FMRQogICAgLy8gICAgIG5ld192YWx1ZSA9IChuZXdfYm9ycm93X2Ftb3VudCAqIHByaWNlX2Zvcl9uZXcpIC8vIFNDQUxFCiAgICAvLyAgICAgc2VsZi5fdXBkYXRlX2dsb2JhbF9ib3Jyb3dzKAogICAgLy8gICAgICAgICBUeG4uc2VuZGVyLAogICAgLy8gICAgICAgICBtYXJrZXRfaWQsCiAgICAvLyAgICAgICAgIG9sZF92YWx1ZSwgICMgb2xkIFVTRCB2YWx1ZQogICAgLy8gICAgICAgICBuZXdfdmFsdWUsICAjIG5ldyBVU0QgdmFsdWUKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vICAgICAjIGlmIHN0b2tlbiwgbWludCBzdG9rZW4KICAgIC8vICAgICBpZiBtYXJrZXRfaWQgPT0gc2VsZi5zdG9rZW5fYXBwX2lkOgogICAgLy8gICAgICAgICBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgICAgICAgICAgU1Rva2VuLm1pbnQsCiAgICAvLyAgICAgICAgICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgICAgICAgICBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIC8vICAgICAgICAgICAgIGFwcF9pZD1BcHBsaWNhdGlvbihtYXJrZXRfaWQpLAogICAgLy8gICAgICAgICApCiAgICAvLyAgICAgICAgIGl0eG4uUGF5bWVudCgKICAgIC8vICAgICAgICAgICAgIHJlY2VpdmVyPUFwcGxpY2F0aW9uKG1hcmtldF9pZCkuYWRkcmVzcywgYW1vdW50PTEwMDAwMCwgZmVlPTAKICAgIC8vICAgICAgICAgKS5zdWJtaXQoKQogICAgLy8gICAgICMgaWYgYVRva2VuLCB0cmFuc2ZlciBhVG9rZW4KICAgIC8vICAgICBlbHNlOgogICAgLy8gICAgICAgICBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgICAgICAgICAgQVJDMjAwVG9rZW5JbnRlcmZhY2UuYXJjMjAwX3RyYW5zZmVyLAogICAgLy8gICAgICAgICAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgICAgICAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgICAgICAgICBhcHBfaWQ9QXBwbGljYXRpb24obWFya2V0X2lkKSwKICAgIC8vICAgICAgICAgKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBnZXRfc2NhbGVkX3JlcGF5X2Ftb3VudCgKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IGFyYzQuVUludDY0LCBhbW91bnQ6IGFyYzQuVUludDI1NgogICAgLy8gKSAtPiBhcmM0LlVJbnQyNTY6CiAgICAvLyAgICAgcmV0dXJuIGFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgc2VsZi5fZ2V0X3NjYWxlZF9yZXBheV9hbW91bnQobWFya2V0X2lkLm5hdGl2ZSwgYW1vdW50Lm5hdGl2ZSkKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2dldF9zY2FsZWRfcmVwYXlfYW1vdW50KHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQpIC0+IEJpZ1VJbnQ6CiAgICAvLyAgICAgbmV3X21hcmtldCA9IHNlbGYuX2FjY3J1ZV9pbnRlcmVzdChtYXJrZXRfaWQpCiAgICAvLyAgICAgcmV0dXJuIChhbW91bnQgKiBTQ0FMRSkgLy8gbmV3X21hcmtldC5ib3Jyb3dfaW5kZXgubmF0aXZlCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIHJlcGF5KHNlbGYsIG1hcmtldF9pZDogYXJjNC5VSW50NjQsIGFtb3VudDogYXJjNC5VSW50MjU2KSAtPiBOb25lOgogICAgLy8gICAgIGVuc3VyZV9idWRnZXQoMTQwMCwgT3BVcEZlZVNvdXJjZS5Hcm91cENyZWRpdCkKICAgIC8vICAgICBzZWxmLl9yZXBheShtYXJrZXRfaWQubmF0aXZlLCBhbW91bnQubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9yZXBheShzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX3ZhbGlkYXRlX21hcmtldF9vcGVyYXRpb24obWFya2V0X2lkLCBhbW91bnQsIEZhbHNlKQogICAgLy8gCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKFR4bi5zZW5kZXIsIG1hcmtldF9pZCkKICAgIC8vICAgICBuZXdfbWFya2V0ID0gc2VsZi5fYWNjcnVlX2ludGVyZXN0KG1hcmtldF9pZCkKICAgIC8vIAogICAgLy8gICAgIHNjYWxlZF9hbW91bnQgPSAoYW1vdW50ICogU0NBTEUpIC8vIG5ld19tYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZQogICAgLy8gICAgIGFzc2VydCB1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSA+PSBzY2FsZWRfYW1vdW50LCAiUmVwYXkgYW1vdW50IGV4Y2VlZHMgZGVidCIKICAgIC8vIAogICAgLy8gICAgIGlmIG1hcmtldF9pZCA9PSBzZWxmLnN0b2tlbl9hcHBfaWQ6CiAgICAvLyAgICAgICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgICAgICBTVG9rZW4uYnVybl9mcm9tLAogICAgLy8gICAgICAgICAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgICAgICAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgICAgICAgICBhcHBfaWQ9QXBwbGljYXRpb24obWFya2V0X2lkKSwKICAgIC8vICAgICAgICAgKQogICAgLy8gICAgIGVsc2U6CiAgICAvLyAgICAgICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgICAgICBBUkMyMDBUb2tlbkludGVyZmFjZS5hcmMyMDBfdHJhbnNmZXJGcm9tLAogICAgLy8gICAgICAgICAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgICAgICAgICAgYXJjNC5BZGRyZXNzKEdsb2JhbC5jdXJyZW50X2FwcGxpY2F0aW9uX2FkZHJlc3MpLAogICAgLy8gICAgICAgICAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgICAgICAgICBhcHBfaWQ9QXBwbGljYXRpb24obWFya2V0X2lkKSwKICAgIC8vICAgICAgICAgKQogICAgLy8gCiAgICAvLyAgICAgc2VsZi5fZGVjcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9ib3Jyb3dzKG1hcmtldF9pZCwgVHhuLnNlbmRlciwgc2NhbGVkX2Ftb3VudCkKICAgIC8vICAgICBzZWxmLl9kZWNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9ib3Jyb3dzKG1hcmtldF9pZCwgc2NhbGVkX2Ftb3VudCkKICAgIC8vIAogICAgLy8gICAgIG9sZF9ib3Jyb3dfYW1vdW50ID0gKAogICAgLy8gICAgICAgICB1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAqIG5ld19tYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZSAvLyBTQ0FMRQogICAgLy8gICAgICkKICAgIC8vICAgICBuZXdfYm9ycm93X2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgKHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlIC0gc2NhbGVkX2Ftb3VudCkKICAgIC8vICAgICAgICAgKiBuZXdfbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUKICAgIC8vICAgICAgICAgLy8gU0NBTEUKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vICAgICAjIFVzZSBjdXJyZW50IG1hcmtldCBwcmljZSBpZiB1c2VyIGRvZXNuJ3QgaGF2ZSBhIHByZXZpb3VzIHByaWNlCiAgICAvLyAgICAgcHJpY2VfZm9yX29sZCA9ICgKICAgIC8vICAgICAgICAgdXNlci5sYXN0X3ByaWNlLm5hdGl2ZQogICAgLy8gICAgICAgICBpZiB1c2VyLmxhc3RfcHJpY2UubmF0aXZlID4gMAogICAgLy8gICAgICAgICBlbHNlIG5ld19tYXJrZXQucHJpY2UubmF0aXZlCiAgICAvLyAgICAgKQogICAgLy8gICAgIHByaWNlX2Zvcl9uZXcgPSBuZXdfbWFya2V0LnByaWNlLm5hdGl2ZQogICAgLy8gCiAgICAvLyAgICAgb2xkX3ZhbHVlID0gKG9sZF9ib3Jyb3dfYW1vdW50ICogcHJpY2VfZm9yX29sZCkgLy8gU0NBTEUKICAgIC8vICAgICBuZXdfdmFsdWUgPSAobmV3X2JvcnJvd19hbW91bnQgKiBwcmljZV9mb3JfbmV3KSAvLyBTQ0FMRQogICAgLy8gICAgIHNlbGYuX3VwZGF0ZV9nbG9iYWxfYm9ycm93cygKICAgIC8vICAgICAgICAgVHhuLnNlbmRlciwKICAgIC8vICAgICAgICAgbWFya2V0X2lkLAogICAgLy8gICAgICAgICBvbGRfdmFsdWUsICAjIG9sZCBVU0QgdmFsdWUKICAgIC8vICAgICAgICAgbmV3X3ZhbHVlLCAgIyBuZXcgVVNEIHZhbHVlCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiByZWRlZW0oc2VsZiwgbWFya2V0X2lkOiBhcmM0LlVJbnQ2NCwgYW1vdW50OiBhcmM0LlVJbnQyNTYpIC0+IE5vbmU6CiAgICAvLyAgICAgZW5zdXJlX2J1ZGdldCgxNDAwLCBPcFVwRmVlU291cmNlLkdyb3VwQ3JlZGl0KQogICAgLy8gICAgIHNlbGYuX3JlZGVlbShtYXJrZXRfaWQubmF0aXZlLCBhbW91bnQubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9yZWRlZW0oc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIGFtb3VudDogQmlnVUludCkgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLl92YWxpZGF0ZV9tYXJrZXRfb3BlcmF0aW9uKG1hcmtldF9pZCwgYW1vdW50LCBUcnVlKQogICAgLy8gCiAgICAvLyAgICAgYXNzZXJ0IG5vdCBzZWxmLl9oYXNfcG9zaXRpb24oCiAgICAvLyAgICAgICAgIFR4bi5zZW5kZXIsIG1hcmtldF9pZAogICAgLy8gICAgICksICJDYW5ub3QgbWludC9yZWRlZW0gd2hlbiB1c2VyIGhhcyB0cmFja2VkIGRlcG9zaXQgcG9zaXRpb24iCiAgICAvLyAKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9hY2NydWVfaW50ZXJlc3QobWFya2V0X2lkKQogICAgLy8gCiAgICAvLyAgICAgYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICAgICAgTlRva2VuLmJ1cm5fZnJvbSwKICAgIC8vICAgICAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgICAgICBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIC8vICAgICAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldC5udG9rZW5faWQubmF0aXZlKSwKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vICAgICBzY2FsZWRfYW1vdW50ID0gKGFtb3VudCAqIFNDQUxFKSAvLyBtYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSA+PSBzY2FsZWRfYW1vdW50CiAgICAvLyAgICAgKSwgIkluc3VmZmljaWVudCBtYXJrZXQgZGVwb3NpdHMgdG8gcmVkZWVtIgogICAgLy8gICAgIHNlbGYuX2RlY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2RlcG9zaXRzKG1hcmtldF9pZCwgc2NhbGVkX2Ftb3VudCkKICAgIC8vIAogICAgLy8gICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIEFSQzIwMFRva2VuSW50ZXJmYWNlLmFyYzIwMF90cmFuc2ZlciwKICAgIC8vICAgICAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgICAgICBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIC8vICAgICAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldF9pZCksCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBtaW50KHNlbGYsIG1hcmtldF9pZDogYXJjNC5VSW50NjQsIGFtb3VudDogYXJjNC5VSW50MjU2KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX21pbnQobWFya2V0X2lkLm5hdGl2ZSwgYW1vdW50Lm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfbWludChzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX3ZhbGlkYXRlX21hcmtldF9vcGVyYXRpb24obWFya2V0X2lkLCBhbW91bnQsIFRydWUpCiAgICAvLyAKICAgIC8vICAgICBhc3NlcnQgbm90IHNlbGYuX2hhc19wb3NpdGlvbigKICAgIC8vICAgICAgICAgVHhuLnNlbmRlciwgbWFya2V0X2lkCiAgICAvLyAgICAgKSwgIkNhbm5vdCBtaW50L3JlZGVlbSB3aGVuIHVzZXIgaGFzIHRyYWNrZWQgZGVwb3NpdCBwb3NpdGlvbiIKICAgIC8vIAogICAgLy8gICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIEFSQzIwMFRva2VuSW50ZXJmYWNlLmFyYzIwMF90cmFuc2ZlckZyb20sCiAgICAvLyAgICAgICAgIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIC8vICAgICAgICAgYXJjNC5BZGRyZXNzKEdsb2JhbC5jdXJyZW50X2FwcGxpY2F0aW9uX2FkZHJlc3MpLAogICAgLy8gICAgICAgICBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIC8vICAgICAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldF9pZCksCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyAgICAgbmV3X21hcmtldCA9IHNlbGYuX2FjY3J1ZV9pbnRlcmVzdCgKICAgIC8vICAgICAgICAgbWFya2V0X2lkCiAgICAvLyAgICAgKSAgIyBHZXQgdXBkYXRlZCBtYXJrZXQgd2l0aCBhY2NydWVkIGludGVyZXN0CiAgICAvLyAgICAgc2NhbGVkX2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgYW1vdW50ICogU0NBTEUKICAgIC8vICAgICApIC8vIG5ld19tYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUgICMgQ2FsY3VsYXRlIHdpdGggbmV3IGluZGV4CiAgICAvLyAKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICBuZXdfbWFya2V0Lm1heF90b3RhbF9kZXBvc2l0cy5uYXRpdmUKICAgIC8vICAgICAgICAgPj0gbmV3X21hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlICsgc2NhbGVkX2Ftb3VudAogICAgLy8gICAgICksICJEZXBvc2l0IGNhcCBleGNlZWRlZCIKICAgIC8vIAogICAgLy8gICAgICMgT25seSBpbmNyZW1lbnQgbWFya2V0IHRvdGFsIGRlcG9zaXRzLCBub3QgdXNlciBkZXBvc2l0cyBzaW5jZSBwb3NpdGlvbiBpcyBub3QgdHJhY2tlZAogICAgLy8gICAgIHNlbGYuX2luY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2RlcG9zaXRzKG1hcmtldF9pZCwgc2NhbGVkX2Ftb3VudCkKICAgIC8vIAogICAgLy8gICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIE5Ub2tlbi5taW50LAogICAgLy8gICAgICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgICAgIGFyYzQuVUludDI1NihhbW91bnQpLAogICAgLy8gICAgICAgICBhcHBfaWQ9QXBwbGljYXRpb24obmV3X21hcmtldC5udG9rZW5faWQubmF0aXZlKSwKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vICAgICBhcmM0LmVtaXQoCiAgICAvLyAgICAgICAgIE1pbnRFdmVudCgKICAgIC8vICAgICAgICAgICAgIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwgYXJjNC5VSW50MjU2KGFtb3VudCksIGFyYzQuVUludDY0KG1hcmtldF9pZCkKICAgIC8vICAgICAgICAgKQogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgc3luY191c2VyX21hcmtldF9mb3JfcHJpY2VfY2hhbmdlKAogICAgLy8gICAgIHNlbGYsIHVzZXJfaWQ6IGFyYzQuQWRkcmVzcywgbWFya2V0X2lkOiBhcmM0LlVJbnQ2NAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIGVuc3VyZV9idWRnZXQoMTQwMCwgT3BVcEZlZVNvdXJjZS5Hcm91cENyZWRpdCkKICAgIC8vICAgICBzZWxmLl91cGRhdGVfdXNlcl9nbG9iYWxfdmFsdWVzX2Zvcl9wcmljZV9jaGFuZ2UoCiAgICAvLyAgICAgICAgIHVzZXJfaWQubmF0aXZlLCBtYXJrZXRfaWQubmF0aXZlCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF91cGRhdGVfdXNlcl9nbG9iYWxfdmFsdWVzX2Zvcl9wcmljZV9jaGFuZ2UoCiAgICAvLyAgICAgc2VsZiwgdXNlcl9pZDogQWNjb3VudCwgbWFya2V0X2lkOiBVSW50NjQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vIAogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpLmNvcHkoKQogICAgLy8gICAgIGlmIHVzZXIuc2NhbGVkX2RlcG9zaXRzID09IDAgYW5kIHVzZXIuc2NhbGVkX2JvcnJvd3MgPT0gMDoKICAgIC8vICAgICAgICAgcmV0dXJuCiAgICAvLyAKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9hY2NydWVfaW50ZXJlc3QobWFya2V0X2lkKQogICAgLy8gCiAgICAvLyAgICAgaWYgdXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlID4gMDoKICAgIC8vICAgICAgICAgZGVwb3NpdF9hbW91bnQgPSAoCiAgICAvLyAgICAgICAgICAgICB1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKiBtYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUKICAgIC8vICAgICAgICAgKSAvLyBTQ0FMRQogICAgLy8gICAgICAgICAjIFVzZSBjdXJyZW50IG1hcmtldCBwcmljZSBpZiB1c2VyIGRvZXNuJ3QgaGF2ZSBhIHByZXZpb3VzIHByaWNlCiAgICAvLyAgICAgICAgIHByaWNlX2Zvcl9vbGQgPSAoCiAgICAvLyAgICAgICAgICAgICB1c2VyLmxhc3RfcHJpY2UubmF0aXZlCiAgICAvLyAgICAgICAgICAgICBpZiB1c2VyLmxhc3RfcHJpY2UubmF0aXZlID4gMAogICAgLy8gICAgICAgICAgICAgZWxzZSBtYXJrZXQucHJpY2UubmF0aXZlCiAgICAvLyAgICAgICAgICkKICAgIC8vICAgICAgICAgb2xkX2RlcG9zaXRfdmFsdWUgPSAoZGVwb3NpdF9hbW91bnQgKiBwcmljZV9mb3Jfb2xkKSAvLyBTQ0FMRQogICAgLy8gICAgICAgICBuZXdfZGVwb3NpdF92YWx1ZSA9IChkZXBvc2l0X2Ftb3VudCAqIG1hcmtldC5wcmljZS5uYXRpdmUpIC8vIFNDQUxFCiAgICAvLyAgICAgICAgIHNlbGYuX3VwZGF0ZV9nbG9iYWxfY29sbGF0ZXJhbCgKICAgIC8vICAgICAgICAgICAgIHVzZXJfaWQsIG1hcmtldF9pZCwgb2xkX2RlcG9zaXRfdmFsdWUsIG5ld19kZXBvc2l0X3ZhbHVlCiAgICAvLyAgICAgICAgICkKICAgIC8vIAogICAgLy8gICAgIGlmIHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlID4gMDoKICAgIC8vICAgICAgICAgYm9ycm93X2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgICAgIHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlICogbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUKICAgIC8vICAgICAgICAgKSAvLyBTQ0FMRQogICAgLy8gICAgICAgICAjIFVzZSBjdXJyZW50IG1hcmtldCBwcmljZSBpZiB1c2VyIGRvZXNuJ3QgaGF2ZSBhIHByZXZpb3VzIHByaWNlCiAgICAvLyAgICAgICAgIHByaWNlX2Zvcl9vbGQgPSAoCiAgICAvLyAgICAgICAgICAgICB1c2VyLmxhc3RfcHJpY2UubmF0aXZlCiAgICAvLyAgICAgICAgICAgICBpZiB1c2VyLmxhc3RfcHJpY2UubmF0aXZlID4gMAogICAgLy8gICAgICAgICAgICAgZWxzZSBtYXJrZXQucHJpY2UubmF0aXZlCiAgICAvLyAgICAgICAgICkKICAgIC8vICAgICAgICAgb2xkX2JvcnJvd192YWx1ZSA9IChib3Jyb3dfYW1vdW50ICogcHJpY2VfZm9yX29sZCkgLy8gU0NBTEUKICAgIC8vICAgICAgICAgbmV3X2JvcnJvd192YWx1ZSA9IChib3Jyb3dfYW1vdW50ICogbWFya2V0LnByaWNlLm5hdGl2ZSkgLy8gU0NBTEUKICAgIC8vICAgICAgICAgc2VsZi5fdXBkYXRlX2dsb2JhbF9ib3Jyb3dzKAogICAgLy8gICAgICAgICAgICAgdXNlcl9pZCwgbWFya2V0X2lkLCBvbGRfYm9ycm93X3ZhbHVlLCBuZXdfYm9ycm93X3ZhbHVlCiAgICAvLyAgICAgICAgICkKICAgIC8vIAogICAgLy8gICAgIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyLmxhc3RfcHJpY2UgPSBtYXJrZXQucHJpY2UKICAgIC8vICAgICBzZWxmLnVzZXJzW3VzZXJfa2V5XSA9IHVzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF9nbG9iYWxfdXNlcihzZWxmLCB1c2VyX2lkOiBhcmM0LkFkZHJlc3MpIC0+IEdsb2JhbFVzZXJEYXRhOgogICAgLy8gICAgIHJldHVybiBzZWxmLl9nZXRfZ2xvYmFsX3VzZXIodXNlcl9pZC5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF9nbG9iYWxfdXNlcl9jb2xsYXRlcmFsKHNlbGYsIHVzZXJfaWQ6IGFyYzQuQWRkcmVzcykgLT4gYXJjNC5VSW50MjU2OgogICAgLy8gICAgIHJldHVybiBzZWxmLl9nZXRfZ2xvYmFsX3VzZXIodXNlcl9pZC5uYXRpdmUpLnRvdGFsX2NvbGxhdGVyYWxfdmFsdWUKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X2dsb2JhbF91c2VyKHNlbGYsIHVzZXJfaWQ6IEFjY291bnQpIC0+IEdsb2JhbFVzZXJEYXRhOgogICAgLy8gCiAgICAvLyAgICAgcmV0dXJuIHNlbGYuZ2xvYmFsX3VzZXJzLmdldCgKICAgIC8vICAgICAgICAgdXNlcl9pZCwKICAgIC8vICAgICAgICAgZGVmYXVsdD1HbG9iYWxVc2VyRGF0YSgKICAgIC8vICAgICAgICAgICAgIHRvdGFsX2NvbGxhdGVyYWxfdmFsdWU9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgdG90YWxfYm9ycm93X3ZhbHVlPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGxhc3RfdXBkYXRlX3RpbWU9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICksCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF91cGRhdGVfZ2xvYmFsX2NvbGxhdGVyYWwoCiAgICAvLyAgICAgc2VsZiwKICAgIC8vICAgICB1c2VyX2lkOiBBY2NvdW50LAogICAgLy8gICAgIG1hcmtldF9pZDogVUludDY0LAogICAgLy8gICAgIG9sZF92YWx1ZTogQmlnVUludCwKICAgIC8vICAgICBuZXdfdmFsdWU6IEJpZ1VJbnQsCiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgZ2xvYmFsX3VzZXIgPSBzZWxmLl9nZXRfZ2xvYmFsX3VzZXIodXNlcl9pZCkKICAgIC8vIAogICAgLy8gICAgIGdsb2JhbF91c2VyLnRvdGFsX2NvbGxhdGVyYWxfdmFsdWUgPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgIGdsb2JhbF91c2VyLnRvdGFsX2NvbGxhdGVyYWxfdmFsdWUubmF0aXZlIC0gb2xkX3ZhbHVlICsgbmV3X3ZhbHVlCiAgICAvLyAgICAgKQogICAgLy8gICAgIGdsb2JhbF91c2VyLmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vIAogICAgLy8gICAgIHNlbGYuZ2xvYmFsX3VzZXJzW3VzZXJfaWRdID0gZ2xvYmFsX3VzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3VwZGF0ZV9nbG9iYWxfYm9ycm93cygKICAgIC8vICAgICBzZWxmLAogICAgLy8gICAgIHVzZXJfaWQ6IEFjY291bnQsCiAgICAvLyAgICAgbWFya2V0X2lkOiBVSW50NjQsCiAgICAvLyAgICAgb2xkX3ZhbHVlOiBCaWdVSW50LAogICAgLy8gICAgIG5ld192YWx1ZTogQmlnVUludCwKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBnbG9iYWxfdXNlciA9IHNlbGYuX2dldF9nbG9iYWxfdXNlcih1c2VyX2lkKQogICAgLy8gCiAgICAvLyAgICAgZ2xvYmFsX3VzZXIudG90YWxfYm9ycm93X3ZhbHVlID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBnbG9iYWxfdXNlci50b3RhbF9ib3Jyb3dfdmFsdWUubmF0aXZlIC0gb2xkX3ZhbHVlICsgbmV3X3ZhbHVlCiAgICAvLyAgICAgKQogICAgLy8gICAgIGdsb2JhbF91c2VyLmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vIAogICAgLy8gICAgIHNlbGYuZ2xvYmFsX3VzZXJzW3VzZXJfaWRdID0gZ2xvYmFsX3VzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF9nbG9iYWxfdXNlcl9oZWFsdGgoCiAgICAvLyAgICAgc2VsZiwgdXNlcl9pZDogYXJjNC5BZGRyZXNzLCBsaXF1aWRhdGlvbl90aHJlc2hvbGQ6IGFyYzQuVUludDY0CiAgICAvLyApIC0+IGFyYzQuVUludDI1NjoKICAgIC8vICAgICByZXR1cm4gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBzZWxmLl9nZXRfZ2xvYmFsX3VzZXJfaGVhbHRoKHVzZXJfaWQubmF0aXZlLCBsaXF1aWRhdGlvbl90aHJlc2hvbGQubmF0aXZlKQogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X2dsb2JhbF91c2VyX2hlYWx0aCgKICAgIC8vICAgICBzZWxmLCB1c2VyX2lkOiBBY2NvdW50LCBsaXF1aWRhdGlvbl90aHJlc2hvbGQ6IFVJbnQ2NAogICAgLy8gKSAtPiBCaWdVSW50OgogICAgLy8gICAgIGdsb2JhbF91c2VyID0gc2VsZi5fZ2V0X2dsb2JhbF91c2VyKHVzZXJfaWQpCiAgICAvLyAKICAgIC8vICAgICBpZiBnbG9iYWxfdXNlci50b3RhbF9ib3Jyb3dfdmFsdWUubmF0aXZlID09IDA6CiAgICAvLyAgICAgICAgIHJldHVybiBCaWdVSW50KDApICAjIE5vIGRlYnQgPSBpbmZpbml0ZSBoZWFsdGgKICAgIC8vIAogICAgLy8gICAgIGhlYWx0aCA9ICgKICAgIC8vICAgICAgICAgZ2xvYmFsX3VzZXIudG90YWxfY29sbGF0ZXJhbF92YWx1ZS5uYXRpdmUKICAgIC8vICAgICAgICAgKiBCaWdVSW50KGxpcXVpZGF0aW9uX3RocmVzaG9sZCkKICAgIC8vICAgICAgICAgKiBCaWdVSW50KDEwMDAwKQogICAgLy8gICAgICkgLy8gKGdsb2JhbF91c2VyLnRvdGFsX2JvcnJvd192YWx1ZS5uYXRpdmUgKiBCaWdVSW50KDEwMDAwKSkKICAgIC8vICAgICByZXR1cm4gaGVhbHRoCiAgICAvLyAKICAgIC8vICMgUkVNIG5vIHNpbmdsZS1tYXJrZXQgbGlxdWlkYXRpb24sIGp1c3QgY3Jvc3MtbWFya2V0IGxpcXVpZGF0aW9uIHNpbmdsZSBtYXJrZXQKICAgIC8vIAogICAgLy8gIyBSRU0gY3Jvc3MtbWFya2V0IGxpcXVpZGF0aW9uCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGxpcXVpZGF0ZV9jcm9zc19tYXJrZXQoCiAgICAvLyAgICAgc2VsZiwKICAgIC8vICAgICBkZWJ0X21hcmtldF9pZDogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgY29sbGF0ZXJhbF9tYXJrZXRfaWQ6IGFyYzQuVUludDY0LAogICAgLy8gICAgIHVzZXI6IGFyYzQuQWRkcmVzcywKICAgIC8vICAgICBkZWJ0X2Ftb3VudDogYXJjNC5VSW50MjU2LAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIGVuc3VyZV9idWRnZXQoMjEwMCwgT3BVcEZlZVNvdXJjZS5Hcm91cENyZWRpdCkKICAgIC8vICAgICBhc3NlcnQgbm90IHNlbGYuX2lzX3BhdXNlZCgpLCAiUHJvdG9jb2wgaXMgcGF1c2VkIgogICAgLy8gICAgIHNlbGYuX2xpcXVpZGF0ZV9jcm9zc19tYXJrZXQoCiAgICAvLyAgICAgICAgIGRlYnRfbWFya2V0X2lkLm5hdGl2ZSwKICAgIC8vICAgICAgICAgY29sbGF0ZXJhbF9tYXJrZXRfaWQubmF0aXZlLAogICAgLy8gICAgICAgICB1c2VyLm5hdGl2ZSwKICAgIC8vICAgICAgICAgZGVidF9hbW91bnQubmF0aXZlLAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfbGlxdWlkYXRlX2Nyb3NzX21hcmtldCgKICAgIC8vICAgICBzZWxmLAogICAgLy8gICAgIGRlYnRfbWFya2V0X2lkOiBVSW50NjQsCiAgICAvLyAgICAgY29sbGF0ZXJhbF9tYXJrZXRfaWQ6IFVJbnQ2NCwKICAgIC8vICAgICB1c2VyX2lkOiBBY2NvdW50LAogICAgLy8gICAgIGRlYnRfYW1vdW50OiBCaWdVSW50LAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIGFzc2VydCBkZWJ0X21hcmtldF9pZCBpbiBzZWxmLm1hcmtldHMsICJEZWJ0IG1hcmtldCBkb2VzIG5vdCBleGlzdCIKICAgIHN3YXAKICAgIGNvbmNhdAogICAgYm94X2xlbgogICAgYnVyeSAxCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1MTAKICAgIC8vIGFzc2VydCBkZWJ0X21hcmtldF9pZCBpbiBzZWxmLm1hcmtldHMsICJEZWJ0IG1hcmtldCBkb2VzIG5vdCBleGlzdCIKICAgIGFzc2VydCAvLyBEZWJ0IG1hcmtldCBkb2VzIG5vdCBleGlzdAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1MTAtMTUxMQogICAgLy8gICAgIHNlbGYubWFya2V0cyA9IEJveE1hcChVSW50NjQsIE1hcmtldERhdGEpICAjIE1hcmtldCBzdGF0ZQogICAgLy8gICAgIHNlbGYudXNlcnMgPSBCb3hNYXAoQnl0ZXM0MCwgVXNlckRhdGEpICAjIFBlci1tYXJrZXQgdXNlciBzdGF0ZQogICAgLy8gICAgIHNlbGYuZ2xvYmFsX3VzZXJzID0gQm94TWFwKEFjY291bnQsIEdsb2JhbFVzZXJEYXRhKSAgIyBHbG9iYWwgdXNlciBzdGF0ZQogICAgLy8gCiAgICAvLyAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vICMgT3duYWJsZQogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX29ubHlfb3duZXIoc2VsZikgLT4gTm9uZToKICAgIC8vICAgICBhc3NlcnQgVHhuLnNlbmRlciA9PSBzZWxmLm93bmVyLCAib25seSB0aGUgb3duZXIgY2FuIGNhbGwgdGhpcyBmdW5jdGlvbiIKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kKHJlYWRvbmx5PVRydWUpCiAgICAvLyBkZWYgZ2V0X293bmVyKHNlbGYpIC0+IGFyYzQuQWRkcmVzczoKICAgIC8vICAgICByZXR1cm4gYXJjNC5BZGRyZXNzKHNlbGYub3duZXIpCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIHRyYW5zZmVyX293bmVyc2hpcChzZWxmLCBuZXdfb3duZXI6IGFyYzQuQWRkcmVzcykgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLl9vbmx5X293bmVyKCkKICAgIC8vICAgICBzZWxmLl90cmFuc2Zlcl9vd25lcnNoaXAobmV3X293bmVyLm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfdHJhbnNmZXJfb3duZXJzaGlwKHNlbGYsIG5ld19vd25lcjogQWNjb3VudCkgLT4gTm9uZToKICAgIC8vICAgICBwcmV2aW91c19vd25lciA9IHNlbGYub3duZXIKICAgIC8vICAgICBzZWxmLm93bmVyID0gbmV3X293bmVyCiAgICAvLyAgICAgYXJjNC5lbWl0KAogICAgLy8gICAgICAgICBPd25lcnNoaXBUcmFuc2ZlcnJlZChhcmM0LkFkZHJlc3MocHJldmlvdXNfb3duZXIpLCBhcmM0LkFkZHJlc3MobmV3X293bmVyKSkKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gCiAgICAvLyAjIFJFTSBoYXZpbmcgaXNzdWVzIHdpdGggdGhlIGluaGVyaXRhbmNlIGhlcmUKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgaXNfcGF1c2VkKHNlbGYpIC0+IGFyYzQuQm9vbDoKICAgIC8vICAgICByZXR1cm4gYXJjNC5Cb29sKHNlbGYuX2lzX3BhdXNlZCgpKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9pc19wYXVzZWQoc2VsZikgLT4gYm9vbDoKICAgIC8vICAgICByZXR1cm4gc2VsZi5wYXVzZWQgPT0gVUludDY0KDEpCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIHBhdXNlKHNlbGYsIHBhdXNlOiBhcmM0LlVJbnQ2NCkgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLl9vbmx5X293bmVyKCkKICAgIC8vICAgICBzZWxmLl9wYXVzZShwYXVzZS5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3BhdXNlKHNlbGYsIHBhdXNlOiBVSW50NjQpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5wYXVzZWQgPSBwYXVzZQogICAgLy8gCiAgICAvLyAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgZ2V0X3N0b2tlbl9hcHBfaWQoc2VsZikgLT4gYXJjNC5VSW50NjQ6CiAgICAvLyAgICAgcmV0dXJuIGFyYzQuVUludDY0KHNlbGYuX2dldF9zdG9rZW5fYXBwX2lkKCkpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2dldF9zdG9rZW5fYXBwX2lkKHNlbGYpIC0+IFVJbnQ2NDoKICAgIC8vICAgICByZXR1cm4gc2VsZi5zdG9rZW5fYXBwX2lkCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIHNldF9zdG9rZW5fYXBwX2lkKHNlbGYsIHN0b2tlbl9hcHBfaWQ6IGFyYzQuVUludDY0KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX29ubHlfb3duZXIoKQogICAgLy8gICAgIHNlbGYuc3Rva2VuX2FwcF9pZCA9IHN0b2tlbl9hcHBfaWQubmF0aXZlCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2dldF91c2VyX2tleShzZWxmLCB1c2VyX2lkOiBBY2NvdW50LCBtYXJrZXRfaWQ6IFVJbnQ2NCkgLT4gQnl0ZXM0MDoKICAgIC8vICAgICByZXR1cm4gQnl0ZXM0MC5mcm9tX2J5dGVzKAogICAgLy8gICAgICAgICBhcmM0LkFkZHJlc3ModXNlcl9pZCkuYnl0ZXMgKyBhcmM0LlVJbnQ2NChtYXJrZXRfaWQpLmJ5dGVzCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBnZXRfdXNlcihzZWxmLCB1c2VyX2lkOiBhcmM0LkFkZHJlc3MsIG1hcmtldF9pZDogYXJjNC5VSW50NjQpIC0+IFVzZXJEYXRhOgogICAgLy8gICAgIHJldHVybiBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLm5hdGl2ZSwgbWFya2V0X2lkLm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X3VzZXIoc2VsZiwgdXNlcl9pZDogQWNjb3VudCwgbWFya2V0X2lkOiBVSW50NjQpIC0+IFVzZXJEYXRhOgogICAgLy8gICAgIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICByZXR1cm4gc2VsZi51c2Vycy5nZXQoCiAgICAvLyAgICAgICAgIHVzZXJfa2V5LAogICAgLy8gICAgICAgICBkZWZhdWx0PVVzZXJEYXRhKAogICAgLy8gICAgICAgICAgICAgc2NhbGVkX2RlcG9zaXRzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIHNjYWxlZF9ib3Jyb3dzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGRlcG9zaXRfaW5kZXg9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgYm9ycm93X2luZGV4PWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGxhc3RfdXBkYXRlX3RpbWU9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICBsYXN0X3ByaWNlPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgKSwKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2hhc19wb3NpdGlvbihzZWxmLCB1c2VyX2lkOiBBY2NvdW50LCBtYXJrZXRfaWQ6IFVJbnQ2NCkgLT4gYm9vbDoKICAgIC8vICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHJldHVybiB1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgPiAwCiAgICAvLyAKICAgIC8vICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gCiAgICAvLyAjIFJFTSBjb25zaWRlciByZW1vdmluZyBhbmQgY2FsY3VsYXRpbmcgaW4gdGhlIGNsaWVudAogICAgLy8gIyBSRU0gdHJ5aW5nIHRvIGN1dCBiYWNrIG9uIGV4dHJhIHBhZ2VzCiAgICAvLyAKICAgIC8vICMgQGFyYzQuYWJpbWV0aG9kCiAgICAvLyAjIGRlZiBnZXRfdXNlcl9kZXBvc2l0X3VuZGVybHlpbmdfYW1vdW50KAogICAgLy8gIyAgICAgc2VsZiwgdXNlcl9pZDogYXJjNC5BZGRyZXNzLCBtYXJrZXRfaWQ6IGFyYzQuVUludDY0CiAgICAvLyAjICkgLT4gYXJjNC5VSW50MjU2OgogICAgLy8gIyAgICAgcmV0dXJuIGFyYzQuVUludDI1NigKICAgIC8vICMgICAgICAgICBzZWxmLl9nZXRfdXNlcl9kZXBvc2l0X3VuZGVybHlpbmdfYW1vdW50KHVzZXJfaWQubmF0aXZlLCBtYXJrZXRfaWQubmF0aXZlKQogICAgLy8gIyAgICAgKQogICAgLy8gCiAgICAvLyAjIEBzdWJyb3V0aW5lCiAgICAvLyAjIGRlZiBfZ2V0X3VzZXJfZGVwb3NpdF91bmRlcmx5aW5nX2Ftb3VudCgKICAgIC8vICMgICAgIHNlbGYsIHVzZXJfaWQ6IEFjY291bnQsIG1hcmtldF9pZDogVUludDY0CiAgICAvLyAjICkgLT4gQmlnVUludDoKICAgIC8vICMgICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAjICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkgICMgQWRkIHRoaXMgbGluZQogICAgLy8gIyAgICAgcmV0dXJuICh1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKiBtYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUpIC8vIFNDQUxFCiAgICAvLyAKICAgIC8vICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9pbmNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2RlcG9zaXRzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCB1c2VyX2lkOiBBY2NvdW50LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyLnNjYWxlZF9kZXBvc2l0cyA9IGFyYzQuVUludDI1Nih1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKyBhbW91bnQpCiAgICAvLyAgICAgdXNlci5kZXBvc2l0X2luZGV4ID0gbWFya2V0LmRlcG9zaXRfaW5kZXgKICAgIC8vICAgICB1c2VyLmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vICAgICB1c2VyLmxhc3RfcHJpY2UgPSBtYXJrZXQucHJpY2UgICMgVXBkYXRlIHVzZXIncyBsYXN0IGtub3duIHByaWNlCiAgICAvLyAgICAgc2VsZi51c2Vyc1t1c2VyX2tleV0gPSB1c2VyLmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9pbmNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2JvcnJvd3MoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIHVzZXJfaWQ6IEFjY291bnQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlcl9rZXkgPSBzZWxmLl9nZXRfdXNlcl9rZXkodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIuc2NhbGVkX2JvcnJvd3MgPSBhcmM0LlVJbnQyNTYodXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgKyBhbW91bnQpCiAgICAvLyAgICAgdXNlci5ib3Jyb3dfaW5kZXggPSBtYXJrZXQuYm9ycm93X2luZGV4CiAgICAvLyAgICAgdXNlci5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApCiAgICAvLyAgICAgdXNlci5sYXN0X3ByaWNlID0gbWFya2V0LnByaWNlICAjIFVwZGF0ZSB1c2VyJ3MgbGFzdCBrbm93biBwcmljZQogICAgLy8gICAgIHNlbGYudXNlcnNbdXNlcl9rZXldID0gdXNlci5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZGVjcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9kZXBvc2l0cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgdXNlcl9pZDogQWNjb3VudCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyX2tleSA9IHNlbGYuX2dldF91c2VyX2tleSh1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgYXNzZXJ0ICgKICAgIC8vICAgICAgICAgdXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlID49IGFtb3VudAogICAgLy8gICAgICksICJJbnN1ZmZpY2llbnQgYmFsYW5jZSB0byB3aXRoZHJhdyB0aGlzIGFtb3VudCIKICAgIC8vICAgICB1c2VyLnNjYWxlZF9kZXBvc2l0cyA9IGFyYzQuVUludDI1Nih1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgLSBhbW91bnQpCiAgICAvLyAgICAgdXNlci5kZXBvc2l0X2luZGV4ID0gbWFya2V0LmRlcG9zaXRfaW5kZXgKICAgIC8vICAgICB1c2VyLmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vICAgICB1c2VyLmxhc3RfcHJpY2UgPSBtYXJrZXQucHJpY2UgICMgVXBkYXRlIHVzZXIncyBsYXN0IGtub3duIHByaWNlCiAgICAvLyAgICAgc2VsZi51c2Vyc1t1c2VyX2tleV0gPSB1c2VyLmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9kZWNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2JvcnJvd3MoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIHVzZXJfaWQ6IEFjY291bnQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlcl9rZXkgPSBzZWxmLl9nZXRfdXNlcl9rZXkodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgIHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlID49IGFtb3VudAogICAgLy8gICAgICksICJJbnN1ZmZpY2llbnQgYmFsYW5jZSB0byByZXBheSB0aGlzIGFtb3VudCIKICAgIC8vICAgICB1c2VyLnNjYWxlZF9ib3Jyb3dzID0gYXJjNC5VSW50MjU2KHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlIC0gYW1vdW50KQogICAgLy8gICAgIHVzZXIuYm9ycm93X2luZGV4ID0gbWFya2V0LmJvcnJvd19pbmRleAogICAgLy8gICAgIHVzZXIubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gICAgIHVzZXIubGFzdF9wcmljZSA9IG1hcmtldC5wcmljZSAgIyBVcGRhdGUgdXNlcidzIGxhc3Qga25vd24gcHJpY2UKICAgIC8vICAgICBzZWxmLnVzZXJzW3VzZXJfa2V5XSA9IHVzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGNyZWF0ZV9tYXJrZXQoCiAgICAvLyAgICAgc2VsZiwKICAgIC8vICAgICB0b2tlbl9pZDogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgY29sbGF0ZXJhbF9mYWN0b3I6IGFyYzQuVUludDY0LAogICAgLy8gICAgIGxpcXVpZGF0aW9uX3RocmVzaG9sZDogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgcmVzZXJ2ZV9mYWN0b3I6IGFyYzQuVUludDY0LAogICAgLy8gICAgIGJvcnJvd19yYXRlOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBzbG9wZTogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgbWF4X3RvdGFsX2RlcG9zaXRzOiBhcmM0LlVJbnQyNTYsCiAgICAvLyAgICAgbWF4X3RvdGFsX2JvcnJvd3M6IGFyYzQuVUludDI1NiwKICAgIC8vICAgICBsaXF1aWRhdGlvbl9ib251czogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgY2xvc2VfZmFjdG9yOiBhcmM0LlVJbnQ2NCwKICAgIC8vICkgLT4gYXJjNC5VSW50NjQ6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgYXNzZXJ0IG5vdCBzZWxmLl9pc19wYXVzZWQoKSwgIlByb3RvY29sIGlzIHBhdXNlZCIKICAgIC8vICAgICByZXR1cm4gYXJjNC5VSW50NjQoCiAgICAvLyAgICAgICAgIHNlbGYuX2NyZWF0ZV9tYXJrZXQoCiAgICAvLyAgICAgICAgICAgICB0b2tlbl9pZC5uYXRpdmUsCiAgICAvLyAgICAgICAgICAgICBNYXJrZXREYXRhKAogICAgLy8gICAgICAgICAgICAgICAgIHBhdXNlZD1hcmM0LkJvb2woVHJ1ZSksICAjIFN0YXJ0IHBhdXNlZCB1bnRpbCBwcmljZSBpcyBzZXQKICAgIC8vICAgICAgICAgICAgICAgICBtYXhfdG90YWxfZGVwb3NpdHM9bWF4X3RvdGFsX2RlcG9zaXRzLAogICAgLy8gICAgICAgICAgICAgICAgIG1heF90b3RhbF9ib3Jyb3dzPW1heF90b3RhbF9ib3Jyb3dzLAogICAgLy8gICAgICAgICAgICAgICAgIGxpcXVpZGF0aW9uX2JvbnVzPWxpcXVpZGF0aW9uX2JvbnVzLAogICAgLy8gICAgICAgICAgICAgICAgIGNvbGxhdGVyYWxfZmFjdG9yPWNvbGxhdGVyYWxfZmFjdG9yLAogICAgLy8gICAgICAgICAgICAgICAgIGxpcXVpZGF0aW9uX3RocmVzaG9sZD1saXF1aWRhdGlvbl90aHJlc2hvbGQsCiAgICAvLyAgICAgICAgICAgICAgICAgcmVzZXJ2ZV9mYWN0b3I9cmVzZXJ2ZV9mYWN0b3IsCiAgICAvLyAgICAgICAgICAgICAgICAgYm9ycm93X3JhdGU9Ym9ycm93X3JhdGUsCiAgICAvLyAgICAgICAgICAgICAgICAgc2xvcGU9c2xvcGUsCiAgICAvLyAgICAgICAgICAgICAgICAgdG90YWxfc2NhbGVkX2RlcG9zaXRzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgICAgICB0b3RhbF9zY2FsZWRfYm9ycm93cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICAgICAgZGVwb3NpdF9pbmRleD1hcmM0LlVJbnQyNTYoU0NBTEUpLCAgIyBTdGFydCBhdCBTQ0FMRSAoMS4wKQogICAgLy8gICAgICAgICAgICAgICAgIGJvcnJvd19pbmRleD1hcmM0LlVJbnQyNTYoU0NBTEUpLCAgIyBTdGFydCBhdCBTQ0FMRSAoMS4wKQogICAgLy8gICAgICAgICAgICAgICAgIGxhc3RfdXBkYXRlX3RpbWU9YXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApLAogICAgLy8gICAgICAgICAgICAgICAgIHJlc2VydmVzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgICAgICBwcmljZT1hcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgICAgICAgICAgICAgIDAKICAgIC8vICAgICAgICAgICAgICAgICApLCAgIyBQcmljZSBtdXN0IGJlIHNldCBiZWZvcmUgbWFya2V0IGNhbiBiZSB1c2VkCiAgICAvLyAgICAgICAgICAgICAgICAgbnRva2VuX2lkPWFyYzQuVUludDY0KDApLCAgIyBXaWxsIGJlIHNldCBkdXJpbmcgdG9rZW4gaW5pdGlhbGl6YXRpb24KICAgIC8vICAgICAgICAgICAgICAgICBjbG9zZV9mYWN0b3I9Y2xvc2VfZmFjdG9yLAogICAgLy8gICAgICAgICAgICAgKSwKICAgIC8vICAgICAgICAgKQogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfY3JlYXRlX21hcmtldChzZWxmLCB0b2tlbl9pZDogVUludDY0LCBtYXJrZXRfZGF0YTogTWFya2V0RGF0YSkgLT4gVUludDY0OgogICAgLy8gICAgIGFzc2VydCBub3QgdG9rZW5faWQgaW4gc2VsZi5tYXJrZXRzLCAiTWFya2V0IGFscmVhZHkgZXhpc3RzIgogICAgLy8gICAgIHBheW1lbnQgPSByZXF1aXJlX3BheW1lbnQoVHhuLnNlbmRlcikKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICBwYXltZW50ID49IHNlbGYuX2NyZWF0ZV9tYXJrZXRfY29zdCgpCiAgICAvLyAgICAgKSwgImluc3VmZmljaWVudCBwYXltZW50IGZvciBjcmVhdGUgbWFya2V0IgogICAgLy8gICAgIGNvbXBpbGVkID0gY29tcGlsZV9jb250cmFjdChOVG9rZW4sIGV4dHJhX3Byb2dyYW1fcGFnZXM9MCkgICMgbm8gZXh0cmEgcGFnZXMKICAgIC8vICAgICBiYXNlX2FwcCA9IGFyYzQuYXJjNF9jcmVhdGUoTlRva2VuLCBjb21waWxlZD1jb21waWxlZCkuY3JlYXRlZF9hcHAKICAgIC8vICAgICBib290c3RyYXA2NF9jb3N0LCB0eG4xID0gYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICAgICAgTlRva2VuLmJvb3RzdHJhcDY0X2Nvc3QsCiAgICAvLyAgICAgICAgIGFwcF9pZD1iYXNlX2FwcCwKICAgIC8vICAgICApCiAgICAvLyAgICAgaXR4bi5QYXltZW50KAogICAgLy8gICAgICAgICByZWNlaXZlcj1iYXNlX2FwcC5hZGRyZXNzLCBhbW91bnQ9Ym9vdHN0cmFwNjRfY29zdC5uYXRpdmUsIGZlZT0wCiAgICAvLyAgICAgKS5zdWJtaXQoKQogICAgLy8gICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIE5Ub2tlbi5ib290c3RyYXA2NCwKICAgIC8vICAgICAgICAgYXJjNC5VSW50NjQodG9rZW5faWQpLAogICAgLy8gICAgICAgICBhcHBfaWQ9YmFzZV9hcHAsCiAgICAvLyAgICAgKQogICAgLy8gICAgIG1hcmtldF9kYXRhLm50b2tlbl9pZCA9IGFyYzQuVUludDY0KGJhc2VfYXBwLmlkKQogICAgLy8gICAgIHNlbGYubWFya2V0c1t0b2tlbl9pZF0gPSBtYXJrZXRfZGF0YS5jb3B5KCkKICAgIC8vICAgICBhcmM0LmVtaXQoCiAgICAvLyAgICAgICAgIE1hcmtldENyZWF0ZWQoYXJjNC5VSW50NjQodG9rZW5faWQpLCBhcmM0LlVJbnQ2NChiYXNlX2FwcC5pZCksIG1hcmtldF9kYXRhKQogICAgLy8gICAgICkKICAgIC8vICAgICByZXR1cm4gYmFzZV9hcHAuaWQKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kKHJlYWRvbmx5PVRydWUpCiAgICAvLyBkZWYgY3JlYXRlX21hcmtldF9jb3N0KHNlbGYpIC0+IGFyYzQuVUludDY0OgogICAgLy8gICAgIHJldHVybiBhcmM0LlVJbnQ2NChzZWxmLl9jcmVhdGVfbWFya2V0X2Nvc3QoKSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfY3JlYXRlX21hcmtldF9jb3N0KHNlbGYpIC0+IFVJbnQ2NDoKICAgIC8vICAgICByZXR1cm4gVUludDY0KDFfMDAwXzAwMCkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kKHJlYWRvbmx5PVRydWUpCiAgICAvLyBkZWYgZ2V0X21hcmtldChzZWxmLCB0b2tlbl9pZDogYXJjNC5VSW50NjQpIC0+IE1hcmtldERhdGE6CiAgICAvLyAgICAgcmV0dXJuIHNlbGYuX2dldF9tYXJrZXQodG9rZW5faWQubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9nZXRfbWFya2V0KHNlbGYsIHRva2VuX2lkOiBVSW50NjQpIC0+IE1hcmtldERhdGE6CiAgICAvLyAgICAgcmV0dXJuIHNlbGYubWFya2V0cy5nZXQoCiAgICAvLyAgICAgICAgIHRva2VuX2lkLAogICAgLy8gICAgICAgICBkZWZhdWx0PU1hcmtldERhdGEoCiAgICAvLyAgICAgICAgICAgICBwYXVzZWQ9YXJjNC5Cb29sKFRydWUpLAogICAgLy8gICAgICAgICAgICAgbWF4X3RvdGFsX2RlcG9zaXRzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIG1heF90b3RhbF9ib3Jyb3dzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGxpcXVpZGF0aW9uX2JvbnVzPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgY29sbGF0ZXJhbF9mYWN0b3I9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICBsaXF1aWRhdGlvbl90aHJlc2hvbGQ9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICByZXNlcnZlX2ZhY3Rvcj1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIGJvcnJvd19yYXRlPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgc2xvcGU9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICB0b3RhbF9zY2FsZWRfZGVwb3NpdHM9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgdG90YWxfc2NhbGVkX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgZGVwb3NpdF9pbmRleD1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBib3Jyb3dfaW5kZXg9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgbGFzdF91cGRhdGVfdGltZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIHJlc2VydmVzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIHByaWNlPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIG50b2tlbl9pZD1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIGNsb3NlX2ZhY3Rvcj1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgKSwKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF9tYXJrZXRfcHJpY2Uoc2VsZiwgdG9rZW5faWQ6IGFyYzQuVUludDY0KSAtPiBhcmM0LlVJbnQyNTY6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldCh0b2tlbl9pZC5uYXRpdmUpCiAgICAvLyAgICAgcmV0dXJuIG1hcmtldC5wcmljZQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBnZXRfbWFya2V0X250b2tlbl9pZChzZWxmLCB0b2tlbl9pZDogYXJjNC5VSW50NjQpIC0+IGFyYzQuVUludDY0OgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQodG9rZW5faWQubmF0aXZlKQogICAgLy8gICAgIHJldHVybiBtYXJrZXQubnRva2VuX2lkCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIHNldF9tYXJrZXRfcHJpY2Uoc2VsZiwgdG9rZW5faWQ6IGFyYzQuVUludDY0LCBwcmljZTogYXJjNC5VSW50MjU2KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX29ubHlfb3duZXIoKQogICAgLy8gICAgIGFzc2VydCBub3Qgc2VsZi5faXNfcGF1c2VkKCksICJQcm90b2NvbCBpcyBwYXVzZWQiCiAgICAvLyAgICAgc2VsZi5fc2V0X21hcmtldF9wcmljZSh0b2tlbl9pZC5uYXRpdmUsIHByaWNlLm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfc2V0X21hcmtldF9wcmljZShzZWxmLCB0b2tlbl9pZDogVUludDY0LCBwcmljZTogQmlnVUludCkgLT4gTm9uZToKICAgIC8vICAgICBhc3NlcnQgdG9rZW5faWQgaW4gc2VsZi5tYXJrZXRzLCAiTWFya2V0IGRvZXMgbm90IGV4aXN0IgogICAgLy8gICAgIGFzc2VydCBwcmljZSA+IDAsICJQcmljZSBtdXN0IGJlIHBvc2l0aXZlIgogICAgLy8gCiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5tYXJrZXRzW3Rva2VuX2lkXS5jb3B5KCkKICAgIC8vIAogICAgLy8gICAgICMgVW5wYXVzZSB0aGUgbWFya2V0IG9uIGZpcnN0IHByaWNlIHNldAogICAgLy8gICAgIGlmIG1hcmtldC5wYXVzZWQgYW5kIG1hcmtldC5wcmljZSA9PSAwOgogICAgLy8gICAgICAgICBtYXJrZXQucGF1c2VkID0gYXJjNC5Cb29sKEZhbHNlKQogICAgLy8gCiAgICAvLyAgICAgIyBTY2FsZSB0aGUgcHJpY2UgYnkgU0NBTEUgaW50ZXJuYWxseSBmb3Igc3RvcmFnZQogICAgLy8gICAgIG1hcmtldC5wcmljZSA9IGFyYzQuVUludDI1NihwcmljZSAqIFNDQUxFKQogICAgLy8gCiAgICAvLyAgICAgc2VsZi5tYXJrZXRzW3Rva2VuX2lkXSA9IG1hcmtldC5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaW5jcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfZGVwb3NpdHMoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMgPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlICsgYW1vdW50CiAgICAvLyAgICAgKQogICAgLy8gICAgIG1hcmtldC5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApCiAgICAvLyAgICAgc2VsZi5tYXJrZXRzW21hcmtldF9pZF0gPSBtYXJrZXQuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2RlY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2RlcG9zaXRzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSA+PSBhbW91bnQKICAgIC8vICAgICApLCAiSW5zdWZmaWNpZW50IGJhbGFuY2UgdG8gd2l0aGRyYXcgdGhpcyBhbW91bnQiCiAgICAvLyAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cyA9IGFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cy5uYXRpdmUgLSBhbW91bnQKICAgIC8vICAgICApCiAgICAvLyAgICAgc2VsZi5tYXJrZXRzW21hcmtldF9pZF0gPSBtYXJrZXQuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2luY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2JvcnJvd3MoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cyA9IGFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzLm5hdGl2ZSArIGFtb3VudAogICAgLy8gICAgICkKICAgIC8vICAgICBtYXJrZXQubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gICAgIHNlbGYubWFya2V0c1ttYXJrZXRfaWRdID0gbWFya2V0LmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9kZWNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9ib3Jyb3dzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlID49IGFtb3VudAogICAgLy8gICAgICksICJJbnN1ZmZpY2llbnQgYmFsYW5jZSB0byB3aXRoZHJhdyB0aGlzIGFtb3VudCIKICAgIC8vICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MgPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUgLSBhbW91bnQKICAgIC8vICAgICApCiAgICAvLyAgICAgc2VsZi5tYXJrZXRzW21hcmtldF9pZF0gPSBtYXJrZXQuY29weSgpCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIHBhdXNlX21hcmtldChzZWxmLCB0b2tlbl9pZDogYXJjNC5VSW50NjQsIHBhdXNlOiBhcmM0LlVJbnQ2NCkgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLl9vbmx5X293bmVyKCkKICAgIC8vICAgICBzZWxmLl9wYXVzZV9tYXJrZXQodG9rZW5faWQubmF0aXZlLCBwYXVzZS5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3BhdXNlX21hcmtldChzZWxmLCB0b2tlbl9pZDogVUludDY0LCBwYXVzZTogVUludDY0KSAtPiBOb25lOgogICAgLy8gICAgIGFzc2VydCB0b2tlbl9pZCBpbiBzZWxmLm1hcmtldHMsICJNYXJrZXQgZG9lcyBub3QgZXhpc3QiCiAgICAvLyAgICAgc2VsZi5tYXJrZXRzW3Rva2VuX2lkXS5wYXVzZWQgPSBhcmM0LkJvb2wocGF1c2UgPT0gVUludDY0KDEpKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9pc19tYXJrZXRfcGF1c2VkKHNlbGYsIHRva2VuX2lkOiBVSW50NjQpIC0+IGJvb2w6CiAgICAvLyAgICAgcmV0dXJuIHNlbGYuX2dldF9tYXJrZXQodG9rZW5faWQpLnBhdXNlZC5uYXRpdmUgPT0gVUludDY0KDEpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2FjY3J1ZV9pbnRlcmVzdChzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCkgLT4gTWFya2V0RGF0YToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICBpZiBtYXJrZXQucGF1c2VkOgogICAgLy8gICAgICAgICByZXR1cm4gbWFya2V0CiAgICAvLyAKICAgIC8vICAgICBjdXJyZW50X3RpbWUgPSBHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcAogICAgLy8gICAgIHRpbWVfZGVsdGEgPSBjdXJyZW50X3RpbWUgLSBtYXJrZXQubGFzdF91cGRhdGVfdGltZS5uYXRpdmUKICAgIC8vICAgICBpZiB0aW1lX2RlbHRhIDw9IDA6CiAgICAvLyAgICAgICAgIHJldHVybiBtYXJrZXQKICAgIC8vIAogICAgLy8gICAgICMgRm9yIHN0b2tlbiBtYXJrZXQgKGJvcnJvdy1vbmx5KSwgdXNlIGEgZml4ZWQgdXRpbGl6YXRpb24gcmF0ZSBzaW5jZSB0aGVyZSBhcmUgbm8gZGVwb3NpdHMKICAgIC8vICAgICBpZiBtYXJrZXRfaWQgPT0gc2VsZi5zdG9rZW5fYXBwX2lkOgogICAgLy8gICAgICAgICB1dGlsaXphdGlvbiA9IEJpZ1VJbnQoMTAwMDApICAjIDEwMCUgdXRpbGl6YXRpb24gZm9yIGJvcnJvdy1vbmx5IG1hcmtldAogICAgLy8gICAgIGVsaWYgbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cy5uYXRpdmUgPT0gMDoKICAgIC8vICAgICAgICAgcmV0dXJuIG1hcmtldAogICAgLy8gICAgIGVsc2U6CiAgICAvLyAgICAgICAgIHV0aWxpemF0aW9uID0gKAogICAgLy8gICAgICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAqIDEwMDAwCiAgICAvLyAgICAgICAgICkgLy8gbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cy5uYXRpdmUKICAgIC8vICAgICByYXRlID0gbWFya2V0LmJvcnJvd19yYXRlLm5hdGl2ZSArIChtYXJrZXQuc2xvcGUubmF0aXZlICogdXRpbGl6YXRpb24pIC8vIDEwMDAwCiAgICAvLyAgICAgaW50ZXJlc3QgPSAocmF0ZSAqIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUgKiB0aW1lX2RlbHRhKSAvLyAoCiAgICAvLyAgICAgICAgIHNlbGYuc2Vjb25kc19wZXJfeWVhciAqIDEwMDAwCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyAgICAgIyBTcGVjaWFsIGhhbmRsaW5nIGZvciBzdG9rZW4gbWFya2V0IC0gYWxsIGludGVyZXN0IGdvZXMgdG8gcmVzZXJ2ZXMKICAgIC8vICAgICBpZiBtYXJrZXRfaWQgPT0gc2VsZi5zdG9rZW5fYXBwX2lkOgogICAgLy8gICAgICAgICBwcm90b2NvbF9wb3J0aW9uID0gaW50ZXJlc3QKICAgIC8vICAgICAgICAgZGVwb3NpdG9yX3BvcnRpb24gPSBCaWdVSW50KDApCiAgICAvLyAgICAgZWxzZToKICAgIC8vICAgICAgICAgcHJvdG9jb2xfcG9ydGlvbiA9ICgKICAgIC8vICAgICAgICAgICAgIGludGVyZXN0ICogYXJjNC5VSW50MjU2LmZyb21fYnl0ZXMobWFya2V0LnJlc2VydmVfZmFjdG9yLmJ5dGVzKS5uYXRpdmUKICAgIC8vICAgICAgICAgKSAvLyAxMDAwMAogICAgLy8gICAgICAgICBpZiBwcm90b2NvbF9wb3J0aW9uID4gaW50ZXJlc3Q6CiAgICAvLyAgICAgICAgICAgICBwcm90b2NvbF9wb3J0aW9uID0gaW50ZXJlc3QKICAgIC8vICAgICAgICAgZGVwb3NpdG9yX3BvcnRpb24gPSBpbnRlcmVzdCAtIHByb3RvY29sX3BvcnRpb24KICAgIC8vIAogICAgLy8gICAgIGlmIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMgPiAwOgogICAgLy8gICAgICAgICBtYXJrZXQuZGVwb3NpdF9pbmRleCA9IGFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgICAgIG1hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZQogICAgLy8gICAgICAgICAgICAgKyAoZGVwb3NpdG9yX3BvcnRpb24gKiBTQ0FMRSkgLy8gbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cy5uYXRpdmUKICAgIC8vICAgICAgICAgKQogICAgLy8gICAgIGlmIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cyA+IDA6CiAgICAvLyAgICAgICAgIG1hcmtldC5ib3Jyb3dfaW5kZXggPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgICAgICBtYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZQogICAgLy8gICAgICAgICAgICAgKyAoaW50ZXJlc3QgKiBTQ0FMRSkgLy8gbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzLm5hdGl2ZQogICAgLy8gICAgICAgICApCiAgICAvLyAKICAgIC8vICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MgPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUgKyBpbnRlcmVzdAogICAgLy8gICAgICkKICAgIC8vICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSArIGRlcG9zaXRvcl9wb3J0aW9uCiAgICAvLyAgICAgKQogICAgLy8gICAgIG1hcmtldC5yZXNlcnZlcyA9IGFyYzQuVUludDI1NihtYXJrZXQucmVzZXJ2ZXMubmF0aXZlICsgcHJvdG9jb2xfcG9ydGlvbikKICAgIC8vICAgICBtYXJrZXQubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KGN1cnJlbnRfdGltZSkKICAgIC8vIAogICAgLy8gICAgIHNlbGYubWFya2V0c1ttYXJrZXRfaWRdID0gbWFya2V0LmNvcHkoKQogICAgLy8gICAgIHJldHVybiBtYXJrZXQuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3ZhbGlkYXRlX21hcmtldF9vcGVyYXRpb24oCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIGFtb3VudDogQmlnVUludCwgZ3VhcmRfc3Rva2VuOiBib29sCiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgYXNzZXJ0IG5vdCBzZWxmLl9pc19wYXVzZWQoKSwgIlByb3RvY29sIGlzIHBhdXNlZCIKICAgIC8vICAgICBhc3NlcnQgbWFya2V0X2lkIGluIHNlbGYubWFya2V0cywgIk1hcmtldCBkb2VzIG5vdCBleGlzdCIKICAgIC8vICAgICBhc3NlcnQgYW1vdW50ID4gMCwgIkFtb3VudCBtdXN0IGJlID4gMCIKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICBhc3NlcnQgbm90IG1hcmtldC5wYXVzZWQsICJNYXJrZXQgaXMgcGF1c2VkIgogICAgLy8gICAgIGlmIGd1YXJkX3N0b2tlbjoKICAgIC8vICAgICAgICAgYXNzZXJ0ICgKICAgIC8vICAgICAgICAgICAgIHNlbGYuc3Rva2VuX2FwcF9pZCAhPSBtYXJrZXRfaWQKICAgIC8vICAgICAgICAgKSwgIkNhbm5vdCB1c2Ugc3Rva2VuIG1hcmtldCBmb3IgdGhpcyBvcGVyYXRpb24iCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGRlcG9zaXQoc2VsZiwgbWFya2V0X2lkOiBhcmM0LlVJbnQ2NCwgYW1vdW50OiBhcmM0LlVJbnQyNTYpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fZGVwb3NpdChtYXJrZXRfaWQubmF0aXZlLCBhbW91bnQubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9kZXBvc2l0KHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fdmFsaWRhdGVfbWFya2V0X29wZXJhdGlvbihtYXJrZXRfaWQsIGFtb3VudCwgVHJ1ZSkKICAgIC8vIAogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIHNjYWxlZF9hbW91bnQgPSAoYW1vdW50ICogU0NBTEUpIC8vIG1hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZQogICAgLy8gICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgIG1hcmtldC5tYXhfdG90YWxfZGVwb3NpdHMubmF0aXZlCiAgICAvLyAgICAgICAgID49IG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlICsgc2NhbGVkX2Ftb3VudAogICAgLy8gICAgICksICJEZXBvc2l0IGNhcCBleGNlZWRlZCIKICAgIC8vIAogICAgLy8gICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIEFSQzIwMFRva2VuSW50ZXJmYWNlLmFyYzIwMF90cmFuc2ZlckZyb20sCiAgICAvLyAgICAgICAgIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIC8vICAgICAgICAgYXJjNC5BZGRyZXNzKEdsb2JhbC5jdXJyZW50X2FwcGxpY2F0aW9uX2FkZHJlc3MpLAogICAgLy8gICAgICAgICBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIC8vICAgICAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldF9pZCksCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKFR4bi5zZW5kZXIsIG1hcmtldF9pZCkKICAgIC8vICAgICBuZXdfbWFya2V0ID0gc2VsZi5fYWNjcnVlX2ludGVyZXN0KAogICAgLy8gICAgICAgICBtYXJrZXRfaWQKICAgIC8vICAgICApICAjIEdldCB1cGRhdGVkIG1hcmtldCB3aXRoIGFjY3J1ZWQgaW50ZXJlc3QKICAgIC8vICAgICBzY2FsZWRfYW1vdW50ID0gKAogICAgLy8gICAgICAgICBhbW91bnQgKiBTQ0FMRQogICAgLy8gICAgICkgLy8gbmV3X21hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZSAgIyBDYWxjdWxhdGUgd2l0aCBuZXcgaW5kZXgKICAgIC8vIAogICAgLy8gICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgIG5ld19tYXJrZXQubWF4X3RvdGFsX2RlcG9zaXRzLm5hdGl2ZQogICAgLy8gICAgICAgICA+PSBuZXdfbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKyBzY2FsZWRfYW1vdW50CiAgICAvLyAgICAgKSwgIkRlcG9zaXQgY2FwIGV4Y2VlZGVkIgogICAgLy8gCiAgICAvLyAgICAgc2VsZi5faW5jcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9kZXBvc2l0cygKICAgIC8vICAgICAgICAgbWFya2V0X2lkLCBUeG4uc2VuZGVyLCBzY2FsZWRfYW1vdW50CiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyAgICAgc2VsZi5faW5jcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfZGVwb3NpdHMobWFya2V0X2lkLCBzY2FsZWRfYW1vdW50KQogICAgLy8gCiAgICAvLyAgICAgYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICAgICAgTlRva2VuLm1pbnQsCiAgICAvLyAgICAgICAgIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIC8vICAgICAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgICAgIGFwcF9pZD1BcHBsaWNhdGlvbihtYXJrZXQubnRva2VuX2lkLm5hdGl2ZSksCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyAgICAgb2xkX2RlcG9zaXRfYW1vdW50ID0gKAogICAgLy8gICAgICAgICB1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKiBuZXdfbWFya2V0LmRlcG9zaXRfaW5kZXgubmF0aXZlCiAgICAvLyAgICAgKSAvLyBTQ0FMRQogICAgLy8gICAgIG5ld19kZXBvc2l0X2Ftb3VudCA9IG9sZF9kZXBvc2l0X2Ftb3VudCArIGFtb3VudAogICAgLy8gCiAgICAvLyAgICAgaWYgdXNlci5sYXN0X3ByaWNlLm5hdGl2ZSA9PSAwOgogICAgLy8gICAgICAgICBvbGRfdmFsdWUgPSAob2xkX2RlcG9zaXRfYW1vdW50ICogbmV3X21hcmtldC5wcmljZS5uYXRpdmUpIC8vIFNDQUxFCiAgICAvLyAgICAgICAgIG5ld192YWx1ZSA9IChuZXdfZGVwb3NpdF9hbW91bnQgKiBuZXdfbWFya2V0LnByaWNlLm5hdGl2ZSkgLy8gU0NBTEUKICAgIC8vICAgICBlbHNlOgogICAgLy8gICAgICAgICBvbGRfdmFsdWUgPSAob2xkX2RlcG9zaXRfYW1vdW50ICogdXNlci5sYXN0X3ByaWNlLm5hdGl2ZSkgLy8gU0NBTEUKICAgIC8vICAgICAgICAgbmV3X3ZhbHVlID0gKG5ld19kZXBvc2l0X2Ftb3VudCAqIG5ld19tYXJrZXQucHJpY2UubmF0aXZlKSAvLyBTQ0FMRQogICAgLy8gCiAgICAvLyAgICAgc2VsZi5fdXBkYXRlX2dsb2JhbF9jb2xsYXRlcmFsKFR4bi5zZW5kZXIsIG1hcmtldF9pZCwgb2xkX3ZhbHVlLCBuZXdfdmFsdWUpCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIHdpdGhkcmF3KHNlbGYsIG1hcmtldF9pZDogYXJjNC5VSW50NjQsIGFtb3VudDogYXJjNC5VSW50MjU2KSAtPiBOb25lOgogICAgLy8gICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgIHNlbGYuc3Rva2VuX2FwcF9pZCAhPSBtYXJrZXRfaWQubmF0aXZlCiAgICAvLyAgICAgKSwgIkNhbm5vdCBkZXBvc2l0IGludG8gc3Rva2VuIG1hcmtldCIKICAgIC8vICAgICBlbnN1cmVfYnVkZ2V0KDcwMCwgT3BVcEZlZVNvdXJjZS5Hcm91cENyZWRpdCkKICAgIC8vICAgICBzZWxmLl93aXRoZHJhdyhtYXJrZXRfaWQubmF0aXZlLCBhbW91bnQubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF93aXRoZHJhdyhzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX3ZhbGlkYXRlX21hcmtldF9vcGVyYXRpb24obWFya2V0X2lkLCBhbW91bnQsIFRydWUpCiAgICAvLyAKICAgIC8vICAgICBuZXdfbWFya2V0ID0gc2VsZi5fYWNjcnVlX2ludGVyZXN0KG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIoVHhuLnNlbmRlciwgbWFya2V0X2lkKQogICAgLy8gCiAgICAvLyAgICAgc2NhbGVkX2Ftb3VudCA9IChhbW91bnQgKiBTQ0FMRSkgLy8gbmV3X21hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZQogICAgLy8gICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgIHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSA+PSBzY2FsZWRfYW1vdW50CiAgICAvLyAgICAgKSwgIkluc3VmZmljaWVudCBiYWxhbmNlIHRvIHdpdGhkcmF3IHRoaXMgYW1vdW50IgogICAgLy8gICAgIHVuZGVybHlpbmdfYW1vdW50ID0gKHNjYWxlZF9hbW91bnQgKiBuZXdfbWFya2V0LmRlcG9zaXRfaW5kZXgubmF0aXZlKSAvLyBTQ0FMRQogICAgLy8gCiAgICAvLyAgICAgZ2xvYmFsX3VzZXIgPSBzZWxmLl9nZXRfZ2xvYmFsX3VzZXIoVHhuLnNlbmRlcikKICAgIC8vICAgICB3aXRoZHJhd192YWx1ZSA9ICgKICAgIC8vICAgICAgICAgdW5kZXJseWluZ19hbW91bnQgKiBuZXdfbWFya2V0LnByaWNlLm5hdGl2ZQogICAgLy8gICAgICkgLy8gU0NBTEUgICMgVXNlIHVuZGVybHlpbmdfYW1vdW50IGFuZCBuZXdfbWFya2V0IHByaWNlCiAgICAvLyAKICAgIC8vICAgICBpZiBnbG9iYWxfdXNlci50b3RhbF9ib3Jyb3dfdmFsdWUgPiAwOgogICAgLy8gICAgICAgICByZW1haW5pbmdfY29sbGF0ZXJhbCA9ICgKICAgIC8vICAgICAgICAgICAgIGdsb2JhbF91c2VyLnRvdGFsX2NvbGxhdGVyYWxfdmFsdWUubmF0aXZlIC0gd2l0aGRyYXdfdmFsdWUKICAgIC8vICAgICAgICAgKQogICAgLy8gICAgICAgICBhc3NlcnQgZ2xvYmFsX3VzZXIudG90YWxfYm9ycm93X3ZhbHVlLm5hdGl2ZSA8PSAoCiAgICAvLyAgICAgICAgICAgICByZW1haW5pbmdfY29sbGF0ZXJhbCAqIEJpZ1VJbnQobmV3X21hcmtldC5jb2xsYXRlcmFsX2ZhY3Rvci5uYXRpdmUpCiAgICAvLyAgICAgICAgICkgLy8gQmlnVUludCgxMDAwMCksICJXaXRoZHJhd2FsIHdvdWxkIHB1dCBib3Jyb3dzIGF0IHJpc2siCiAgICAvLyAKICAgIC8vICAgICBzZWxmLl9kZWNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2RlcG9zaXRzKAogICAgLy8gICAgICAgICBtYXJrZXRfaWQsIFR4bi5zZW5kZXIsIHNjYWxlZF9hbW91bnQKICAgIC8vICAgICApCiAgICAvLyAgICAgc2VsZi5fZGVjcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfZGVwb3NpdHMobWFya2V0X2lkLCBzY2FsZWRfYW1vdW50KQogICAgLy8gCiAgICAvLyAgICAgYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICAgICAgTlRva2VuLmJ1cm5fZnJvbSwKICAgIC8vICAgICAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgICAgICBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIC8vICAgICAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG5ld19tYXJrZXQubnRva2VuX2lkLm5hdGl2ZSksCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyAgICAgYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICAgICAgQVJDMjAwVG9rZW5JbnRlcmZhY2UuYXJjMjAwX3RyYW5zZmVyLAogICAgLy8gICAgICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgICAgIGFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgICAgIHVuZGVybHlpbmdfYW1vdW50CiAgICAvLyAgICAgICAgICksICAjIFVzZSB1bmRlcmx5aW5nX2Ftb3VudCB3aGljaCBpbmNsdWRlcyBpbnRlcmVzdAogICAgLy8gICAgICAgICBhcHBfaWQ9QXBwbGljYXRpb24obWFya2V0X2lkKSwgICMgVHJhbnNmZXIgZnJvbSB1bmRlcmx5aW5nIHRva2VuIGNvbnRyYWN0CiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyAgICAgb2xkX2RlcG9zaXRfYW1vdW50ID0gKAogICAgLy8gICAgICAgICB1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKiBuZXdfbWFya2V0LmRlcG9zaXRfaW5kZXgubmF0aXZlCiAgICAvLyAgICAgKSAvLyBTQ0FMRQogICAgLy8gICAgIG5ld19kZXBvc2l0X2Ftb3VudCA9IG9sZF9kZXBvc2l0X2Ftb3VudCAtIHVuZGVybHlpbmdfYW1vdW50CiAgICAvLyAKICAgIC8vICAgICAjIFVzZSBjdXJyZW50IG1hcmtldCBwcmljZSBpZiB1c2VyIGRvZXNuJ3QgaGF2ZSBhIHByZXZpb3VzIHByaWNlCiAgICAvLyAgICAgcHJpY2VfZm9yX29sZCA9ICgKICAgIC8vICAgICAgICAgdXNlci5sYXN0X3ByaWNlLm5hdGl2ZQogICAgLy8gICAgICAgICBpZiB1c2VyLmxhc3RfcHJpY2UubmF0aXZlID4gMAogICAgLy8gICAgICAgICBlbHNlIG5ld19tYXJrZXQucHJpY2UubmF0aXZlCiAgICAvLyAgICAgKQogICAgLy8gICAgIHByaWNlX2Zvcl9uZXcgPSBuZXdfbWFya2V0LnByaWNlLm5hdGl2ZQogICAgLy8gCiAgICAvLyAgICAgb2xkX3ZhbHVlID0gKAogICAgLy8gICAgICAgICBvbGRfZGVwb3NpdF9hbW91bnQgKiBwcmljZV9mb3Jfb2xkCiAgICAvLyAgICAgKSAvLyBTQ0FMRSAgIyBVc2UgdXNlcidzIGxhc3Qga25vd24gcHJpY2Ugb3IgY3VycmVudCBwcmljZQogICAgLy8gICAgIG5ld192YWx1ZSA9ICgKICAgIC8vICAgICAgICAgbmV3X2RlcG9zaXRfYW1vdW50ICogcHJpY2VfZm9yX25ldwogICAgLy8gICAgICkgLy8gU0NBTEUgICMgVXNlIGN1cnJlbnQgbWFya2V0IHByaWNlCiAgICAvLyAgICAgc2VsZi5fdXBkYXRlX2dsb2JhbF9jb2xsYXRlcmFsKAogICAgLy8gICAgICAgICBUeG4uc2VuZGVyLAogICAgLy8gICAgICAgICBtYXJrZXRfaWQsCiAgICAvLyAgICAgICAgIG9sZF92YWx1ZSwgICMgb2xkIFVTRCB2YWx1ZQogICAgLy8gICAgICAgICBuZXdfdmFsdWUsICAjIG5ldyBVU0QgdmFsdWUKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vICMgd2l0aGRyYXcgY29zdCA5MDAwMDAKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgYm9ycm93KHNlbGYsIG1hcmtldF9pZDogYXJjNC5VSW50NjQsIGFtb3VudDogYXJjNC5VSW50MjU2KSAtPiBOb25lOgogICAgLy8gICAgIGVuc3VyZV9idWRnZXQoMTQwMCwgT3BVcEZlZVNvdXJjZS5Hcm91cENyZWRpdCkKICAgIC8vICAgICBzZWxmLl9ib3Jyb3cobWFya2V0X2lkLm5hdGl2ZSwgYW1vdW50Lm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfYm9ycm93KHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fdmFsaWRhdGVfbWFya2V0X29wZXJhdGlvbihtYXJrZXRfaWQsIGFtb3VudCwgRmFsc2UpCiAgICAvLyAKICAgIC8vICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIoVHhuLnNlbmRlciwgbWFya2V0X2lkKQogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gCiAgICAvLyAgICAgcGF5bWVudCA9IHJlcXVpcmVfcGF5bWVudChUeG4uc2VuZGVyKQogICAgLy8gICAgIGFzc2VydCBwYXltZW50ID49IFVJbnQ2NCgxMDAwMDApLCAiUGF5bWVudCBhbW91bnQgbXVzdCBiZSA+PSAwLjEiCiAgICAvLyAKICAgIC8vICAgICB0b3RhbF9ib3Jyb3dzID0gKAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlICogbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUKICAgIC8vICAgICApIC8vIFNDQUxFCiAgICAvLyAgICAgYXNzZXJ0IG1hcmtldC5tYXhfdG90YWxfYm9ycm93cy5uYXRpdmUgPj0gdG90YWxfYm9ycm93cyArIGFtb3VudCwgIkJvcnJvdyBjYXAiCiAgICAvLyAKICAgIC8vICAgICBnbG9iYWxfdXNlciA9IHNlbGYuX2dldF9nbG9iYWxfdXNlcihUeG4uc2VuZGVyKQogICAgLy8gICAgIG5ld19ib3Jyb3dfdmFsdWUgPSAoYW1vdW50ICogbWFya2V0LnByaWNlLm5hdGl2ZSkgLy8gU0NBTEUKICAgIC8vICAgICB0b3RhbF9ib3Jyb3dfdmFsdWUgPSBnbG9iYWxfdXNlci50b3RhbF9ib3Jyb3dfdmFsdWUubmF0aXZlICsgbmV3X2JvcnJvd192YWx1ZQogICAgLy8gCiAgICAvLyAgICAgYXNzZXJ0IHRvdGFsX2JvcnJvd192YWx1ZSA8PSAoCiAgICAvLyAgICAgICAgIGdsb2JhbF91c2VyLnRvdGFsX2NvbGxhdGVyYWxfdmFsdWUubmF0aXZlCiAgICAvLyAgICAgICAgICogQmlnVUludChtYXJrZXQuY29sbGF0ZXJhbF9mYWN0b3IubmF0aXZlKQogICAgLy8gICAgICkgLy8gQmlnVUludCgxMDAwMCksICJJbnN1ZmZpY2llbnQgY29sbGF0ZXJhbCBhY3Jvc3MgbWFya2V0cyIKICAgIC8vIAogICAgLy8gICAgIG5ld19tYXJrZXQgPSBzZWxmLl9hY2NydWVfaW50ZXJlc3QobWFya2V0X2lkKQogICAgLy8gICAgIHNjYWxlZF9hbW91bnQgPSAoYW1vdW50ICogU0NBTEUpIC8vIG5ld19tYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZQogICAgLy8gCiAgICAvLyAgICAgc2VsZi5faW5jcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9ib3Jyb3dzKG1hcmtldF9pZCwgVHhuLnNlbmRlciwgc2NhbGVkX2Ftb3VudCkKICAgIC8vICAgICBzZWxmLl9pbmNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9ib3Jyb3dzKG1hcmtldF9pZCwgc2NhbGVkX2Ftb3VudCkKICAgIC8vIAogICAgLy8gICAgIG9sZF9ib3Jyb3dfYW1vdW50ID0gKAogICAgLy8gICAgICAgICB1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAqIG1hcmtldC5ib3Jyb3dfaW5kZXgubmF0aXZlIC8vIFNDQUxFCiAgICAvLyAgICAgKQogICAgLy8gICAgIG5ld19ib3Jyb3dfYW1vdW50ID0gKAogICAgLy8gICAgICAgICAodXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgKyBzY2FsZWRfYW1vdW50KQogICAgLy8gICAgICAgICAqIG5ld19tYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZQogICAgLy8gICAgICAgICAvLyBTQ0FMRQogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gICAgICMgVXNlIGN1cnJlbnQgbWFya2V0IHByaWNlIGlmIHVzZXIgZG9lc24ndCBoYXZlIGEgcHJldmlvdXMgcHJpY2UKICAgIC8vICAgICBwcmljZV9mb3Jfb2xkID0gKAogICAgLy8gICAgICAgICB1c2VyLmxhc3RfcHJpY2UubmF0aXZlCiAgICAvLyAgICAgICAgIGlmIHVzZXIubGFzdF9wcmljZS5uYXRpdmUgPiAwCiAgICAvLyAgICAgICAgIGVsc2UgbWFya2V0LnByaWNlLm5hdGl2ZQogICAgLy8gICAgICkKICAgIC8vICAgICBwcmljZV9mb3JfbmV3ID0gbmV3X21hcmtldC5wcmljZS5uYXRpdmUKICAgIC8vIAogICAgLy8gICAgIG9sZF92YWx1ZSA9IChvbGRfYm9ycm93X2Ftb3VudCAqIHByaWNlX2Zvcl9vbGQpIC8vIFNDQUxFCiAgICAvLyAgICAgbmV3X3ZhbHVlID0gKG5ld19ib3Jyb3dfYW1vdW50ICogcHJpY2VfZm9yX25ldykgLy8gU0NBTEUKICAgIC8vICAgICBzZWxmLl91cGRhdGVfZ2xvYmFsX2JvcnJvd3MoCiAgICAvLyAgICAgICAgIFR4bi5zZW5kZXIsCiAgICAvLyAgICAgICAgIG1hcmtldF9pZCwKICAgIC8vICAgICAgICAgb2xkX3ZhbHVlLCAgIyBvbGQgVVNEIHZhbHVlCiAgICAvLyAgICAgICAgIG5ld192YWx1ZSwgICMgbmV3IFVTRCB2YWx1ZQogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gICAgICMgaWYgc3Rva2VuLCBtaW50IHN0b2tlbgogICAgLy8gICAgIGlmIG1hcmtldF9pZCA9PSBzZWxmLnN0b2tlbl9hcHBfaWQ6CiAgICAvLyAgICAgICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgICAgICBTVG9rZW4ubWludCwKICAgIC8vICAgICAgICAgICAgIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIC8vICAgICAgICAgICAgIGFyYzQuVUludDI1NihhbW91bnQpLAogICAgLy8gICAgICAgICAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldF9pZCksCiAgICAvLyAgICAgICAgICkKICAgIC8vICAgICAgICAgaXR4bi5QYXltZW50KAogICAgLy8gICAgICAgICAgICAgcmVjZWl2ZXI9QXBwbGljYXRpb24obWFya2V0X2lkKS5hZGRyZXNzLCBhbW91bnQ9MTAwMDAwLCBmZWU9MAogICAgLy8gICAgICAgICApLnN1Ym1pdCgpCiAgICAvLyAgICAgIyBpZiBhVG9rZW4sIHRyYW5zZmVyIGFUb2tlbgogICAgLy8gICAgIGVsc2U6CiAgICAvLyAgICAgICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgICAgICBBUkMyMDBUb2tlbkludGVyZmFjZS5hcmMyMDBfdHJhbnNmZXIsCiAgICAvLyAgICAgICAgICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgICAgICAgICBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIC8vICAgICAgICAgICAgIGFwcF9pZD1BcHBsaWNhdGlvbihtYXJrZXRfaWQpLAogICAgLy8gICAgICAgICApCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF9zY2FsZWRfcmVwYXlfYW1vdW50KAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogYXJjNC5VSW50NjQsIGFtb3VudDogYXJjNC5VSW50MjU2CiAgICAvLyApIC0+IGFyYzQuVUludDI1NjoKICAgIC8vICAgICByZXR1cm4gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBzZWxmLl9nZXRfc2NhbGVkX3JlcGF5X2Ftb3VudChtYXJrZXRfaWQubmF0aXZlLCBhbW91bnQubmF0aXZlKQogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X3NjYWxlZF9yZXBheV9hbW91bnQoc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIGFtb3VudDogQmlnVUludCkgLT4gQmlnVUludDoKICAgIC8vICAgICBuZXdfbWFya2V0ID0gc2VsZi5fYWNjcnVlX2ludGVyZXN0KG1hcmtldF9pZCkKICAgIC8vICAgICByZXR1cm4gKGFtb3VudCAqIFNDQUxFKSAvLyBuZXdfbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgcmVwYXkoc2VsZiwgbWFya2V0X2lkOiBhcmM0LlVJbnQ2NCwgYW1vdW50OiBhcmM0LlVJbnQyNTYpIC0+IE5vbmU6CiAgICAvLyAgICAgZW5zdXJlX2J1ZGdldCgxNDAwLCBPcFVwRmVlU291cmNlLkdyb3VwQ3JlZGl0KQogICAgLy8gICAgIHNlbGYuX3JlcGF5KG1hcmtldF9pZC5uYXRpdmUsIGFtb3VudC5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3JlcGF5KHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fdmFsaWRhdGVfbWFya2V0X29wZXJhdGlvbihtYXJrZXRfaWQsIGFtb3VudCwgRmFsc2UpCiAgICAvLyAKICAgIC8vICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIoVHhuLnNlbmRlciwgbWFya2V0X2lkKQogICAgLy8gICAgIG5ld19tYXJrZXQgPSBzZWxmLl9hY2NydWVfaW50ZXJlc3QobWFya2V0X2lkKQogICAgLy8gCiAgICAvLyAgICAgc2NhbGVkX2Ftb3VudCA9IChhbW91bnQgKiBTQ0FMRSkgLy8gbmV3X21hcmtldC5ib3Jyb3dfaW5kZXgubmF0aXZlCiAgICAvLyAgICAgYXNzZXJ0IHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlID49IHNjYWxlZF9hbW91bnQsICJSZXBheSBhbW91bnQgZXhjZWVkcyBkZWJ0IgogICAgLy8gCiAgICAvLyAgICAgaWYgbWFya2V0X2lkID09IHNlbGYuc3Rva2VuX2FwcF9pZDoKICAgIC8vICAgICAgICAgYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICAgICAgICAgIFNUb2tlbi5idXJuX2Zyb20sCiAgICAvLyAgICAgICAgICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgICAgICAgICBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIC8vICAgICAgICAgICAgIGFwcF9pZD1BcHBsaWNhdGlvbihtYXJrZXRfaWQpLAogICAgLy8gICAgICAgICApCiAgICAvLyAgICAgZWxzZToKICAgIC8vICAgICAgICAgYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICAgICAgICAgIEFSQzIwMFRva2VuSW50ZXJmYWNlLmFyYzIwMF90cmFuc2ZlckZyb20sCiAgICAvLyAgICAgICAgICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgICAgICAgICBhcmM0LkFkZHJlc3MoR2xvYmFsLmN1cnJlbnRfYXBwbGljYXRpb25fYWRkcmVzcyksCiAgICAvLyAgICAgICAgICAgICBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIC8vICAgICAgICAgICAgIGFwcF9pZD1BcHBsaWNhdGlvbihtYXJrZXRfaWQpLAogICAgLy8gICAgICAgICApCiAgICAvLyAKICAgIC8vICAgICBzZWxmLl9kZWNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2JvcnJvd3MobWFya2V0X2lkLCBUeG4uc2VuZGVyLCBzY2FsZWRfYW1vdW50KQogICAgLy8gICAgIHNlbGYuX2RlY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2JvcnJvd3MobWFya2V0X2lkLCBzY2FsZWRfYW1vdW50KQogICAgLy8gCiAgICAvLyAgICAgb2xkX2JvcnJvd19hbW91bnQgPSAoCiAgICAvLyAgICAgICAgIHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlICogbmV3X21hcmtldC5ib3Jyb3dfaW5kZXgubmF0aXZlIC8vIFNDQUxFCiAgICAvLyAgICAgKQogICAgLy8gICAgIG5ld19ib3Jyb3dfYW1vdW50ID0gKAogICAgLy8gICAgICAgICAodXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgLSBzY2FsZWRfYW1vdW50KQogICAgLy8gICAgICAgICAqIG5ld19tYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZQogICAgLy8gICAgICAgICAvLyBTQ0FMRQogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gICAgICMgVXNlIGN1cnJlbnQgbWFya2V0IHByaWNlIGlmIHVzZXIgZG9lc24ndCBoYXZlIGEgcHJldmlvdXMgcHJpY2UKICAgIC8vICAgICBwcmljZV9mb3Jfb2xkID0gKAogICAgLy8gICAgICAgICB1c2VyLmxhc3RfcHJpY2UubmF0aXZlCiAgICAvLyAgICAgICAgIGlmIHVzZXIubGFzdF9wcmljZS5uYXRpdmUgPiAwCiAgICAvLyAgICAgICAgIGVsc2UgbmV3X21hcmtldC5wcmljZS5uYXRpdmUKICAgIC8vICAgICApCiAgICAvLyAgICAgcHJpY2VfZm9yX25ldyA9IG5ld19tYXJrZXQucHJpY2UubmF0aXZlCiAgICAvLyAKICAgIC8vICAgICBvbGRfdmFsdWUgPSAob2xkX2JvcnJvd19hbW91bnQgKiBwcmljZV9mb3Jfb2xkKSAvLyBTQ0FMRQogICAgLy8gICAgIG5ld192YWx1ZSA9IChuZXdfYm9ycm93X2Ftb3VudCAqIHByaWNlX2Zvcl9uZXcpIC8vIFNDQUxFCiAgICAvLyAgICAgc2VsZi5fdXBkYXRlX2dsb2JhbF9ib3Jyb3dzKAogICAgLy8gICAgICAgICBUeG4uc2VuZGVyLAogICAgLy8gICAgICAgICBtYXJrZXRfaWQsCiAgICAvLyAgICAgICAgIG9sZF92YWx1ZSwgICMgb2xkIFVTRCB2YWx1ZQogICAgLy8gICAgICAgICBuZXdfdmFsdWUsICAjIG5ldyBVU0QgdmFsdWUKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIHJlZGVlbShzZWxmLCBtYXJrZXRfaWQ6IGFyYzQuVUludDY0LCBhbW91bnQ6IGFyYzQuVUludDI1NikgLT4gTm9uZToKICAgIC8vICAgICBlbnN1cmVfYnVkZ2V0KDE0MDAsIE9wVXBGZWVTb3VyY2UuR3JvdXBDcmVkaXQpCiAgICAvLyAgICAgc2VsZi5fcmVkZWVtKG1hcmtldF9pZC5uYXRpdmUsIGFtb3VudC5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3JlZGVlbShzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX3ZhbGlkYXRlX21hcmtldF9vcGVyYXRpb24obWFya2V0X2lkLCBhbW91bnQsIFRydWUpCiAgICAvLyAKICAgIC8vICAgICBhc3NlcnQgbm90IHNlbGYuX2hhc19wb3NpdGlvbigKICAgIC8vICAgICAgICAgVHhuLnNlbmRlciwgbWFya2V0X2lkCiAgICAvLyAgICAgKSwgIkNhbm5vdCBtaW50L3JlZGVlbSB3aGVuIHVzZXIgaGFzIHRyYWNrZWQgZGVwb3NpdCBwb3NpdGlvbiIKICAgIC8vIAogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2FjY3J1ZV9pbnRlcmVzdChtYXJrZXRfaWQpCiAgICAvLyAKICAgIC8vICAgICBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgICAgICBOVG9rZW4uYnVybl9mcm9tLAogICAgLy8gICAgICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgICAgIGFyYzQuVUludDI1NihhbW91bnQpLAogICAgLy8gICAgICAgICBhcHBfaWQ9QXBwbGljYXRpb24obWFya2V0Lm50b2tlbl9pZC5uYXRpdmUpLAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gICAgIHNjYWxlZF9hbW91bnQgPSAoYW1vdW50ICogU0NBTEUpIC8vIG1hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZQogICAgLy8gICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlID49IHNjYWxlZF9hbW91bnQKICAgIC8vICAgICApLCAiSW5zdWZmaWNpZW50IG1hcmtldCBkZXBvc2l0cyB0byByZWRlZW0iCiAgICAvLyAgICAgc2VsZi5fZGVjcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfZGVwb3NpdHMobWFya2V0X2lkLCBzY2FsZWRfYW1vdW50KQogICAgLy8gCiAgICAvLyAgICAgYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICAgICAgQVJDMjAwVG9rZW5JbnRlcmZhY2UuYXJjMjAwX3RyYW5zZmVyLAogICAgLy8gICAgICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgICAgIGFyYzQuVUludDI1NihhbW91bnQpLAogICAgLy8gICAgICAgICBhcHBfaWQ9QXBwbGljYXRpb24obWFya2V0X2lkKSwKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIG1pbnQoc2VsZiwgbWFya2V0X2lkOiBhcmM0LlVJbnQ2NCwgYW1vdW50OiBhcmM0LlVJbnQyNTYpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fbWludChtYXJrZXRfaWQubmF0aXZlLCBhbW91bnQubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9taW50KHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fdmFsaWRhdGVfbWFya2V0X29wZXJhdGlvbihtYXJrZXRfaWQsIGFtb3VudCwgVHJ1ZSkKICAgIC8vIAogICAgLy8gICAgIGFzc2VydCBub3Qgc2VsZi5faGFzX3Bvc2l0aW9uKAogICAgLy8gICAgICAgICBUeG4uc2VuZGVyLCBtYXJrZXRfaWQKICAgIC8vICAgICApLCAiQ2Fubm90IG1pbnQvcmVkZWVtIHdoZW4gdXNlciBoYXMgdHJhY2tlZCBkZXBvc2l0IHBvc2l0aW9uIgogICAgLy8gCiAgICAvLyAgICAgYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICAgICAgQVJDMjAwVG9rZW5JbnRlcmZhY2UuYXJjMjAwX3RyYW5zZmVyRnJvbSwKICAgIC8vICAgICAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgICAgICBhcmM0LkFkZHJlc3MoR2xvYmFsLmN1cnJlbnRfYXBwbGljYXRpb25fYWRkcmVzcyksCiAgICAvLyAgICAgICAgIGFyYzQuVUludDI1NihhbW91bnQpLAogICAgLy8gICAgICAgICBhcHBfaWQ9QXBwbGljYXRpb24obWFya2V0X2lkKSwKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vICAgICBuZXdfbWFya2V0ID0gc2VsZi5fYWNjcnVlX2ludGVyZXN0KAogICAgLy8gICAgICAgICBtYXJrZXRfaWQKICAgIC8vICAgICApICAjIEdldCB1cGRhdGVkIG1hcmtldCB3aXRoIGFjY3J1ZWQgaW50ZXJlc3QKICAgIC8vICAgICBzY2FsZWRfYW1vdW50ID0gKAogICAgLy8gICAgICAgICBhbW91bnQgKiBTQ0FMRQogICAgLy8gICAgICkgLy8gbmV3X21hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZSAgIyBDYWxjdWxhdGUgd2l0aCBuZXcgaW5kZXgKICAgIC8vIAogICAgLy8gICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgIG5ld19tYXJrZXQubWF4X3RvdGFsX2RlcG9zaXRzLm5hdGl2ZQogICAgLy8gICAgICAgICA+PSBuZXdfbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKyBzY2FsZWRfYW1vdW50CiAgICAvLyAgICAgKSwgIkRlcG9zaXQgY2FwIGV4Y2VlZGVkIgogICAgLy8gCiAgICAvLyAgICAgIyBPbmx5IGluY3JlbWVudCBtYXJrZXQgdG90YWwgZGVwb3NpdHMsIG5vdCB1c2VyIGRlcG9zaXRzIHNpbmNlIHBvc2l0aW9uIGlzIG5vdCB0cmFja2VkCiAgICAvLyAgICAgc2VsZi5faW5jcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfZGVwb3NpdHMobWFya2V0X2lkLCBzY2FsZWRfYW1vdW50KQogICAgLy8gCiAgICAvLyAgICAgYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICAgICAgTlRva2VuLm1pbnQsCiAgICAvLyAgICAgICAgIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIC8vICAgICAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgICAgIGFwcF9pZD1BcHBsaWNhdGlvbihuZXdfbWFya2V0Lm50b2tlbl9pZC5uYXRpdmUpLAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gICAgIGFyYzQuZW1pdCgKICAgIC8vICAgICAgICAgTWludEV2ZW50KAogICAgLy8gICAgICAgICAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLCBhcmM0LlVJbnQyNTYoYW1vdW50KSwgYXJjNC5VSW50NjQobWFya2V0X2lkKQogICAgLy8gICAgICAgICApCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBzeW5jX3VzZXJfbWFya2V0X2Zvcl9wcmljZV9jaGFuZ2UoCiAgICAvLyAgICAgc2VsZiwgdXNlcl9pZDogYXJjNC5BZGRyZXNzLCBtYXJrZXRfaWQ6IGFyYzQuVUludDY0CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgZW5zdXJlX2J1ZGdldCgxNDAwLCBPcFVwRmVlU291cmNlLkdyb3VwQ3JlZGl0KQogICAgLy8gICAgIHNlbGYuX3VwZGF0ZV91c2VyX2dsb2JhbF92YWx1ZXNfZm9yX3ByaWNlX2NoYW5nZSgKICAgIC8vICAgICAgICAgdXNlcl9pZC5uYXRpdmUsIG1hcmtldF9pZC5uYXRpdmUKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3VwZGF0ZV91c2VyX2dsb2JhbF92YWx1ZXNfZm9yX3ByaWNlX2NoYW5nZSgKICAgIC8vICAgICBzZWxmLCB1c2VyX2lkOiBBY2NvdW50LCBtYXJrZXRfaWQ6IFVJbnQ2NAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkuY29weSgpCiAgICAvLyAgICAgaWYgdXNlci5zY2FsZWRfZGVwb3NpdHMgPT0gMCBhbmQgdXNlci5zY2FsZWRfYm9ycm93cyA9PSAwOgogICAgLy8gICAgICAgICByZXR1cm4KICAgIC8vIAogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2FjY3J1ZV9pbnRlcmVzdChtYXJrZXRfaWQpCiAgICAvLyAKICAgIC8vICAgICBpZiB1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgPiAwOgogICAgLy8gICAgICAgICBkZXBvc2l0X2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgICAgIHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSAqIG1hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZQogICAgLy8gICAgICAgICApIC8vIFNDQUxFCiAgICAvLyAgICAgICAgICMgVXNlIGN1cnJlbnQgbWFya2V0IHByaWNlIGlmIHVzZXIgZG9lc24ndCBoYXZlIGEgcHJldmlvdXMgcHJpY2UKICAgIC8vICAgICAgICAgcHJpY2VfZm9yX29sZCA9ICgKICAgIC8vICAgICAgICAgICAgIHVzZXIubGFzdF9wcmljZS5uYXRpdmUKICAgIC8vICAgICAgICAgICAgIGlmIHVzZXIubGFzdF9wcmljZS5uYXRpdmUgPiAwCiAgICAvLyAgICAgICAgICAgICBlbHNlIG1hcmtldC5wcmljZS5uYXRpdmUKICAgIC8vICAgICAgICAgKQogICAgLy8gICAgICAgICBvbGRfZGVwb3NpdF92YWx1ZSA9IChkZXBvc2l0X2Ftb3VudCAqIHByaWNlX2Zvcl9vbGQpIC8vIFNDQUxFCiAgICAvLyAgICAgICAgIG5ld19kZXBvc2l0X3ZhbHVlID0gKGRlcG9zaXRfYW1vdW50ICogbWFya2V0LnByaWNlLm5hdGl2ZSkgLy8gU0NBTEUKICAgIC8vICAgICAgICAgc2VsZi5fdXBkYXRlX2dsb2JhbF9jb2xsYXRlcmFsKAogICAgLy8gICAgICAgICAgICAgdXNlcl9pZCwgbWFya2V0X2lkLCBvbGRfZGVwb3NpdF92YWx1ZSwgbmV3X2RlcG9zaXRfdmFsdWUKICAgIC8vICAgICAgICAgKQogICAgLy8gCiAgICAvLyAgICAgaWYgdXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgPiAwOgogICAgLy8gICAgICAgICBib3Jyb3dfYW1vdW50ID0gKAogICAgLy8gICAgICAgICAgICAgdXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgKiBtYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZQogICAgLy8gICAgICAgICApIC8vIFNDQUxFCiAgICAvLyAgICAgICAgICMgVXNlIGN1cnJlbnQgbWFya2V0IHByaWNlIGlmIHVzZXIgZG9lc24ndCBoYXZlIGEgcHJldmlvdXMgcHJpY2UKICAgIC8vICAgICAgICAgcHJpY2VfZm9yX29sZCA9ICgKICAgIC8vICAgICAgICAgICAgIHVzZXIubGFzdF9wcmljZS5uYXRpdmUKICAgIC8vICAgICAgICAgICAgIGlmIHVzZXIubGFzdF9wcmljZS5uYXRpdmUgPiAwCiAgICAvLyAgICAgICAgICAgICBlbHNlIG1hcmtldC5wcmljZS5uYXRpdmUKICAgIC8vICAgICAgICAgKQogICAgLy8gICAgICAgICBvbGRfYm9ycm93X3ZhbHVlID0gKGJvcnJvd19hbW91bnQgKiBwcmljZV9mb3Jfb2xkKSAvLyBTQ0FMRQogICAgLy8gICAgICAgICBuZXdfYm9ycm93X3ZhbHVlID0gKGJvcnJvd19hbW91bnQgKiBtYXJrZXQucHJpY2UubmF0aXZlKSAvLyBTQ0FMRQogICAgLy8gICAgICAgICBzZWxmLl91cGRhdGVfZ2xvYmFsX2JvcnJvd3MoCiAgICAvLyAgICAgICAgICAgICB1c2VyX2lkLCBtYXJrZXRfaWQsIG9sZF9ib3Jyb3dfdmFsdWUsIG5ld19ib3Jyb3dfdmFsdWUKICAgIC8vICAgICAgICAgKQogICAgLy8gCiAgICAvLyAgICAgdXNlcl9rZXkgPSBzZWxmLl9nZXRfdXNlcl9rZXkodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIubGFzdF9wcmljZSA9IG1hcmtldC5wcmljZQogICAgLy8gICAgIHNlbGYudXNlcnNbdXNlcl9rZXldID0gdXNlci5jb3B5KCkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgZ2V0X2dsb2JhbF91c2VyKHNlbGYsIHVzZXJfaWQ6IGFyYzQuQWRkcmVzcykgLT4gR2xvYmFsVXNlckRhdGE6CiAgICAvLyAgICAgcmV0dXJuIHNlbGYuX2dldF9nbG9iYWxfdXNlcih1c2VyX2lkLm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgZ2V0X2dsb2JhbF91c2VyX2NvbGxhdGVyYWwoc2VsZiwgdXNlcl9pZDogYXJjNC5BZGRyZXNzKSAtPiBhcmM0LlVJbnQyNTY6CiAgICAvLyAgICAgcmV0dXJuIHNlbGYuX2dldF9nbG9iYWxfdXNlcih1c2VyX2lkLm5hdGl2ZSkudG90YWxfY29sbGF0ZXJhbF92YWx1ZQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9nZXRfZ2xvYmFsX3VzZXIoc2VsZiwgdXNlcl9pZDogQWNjb3VudCkgLT4gR2xvYmFsVXNlckRhdGE6CiAgICAvLyAKICAgIC8vICAgICByZXR1cm4gc2VsZi5nbG9iYWxfdXNlcnMuZ2V0KAogICAgLy8gICAgICAgICB1c2VyX2lkLAogICAgLy8gICAgICAgICBkZWZhdWx0PUdsb2JhbFVzZXJEYXRhKAogICAgLy8gICAgICAgICAgICAgdG90YWxfY29sbGF0ZXJhbF92YWx1ZT1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICB0b3RhbF9ib3Jyb3dfdmFsdWU9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgbGFzdF91cGRhdGVfdGltZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgKSwKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3VwZGF0ZV9nbG9iYWxfY29sbGF0ZXJhbCgKICAgIC8vICAgICBzZWxmLAogICAgLy8gICAgIHVzZXJfaWQ6IEFjY291bnQsCiAgICAvLyAgICAgbWFya2V0X2lkOiBVSW50NjQsCiAgICAvLyAgICAgb2xkX3ZhbHVlOiBCaWdVSW50LAogICAgLy8gICAgIG5ld192YWx1ZTogQmlnVUludCwKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBnbG9iYWxfdXNlciA9IHNlbGYuX2dldF9nbG9iYWxfdXNlcih1c2VyX2lkKQogICAgLy8gCiAgICAvLyAgICAgZ2xvYmFsX3VzZXIudG90YWxfY29sbGF0ZXJhbF92YWx1ZSA9IGFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgZ2xvYmFsX3VzZXIudG90YWxfY29sbGF0ZXJhbF92YWx1ZS5uYXRpdmUgLSBvbGRfdmFsdWUgKyBuZXdfdmFsdWUKICAgIC8vICAgICApCiAgICAvLyAgICAgZ2xvYmFsX3VzZXIubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gCiAgICAvLyAgICAgc2VsZi5nbG9iYWxfdXNlcnNbdXNlcl9pZF0gPSBnbG9iYWxfdXNlci5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfdXBkYXRlX2dsb2JhbF9ib3Jyb3dzKAogICAgLy8gICAgIHNlbGYsCiAgICAvLyAgICAgdXNlcl9pZDogQWNjb3VudCwKICAgIC8vICAgICBtYXJrZXRfaWQ6IFVJbnQ2NCwKICAgIC8vICAgICBvbGRfdmFsdWU6IEJpZ1VJbnQsCiAgICAvLyAgICAgbmV3X3ZhbHVlOiBCaWdVSW50LAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIGdsb2JhbF91c2VyID0gc2VsZi5fZ2V0X2dsb2JhbF91c2VyKHVzZXJfaWQpCiAgICAvLyAKICAgIC8vICAgICBnbG9iYWxfdXNlci50b3RhbF9ib3Jyb3dfdmFsdWUgPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgIGdsb2JhbF91c2VyLnRvdGFsX2JvcnJvd192YWx1ZS5uYXRpdmUgLSBvbGRfdmFsdWUgKyBuZXdfdmFsdWUKICAgIC8vICAgICApCiAgICAvLyAgICAgZ2xvYmFsX3VzZXIubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gCiAgICAvLyAgICAgc2VsZi5nbG9iYWxfdXNlcnNbdXNlcl9pZF0gPSBnbG9iYWxfdXNlci5jb3B5KCkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgZ2V0X2dsb2JhbF91c2VyX2hlYWx0aCgKICAgIC8vICAgICBzZWxmLCB1c2VyX2lkOiBhcmM0LkFkZHJlc3MsIGxpcXVpZGF0aW9uX3RocmVzaG9sZDogYXJjNC5VSW50NjQKICAgIC8vICkgLT4gYXJjNC5VSW50MjU2OgogICAgLy8gICAgIHJldHVybiBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgIHNlbGYuX2dldF9nbG9iYWxfdXNlcl9oZWFsdGgodXNlcl9pZC5uYXRpdmUsIGxpcXVpZGF0aW9uX3RocmVzaG9sZC5uYXRpdmUpCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9nZXRfZ2xvYmFsX3VzZXJfaGVhbHRoKAogICAgLy8gICAgIHNlbGYsIHVzZXJfaWQ6IEFjY291bnQsIGxpcXVpZGF0aW9uX3RocmVzaG9sZDogVUludDY0CiAgICAvLyApIC0+IEJpZ1VJbnQ6CiAgICAvLyAgICAgZ2xvYmFsX3VzZXIgPSBzZWxmLl9nZXRfZ2xvYmFsX3VzZXIodXNlcl9pZCkKICAgIC8vIAogICAgLy8gICAgIGlmIGdsb2JhbF91c2VyLnRvdGFsX2JvcnJvd192YWx1ZS5uYXRpdmUgPT0gMDoKICAgIC8vICAgICAgICAgcmV0dXJuIEJpZ1VJbnQoMCkgICMgTm8gZGVidCA9IGluZmluaXRlIGhlYWx0aAogICAgLy8gCiAgICAvLyAgICAgaGVhbHRoID0gKAogICAgLy8gICAgICAgICBnbG9iYWxfdXNlci50b3RhbF9jb2xsYXRlcmFsX3ZhbHVlLm5hdGl2ZQogICAgLy8gICAgICAgICAqIEJpZ1VJbnQobGlxdWlkYXRpb25fdGhyZXNob2xkKQogICAgLy8gICAgICAgICAqIEJpZ1VJbnQoMTAwMDApCiAgICAvLyAgICAgKSAvLyAoZ2xvYmFsX3VzZXIudG90YWxfYm9ycm93X3ZhbHVlLm5hdGl2ZSAqIEJpZ1VJbnQoMTAwMDApKQogICAgLy8gICAgIHJldHVybiBoZWFsdGgKICAgIC8vIAogICAgLy8gIyBSRU0gbm8gc2luZ2xlLW1hcmtldCBsaXF1aWRhdGlvbiwganVzdCBjcm9zcy1tYXJrZXQgbGlxdWlkYXRpb24gc2luZ2xlIG1hcmtldAogICAgLy8gCiAgICAvLyAjIFJFTSBjcm9zcy1tYXJrZXQgbGlxdWlkYXRpb24KICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgbGlxdWlkYXRlX2Nyb3NzX21hcmtldCgKICAgIC8vICAgICBzZWxmLAogICAgLy8gICAgIGRlYnRfbWFya2V0X2lkOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBjb2xsYXRlcmFsX21hcmtldF9pZDogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgdXNlcjogYXJjNC5BZGRyZXNzLAogICAgLy8gICAgIGRlYnRfYW1vdW50OiBhcmM0LlVJbnQyNTYsCiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgZW5zdXJlX2J1ZGdldCgyMTAwLCBPcFVwRmVlU291cmNlLkdyb3VwQ3JlZGl0KQogICAgLy8gICAgIGFzc2VydCBub3Qgc2VsZi5faXNfcGF1c2VkKCksICJQcm90b2NvbCBpcyBwYXVzZWQiCiAgICAvLyAgICAgc2VsZi5fbGlxdWlkYXRlX2Nyb3NzX21hcmtldCgKICAgIC8vICAgICAgICAgZGVidF9tYXJrZXRfaWQubmF0aXZlLAogICAgLy8gICAgICAgICBjb2xsYXRlcmFsX21hcmtldF9pZC5uYXRpdmUsCiAgICAvLyAgICAgICAgIHVzZXIubmF0aXZlLAogICAgLy8gICAgICAgICBkZWJ0X2Ftb3VudC5uYXRpdmUsCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9saXF1aWRhdGVfY3Jvc3NfbWFya2V0KAogICAgLy8gICAgIHNlbGYsCiAgICAvLyAgICAgZGVidF9tYXJrZXRfaWQ6IFVJbnQ2NCwKICAgIC8vICAgICBjb2xsYXRlcmFsX21hcmtldF9pZDogVUludDY0LAogICAgLy8gICAgIHVzZXJfaWQ6IEFjY291bnQsCiAgICAvLyAgICAgZGVidF9hbW91bnQ6IEJpZ1VJbnQsCiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgYXNzZXJ0IGRlYnRfbWFya2V0X2lkIGluIHNlbGYubWFya2V0cywgIkRlYnQgbWFya2V0IGRvZXMgbm90IGV4aXN0IgogICAgLy8gICAgIGFzc2VydCBjb2xsYXRlcmFsX21hcmtldF9pZCBpbiBzZWxmLm1hcmtldHMsICJDb2xsYXRlcmFsIG1hcmtldCBkb2VzIG5vdCBleGlzdCIKICAgIGZyYW1lX2RpZyAtMwogICAgaXRvYgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1MTAKICAgIC8vIHNlbGYubWFya2V0cyA9IEJveE1hcChVSW50NjQsIE1hcmtldERhdGEpICAjIE1hcmtldCBzdGF0ZQogICAgYnl0ZSAibWFya2V0cyIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTEwLTE1MTEKICAgIC8vICAgICBzZWxmLm1hcmtldHMgPSBCb3hNYXAoVUludDY0LCBNYXJrZXREYXRhKSAgIyBNYXJrZXQgc3RhdGUKICAgIC8vICAgICBzZWxmLnVzZXJzID0gQm94TWFwKEJ5dGVzNDAsIFVzZXJEYXRhKSAgIyBQZXItbWFya2V0IHVzZXIgc3RhdGUKICAgIC8vICAgICBzZWxmLmdsb2JhbF91c2VycyA9IEJveE1hcChBY2NvdW50LCBHbG9iYWxVc2VyRGF0YSkgICMgR2xvYmFsIHVzZXIgc3RhdGUKICAgIC8vIAogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAjIE93bmFibGUKICAgIC8vICMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9vbmx5X293bmVyKHNlbGYpIC0+IE5vbmU6CiAgICAvLyAgICAgYXNzZXJ0IFR4bi5zZW5kZXIgPT0gc2VsZi5vd25lciwgIm9ubHkgdGhlIG93bmVyIGNhbiBjYWxsIHRoaXMgZnVuY3Rpb24iCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZChyZWFkb25seT1UcnVlKQogICAgLy8gZGVmIGdldF9vd25lcihzZWxmKSAtPiBhcmM0LkFkZHJlc3M6CiAgICAvLyAgICAgcmV0dXJuIGFyYzQuQWRkcmVzcyhzZWxmLm93bmVyKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiB0cmFuc2Zlcl9vd25lcnNoaXAoc2VsZiwgbmV3X293bmVyOiBhcmM0LkFkZHJlc3MpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgc2VsZi5fdHJhbnNmZXJfb3duZXJzaGlwKG5ld19vd25lci5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3RyYW5zZmVyX293bmVyc2hpcChzZWxmLCBuZXdfb3duZXI6IEFjY291bnQpIC0+IE5vbmU6CiAgICAvLyAgICAgcHJldmlvdXNfb3duZXIgPSBzZWxmLm93bmVyCiAgICAvLyAgICAgc2VsZi5vd25lciA9IG5ld19vd25lcgogICAgLy8gICAgIGFyYzQuZW1pdCgKICAgIC8vICAgICAgICAgT3duZXJzaGlwVHJhbnNmZXJyZWQoYXJjNC5BZGRyZXNzKHByZXZpb3VzX293bmVyKSwgYXJjNC5BZGRyZXNzKG5ld19vd25lcikpCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIAogICAgLy8gIyBSRU0gaGF2aW5nIGlzc3VlcyB3aXRoIHRoZSBpbmhlcml0YW5jZSBoZXJlCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGlzX3BhdXNlZChzZWxmKSAtPiBhcmM0LkJvb2w6CiAgICAvLyAgICAgcmV0dXJuIGFyYzQuQm9vbChzZWxmLl9pc19wYXVzZWQoKSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaXNfcGF1c2VkKHNlbGYpIC0+IGJvb2w6CiAgICAvLyAgICAgcmV0dXJuIHNlbGYucGF1c2VkID09IFVJbnQ2NCgxKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBwYXVzZShzZWxmLCBwYXVzZTogYXJjNC5VSW50NjQpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgc2VsZi5fcGF1c2UocGF1c2UubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9wYXVzZShzZWxmLCBwYXVzZTogVUludDY0KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYucGF1c2VkID0gcGF1c2UKICAgIC8vIAogICAgLy8gIyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF9zdG9rZW5fYXBwX2lkKHNlbGYpIC0+IGFyYzQuVUludDY0OgogICAgLy8gICAgIHJldHVybiBhcmM0LlVJbnQ2NChzZWxmLl9nZXRfc3Rva2VuX2FwcF9pZCgpKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9nZXRfc3Rva2VuX2FwcF9pZChzZWxmKSAtPiBVSW50NjQ6CiAgICAvLyAgICAgcmV0dXJuIHNlbGYuc3Rva2VuX2FwcF9pZAogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBzZXRfc3Rva2VuX2FwcF9pZChzZWxmLCBzdG9rZW5fYXBwX2lkOiBhcmM0LlVJbnQ2NCkgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLl9vbmx5X293bmVyKCkKICAgIC8vICAgICBzZWxmLnN0b2tlbl9hcHBfaWQgPSBzdG9rZW5fYXBwX2lkLm5hdGl2ZQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9nZXRfdXNlcl9rZXkoc2VsZiwgdXNlcl9pZDogQWNjb3VudCwgbWFya2V0X2lkOiBVSW50NjQpIC0+IEJ5dGVzNDA6CiAgICAvLyAgICAgcmV0dXJuIEJ5dGVzNDAuZnJvbV9ieXRlcygKICAgIC8vICAgICAgICAgYXJjNC5BZGRyZXNzKHVzZXJfaWQpLmJ5dGVzICsgYXJjNC5VSW50NjQobWFya2V0X2lkKS5ieXRlcwogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgZ2V0X3VzZXIoc2VsZiwgdXNlcl9pZDogYXJjNC5BZGRyZXNzLCBtYXJrZXRfaWQ6IGFyYzQuVUludDY0KSAtPiBVc2VyRGF0YToKICAgIC8vICAgICByZXR1cm4gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZC5uYXRpdmUsIG1hcmtldF9pZC5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2dldF91c2VyKHNlbGYsIHVzZXJfaWQ6IEFjY291bnQsIG1hcmtldF9pZDogVUludDY0KSAtPiBVc2VyRGF0YToKICAgIC8vICAgICB1c2VyX2tleSA9IHNlbGYuX2dldF91c2VyX2tleSh1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgcmV0dXJuIHNlbGYudXNlcnMuZ2V0KAogICAgLy8gICAgICAgICB1c2VyX2tleSwKICAgIC8vICAgICAgICAgZGVmYXVsdD1Vc2VyRGF0YSgKICAgIC8vICAgICAgICAgICAgIHNjYWxlZF9kZXBvc2l0cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBzY2FsZWRfYm9ycm93cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBkZXBvc2l0X2luZGV4PWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGJvcnJvd19pbmRleD1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBsYXN0X3VwZGF0ZV90aW1lPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgbGFzdF9wcmljZT1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICksCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9oYXNfcG9zaXRpb24oc2VsZiwgdXNlcl9pZDogQWNjb3VudCwgbWFya2V0X2lkOiBVSW50NjQpIC0+IGJvb2w6CiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICByZXR1cm4gdXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlID4gMAogICAgLy8gCiAgICAvLyAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIAogICAgLy8gIyBSRU0gY29uc2lkZXIgcmVtb3ZpbmcgYW5kIGNhbGN1bGF0aW5nIGluIHRoZSBjbGllbnQKICAgIC8vICMgUkVNIHRyeWluZyB0byBjdXQgYmFjayBvbiBleHRyYSBwYWdlcwogICAgLy8gCiAgICAvLyAjIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gIyBkZWYgZ2V0X3VzZXJfZGVwb3NpdF91bmRlcmx5aW5nX2Ftb3VudCgKICAgIC8vICMgICAgIHNlbGYsIHVzZXJfaWQ6IGFyYzQuQWRkcmVzcywgbWFya2V0X2lkOiBhcmM0LlVJbnQ2NAogICAgLy8gIyApIC0+IGFyYzQuVUludDI1NjoKICAgIC8vICMgICAgIHJldHVybiBhcmM0LlVJbnQyNTYoCiAgICAvLyAjICAgICAgICAgc2VsZi5fZ2V0X3VzZXJfZGVwb3NpdF91bmRlcmx5aW5nX2Ftb3VudCh1c2VyX2lkLm5hdGl2ZSwgbWFya2V0X2lkLm5hdGl2ZSkKICAgIC8vICMgICAgICkKICAgIC8vIAogICAgLy8gIyBAc3Vicm91dGluZQogICAgLy8gIyBkZWYgX2dldF91c2VyX2RlcG9zaXRfdW5kZXJseWluZ19hbW91bnQoCiAgICAvLyAjICAgICBzZWxmLCB1c2VyX2lkOiBBY2NvdW50LCBtYXJrZXRfaWQ6IFVJbnQ2NAogICAgLy8gIyApIC0+IEJpZ1VJbnQ6CiAgICAvLyAjICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gIyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpICAjIEFkZCB0aGlzIGxpbmUKICAgIC8vICMgICAgIHJldHVybiAodXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlICogbWFya2V0LmRlcG9zaXRfaW5kZXgubmF0aXZlKSAvLyBTQ0FMRQogICAgLy8gCiAgICAvLyAjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaW5jcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9kZXBvc2l0cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgdXNlcl9pZDogQWNjb3VudCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyX2tleSA9IHNlbGYuX2dldF91c2VyX2tleSh1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlci5zY2FsZWRfZGVwb3NpdHMgPSBhcmM0LlVJbnQyNTYodXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlICsgYW1vdW50KQogICAgLy8gICAgIHVzZXIuZGVwb3NpdF9pbmRleCA9IG1hcmtldC5kZXBvc2l0X2luZGV4CiAgICAvLyAgICAgdXNlci5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApCiAgICAvLyAgICAgdXNlci5sYXN0X3ByaWNlID0gbWFya2V0LnByaWNlICAjIFVwZGF0ZSB1c2VyJ3MgbGFzdCBrbm93biBwcmljZQogICAgLy8gICAgIHNlbGYudXNlcnNbdXNlcl9rZXldID0gdXNlci5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaW5jcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9ib3Jyb3dzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCB1c2VyX2lkOiBBY2NvdW50LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyLnNjYWxlZF9ib3Jyb3dzID0gYXJjNC5VSW50MjU2KHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlICsgYW1vdW50KQogICAgLy8gICAgIHVzZXIuYm9ycm93X2luZGV4ID0gbWFya2V0LmJvcnJvd19pbmRleAogICAgLy8gICAgIHVzZXIubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gICAgIHVzZXIubGFzdF9wcmljZSA9IG1hcmtldC5wcmljZSAgIyBVcGRhdGUgdXNlcidzIGxhc3Qga25vd24gcHJpY2UKICAgIC8vICAgICBzZWxmLnVzZXJzW3VzZXJfa2V5XSA9IHVzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2RlY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfZGVwb3NpdHMoCiAgICAvLyAgICAgc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIHVzZXJfaWQ6IEFjY291bnQsIGFtb3VudDogQmlnVUludAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQobWFya2V0X2lkKQogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlcl9rZXkgPSBzZWxmLl9nZXRfdXNlcl9rZXkodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgIHVzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSA+PSBhbW91bnQKICAgIC8vICAgICApLCAiSW5zdWZmaWNpZW50IGJhbGFuY2UgdG8gd2l0aGRyYXcgdGhpcyBhbW91bnQiCiAgICAvLyAgICAgdXNlci5zY2FsZWRfZGVwb3NpdHMgPSBhcmM0LlVJbnQyNTYodXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlIC0gYW1vdW50KQogICAgLy8gICAgIHVzZXIuZGVwb3NpdF9pbmRleCA9IG1hcmtldC5kZXBvc2l0X2luZGV4CiAgICAvLyAgICAgdXNlci5sYXN0X3VwZGF0ZV90aW1lID0gYXJjNC5VSW50NjQoR2xvYmFsLmxhdGVzdF90aW1lc3RhbXApCiAgICAvLyAgICAgdXNlci5sYXN0X3ByaWNlID0gbWFya2V0LnByaWNlICAjIFVwZGF0ZSB1c2VyJ3MgbGFzdCBrbm93biBwcmljZQogICAgLy8gICAgIHNlbGYudXNlcnNbdXNlcl9rZXldID0gdXNlci5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZGVjcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9ib3Jyb3dzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCB1c2VyX2lkOiBBY2NvdW50LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgbWFya2V0X2lkKQogICAgLy8gICAgIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICB1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSA+PSBhbW91bnQKICAgIC8vICAgICApLCAiSW5zdWZmaWNpZW50IGJhbGFuY2UgdG8gcmVwYXkgdGhpcyBhbW91bnQiCiAgICAvLyAgICAgdXNlci5zY2FsZWRfYm9ycm93cyA9IGFyYzQuVUludDI1Nih1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAtIGFtb3VudCkKICAgIC8vICAgICB1c2VyLmJvcnJvd19pbmRleCA9IG1hcmtldC5ib3Jyb3dfaW5kZXgKICAgIC8vICAgICB1c2VyLmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vICAgICB1c2VyLmxhc3RfcHJpY2UgPSBtYXJrZXQucHJpY2UgICMgVXBkYXRlIHVzZXIncyBsYXN0IGtub3duIHByaWNlCiAgICAvLyAgICAgc2VsZi51c2Vyc1t1c2VyX2tleV0gPSB1c2VyLmNvcHkoKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBjcmVhdGVfbWFya2V0KAogICAgLy8gICAgIHNlbGYsCiAgICAvLyAgICAgdG9rZW5faWQ6IGFyYzQuVUludDY0LAogICAgLy8gICAgIGNvbGxhdGVyYWxfZmFjdG9yOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBsaXF1aWRhdGlvbl90aHJlc2hvbGQ6IGFyYzQuVUludDY0LAogICAgLy8gICAgIHJlc2VydmVfZmFjdG9yOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBib3Jyb3dfcmF0ZTogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgc2xvcGU6IGFyYzQuVUludDY0LAogICAgLy8gICAgIG1heF90b3RhbF9kZXBvc2l0czogYXJjNC5VSW50MjU2LAogICAgLy8gICAgIG1heF90b3RhbF9ib3Jyb3dzOiBhcmM0LlVJbnQyNTYsCiAgICAvLyAgICAgbGlxdWlkYXRpb25fYm9udXM6IGFyYzQuVUludDY0LAogICAgLy8gICAgIGNsb3NlX2ZhY3RvcjogYXJjNC5VSW50NjQsCiAgICAvLyApIC0+IGFyYzQuVUludDY0OgogICAgLy8gICAgIHNlbGYuX29ubHlfb3duZXIoKQogICAgLy8gICAgIGFzc2VydCBub3Qgc2VsZi5faXNfcGF1c2VkKCksICJQcm90b2NvbCBpcyBwYXVzZWQiCiAgICAvLyAgICAgcmV0dXJuIGFyYzQuVUludDY0KAogICAgLy8gICAgICAgICBzZWxmLl9jcmVhdGVfbWFya2V0KAogICAgLy8gICAgICAgICAgICAgdG9rZW5faWQubmF0aXZlLAogICAgLy8gICAgICAgICAgICAgTWFya2V0RGF0YSgKICAgIC8vICAgICAgICAgICAgICAgICBwYXVzZWQ9YXJjNC5Cb29sKFRydWUpLCAgIyBTdGFydCBwYXVzZWQgdW50aWwgcHJpY2UgaXMgc2V0CiAgICAvLyAgICAgICAgICAgICAgICAgbWF4X3RvdGFsX2RlcG9zaXRzPW1heF90b3RhbF9kZXBvc2l0cywKICAgIC8vICAgICAgICAgICAgICAgICBtYXhfdG90YWxfYm9ycm93cz1tYXhfdG90YWxfYm9ycm93cywKICAgIC8vICAgICAgICAgICAgICAgICBsaXF1aWRhdGlvbl9ib251cz1saXF1aWRhdGlvbl9ib251cywKICAgIC8vICAgICAgICAgICAgICAgICBjb2xsYXRlcmFsX2ZhY3Rvcj1jb2xsYXRlcmFsX2ZhY3RvciwKICAgIC8vICAgICAgICAgICAgICAgICBsaXF1aWRhdGlvbl90aHJlc2hvbGQ9bGlxdWlkYXRpb25fdGhyZXNob2xkLAogICAgLy8gICAgICAgICAgICAgICAgIHJlc2VydmVfZmFjdG9yPXJlc2VydmVfZmFjdG9yLAogICAgLy8gICAgICAgICAgICAgICAgIGJvcnJvd19yYXRlPWJvcnJvd19yYXRlLAogICAgLy8gICAgICAgICAgICAgICAgIHNsb3BlPXNsb3BlLAogICAgLy8gICAgICAgICAgICAgICAgIHRvdGFsX3NjYWxlZF9kZXBvc2l0cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICAgICAgdG90YWxfc2NhbGVkX2JvcnJvd3M9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgICAgIGRlcG9zaXRfaW5kZXg9YXJjNC5VSW50MjU2KFNDQUxFKSwgICMgU3RhcnQgYXQgU0NBTEUgKDEuMCkKICAgIC8vICAgICAgICAgICAgICAgICBib3Jyb3dfaW5kZXg9YXJjNC5VSW50MjU2KFNDQUxFKSwgICMgU3RhcnQgYXQgU0NBTEUgKDEuMCkKICAgIC8vICAgICAgICAgICAgICAgICBsYXN0X3VwZGF0ZV90aW1lPWFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKSwKICAgIC8vICAgICAgICAgICAgICAgICByZXNlcnZlcz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICAgICAgcHJpY2U9YXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICAgICAgICAgICAgICAwCiAgICAvLyAgICAgICAgICAgICAgICAgKSwgICMgUHJpY2UgbXVzdCBiZSBzZXQgYmVmb3JlIG1hcmtldCBjYW4gYmUgdXNlZAogICAgLy8gICAgICAgICAgICAgICAgIG50b2tlbl9pZD1hcmM0LlVJbnQ2NCgwKSwgICMgV2lsbCBiZSBzZXQgZHVyaW5nIHRva2VuIGluaXRpYWxpemF0aW9uCiAgICAvLyAgICAgICAgICAgICAgICAgY2xvc2VfZmFjdG9yPWNsb3NlX2ZhY3RvciwKICAgIC8vICAgICAgICAgICAgICksCiAgICAvLyAgICAgICAgICkKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2NyZWF0ZV9tYXJrZXQoc2VsZiwgdG9rZW5faWQ6IFVJbnQ2NCwgbWFya2V0X2RhdGE6IE1hcmtldERhdGEpIC0+IFVJbnQ2NDoKICAgIC8vICAgICBhc3NlcnQgbm90IHRva2VuX2lkIGluIHNlbGYubWFya2V0cywgIk1hcmtldCBhbHJlYWR5IGV4aXN0cyIKICAgIC8vICAgICBwYXltZW50ID0gcmVxdWlyZV9wYXltZW50KFR4bi5zZW5kZXIpCiAgICAvLyAgICAgYXNzZXJ0ICgKICAgIC8vICAgICAgICAgcGF5bWVudCA+PSBzZWxmLl9jcmVhdGVfbWFya2V0X2Nvc3QoKQogICAgLy8gICAgICksICJpbnN1ZmZpY2llbnQgcGF5bWVudCBmb3IgY3JlYXRlIG1hcmtldCIKICAgIC8vICAgICBjb21waWxlZCA9IGNvbXBpbGVfY29udHJhY3QoTlRva2VuLCBleHRyYV9wcm9ncmFtX3BhZ2VzPTApICAjIG5vIGV4dHJhIHBhZ2VzCiAgICAvLyAgICAgYmFzZV9hcHAgPSBhcmM0LmFyYzRfY3JlYXRlKE5Ub2tlbiwgY29tcGlsZWQ9Y29tcGlsZWQpLmNyZWF0ZWRfYXBwCiAgICAvLyAgICAgYm9vdHN0cmFwNjRfY29zdCwgdHhuMSA9IGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIE5Ub2tlbi5ib290c3RyYXA2NF9jb3N0LAogICAgLy8gICAgICAgICBhcHBfaWQ9YmFzZV9hcHAsCiAgICAvLyAgICAgKQogICAgLy8gICAgIGl0eG4uUGF5bWVudCgKICAgIC8vICAgICAgICAgcmVjZWl2ZXI9YmFzZV9hcHAuYWRkcmVzcywgYW1vdW50PWJvb3RzdHJhcDY0X2Nvc3QubmF0aXZlLCBmZWU9MAogICAgLy8gICAgICkuc3VibWl0KCkKICAgIC8vICAgICBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgICAgICBOVG9rZW4uYm9vdHN0cmFwNjQsCiAgICAvLyAgICAgICAgIGFyYzQuVUludDY0KHRva2VuX2lkKSwKICAgIC8vICAgICAgICAgYXBwX2lkPWJhc2VfYXBwLAogICAgLy8gICAgICkKICAgIC8vICAgICBtYXJrZXRfZGF0YS5udG9rZW5faWQgPSBhcmM0LlVJbnQ2NChiYXNlX2FwcC5pZCkKICAgIC8vICAgICBzZWxmLm1hcmtldHNbdG9rZW5faWRdID0gbWFya2V0X2RhdGEuY29weSgpCiAgICAvLyAgICAgYXJjNC5lbWl0KAogICAgLy8gICAgICAgICBNYXJrZXRDcmVhdGVkKGFyYzQuVUludDY0KHRva2VuX2lkKSwgYXJjNC5VSW50NjQoYmFzZV9hcHAuaWQpLCBtYXJrZXRfZGF0YSkKICAgIC8vICAgICApCiAgICAvLyAgICAgcmV0dXJuIGJhc2VfYXBwLmlkCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZChyZWFkb25seT1UcnVlKQogICAgLy8gZGVmIGNyZWF0ZV9tYXJrZXRfY29zdChzZWxmKSAtPiBhcmM0LlVJbnQ2NDoKICAgIC8vICAgICByZXR1cm4gYXJjNC5VSW50NjQoc2VsZi5fY3JlYXRlX21hcmtldF9jb3N0KCkpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2NyZWF0ZV9tYXJrZXRfY29zdChzZWxmKSAtPiBVSW50NjQ6CiAgICAvLyAgICAgcmV0dXJuIFVJbnQ2NCgxXzAwMF8wMDApCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZChyZWFkb25seT1UcnVlKQogICAgLy8gZGVmIGdldF9tYXJrZXQoc2VsZiwgdG9rZW5faWQ6IGFyYzQuVUludDY0KSAtPiBNYXJrZXREYXRhOgogICAgLy8gICAgIHJldHVybiBzZWxmLl9nZXRfbWFya2V0KHRva2VuX2lkLm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X21hcmtldChzZWxmLCB0b2tlbl9pZDogVUludDY0KSAtPiBNYXJrZXREYXRhOgogICAgLy8gICAgIHJldHVybiBzZWxmLm1hcmtldHMuZ2V0KAogICAgLy8gICAgICAgICB0b2tlbl9pZCwKICAgIC8vICAgICAgICAgZGVmYXVsdD1NYXJrZXREYXRhKAogICAgLy8gICAgICAgICAgICAgcGF1c2VkPWFyYzQuQm9vbChUcnVlKSwKICAgIC8vICAgICAgICAgICAgIG1heF90b3RhbF9kZXBvc2l0cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBtYXhfdG90YWxfYm9ycm93cz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBsaXF1aWRhdGlvbl9ib251cz1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIGNvbGxhdGVyYWxfZmFjdG9yPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgbGlxdWlkYXRpb25fdGhyZXNob2xkPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgcmVzZXJ2ZV9mYWN0b3I9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICBib3Jyb3dfcmF0ZT1hcmM0LlVJbnQ2NCgwKSwKICAgIC8vICAgICAgICAgICAgIHNsb3BlPWFyYzQuVUludDY0KDApLAogICAgLy8gICAgICAgICAgICAgdG90YWxfc2NhbGVkX2RlcG9zaXRzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIHRvdGFsX3NjYWxlZF9ib3Jyb3dzPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGRlcG9zaXRfaW5kZXg9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgYm9ycm93X2luZGV4PWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGxhc3RfdXBkYXRlX3RpbWU9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICByZXNlcnZlcz1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBwcmljZT1hcmM0LlVJbnQyNTYoMCksCiAgICAvLyAgICAgICAgICAgICBudG9rZW5faWQ9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICAgICBjbG9zZV9mYWN0b3I9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICksCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBnZXRfbWFya2V0X3ByaWNlKHNlbGYsIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCkgLT4gYXJjNC5VSW50MjU2OgogICAgLy8gICAgIG1hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQodG9rZW5faWQubmF0aXZlKQogICAgLy8gICAgIHJldHVybiBtYXJrZXQucHJpY2UKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgZ2V0X21hcmtldF9udG9rZW5faWQoc2VsZiwgdG9rZW5faWQ6IGFyYzQuVUludDY0KSAtPiBhcmM0LlVJbnQ2NDoKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KHRva2VuX2lkLm5hdGl2ZSkKICAgIC8vICAgICByZXR1cm4gbWFya2V0Lm50b2tlbl9pZAogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBzZXRfbWFya2V0X3ByaWNlKHNlbGYsIHRva2VuX2lkOiBhcmM0LlVJbnQ2NCwgcHJpY2U6IGFyYzQuVUludDI1NikgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLl9vbmx5X293bmVyKCkKICAgIC8vICAgICBhc3NlcnQgbm90IHNlbGYuX2lzX3BhdXNlZCgpLCAiUHJvdG9jb2wgaXMgcGF1c2VkIgogICAgLy8gICAgIHNlbGYuX3NldF9tYXJrZXRfcHJpY2UodG9rZW5faWQubmF0aXZlLCBwcmljZS5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3NldF9tYXJrZXRfcHJpY2Uoc2VsZiwgdG9rZW5faWQ6IFVJbnQ2NCwgcHJpY2U6IEJpZ1VJbnQpIC0+IE5vbmU6CiAgICAvLyAgICAgYXNzZXJ0IHRva2VuX2lkIGluIHNlbGYubWFya2V0cywgIk1hcmtldCBkb2VzIG5vdCBleGlzdCIKICAgIC8vICAgICBhc3NlcnQgcHJpY2UgPiAwLCAiUHJpY2UgbXVzdCBiZSBwb3NpdGl2ZSIKICAgIC8vIAogICAgLy8gICAgIG1hcmtldCA9IHNlbGYubWFya2V0c1t0b2tlbl9pZF0uY29weSgpCiAgICAvLyAKICAgIC8vICAgICAjIFVucGF1c2UgdGhlIG1hcmtldCBvbiBmaXJzdCBwcmljZSBzZXQKICAgIC8vICAgICBpZiBtYXJrZXQucGF1c2VkIGFuZCBtYXJrZXQucHJpY2UgPT0gMDoKICAgIC8vICAgICAgICAgbWFya2V0LnBhdXNlZCA9IGFyYzQuQm9vbChGYWxzZSkKICAgIC8vIAogICAgLy8gICAgICMgU2NhbGUgdGhlIHByaWNlIGJ5IFNDQUxFIGludGVybmFsbHkgZm9yIHN0b3JhZ2UKICAgIC8vICAgICBtYXJrZXQucHJpY2UgPSBhcmM0LlVJbnQyNTYocHJpY2UgKiBTQ0FMRSkKICAgIC8vIAogICAgLy8gICAgIHNlbGYubWFya2V0c1t0b2tlbl9pZF0gPSBtYXJrZXQuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2luY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2RlcG9zaXRzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSArIGFtb3VudAogICAgLy8gICAgICkKICAgIC8vICAgICBtYXJrZXQubGFzdF91cGRhdGVfdGltZSA9IGFyYzQuVUludDY0KEdsb2JhbC5sYXRlc3RfdGltZXN0YW1wKQogICAgLy8gICAgIHNlbGYubWFya2V0c1ttYXJrZXRfaWRdID0gbWFya2V0LmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9kZWNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9kZXBvc2l0cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgYXNzZXJ0ICgKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cy5uYXRpdmUgPj0gYW1vdW50CiAgICAvLyAgICAgKSwgIkluc3VmZmljaWVudCBiYWxhbmNlIHRvIHdpdGhkcmF3IHRoaXMgYW1vdW50IgogICAgLy8gICAgIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMgPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlIC0gYW1vdW50CiAgICAvLyAgICAgKQogICAgLy8gICAgIHNlbGYubWFya2V0c1ttYXJrZXRfaWRdID0gbWFya2V0LmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9pbmNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9ib3Jyb3dzKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MgPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUgKyBhbW91bnQKICAgIC8vICAgICApCiAgICAvLyAgICAgbWFya2V0Lmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vICAgICBzZWxmLm1hcmtldHNbbWFya2V0X2lkXSA9IG1hcmtldC5jb3B5KCkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZGVjcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfYm9ycm93cygKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50CiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgYXNzZXJ0ICgKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzLm5hdGl2ZSA+PSBhbW91bnQKICAgIC8vICAgICApLCAiSW5zdWZmaWNpZW50IGJhbGFuY2UgdG8gd2l0aGRyYXcgdGhpcyBhbW91bnQiCiAgICAvLyAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlIC0gYW1vdW50CiAgICAvLyAgICAgKQogICAgLy8gICAgIHNlbGYubWFya2V0c1ttYXJrZXRfaWRdID0gbWFya2V0LmNvcHkoKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBwYXVzZV9tYXJrZXQoc2VsZiwgdG9rZW5faWQ6IGFyYzQuVUludDY0LCBwYXVzZTogYXJjNC5VSW50NjQpIC0+IE5vbmU6CiAgICAvLyAgICAgc2VsZi5fb25seV9vd25lcigpCiAgICAvLyAgICAgc2VsZi5fcGF1c2VfbWFya2V0KHRva2VuX2lkLm5hdGl2ZSwgcGF1c2UubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9wYXVzZV9tYXJrZXQoc2VsZiwgdG9rZW5faWQ6IFVJbnQ2NCwgcGF1c2U6IFVJbnQ2NCkgLT4gTm9uZToKICAgIC8vICAgICBhc3NlcnQgdG9rZW5faWQgaW4gc2VsZi5tYXJrZXRzLCAiTWFya2V0IGRvZXMgbm90IGV4aXN0IgogICAgLy8gICAgIHNlbGYubWFya2V0c1t0b2tlbl9pZF0ucGF1c2VkID0gYXJjNC5Cb29sKHBhdXNlID09IFVJbnQ2NCgxKSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfaXNfbWFya2V0X3BhdXNlZChzZWxmLCB0b2tlbl9pZDogVUludDY0KSAtPiBib29sOgogICAgLy8gICAgIHJldHVybiBzZWxmLl9nZXRfbWFya2V0KHRva2VuX2lkKS5wYXVzZWQubmF0aXZlID09IFVJbnQ2NCgxKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9hY2NydWVfaW50ZXJlc3Qoc2VsZiwgbWFya2V0X2lkOiBVSW50NjQpIC0+IE1hcmtldERhdGE6CiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgaWYgbWFya2V0LnBhdXNlZDoKICAgIC8vICAgICAgICAgcmV0dXJuIG1hcmtldAogICAgLy8gCiAgICAvLyAgICAgY3VycmVudF90aW1lID0gR2xvYmFsLmxhdGVzdF90aW1lc3RhbXAKICAgIC8vICAgICB0aW1lX2RlbHRhID0gY3VycmVudF90aW1lIC0gbWFya2V0Lmxhc3RfdXBkYXRlX3RpbWUubmF0aXZlCiAgICAvLyAgICAgaWYgdGltZV9kZWx0YSA8PSAwOgogICAgLy8gICAgICAgICByZXR1cm4gbWFya2V0CiAgICAvLyAKICAgIC8vICAgICAjIEZvciBzdG9rZW4gbWFya2V0IChib3Jyb3ctb25seSksIHVzZSBhIGZpeGVkIHV0aWxpemF0aW9uIHJhdGUgc2luY2UgdGhlcmUgYXJlIG5vIGRlcG9zaXRzCiAgICAvLyAgICAgaWYgbWFya2V0X2lkID09IHNlbGYuc3Rva2VuX2FwcF9pZDoKICAgIC8vICAgICAgICAgdXRpbGl6YXRpb24gPSBCaWdVSW50KDEwMDAwKSAgIyAxMDAlIHV0aWxpemF0aW9uIGZvciBib3Jyb3ctb25seSBtYXJrZXQKICAgIC8vICAgICBlbGlmIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlID09IDA6CiAgICAvLyAgICAgICAgIHJldHVybiBtYXJrZXQKICAgIC8vICAgICBlbHNlOgogICAgLy8gICAgICAgICB1dGlsaXphdGlvbiA9ICgKICAgIC8vICAgICAgICAgICAgIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUgKiAxMDAwMAogICAgLy8gICAgICAgICApIC8vIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlCiAgICAvLyAgICAgcmF0ZSA9IG1hcmtldC5ib3Jyb3dfcmF0ZS5uYXRpdmUgKyAobWFya2V0LnNsb3BlLm5hdGl2ZSAqIHV0aWxpemF0aW9uKSAvLyAxMDAwMAogICAgLy8gICAgIGludGVyZXN0ID0gKHJhdGUgKiBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlICogdGltZV9kZWx0YSkgLy8gKAogICAgLy8gICAgICAgICBzZWxmLnNlY29uZHNfcGVyX3llYXIgKiAxMDAwMAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gICAgICMgU3BlY2lhbCBoYW5kbGluZyBmb3Igc3Rva2VuIG1hcmtldCAtIGFsbCBpbnRlcmVzdCBnb2VzIHRvIHJlc2VydmVzCiAgICAvLyAgICAgaWYgbWFya2V0X2lkID09IHNlbGYuc3Rva2VuX2FwcF9pZDoKICAgIC8vICAgICAgICAgcHJvdG9jb2xfcG9ydGlvbiA9IGludGVyZXN0CiAgICAvLyAgICAgICAgIGRlcG9zaXRvcl9wb3J0aW9uID0gQmlnVUludCgwKQogICAgLy8gICAgIGVsc2U6CiAgICAvLyAgICAgICAgIHByb3RvY29sX3BvcnRpb24gPSAoCiAgICAvLyAgICAgICAgICAgICBpbnRlcmVzdCAqIGFyYzQuVUludDI1Ni5mcm9tX2J5dGVzKG1hcmtldC5yZXNlcnZlX2ZhY3Rvci5ieXRlcykubmF0aXZlCiAgICAvLyAgICAgICAgICkgLy8gMTAwMDAKICAgIC8vICAgICAgICAgaWYgcHJvdG9jb2xfcG9ydGlvbiA+IGludGVyZXN0OgogICAgLy8gICAgICAgICAgICAgcHJvdG9jb2xfcG9ydGlvbiA9IGludGVyZXN0CiAgICAvLyAgICAgICAgIGRlcG9zaXRvcl9wb3J0aW9uID0gaW50ZXJlc3QgLSBwcm90b2NvbF9wb3J0aW9uCiAgICAvLyAKICAgIC8vICAgICBpZiBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzID4gMDoKICAgIC8vICAgICAgICAgbWFya2V0LmRlcG9zaXRfaW5kZXggPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgICAgICBtYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUKICAgIC8vICAgICAgICAgICAgICsgKGRlcG9zaXRvcl9wb3J0aW9uICogU0NBTEUpIC8vIG1hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlCiAgICAvLyAgICAgICAgICkKICAgIC8vICAgICBpZiBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MgPiAwOgogICAgLy8gICAgICAgICBtYXJrZXQuYm9ycm93X2luZGV4ID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICAgICAgbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUKICAgIC8vICAgICAgICAgICAgICsgKGludGVyZXN0ICogU0NBTEUpIC8vIG1hcmtldC50b3RhbF9zY2FsZWRfYm9ycm93cy5uYXRpdmUKICAgIC8vICAgICAgICAgKQogICAgLy8gCiAgICAvLyAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2JvcnJvd3MubmF0aXZlICsgaW50ZXJlc3QKICAgIC8vICAgICApCiAgICAvLyAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cyA9IGFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKyBkZXBvc2l0b3JfcG9ydGlvbgogICAgLy8gICAgICkKICAgIC8vICAgICBtYXJrZXQucmVzZXJ2ZXMgPSBhcmM0LlVJbnQyNTYobWFya2V0LnJlc2VydmVzLm5hdGl2ZSArIHByb3RvY29sX3BvcnRpb24pCiAgICAvLyAgICAgbWFya2V0Lmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChjdXJyZW50X3RpbWUpCiAgICAvLyAKICAgIC8vICAgICBzZWxmLm1hcmtldHNbbWFya2V0X2lkXSA9IG1hcmtldC5jb3B5KCkKICAgIC8vICAgICByZXR1cm4gbWFya2V0LmNvcHkoKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF92YWxpZGF0ZV9tYXJrZXRfb3BlcmF0aW9uKAogICAgLy8gICAgIHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQsIGd1YXJkX3N0b2tlbjogYm9vbAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIGFzc2VydCBub3Qgc2VsZi5faXNfcGF1c2VkKCksICJQcm90b2NvbCBpcyBwYXVzZWQiCiAgICAvLyAgICAgYXNzZXJ0IG1hcmtldF9pZCBpbiBzZWxmLm1hcmtldHMsICJNYXJrZXQgZG9lcyBub3QgZXhpc3QiCiAgICAvLyAgICAgYXNzZXJ0IGFtb3VudCA+IDAsICJBbW91bnQgbXVzdCBiZSA+IDAiCiAgICAvLyAgICAgbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChtYXJrZXRfaWQpCiAgICAvLyAgICAgYXNzZXJ0IG5vdCBtYXJrZXQucGF1c2VkLCAiTWFya2V0IGlzIHBhdXNlZCIKICAgIC8vICAgICBpZiBndWFyZF9zdG9rZW46CiAgICAvLyAgICAgICAgIGFzc2VydCAoCiAgICAvLyAgICAgICAgICAgICBzZWxmLnN0b2tlbl9hcHBfaWQgIT0gbWFya2V0X2lkCiAgICAvLyAgICAgICAgICksICJDYW5ub3QgdXNlIHN0b2tlbiBtYXJrZXQgZm9yIHRoaXMgb3BlcmF0aW9uIgogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBkZXBvc2l0KHNlbGYsIG1hcmtldF9pZDogYXJjNC5VSW50NjQsIGFtb3VudDogYXJjNC5VSW50MjU2KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX2RlcG9zaXQobWFya2V0X2lkLm5hdGl2ZSwgYW1vdW50Lm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZGVwb3NpdChzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX3ZhbGlkYXRlX21hcmtldF9vcGVyYXRpb24obWFya2V0X2lkLCBhbW91bnQsIFRydWUpCiAgICAvLyAKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vICAgICBzY2FsZWRfYW1vdW50ID0gKGFtb3VudCAqIFNDQUxFKSAvLyBtYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICBtYXJrZXQubWF4X3RvdGFsX2RlcG9zaXRzLm5hdGl2ZQogICAgLy8gICAgICAgICA+PSBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSArIHNjYWxlZF9hbW91bnQKICAgIC8vICAgICApLCAiRGVwb3NpdCBjYXAgZXhjZWVkZWQiCiAgICAvLyAKICAgIC8vICAgICBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgICAgICBBUkMyMDBUb2tlbkludGVyZmFjZS5hcmMyMDBfdHJhbnNmZXJGcm9tLAogICAgLy8gICAgICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgICAgIGFyYzQuQWRkcmVzcyhHbG9iYWwuY3VycmVudF9hcHBsaWNhdGlvbl9hZGRyZXNzKSwKICAgIC8vICAgICAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgICAgIGFwcF9pZD1BcHBsaWNhdGlvbihtYXJrZXRfaWQpLAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcihUeG4uc2VuZGVyLCBtYXJrZXRfaWQpCiAgICAvLyAgICAgbmV3X21hcmtldCA9IHNlbGYuX2FjY3J1ZV9pbnRlcmVzdCgKICAgIC8vICAgICAgICAgbWFya2V0X2lkCiAgICAvLyAgICAgKSAgIyBHZXQgdXBkYXRlZCBtYXJrZXQgd2l0aCBhY2NydWVkIGludGVyZXN0CiAgICAvLyAgICAgc2NhbGVkX2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgYW1vdW50ICogU0NBTEUKICAgIC8vICAgICApIC8vIG5ld19tYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUgICMgQ2FsY3VsYXRlIHdpdGggbmV3IGluZGV4CiAgICAvLyAKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICBuZXdfbWFya2V0Lm1heF90b3RhbF9kZXBvc2l0cy5uYXRpdmUKICAgIC8vICAgICAgICAgPj0gbmV3X21hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlICsgc2NhbGVkX2Ftb3VudAogICAgLy8gICAgICksICJEZXBvc2l0IGNhcCBleGNlZWRlZCIKICAgIC8vIAogICAgLy8gICAgIHNlbGYuX2luY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfZGVwb3NpdHMoCiAgICAvLyAgICAgICAgIG1hcmtldF9pZCwgVHhuLnNlbmRlciwgc2NhbGVkX2Ftb3VudAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gICAgIHNlbGYuX2luY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2RlcG9zaXRzKG1hcmtldF9pZCwgc2NhbGVkX2Ftb3VudCkKICAgIC8vIAogICAgLy8gICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIE5Ub2tlbi5taW50LAogICAgLy8gICAgICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgICAgIGFyYzQuVUludDI1NihhbW91bnQpLAogICAgLy8gICAgICAgICBhcHBfaWQ9QXBwbGljYXRpb24obWFya2V0Lm50b2tlbl9pZC5uYXRpdmUpLAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gICAgIG9sZF9kZXBvc2l0X2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgdXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlICogbmV3X21hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZQogICAgLy8gICAgICkgLy8gU0NBTEUKICAgIC8vICAgICBuZXdfZGVwb3NpdF9hbW91bnQgPSBvbGRfZGVwb3NpdF9hbW91bnQgKyBhbW91bnQKICAgIC8vIAogICAgLy8gICAgIGlmIHVzZXIubGFzdF9wcmljZS5uYXRpdmUgPT0gMDoKICAgIC8vICAgICAgICAgb2xkX3ZhbHVlID0gKG9sZF9kZXBvc2l0X2Ftb3VudCAqIG5ld19tYXJrZXQucHJpY2UubmF0aXZlKSAvLyBTQ0FMRQogICAgLy8gICAgICAgICBuZXdfdmFsdWUgPSAobmV3X2RlcG9zaXRfYW1vdW50ICogbmV3X21hcmtldC5wcmljZS5uYXRpdmUpIC8vIFNDQUxFCiAgICAvLyAgICAgZWxzZToKICAgIC8vICAgICAgICAgb2xkX3ZhbHVlID0gKG9sZF9kZXBvc2l0X2Ftb3VudCAqIHVzZXIubGFzdF9wcmljZS5uYXRpdmUpIC8vIFNDQUxFCiAgICAvLyAgICAgICAgIG5ld192YWx1ZSA9IChuZXdfZGVwb3NpdF9hbW91bnQgKiBuZXdfbWFya2V0LnByaWNlLm5hdGl2ZSkgLy8gU0NBTEUKICAgIC8vIAogICAgLy8gICAgIHNlbGYuX3VwZGF0ZV9nbG9iYWxfY29sbGF0ZXJhbChUeG4uc2VuZGVyLCBtYXJrZXRfaWQsIG9sZF92YWx1ZSwgbmV3X3ZhbHVlKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiB3aXRoZHJhdyhzZWxmLCBtYXJrZXRfaWQ6IGFyYzQuVUludDY0LCBhbW91bnQ6IGFyYzQuVUludDI1NikgLT4gTm9uZToKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICBzZWxmLnN0b2tlbl9hcHBfaWQgIT0gbWFya2V0X2lkLm5hdGl2ZQogICAgLy8gICAgICksICJDYW5ub3QgZGVwb3NpdCBpbnRvIHN0b2tlbiBtYXJrZXQiCiAgICAvLyAgICAgZW5zdXJlX2J1ZGdldCg3MDAsIE9wVXBGZWVTb3VyY2UuR3JvdXBDcmVkaXQpCiAgICAvLyAgICAgc2VsZi5fd2l0aGRyYXcobWFya2V0X2lkLm5hdGl2ZSwgYW1vdW50Lm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfd2l0aGRyYXcoc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIGFtb3VudDogQmlnVUludCkgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLl92YWxpZGF0ZV9tYXJrZXRfb3BlcmF0aW9uKG1hcmtldF9pZCwgYW1vdW50LCBUcnVlKQogICAgLy8gCiAgICAvLyAgICAgbmV3X21hcmtldCA9IHNlbGYuX2FjY3J1ZV9pbnRlcmVzdChtYXJrZXRfaWQpCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKFR4bi5zZW5kZXIsIG1hcmtldF9pZCkKICAgIC8vIAogICAgLy8gICAgIHNjYWxlZF9hbW91bnQgPSAoYW1vdW50ICogU0NBTEUpIC8vIG5ld19tYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICB1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgPj0gc2NhbGVkX2Ftb3VudAogICAgLy8gICAgICksICJJbnN1ZmZpY2llbnQgYmFsYW5jZSB0byB3aXRoZHJhdyB0aGlzIGFtb3VudCIKICAgIC8vICAgICB1bmRlcmx5aW5nX2Ftb3VudCA9IChzY2FsZWRfYW1vdW50ICogbmV3X21hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZSkgLy8gU0NBTEUKICAgIC8vIAogICAgLy8gICAgIGdsb2JhbF91c2VyID0gc2VsZi5fZ2V0X2dsb2JhbF91c2VyKFR4bi5zZW5kZXIpCiAgICAvLyAgICAgd2l0aGRyYXdfdmFsdWUgPSAoCiAgICAvLyAgICAgICAgIHVuZGVybHlpbmdfYW1vdW50ICogbmV3X21hcmtldC5wcmljZS5uYXRpdmUKICAgIC8vICAgICApIC8vIFNDQUxFICAjIFVzZSB1bmRlcmx5aW5nX2Ftb3VudCBhbmQgbmV3X21hcmtldCBwcmljZQogICAgLy8gCiAgICAvLyAgICAgaWYgZ2xvYmFsX3VzZXIudG90YWxfYm9ycm93X3ZhbHVlID4gMDoKICAgIC8vICAgICAgICAgcmVtYWluaW5nX2NvbGxhdGVyYWwgPSAoCiAgICAvLyAgICAgICAgICAgICBnbG9iYWxfdXNlci50b3RhbF9jb2xsYXRlcmFsX3ZhbHVlLm5hdGl2ZSAtIHdpdGhkcmF3X3ZhbHVlCiAgICAvLyAgICAgICAgICkKICAgIC8vICAgICAgICAgYXNzZXJ0IGdsb2JhbF91c2VyLnRvdGFsX2JvcnJvd192YWx1ZS5uYXRpdmUgPD0gKAogICAgLy8gICAgICAgICAgICAgcmVtYWluaW5nX2NvbGxhdGVyYWwgKiBCaWdVSW50KG5ld19tYXJrZXQuY29sbGF0ZXJhbF9mYWN0b3IubmF0aXZlKQogICAgLy8gICAgICAgICApIC8vIEJpZ1VJbnQoMTAwMDApLCAiV2l0aGRyYXdhbCB3b3VsZCBwdXQgYm9ycm93cyBhdCByaXNrIgogICAgLy8gCiAgICAvLyAgICAgc2VsZi5fZGVjcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9kZXBvc2l0cygKICAgIC8vICAgICAgICAgbWFya2V0X2lkLCBUeG4uc2VuZGVyLCBzY2FsZWRfYW1vdW50CiAgICAvLyAgICAgKQogICAgLy8gICAgIHNlbGYuX2RlY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2RlcG9zaXRzKG1hcmtldF9pZCwgc2NhbGVkX2Ftb3VudCkKICAgIC8vIAogICAgLy8gICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIE5Ub2tlbi5idXJuX2Zyb20sCiAgICAvLyAgICAgICAgIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIC8vICAgICAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgICAgIGFwcF9pZD1BcHBsaWNhdGlvbihuZXdfbWFya2V0Lm50b2tlbl9pZC5uYXRpdmUpLAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIEFSQzIwMFRva2VuSW50ZXJmYWNlLmFyYzIwMF90cmFuc2ZlciwKICAgIC8vICAgICAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgICAgICBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgICAgICB1bmRlcmx5aW5nX2Ftb3VudAogICAgLy8gICAgICAgICApLCAgIyBVc2UgdW5kZXJseWluZ19hbW91bnQgd2hpY2ggaW5jbHVkZXMgaW50ZXJlc3QKICAgIC8vICAgICAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldF9pZCksICAjIFRyYW5zZmVyIGZyb20gdW5kZXJseWluZyB0b2tlbiBjb250cmFjdAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gICAgIG9sZF9kZXBvc2l0X2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgdXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlICogbmV3X21hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZQogICAgLy8gICAgICkgLy8gU0NBTEUKICAgIC8vICAgICBuZXdfZGVwb3NpdF9hbW91bnQgPSBvbGRfZGVwb3NpdF9hbW91bnQgLSB1bmRlcmx5aW5nX2Ftb3VudAogICAgLy8gCiAgICAvLyAgICAgIyBVc2UgY3VycmVudCBtYXJrZXQgcHJpY2UgaWYgdXNlciBkb2Vzbid0IGhhdmUgYSBwcmV2aW91cyBwcmljZQogICAgLy8gICAgIHByaWNlX2Zvcl9vbGQgPSAoCiAgICAvLyAgICAgICAgIHVzZXIubGFzdF9wcmljZS5uYXRpdmUKICAgIC8vICAgICAgICAgaWYgdXNlci5sYXN0X3ByaWNlLm5hdGl2ZSA+IDAKICAgIC8vICAgICAgICAgZWxzZSBuZXdfbWFya2V0LnByaWNlLm5hdGl2ZQogICAgLy8gICAgICkKICAgIC8vICAgICBwcmljZV9mb3JfbmV3ID0gbmV3X21hcmtldC5wcmljZS5uYXRpdmUKICAgIC8vIAogICAgLy8gICAgIG9sZF92YWx1ZSA9ICgKICAgIC8vICAgICAgICAgb2xkX2RlcG9zaXRfYW1vdW50ICogcHJpY2VfZm9yX29sZAogICAgLy8gICAgICkgLy8gU0NBTEUgICMgVXNlIHVzZXIncyBsYXN0IGtub3duIHByaWNlIG9yIGN1cnJlbnQgcHJpY2UKICAgIC8vICAgICBuZXdfdmFsdWUgPSAoCiAgICAvLyAgICAgICAgIG5ld19kZXBvc2l0X2Ftb3VudCAqIHByaWNlX2Zvcl9uZXcKICAgIC8vICAgICApIC8vIFNDQUxFICAjIFVzZSBjdXJyZW50IG1hcmtldCBwcmljZQogICAgLy8gICAgIHNlbGYuX3VwZGF0ZV9nbG9iYWxfY29sbGF0ZXJhbCgKICAgIC8vICAgICAgICAgVHhuLnNlbmRlciwKICAgIC8vICAgICAgICAgbWFya2V0X2lkLAogICAgLy8gICAgICAgICBvbGRfdmFsdWUsICAjIG9sZCBVU0QgdmFsdWUKICAgIC8vICAgICAgICAgbmV3X3ZhbHVlLCAgIyBuZXcgVVNEIHZhbHVlCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyAjIHdpdGhkcmF3IGNvc3QgOTAwMDAwCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGJvcnJvdyhzZWxmLCBtYXJrZXRfaWQ6IGFyYzQuVUludDY0LCBhbW91bnQ6IGFyYzQuVUludDI1NikgLT4gTm9uZToKICAgIC8vICAgICBlbnN1cmVfYnVkZ2V0KDE0MDAsIE9wVXBGZWVTb3VyY2UuR3JvdXBDcmVkaXQpCiAgICAvLyAgICAgc2VsZi5fYm9ycm93KG1hcmtldF9pZC5uYXRpdmUsIGFtb3VudC5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2JvcnJvdyhzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX3ZhbGlkYXRlX21hcmtldF9vcGVyYXRpb24obWFya2V0X2lkLCBhbW91bnQsIEZhbHNlKQogICAgLy8gCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKFR4bi5zZW5kZXIsIG1hcmtldF9pZCkKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9nZXRfbWFya2V0KG1hcmtldF9pZCkKICAgIC8vIAogICAgLy8gICAgIHBheW1lbnQgPSByZXF1aXJlX3BheW1lbnQoVHhuLnNlbmRlcikKICAgIC8vICAgICBhc3NlcnQgcGF5bWVudCA+PSBVSW50NjQoMTAwMDAwKSwgIlBheW1lbnQgYW1vdW50IG11c3QgYmUgPj0gMC4xIgogICAgLy8gCiAgICAvLyAgICAgdG90YWxfYm9ycm93cyA9ICgKICAgIC8vICAgICAgICAgbWFya2V0LnRvdGFsX3NjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAqIG1hcmtldC5ib3Jyb3dfaW5kZXgubmF0aXZlCiAgICAvLyAgICAgKSAvLyBTQ0FMRQogICAgLy8gICAgIGFzc2VydCBtYXJrZXQubWF4X3RvdGFsX2JvcnJvd3MubmF0aXZlID49IHRvdGFsX2JvcnJvd3MgKyBhbW91bnQsICJCb3Jyb3cgY2FwIgogICAgLy8gCiAgICAvLyAgICAgZ2xvYmFsX3VzZXIgPSBzZWxmLl9nZXRfZ2xvYmFsX3VzZXIoVHhuLnNlbmRlcikKICAgIC8vICAgICBuZXdfYm9ycm93X3ZhbHVlID0gKGFtb3VudCAqIG1hcmtldC5wcmljZS5uYXRpdmUpIC8vIFNDQUxFCiAgICAvLyAgICAgdG90YWxfYm9ycm93X3ZhbHVlID0gZ2xvYmFsX3VzZXIudG90YWxfYm9ycm93X3ZhbHVlLm5hdGl2ZSArIG5ld19ib3Jyb3dfdmFsdWUKICAgIC8vIAogICAgLy8gICAgIGFzc2VydCB0b3RhbF9ib3Jyb3dfdmFsdWUgPD0gKAogICAgLy8gICAgICAgICBnbG9iYWxfdXNlci50b3RhbF9jb2xsYXRlcmFsX3ZhbHVlLm5hdGl2ZQogICAgLy8gICAgICAgICAqIEJpZ1VJbnQobWFya2V0LmNvbGxhdGVyYWxfZmFjdG9yLm5hdGl2ZSkKICAgIC8vICAgICApIC8vIEJpZ1VJbnQoMTAwMDApLCAiSW5zdWZmaWNpZW50IGNvbGxhdGVyYWwgYWNyb3NzIG1hcmtldHMiCiAgICAvLyAKICAgIC8vICAgICBuZXdfbWFya2V0ID0gc2VsZi5fYWNjcnVlX2ludGVyZXN0KG1hcmtldF9pZCkKICAgIC8vICAgICBzY2FsZWRfYW1vdW50ID0gKGFtb3VudCAqIFNDQUxFKSAvLyBuZXdfbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUKICAgIC8vIAogICAgLy8gICAgIHNlbGYuX2luY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfYm9ycm93cyhtYXJrZXRfaWQsIFR4bi5zZW5kZXIsIHNjYWxlZF9hbW91bnQpCiAgICAvLyAgICAgc2VsZi5faW5jcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfYm9ycm93cyhtYXJrZXRfaWQsIHNjYWxlZF9hbW91bnQpCiAgICAvLyAKICAgIC8vICAgICBvbGRfYm9ycm93X2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgdXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgKiBtYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZSAvLyBTQ0FMRQogICAgLy8gICAgICkKICAgIC8vICAgICBuZXdfYm9ycm93X2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgKHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlICsgc2NhbGVkX2Ftb3VudCkKICAgIC8vICAgICAgICAgKiBuZXdfbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUKICAgIC8vICAgICAgICAgLy8gU0NBTEUKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vICAgICAjIFVzZSBjdXJyZW50IG1hcmtldCBwcmljZSBpZiB1c2VyIGRvZXNuJ3QgaGF2ZSBhIHByZXZpb3VzIHByaWNlCiAgICAvLyAgICAgcHJpY2VfZm9yX29sZCA9ICgKICAgIC8vICAgICAgICAgdXNlci5sYXN0X3ByaWNlLm5hdGl2ZQogICAgLy8gICAgICAgICBpZiB1c2VyLmxhc3RfcHJpY2UubmF0aXZlID4gMAogICAgLy8gICAgICAgICBlbHNlIG1hcmtldC5wcmljZS5uYXRpdmUKICAgIC8vICAgICApCiAgICAvLyAgICAgcHJpY2VfZm9yX25ldyA9IG5ld19tYXJrZXQucHJpY2UubmF0aXZlCiAgICAvLyAKICAgIC8vICAgICBvbGRfdmFsdWUgPSAob2xkX2JvcnJvd19hbW91bnQgKiBwcmljZV9mb3Jfb2xkKSAvLyBTQ0FMRQogICAgLy8gICAgIG5ld192YWx1ZSA9IChuZXdfYm9ycm93X2Ftb3VudCAqIHByaWNlX2Zvcl9uZXcpIC8vIFNDQUxFCiAgICAvLyAgICAgc2VsZi5fdXBkYXRlX2dsb2JhbF9ib3Jyb3dzKAogICAgLy8gICAgICAgICBUeG4uc2VuZGVyLAogICAgLy8gICAgICAgICBtYXJrZXRfaWQsCiAgICAvLyAgICAgICAgIG9sZF92YWx1ZSwgICMgb2xkIFVTRCB2YWx1ZQogICAgLy8gICAgICAgICBuZXdfdmFsdWUsICAjIG5ldyBVU0QgdmFsdWUKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vICAgICAjIGlmIHN0b2tlbiwgbWludCBzdG9rZW4KICAgIC8vICAgICBpZiBtYXJrZXRfaWQgPT0gc2VsZi5zdG9rZW5fYXBwX2lkOgogICAgLy8gICAgICAgICBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgICAgICAgICAgU1Rva2VuLm1pbnQsCiAgICAvLyAgICAgICAgICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgICAgICAgICBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIC8vICAgICAgICAgICAgIGFwcF9pZD1BcHBsaWNhdGlvbihtYXJrZXRfaWQpLAogICAgLy8gICAgICAgICApCiAgICAvLyAgICAgICAgIGl0eG4uUGF5bWVudCgKICAgIC8vICAgICAgICAgICAgIHJlY2VpdmVyPUFwcGxpY2F0aW9uKG1hcmtldF9pZCkuYWRkcmVzcywgYW1vdW50PTEwMDAwMCwgZmVlPTAKICAgIC8vICAgICAgICAgKS5zdWJtaXQoKQogICAgLy8gICAgICMgaWYgYVRva2VuLCB0cmFuc2ZlciBhVG9rZW4KICAgIC8vICAgICBlbHNlOgogICAgLy8gICAgICAgICBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgICAgICAgICAgQVJDMjAwVG9rZW5JbnRlcmZhY2UuYXJjMjAwX3RyYW5zZmVyLAogICAgLy8gICAgICAgICAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgICAgICAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgICAgICAgICBhcHBfaWQ9QXBwbGljYXRpb24obWFya2V0X2lkKSwKICAgIC8vICAgICAgICAgKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBnZXRfc2NhbGVkX3JlcGF5X2Ftb3VudCgKICAgIC8vICAgICBzZWxmLCBtYXJrZXRfaWQ6IGFyYzQuVUludDY0LCBhbW91bnQ6IGFyYzQuVUludDI1NgogICAgLy8gKSAtPiBhcmM0LlVJbnQyNTY6CiAgICAvLyAgICAgcmV0dXJuIGFyYzQuVUludDI1NigKICAgIC8vICAgICAgICAgc2VsZi5fZ2V0X3NjYWxlZF9yZXBheV9hbW91bnQobWFya2V0X2lkLm5hdGl2ZSwgYW1vdW50Lm5hdGl2ZSkKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2dldF9zY2FsZWRfcmVwYXlfYW1vdW50KHNlbGYsIG1hcmtldF9pZDogVUludDY0LCBhbW91bnQ6IEJpZ1VJbnQpIC0+IEJpZ1VJbnQ6CiAgICAvLyAgICAgbmV3X21hcmtldCA9IHNlbGYuX2FjY3J1ZV9pbnRlcmVzdChtYXJrZXRfaWQpCiAgICAvLyAgICAgcmV0dXJuIChhbW91bnQgKiBTQ0FMRSkgLy8gbmV3X21hcmtldC5ib3Jyb3dfaW5kZXgubmF0aXZlCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIHJlcGF5KHNlbGYsIG1hcmtldF9pZDogYXJjNC5VSW50NjQsIGFtb3VudDogYXJjNC5VSW50MjU2KSAtPiBOb25lOgogICAgLy8gICAgIGVuc3VyZV9idWRnZXQoMTQwMCwgT3BVcEZlZVNvdXJjZS5Hcm91cENyZWRpdCkKICAgIC8vICAgICBzZWxmLl9yZXBheShtYXJrZXRfaWQubmF0aXZlLCBhbW91bnQubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9yZXBheShzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX3ZhbGlkYXRlX21hcmtldF9vcGVyYXRpb24obWFya2V0X2lkLCBhbW91bnQsIEZhbHNlKQogICAgLy8gCiAgICAvLyAgICAgdXNlciA9IHNlbGYuX2dldF91c2VyKFR4bi5zZW5kZXIsIG1hcmtldF9pZCkKICAgIC8vICAgICBuZXdfbWFya2V0ID0gc2VsZi5fYWNjcnVlX2ludGVyZXN0KG1hcmtldF9pZCkKICAgIC8vIAogICAgLy8gICAgIHNjYWxlZF9hbW91bnQgPSAoYW1vdW50ICogU0NBTEUpIC8vIG5ld19tYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZQogICAgLy8gICAgIGFzc2VydCB1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSA+PSBzY2FsZWRfYW1vdW50LCAiUmVwYXkgYW1vdW50IGV4Y2VlZHMgZGVidCIKICAgIC8vIAogICAgLy8gICAgIGlmIG1hcmtldF9pZCA9PSBzZWxmLnN0b2tlbl9hcHBfaWQ6CiAgICAvLyAgICAgICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgICAgICBTVG9rZW4uYnVybl9mcm9tLAogICAgLy8gICAgICAgICAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgICAgICAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgICAgICAgICBhcHBfaWQ9QXBwbGljYXRpb24obWFya2V0X2lkKSwKICAgIC8vICAgICAgICAgKQogICAgLy8gICAgIGVsc2U6CiAgICAvLyAgICAgICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgICAgICBBUkMyMDBUb2tlbkludGVyZmFjZS5hcmMyMDBfdHJhbnNmZXJGcm9tLAogICAgLy8gICAgICAgICAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgICAgICAgICAgYXJjNC5BZGRyZXNzKEdsb2JhbC5jdXJyZW50X2FwcGxpY2F0aW9uX2FkZHJlc3MpLAogICAgLy8gICAgICAgICAgICAgYXJjNC5VSW50MjU2KGFtb3VudCksCiAgICAvLyAgICAgICAgICAgICBhcHBfaWQ9QXBwbGljYXRpb24obWFya2V0X2lkKSwKICAgIC8vICAgICAgICAgKQogICAgLy8gCiAgICAvLyAgICAgc2VsZi5fZGVjcmVtZW50X21hcmtldF91c2VyX3NjYWxlZF9ib3Jyb3dzKG1hcmtldF9pZCwgVHhuLnNlbmRlciwgc2NhbGVkX2Ftb3VudCkKICAgIC8vICAgICBzZWxmLl9kZWNyZW1lbnRfbWFya2V0X3RvdGFsX3NjYWxlZF9ib3Jyb3dzKG1hcmtldF9pZCwgc2NhbGVkX2Ftb3VudCkKICAgIC8vIAogICAgLy8gICAgIG9sZF9ib3Jyb3dfYW1vdW50ID0gKAogICAgLy8gICAgICAgICB1c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAqIG5ld19tYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZSAvLyBTQ0FMRQogICAgLy8gICAgICkKICAgIC8vICAgICBuZXdfYm9ycm93X2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgKHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlIC0gc2NhbGVkX2Ftb3VudCkKICAgIC8vICAgICAgICAgKiBuZXdfbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUKICAgIC8vICAgICAgICAgLy8gU0NBTEUKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vICAgICAjIFVzZSBjdXJyZW50IG1hcmtldCBwcmljZSBpZiB1c2VyIGRvZXNuJ3QgaGF2ZSBhIHByZXZpb3VzIHByaWNlCiAgICAvLyAgICAgcHJpY2VfZm9yX29sZCA9ICgKICAgIC8vICAgICAgICAgdXNlci5sYXN0X3ByaWNlLm5hdGl2ZQogICAgLy8gICAgICAgICBpZiB1c2VyLmxhc3RfcHJpY2UubmF0aXZlID4gMAogICAgLy8gICAgICAgICBlbHNlIG5ld19tYXJrZXQucHJpY2UubmF0aXZlCiAgICAvLyAgICAgKQogICAgLy8gICAgIHByaWNlX2Zvcl9uZXcgPSBuZXdfbWFya2V0LnByaWNlLm5hdGl2ZQogICAgLy8gCiAgICAvLyAgICAgb2xkX3ZhbHVlID0gKG9sZF9ib3Jyb3dfYW1vdW50ICogcHJpY2VfZm9yX29sZCkgLy8gU0NBTEUKICAgIC8vICAgICBuZXdfdmFsdWUgPSAobmV3X2JvcnJvd19hbW91bnQgKiBwcmljZV9mb3JfbmV3KSAvLyBTQ0FMRQogICAgLy8gICAgIHNlbGYuX3VwZGF0ZV9nbG9iYWxfYm9ycm93cygKICAgIC8vICAgICAgICAgVHhuLnNlbmRlciwKICAgIC8vICAgICAgICAgbWFya2V0X2lkLAogICAgLy8gICAgICAgICBvbGRfdmFsdWUsICAjIG9sZCBVU0QgdmFsdWUKICAgIC8vICAgICAgICAgbmV3X3ZhbHVlLCAgIyBuZXcgVVNEIHZhbHVlCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiByZWRlZW0oc2VsZiwgbWFya2V0X2lkOiBhcmM0LlVJbnQ2NCwgYW1vdW50OiBhcmM0LlVJbnQyNTYpIC0+IE5vbmU6CiAgICAvLyAgICAgZW5zdXJlX2J1ZGdldCgxNDAwLCBPcFVwRmVlU291cmNlLkdyb3VwQ3JlZGl0KQogICAgLy8gICAgIHNlbGYuX3JlZGVlbShtYXJrZXRfaWQubmF0aXZlLCBhbW91bnQubmF0aXZlKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9yZWRlZW0oc2VsZiwgbWFya2V0X2lkOiBVSW50NjQsIGFtb3VudDogQmlnVUludCkgLT4gTm9uZToKICAgIC8vICAgICBzZWxmLl92YWxpZGF0ZV9tYXJrZXRfb3BlcmF0aW9uKG1hcmtldF9pZCwgYW1vdW50LCBUcnVlKQogICAgLy8gCiAgICAvLyAgICAgYXNzZXJ0IG5vdCBzZWxmLl9oYXNfcG9zaXRpb24oCiAgICAvLyAgICAgICAgIFR4bi5zZW5kZXIsIG1hcmtldF9pZAogICAgLy8gICAgICksICJDYW5ub3QgbWludC9yZWRlZW0gd2hlbiB1c2VyIGhhcyB0cmFja2VkIGRlcG9zaXQgcG9zaXRpb24iCiAgICAvLyAKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9hY2NydWVfaW50ZXJlc3QobWFya2V0X2lkKQogICAgLy8gCiAgICAvLyAgICAgYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICAgICAgTlRva2VuLmJ1cm5fZnJvbSwKICAgIC8vICAgICAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgICAgICBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIC8vICAgICAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldC5udG9rZW5faWQubmF0aXZlKSwKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vICAgICBzY2FsZWRfYW1vdW50ID0gKGFtb3VudCAqIFNDQUxFKSAvLyBtYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICBtYXJrZXQudG90YWxfc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZSA+PSBzY2FsZWRfYW1vdW50CiAgICAvLyAgICAgKSwgIkluc3VmZmljaWVudCBtYXJrZXQgZGVwb3NpdHMgdG8gcmVkZWVtIgogICAgLy8gICAgIHNlbGYuX2RlY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2RlcG9zaXRzKG1hcmtldF9pZCwgc2NhbGVkX2Ftb3VudCkKICAgIC8vIAogICAgLy8gICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIEFSQzIwMFRva2VuSW50ZXJmYWNlLmFyYzIwMF90cmFuc2ZlciwKICAgIC8vICAgICAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgICAgICBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIC8vICAgICAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldF9pZCksCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBtaW50KHNlbGYsIG1hcmtldF9pZDogYXJjNC5VSW50NjQsIGFtb3VudDogYXJjNC5VSW50MjU2KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX21pbnQobWFya2V0X2lkLm5hdGl2ZSwgYW1vdW50Lm5hdGl2ZSkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfbWludChzZWxmLCBtYXJrZXRfaWQ6IFVJbnQ2NCwgYW1vdW50OiBCaWdVSW50KSAtPiBOb25lOgogICAgLy8gICAgIHNlbGYuX3ZhbGlkYXRlX21hcmtldF9vcGVyYXRpb24obWFya2V0X2lkLCBhbW91bnQsIFRydWUpCiAgICAvLyAKICAgIC8vICAgICBhc3NlcnQgbm90IHNlbGYuX2hhc19wb3NpdGlvbigKICAgIC8vICAgICAgICAgVHhuLnNlbmRlciwgbWFya2V0X2lkCiAgICAvLyAgICAgKSwgIkNhbm5vdCBtaW50L3JlZGVlbSB3aGVuIHVzZXIgaGFzIHRyYWNrZWQgZGVwb3NpdCBwb3NpdGlvbiIKICAgIC8vIAogICAgLy8gICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIEFSQzIwMFRva2VuSW50ZXJmYWNlLmFyYzIwMF90cmFuc2ZlckZyb20sCiAgICAvLyAgICAgICAgIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIC8vICAgICAgICAgYXJjNC5BZGRyZXNzKEdsb2JhbC5jdXJyZW50X2FwcGxpY2F0aW9uX2FkZHJlc3MpLAogICAgLy8gICAgICAgICBhcmM0LlVJbnQyNTYoYW1vdW50KSwKICAgIC8vICAgICAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG1hcmtldF9pZCksCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyAgICAgbmV3X21hcmtldCA9IHNlbGYuX2FjY3J1ZV9pbnRlcmVzdCgKICAgIC8vICAgICAgICAgbWFya2V0X2lkCiAgICAvLyAgICAgKSAgIyBHZXQgdXBkYXRlZCBtYXJrZXQgd2l0aCBhY2NydWVkIGludGVyZXN0CiAgICAvLyAgICAgc2NhbGVkX2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgYW1vdW50ICogU0NBTEUKICAgIC8vICAgICApIC8vIG5ld19tYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUgICMgQ2FsY3VsYXRlIHdpdGggbmV3IGluZGV4CiAgICAvLyAKICAgIC8vICAgICBhc3NlcnQgKAogICAgLy8gICAgICAgICBuZXdfbWFya2V0Lm1heF90b3RhbF9kZXBvc2l0cy5uYXRpdmUKICAgIC8vICAgICAgICAgPj0gbmV3X21hcmtldC50b3RhbF9zY2FsZWRfZGVwb3NpdHMubmF0aXZlICsgc2NhbGVkX2Ftb3VudAogICAgLy8gICAgICksICJEZXBvc2l0IGNhcCBleGNlZWRlZCIKICAgIC8vIAogICAgLy8gICAgICMgT25seSBpbmNyZW1lbnQgbWFya2V0IHRvdGFsIGRlcG9zaXRzLCBub3QgdXNlciBkZXBvc2l0cyBzaW5jZSBwb3NpdGlvbiBpcyBub3QgdHJhY2tlZAogICAgLy8gICAgIHNlbGYuX2luY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2RlcG9zaXRzKG1hcmtldF9pZCwgc2NhbGVkX2Ftb3VudCkKICAgIC8vIAogICAgLy8gICAgIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgICAgIE5Ub2tlbi5taW50LAogICAgLy8gICAgICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgICAgIGFyYzQuVUludDI1NihhbW91bnQpLAogICAgLy8gICAgICAgICBhcHBfaWQ9QXBwbGljYXRpb24obmV3X21hcmtldC5udG9rZW5faWQubmF0aXZlKSwKICAgIC8vICAgICApCiAgICAvLyAKICAgIC8vICAgICBhcmM0LmVtaXQoCiAgICAvLyAgICAgICAgIE1pbnRFdmVudCgKICAgIC8vICAgICAgICAgICAgIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwgYXJjNC5VSW50MjU2KGFtb3VudCksIGFyYzQuVUludDY0KG1hcmtldF9pZCkKICAgIC8vICAgICAgICAgKQogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgc3luY191c2VyX21hcmtldF9mb3JfcHJpY2VfY2hhbmdlKAogICAgLy8gICAgIHNlbGYsIHVzZXJfaWQ6IGFyYzQuQWRkcmVzcywgbWFya2V0X2lkOiBhcmM0LlVJbnQ2NAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIGVuc3VyZV9idWRnZXQoMTQwMCwgT3BVcEZlZVNvdXJjZS5Hcm91cENyZWRpdCkKICAgIC8vICAgICBzZWxmLl91cGRhdGVfdXNlcl9nbG9iYWxfdmFsdWVzX2Zvcl9wcmljZV9jaGFuZ2UoCiAgICAvLyAgICAgICAgIHVzZXJfaWQubmF0aXZlLCBtYXJrZXRfaWQubmF0aXZlCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF91cGRhdGVfdXNlcl9nbG9iYWxfdmFsdWVzX2Zvcl9wcmljZV9jaGFuZ2UoCiAgICAvLyAgICAgc2VsZiwgdXNlcl9pZDogQWNjb3VudCwgbWFya2V0X2lkOiBVSW50NjQKICAgIC8vICkgLT4gTm9uZToKICAgIC8vIAogICAgLy8gICAgIHVzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBtYXJrZXRfaWQpLmNvcHkoKQogICAgLy8gICAgIGlmIHVzZXIuc2NhbGVkX2RlcG9zaXRzID09IDAgYW5kIHVzZXIuc2NhbGVkX2JvcnJvd3MgPT0gMDoKICAgIC8vICAgICAgICAgcmV0dXJuCiAgICAvLyAKICAgIC8vICAgICBtYXJrZXQgPSBzZWxmLl9hY2NydWVfaW50ZXJlc3QobWFya2V0X2lkKQogICAgLy8gCiAgICAvLyAgICAgaWYgdXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlID4gMDoKICAgIC8vICAgICAgICAgZGVwb3NpdF9hbW91bnQgPSAoCiAgICAvLyAgICAgICAgICAgICB1c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgKiBtYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUKICAgIC8vICAgICAgICAgKSAvLyBTQ0FMRQogICAgLy8gICAgICAgICAjIFVzZSBjdXJyZW50IG1hcmtldCBwcmljZSBpZiB1c2VyIGRvZXNuJ3QgaGF2ZSBhIHByZXZpb3VzIHByaWNlCiAgICAvLyAgICAgICAgIHByaWNlX2Zvcl9vbGQgPSAoCiAgICAvLyAgICAgICAgICAgICB1c2VyLmxhc3RfcHJpY2UubmF0aXZlCiAgICAvLyAgICAgICAgICAgICBpZiB1c2VyLmxhc3RfcHJpY2UubmF0aXZlID4gMAogICAgLy8gICAgICAgICAgICAgZWxzZSBtYXJrZXQucHJpY2UubmF0aXZlCiAgICAvLyAgICAgICAgICkKICAgIC8vICAgICAgICAgb2xkX2RlcG9zaXRfdmFsdWUgPSAoZGVwb3NpdF9hbW91bnQgKiBwcmljZV9mb3Jfb2xkKSAvLyBTQ0FMRQogICAgLy8gICAgICAgICBuZXdfZGVwb3NpdF92YWx1ZSA9IChkZXBvc2l0X2Ftb3VudCAqIG1hcmtldC5wcmljZS5uYXRpdmUpIC8vIFNDQUxFCiAgICAvLyAgICAgICAgIHNlbGYuX3VwZGF0ZV9nbG9iYWxfY29sbGF0ZXJhbCgKICAgIC8vICAgICAgICAgICAgIHVzZXJfaWQsIG1hcmtldF9pZCwgb2xkX2RlcG9zaXRfdmFsdWUsIG5ld19kZXBvc2l0X3ZhbHVlCiAgICAvLyAgICAgICAgICkKICAgIC8vIAogICAgLy8gICAgIGlmIHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlID4gMDoKICAgIC8vICAgICAgICAgYm9ycm93X2Ftb3VudCA9ICgKICAgIC8vICAgICAgICAgICAgIHVzZXIuc2NhbGVkX2JvcnJvd3MubmF0aXZlICogbWFya2V0LmJvcnJvd19pbmRleC5uYXRpdmUKICAgIC8vICAgICAgICAgKSAvLyBTQ0FMRQogICAgLy8gICAgICAgICAjIFVzZSBjdXJyZW50IG1hcmtldCBwcmljZSBpZiB1c2VyIGRvZXNuJ3QgaGF2ZSBhIHByZXZpb3VzIHByaWNlCiAgICAvLyAgICAgICAgIHByaWNlX2Zvcl9vbGQgPSAoCiAgICAvLyAgICAgICAgICAgICB1c2VyLmxhc3RfcHJpY2UubmF0aXZlCiAgICAvLyAgICAgICAgICAgICBpZiB1c2VyLmxhc3RfcHJpY2UubmF0aXZlID4gMAogICAgLy8gICAgICAgICAgICAgZWxzZSBtYXJrZXQucHJpY2UubmF0aXZlCiAgICAvLyAgICAgICAgICkKICAgIC8vICAgICAgICAgb2xkX2JvcnJvd192YWx1ZSA9IChib3Jyb3dfYW1vdW50ICogcHJpY2VfZm9yX29sZCkgLy8gU0NBTEUKICAgIC8vICAgICAgICAgbmV3X2JvcnJvd192YWx1ZSA9IChib3Jyb3dfYW1vdW50ICogbWFya2V0LnByaWNlLm5hdGl2ZSkgLy8gU0NBTEUKICAgIC8vICAgICAgICAgc2VsZi5fdXBkYXRlX2dsb2JhbF9ib3Jyb3dzKAogICAgLy8gICAgICAgICAgICAgdXNlcl9pZCwgbWFya2V0X2lkLCBvbGRfYm9ycm93X3ZhbHVlLCBuZXdfYm9ycm93X3ZhbHVlCiAgICAvLyAgICAgICAgICkKICAgIC8vIAogICAgLy8gICAgIHVzZXJfa2V5ID0gc2VsZi5fZ2V0X3VzZXJfa2V5KHVzZXJfaWQsIG1hcmtldF9pZCkKICAgIC8vICAgICB1c2VyLmxhc3RfcHJpY2UgPSBtYXJrZXQucHJpY2UKICAgIC8vICAgICBzZWxmLnVzZXJzW3VzZXJfa2V5XSA9IHVzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF9nbG9iYWxfdXNlcihzZWxmLCB1c2VyX2lkOiBhcmM0LkFkZHJlc3MpIC0+IEdsb2JhbFVzZXJEYXRhOgogICAgLy8gICAgIHJldHVybiBzZWxmLl9nZXRfZ2xvYmFsX3VzZXIodXNlcl9pZC5uYXRpdmUpCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF9nbG9iYWxfdXNlcl9jb2xsYXRlcmFsKHNlbGYsIHVzZXJfaWQ6IGFyYzQuQWRkcmVzcykgLT4gYXJjNC5VSW50MjU2OgogICAgLy8gICAgIHJldHVybiBzZWxmLl9nZXRfZ2xvYmFsX3VzZXIodXNlcl9pZC5uYXRpdmUpLnRvdGFsX2NvbGxhdGVyYWxfdmFsdWUKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X2dsb2JhbF91c2VyKHNlbGYsIHVzZXJfaWQ6IEFjY291bnQpIC0+IEdsb2JhbFVzZXJEYXRhOgogICAgLy8gCiAgICAvLyAgICAgcmV0dXJuIHNlbGYuZ2xvYmFsX3VzZXJzLmdldCgKICAgIC8vICAgICAgICAgdXNlcl9pZCwKICAgIC8vICAgICAgICAgZGVmYXVsdD1HbG9iYWxVc2VyRGF0YSgKICAgIC8vICAgICAgICAgICAgIHRvdGFsX2NvbGxhdGVyYWxfdmFsdWU9YXJjNC5VSW50MjU2KDApLAogICAgLy8gICAgICAgICAgICAgdG90YWxfYm9ycm93X3ZhbHVlPWFyYzQuVUludDI1NigwKSwKICAgIC8vICAgICAgICAgICAgIGxhc3RfdXBkYXRlX3RpbWU9YXJjNC5VSW50NjQoMCksCiAgICAvLyAgICAgICAgICksCiAgICAvLyAgICAgKQogICAgLy8gCiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF91cGRhdGVfZ2xvYmFsX2NvbGxhdGVyYWwoCiAgICAvLyAgICAgc2VsZiwKICAgIC8vICAgICB1c2VyX2lkOiBBY2NvdW50LAogICAgLy8gICAgIG1hcmtldF9pZDogVUludDY0LAogICAgLy8gICAgIG9sZF92YWx1ZTogQmlnVUludCwKICAgIC8vICAgICBuZXdfdmFsdWU6IEJpZ1VJbnQsCiAgICAvLyApIC0+IE5vbmU6CiAgICAvLyAgICAgZ2xvYmFsX3VzZXIgPSBzZWxmLl9nZXRfZ2xvYmFsX3VzZXIodXNlcl9pZCkKICAgIC8vIAogICAgLy8gICAgIGdsb2JhbF91c2VyLnRvdGFsX2NvbGxhdGVyYWxfdmFsdWUgPSBhcmM0LlVJbnQyNTYoCiAgICAvLyAgICAgICAgIGdsb2JhbF91c2VyLnRvdGFsX2NvbGxhdGVyYWxfdmFsdWUubmF0aXZlIC0gb2xkX3ZhbHVlICsgbmV3X3ZhbHVlCiAgICAvLyAgICAgKQogICAgLy8gICAgIGdsb2JhbF91c2VyLmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vIAogICAgLy8gICAgIHNlbGYuZ2xvYmFsX3VzZXJzW3VzZXJfaWRdID0gZ2xvYmFsX3VzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX3VwZGF0ZV9nbG9iYWxfYm9ycm93cygKICAgIC8vICAgICBzZWxmLAogICAgLy8gICAgIHVzZXJfaWQ6IEFjY291bnQsCiAgICAvLyAgICAgbWFya2V0X2lkOiBVSW50NjQsCiAgICAvLyAgICAgb2xkX3ZhbHVlOiBCaWdVSW50LAogICAgLy8gICAgIG5ld192YWx1ZTogQmlnVUludCwKICAgIC8vICkgLT4gTm9uZToKICAgIC8vICAgICBnbG9iYWxfdXNlciA9IHNlbGYuX2dldF9nbG9iYWxfdXNlcih1c2VyX2lkKQogICAgLy8gCiAgICAvLyAgICAgZ2xvYmFsX3VzZXIudG90YWxfYm9ycm93X3ZhbHVlID0gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBnbG9iYWxfdXNlci50b3RhbF9ib3Jyb3dfdmFsdWUubmF0aXZlIC0gb2xkX3ZhbHVlICsgbmV3X3ZhbHVlCiAgICAvLyAgICAgKQogICAgLy8gICAgIGdsb2JhbF91c2VyLmxhc3RfdXBkYXRlX3RpbWUgPSBhcmM0LlVJbnQ2NChHbG9iYWwubGF0ZXN0X3RpbWVzdGFtcCkKICAgIC8vIAogICAgLy8gICAgIHNlbGYuZ2xvYmFsX3VzZXJzW3VzZXJfaWRdID0gZ2xvYmFsX3VzZXIuY29weSgpCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGdldF9nbG9iYWxfdXNlcl9oZWFsdGgoCiAgICAvLyAgICAgc2VsZiwgdXNlcl9pZDogYXJjNC5BZGRyZXNzLCBsaXF1aWRhdGlvbl90aHJlc2hvbGQ6IGFyYzQuVUludDY0CiAgICAvLyApIC0+IGFyYzQuVUludDI1NjoKICAgIC8vICAgICByZXR1cm4gYXJjNC5VSW50MjU2KAogICAgLy8gICAgICAgICBzZWxmLl9nZXRfZ2xvYmFsX3VzZXJfaGVhbHRoKHVzZXJfaWQubmF0aXZlLCBsaXF1aWRhdGlvbl90aHJlc2hvbGQubmF0aXZlKQogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfZ2V0X2dsb2JhbF91c2VyX2hlYWx0aCgKICAgIC8vICAgICBzZWxmLCB1c2VyX2lkOiBBY2NvdW50LCBsaXF1aWRhdGlvbl90aHJlc2hvbGQ6IFVJbnQ2NAogICAgLy8gKSAtPiBCaWdVSW50OgogICAgLy8gICAgIGdsb2JhbF91c2VyID0gc2VsZi5fZ2V0X2dsb2JhbF91c2VyKHVzZXJfaWQpCiAgICAvLyAKICAgIC8vICAgICBpZiBnbG9iYWxfdXNlci50b3RhbF9ib3Jyb3dfdmFsdWUubmF0aXZlID09IDA6CiAgICAvLyAgICAgICAgIHJldHVybiBCaWdVSW50KDApICAjIE5vIGRlYnQgPSBpbmZpbml0ZSBoZWFsdGgKICAgIC8vIAogICAgLy8gICAgIGhlYWx0aCA9ICgKICAgIC8vICAgICAgICAgZ2xvYmFsX3VzZXIudG90YWxfY29sbGF0ZXJhbF92YWx1ZS5uYXRpdmUKICAgIC8vICAgICAgICAgKiBCaWdVSW50KGxpcXVpZGF0aW9uX3RocmVzaG9sZCkKICAgIC8vICAgICAgICAgKiBCaWdVSW50KDEwMDAwKQogICAgLy8gICAgICkgLy8gKGdsb2JhbF91c2VyLnRvdGFsX2JvcnJvd192YWx1ZS5uYXRpdmUgKiBCaWdVSW50KDEwMDAwKSkKICAgIC8vICAgICByZXR1cm4gaGVhbHRoCiAgICAvLyAKICAgIC8vICMgUkVNIG5vIHNpbmdsZS1tYXJrZXQgbGlxdWlkYXRpb24sIGp1c3QgY3Jvc3MtbWFya2V0IGxpcXVpZGF0aW9uIHNpbmdsZSBtYXJrZXQKICAgIC8vIAogICAgLy8gIyBSRU0gY3Jvc3MtbWFya2V0IGxpcXVpZGF0aW9uCiAgICAvLyAKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGxpcXVpZGF0ZV9jcm9zc19tYXJrZXQoCiAgICAvLyAgICAgc2VsZiwKICAgIC8vICAgICBkZWJ0X21hcmtldF9pZDogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgY29sbGF0ZXJhbF9tYXJrZXRfaWQ6IGFyYzQuVUludDY0LAogICAgLy8gICAgIHVzZXI6IGFyYzQuQWRkcmVzcywKICAgIC8vICAgICBkZWJ0X2Ftb3VudDogYXJjNC5VSW50MjU2LAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIGVuc3VyZV9idWRnZXQoMjEwMCwgT3BVcEZlZVNvdXJjZS5Hcm91cENyZWRpdCkKICAgIC8vICAgICBhc3NlcnQgbm90IHNlbGYuX2lzX3BhdXNlZCgpLCAiUHJvdG9jb2wgaXMgcGF1c2VkIgogICAgLy8gICAgIHNlbGYuX2xpcXVpZGF0ZV9jcm9zc19tYXJrZXQoCiAgICAvLyAgICAgICAgIGRlYnRfbWFya2V0X2lkLm5hdGl2ZSwKICAgIC8vICAgICAgICAgY29sbGF0ZXJhbF9tYXJrZXRfaWQubmF0aXZlLAogICAgLy8gICAgICAgICB1c2VyLm5hdGl2ZSwKICAgIC8vICAgICAgICAgZGVidF9hbW91bnQubmF0aXZlLAogICAgLy8gICAgICkKICAgIC8vIAogICAgLy8gQHN1YnJvdXRpbmUKICAgIC8vIGRlZiBfbGlxdWlkYXRlX2Nyb3NzX21hcmtldCgKICAgIC8vICAgICBzZWxmLAogICAgLy8gICAgIGRlYnRfbWFya2V0X2lkOiBVSW50NjQsCiAgICAvLyAgICAgY29sbGF0ZXJhbF9tYXJrZXRfaWQ6IFVJbnQ2NCwKICAgIC8vICAgICB1c2VyX2lkOiBBY2NvdW50LAogICAgLy8gICAgIGRlYnRfYW1vdW50OiBCaWdVSW50LAogICAgLy8gKSAtPiBOb25lOgogICAgLy8gICAgIGFzc2VydCBkZWJ0X21hcmtldF9pZCBpbiBzZWxmLm1hcmtldHMsICJEZWJ0IG1hcmtldCBkb2VzIG5vdCBleGlzdCIKICAgIC8vICAgICBhc3NlcnQgY29sbGF0ZXJhbF9tYXJrZXRfaWQgaW4gc2VsZi5tYXJrZXRzLCAiQ29sbGF0ZXJhbCBtYXJrZXQgZG9lcyBub3QgZXhpc3QiCiAgICBzd2FwCiAgICBjb25jYXQKICAgIGJveF9sZW4KICAgIGJ1cnkgMQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNTExCiAgICAvLyBhc3NlcnQgY29sbGF0ZXJhbF9tYXJrZXRfaWQgaW4gc2VsZi5tYXJrZXRzLCAiQ29sbGF0ZXJhbCBtYXJrZXQgZG9lcyBub3QgZXhpc3QiCiAgICBhc3NlcnQgLy8gQ29sbGF0ZXJhbCBtYXJrZXQgZG9lcyBub3QgZXhpc3QKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTUxMgogICAgLy8gYXNzZXJ0IGRlYnRfYW1vdW50ID4gMCwgIkRlYnQgYW1vdW50IG11c3QgYmUgPiAwIgogICAgZnJhbWVfZGlnIC0xCiAgICBieXRlIDB4CiAgICBiPgogICAgYXNzZXJ0IC8vIERlYnQgYW1vdW50IG11c3QgYmUgPiAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1MTQKICAgIC8vIGRlYnRfbWFya2V0ID0gc2VsZi5fZ2V0X21hcmtldChkZWJ0X21hcmtldF9pZCkKICAgIGZyYW1lX2RpZyAtNAogICAgY2FsbHN1YiBfZ2V0X21hcmtldAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNTE1CiAgICAvLyBjb2xsYXRlcmFsX21hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQoY29sbGF0ZXJhbF9tYXJrZXRfaWQpCiAgICBmcmFtZV9kaWcgLTMKICAgIGNhbGxzdWIgX2dldF9tYXJrZXQKICAgIHN3YXAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTUxNgogICAgLy8gZGVidF91c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgZGVidF9tYXJrZXRfaWQpCiAgICBmcmFtZV9kaWcgLTIKICAgIGZyYW1lX2RpZyAtNAogICAgY2FsbHN1YiBfZ2V0X3VzZXIKICAgIGNvdmVyIDIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTUxNwogICAgLy8gY29sbGF0ZXJhbF91c2VyID0gc2VsZi5fZ2V0X3VzZXIodXNlcl9pZCwgY29sbGF0ZXJhbF9tYXJrZXRfaWQpCiAgICBmcmFtZV9kaWcgLTIKICAgIGZyYW1lX2RpZyAtMwogICAgY2FsbHN1YiBfZ2V0X3VzZXIKICAgIGNvdmVyIDMKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTUxOQogICAgLy8gYXNzZXJ0IG5vdCBkZWJ0X21hcmtldC5wYXVzZWQsICJEZWJ0IG1hcmtldCBpcyBwYXVzZWQiCiAgICBkdXAKICAgIGludCAwCiAgICBnZXRiaXQKICAgIGJ5dGUgMHgwMAogICAgaW50IDAKICAgIHVuY292ZXIgMgogICAgc2V0Yml0CiAgICBieXRlIDB4MDAKICAgID09CiAgICBhc3NlcnQgLy8gRGVidCBtYXJrZXQgaXMgcGF1c2VkCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1MjAKICAgIC8vIGFzc2VydCBub3QgY29sbGF0ZXJhbF9tYXJrZXQucGF1c2VkLCAiQ29sbGF0ZXJhbCBtYXJrZXQgaXMgcGF1c2VkIgogICAgZGlnIDEKICAgIGludCAwCiAgICBnZXRiaXQKICAgIGJ5dGUgMHgwMAogICAgaW50IDAKICAgIHVuY292ZXIgMgogICAgc2V0Yml0CiAgICBieXRlIDB4MDAKICAgID09CiAgICBhc3NlcnQgLy8gQ29sbGF0ZXJhbCBtYXJrZXQgaXMgcGF1c2VkCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1MjIKICAgIC8vIG5ld19kZWJ0X21hcmtldCA9IHNlbGYuX2FjY3J1ZV9pbnRlcmVzdChkZWJ0X21hcmtldF9pZCkKICAgIGZyYW1lX2RpZyAtNAogICAgY2FsbHN1YiBfYWNjcnVlX2ludGVyZXN0CiAgICBjb3ZlciAyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1MjMKICAgIC8vIG5ld19jb2xsYXRlcmFsX21hcmtldCA9IHNlbGYuX2FjY3J1ZV9pbnRlcmVzdChjb2xsYXRlcmFsX21hcmtldF9pZCkKICAgIGZyYW1lX2RpZyAtMwogICAgY2FsbHN1YiBfYWNjcnVlX2ludGVyZXN0CiAgICBjb3ZlciA0CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1MjUKICAgIC8vIGdsb2JhbF91c2VyID0gc2VsZi5fZ2V0X2dsb2JhbF91c2VyKHVzZXJfaWQpCiAgICBmcmFtZV9kaWcgLTIKICAgIGNhbGxzdWIgX2dldF9nbG9iYWxfdXNlcgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNTI2CiAgICAvLyBpZiBnbG9iYWxfdXNlci50b3RhbF9ib3Jyb3dfdmFsdWUubmF0aXZlID09IDA6CiAgICBkdXAKICAgIGV4dHJhY3QgMzIgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBkdXAKICAgIGJ5dGUgMHgKICAgIGI9PQogICAgIQogICAgYXNzZXJ0IC8vIFVzZXIgaGFzIG5vIGRlYnQgdG8gbGlxdWlkYXRlCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1MzAKICAgIC8vIGRlYnRfbWFya2V0LmxpcXVpZGF0aW9uX3RocmVzaG9sZC5uYXRpdmUsCiAgICB1bmNvdmVyIDIKICAgIGV4dHJhY3QgODEgOCAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIGJ0b2kKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTUzMQogICAgLy8gY29sbGF0ZXJhbF9tYXJrZXQubGlxdWlkYXRpb25fdGhyZXNob2xkLm5hdGl2ZSwKICAgIHVuY292ZXIgMwogICAgZXh0cmFjdCA4MSA4IC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgYnRvaQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNTI5LTE1MzIKICAgIC8vIGxpcXVpZGF0aW9uX3RocmVzaG9sZCA9IHNlbGYuX21pbjY0KAogICAgLy8gICAgIGRlYnRfbWFya2V0LmxpcXVpZGF0aW9uX3RocmVzaG9sZC5uYXRpdmUsCiAgICAvLyAgICAgY29sbGF0ZXJhbF9tYXJrZXQubGlxdWlkYXRpb25fdGhyZXNob2xkLm5hdGl2ZSwKICAgIC8vICkKICAgIGNhbGxzdWIgX21pbjY0CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1MzQKICAgIC8vIGdsb2JhbF91c2VyLnRvdGFsX2NvbGxhdGVyYWxfdmFsdWUubmF0aXZlCiAgICB1bmNvdmVyIDIKICAgIGV4dHJhY3QgMCAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIHN3YXAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTUzNQogICAgLy8gKiBCaWdVSW50KGxpcXVpZGF0aW9uX3RocmVzaG9sZCkKICAgIGl0b2IKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTUzNC0xNTM1CiAgICAvLyBnbG9iYWxfdXNlci50b3RhbF9jb2xsYXRlcmFsX3ZhbHVlLm5hdGl2ZQogICAgLy8gKiBCaWdVSW50KGxpcXVpZGF0aW9uX3RocmVzaG9sZCkKICAgIGIqCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1MzYKICAgIC8vICogQmlnVUludCgxMDAwMCkKICAgIGJ5dGUgMHgyNzEwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1MzQtMTUzNgogICAgLy8gZ2xvYmFsX3VzZXIudG90YWxfY29sbGF0ZXJhbF92YWx1ZS5uYXRpdmUKICAgIC8vICogQmlnVUludChsaXF1aWRhdGlvbl90aHJlc2hvbGQpCiAgICAvLyAqIEJpZ1VJbnQoMTAwMDApCiAgICBiKgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNTM3CiAgICAvLyApIC8vIChnbG9iYWxfdXNlci50b3RhbF9ib3Jyb3dfdmFsdWUubmF0aXZlICogQmlnVUludCgxMDAwMCkpCiAgICBzd2FwCiAgICBieXRlIDB4MjcxMAogICAgYioKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTUzMy0xNTM3CiAgICAvLyBoZWFsdGggPSAoCiAgICAvLyAgICAgZ2xvYmFsX3VzZXIudG90YWxfY29sbGF0ZXJhbF92YWx1ZS5uYXRpdmUKICAgIC8vICAgICAqIEJpZ1VJbnQobGlxdWlkYXRpb25fdGhyZXNob2xkKQogICAgLy8gICAgICogQmlnVUludCgxMDAwMCkKICAgIC8vICkgLy8gKGdsb2JhbF91c2VyLnRvdGFsX2JvcnJvd192YWx1ZS5uYXRpdmUgKiBCaWdVSW50KDEwMDAwKSkKICAgIGIvCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1MzgKICAgIC8vIGFzc2VydCBoZWFsdGggPCAxMDAwMCwgIlBvc2l0aW9uIGlzIG5vdCBsaXF1aWRhdGFibGUiCiAgICBieXRlIDB4MjcxMAogICAgYjwKICAgIGFzc2VydCAvLyBQb3NpdGlvbiBpcyBub3QgbGlxdWlkYXRhYmxlCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1NDEKICAgIC8vIGRlYnRfdXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgKiBuZXdfZGVidF9tYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZQogICAgZGlnIDEKICAgIGV4dHJhY3QgMzIgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBkaWcgMQogICAgZXh0cmFjdCAyMDkgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBkdXAyCiAgICBiKgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNTQyCiAgICAvLyApIC8vIFNDQUxFCiAgICBieXRlIDB4MGRlMGI2YjNhNzY0MDAwMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNTQwLTE1NDIKICAgIC8vIGRlYnRfdmFsdWUgPSAoCiAgICAvLyAgICAgZGVidF91c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAqIG5ld19kZWJ0X21hcmtldC5ib3Jyb3dfaW5kZXgubmF0aXZlCiAgICAvLyApIC8vIFNDQUxFCiAgICBiLwogICAgc3dhcAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNTQ0CiAgICAvLyBkZWJ0X3ZhbHVlICogQmlnVUludChuZXdfZGVidF9tYXJrZXQuY2xvc2VfZmFjdG9yLm5hdGl2ZSkKICAgIGRpZyAzCiAgICBpbnQgMzIxCiAgICBpbnQgOAogICAgZXh0cmFjdDMgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBidG9pCiAgICBpdG9iCiAgICBkaWcgMgogICAgYioKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTU0NQogICAgLy8gKSAvLyBCaWdVSW50KDEwMDAwKQogICAgYnl0ZSAweDI3MTAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTU0My0xNTQ1CiAgICAvLyBtYXhfbGlxdWlkYXRhYmxlID0gKAogICAgLy8gICAgIGRlYnRfdmFsdWUgKiBCaWdVSW50KG5ld19kZWJ0X21hcmtldC5jbG9zZV9mYWN0b3IubmF0aXZlKQogICAgLy8gKSAvLyBCaWdVSW50KDEwMDAwKQogICAgYi8KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTU0NwogICAgLy8gZGVidF9hbW91bnQgPD0gbWF4X2xpcXVpZGF0YWJsZQogICAgZnJhbWVfZGlnIC0xCiAgICBiPj0KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTU0Ni0xNTQ4CiAgICAvLyBhc3NlcnQgKAogICAgLy8gICAgIGRlYnRfYW1vdW50IDw9IG1heF9saXF1aWRhdGFibGUKICAgIC8vICksICJBbW91bnQgZXhjZWVkcyBtYXhpbXVtIGxpcXVpZGF0YWJsZSBhbW91bnQiCiAgICBhc3NlcnQgLy8gQW1vdW50IGV4Y2VlZHMgbWF4aW11bSBsaXF1aWRhdGFibGUgYW1vdW50CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1NTEKICAgIC8vIGRlYnRfYW1vdW50ICogU0NBTEUKICAgIGZyYW1lX2RpZyAtMQogICAgYnl0ZSAweDBkZTBiNmIzYTc2NDAwMDAKICAgIGIqCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1NTAtMTU1MgogICAgLy8gc2NhbGVkX3JlcGF5X2Ftb3VudCA9ICgKICAgIC8vICAgICBkZWJ0X2Ftb3VudCAqIFNDQUxFCiAgICAvLyApIC8vIG5ld19kZWJ0X21hcmtldC5ib3Jyb3dfaW5kZXgubmF0aXZlCiAgICBkaWcgMQogICAgYi8KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTU1NAogICAgLy8gZGVidF91c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSA+PSBzY2FsZWRfcmVwYXlfYW1vdW50CiAgICBkaWcgMwogICAgZGlnIDEKICAgIGI+PQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNTUzLTE1NTUKICAgIC8vIGFzc2VydCAoCiAgICAvLyAgICAgZGVidF91c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSA+PSBzY2FsZWRfcmVwYXlfYW1vdW50CiAgICAvLyApLCAiQW1vdW50IGV4Y2VlZHMgdGFyZ2V0J3MgZGVidCIKICAgIGFzc2VydCAvLyBBbW91bnQgZXhjZWVkcyB0YXJnZXQncyBkZWJ0CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1NTcKICAgIC8vIGRlYnRfdXNkX3ZhbHVlID0gKGRlYnRfYW1vdW50ICogbmV3X2RlYnRfbWFya2V0LnByaWNlLm5hdGl2ZSkgLy8gU0NBTEUKICAgIHVuY292ZXIgNAogICAgaW50IDI4MQogICAgaW50IDMyCiAgICBleHRyYWN0MyAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIGZyYW1lX2RpZyAtMQogICAgZGlnIDEKICAgIGIqCiAgICBieXRlIDB4MGRlMGI2YjNhNzY0MDAwMAogICAgYi8KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTU2MAogICAgLy8gZGVidF91c2RfdmFsdWUgKiBCaWdVSW50KG5ld19jb2xsYXRlcmFsX21hcmtldC5saXF1aWRhdGlvbl9ib251cy5uYXRpdmUpCiAgICBkaWcgNwogICAgZXh0cmFjdCA2NSA4IC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgYnRvaQogICAgaXRvYgogICAgZGlnIDEKICAgIGIqCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1NjEKICAgIC8vICkgLy8gQmlnVUludCgxMDAwMCkKICAgIGJ5dGUgMHgyNzEwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1NTktMTU2MQogICAgLy8gYm9udXNfdXNkX3ZhbHVlID0gKAogICAgLy8gICAgIGRlYnRfdXNkX3ZhbHVlICogQmlnVUludChuZXdfY29sbGF0ZXJhbF9tYXJrZXQubGlxdWlkYXRpb25fYm9udXMubmF0aXZlKQogICAgLy8gKSAvLyBCaWdVSW50KDEwMDAwKQogICAgYi8KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTU2MgogICAgLy8gY29sbGF0ZXJhbF91c2RfdmFsdWUgPSBkZWJ0X3VzZF92YWx1ZSArIGJvbnVzX3VzZF92YWx1ZQogICAgYisKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTU2NQogICAgLy8gY29sbGF0ZXJhbF91c2RfdmFsdWUgKiBTQ0FMRQogICAgYnl0ZSAweDBkZTBiNmIzYTc2NDAwMDAKICAgIGIqCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1NjYKICAgIC8vICkgLy8gbmV3X2NvbGxhdGVyYWxfbWFya2V0LnByaWNlLm5hdGl2ZQogICAgZGlnIDcKICAgIGludCAyODEKICAgIGludCAzMgogICAgZXh0cmFjdDMgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1NjQtMTU2NgogICAgLy8gY29sbGF0ZXJhbF9hbW91bnQgPSAoCiAgICAvLyAgICAgY29sbGF0ZXJhbF91c2RfdmFsdWUgKiBTQ0FMRQogICAgLy8gKSAvLyBuZXdfY29sbGF0ZXJhbF9tYXJrZXQucHJpY2UubmF0aXZlCiAgICBkdXAKICAgIGNvdmVyIDgKICAgIGIvCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1NjgKICAgIC8vIGNvbGxhdGVyYWxfYW1vdW50ICogU0NBTEUKICAgIGR1cAogICAgYnl0ZSAweDBkZTBiNmIzYTc2NDAwMDAKICAgIGIqCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1NjkKICAgIC8vICkgLy8gbmV3X2NvbGxhdGVyYWxfbWFya2V0LmRlcG9zaXRfaW5kZXgubmF0aXZlCiAgICBkaWcgOQogICAgZXh0cmFjdCAxNzcgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1NjctMTU2OQogICAgLy8gc2NhbGVkX2NvbGxhdGVyYWxfYW1vdW50ID0gKAogICAgLy8gICAgIGNvbGxhdGVyYWxfYW1vdW50ICogU0NBTEUKICAgIC8vICkgLy8gbmV3X2NvbGxhdGVyYWxfbWFya2V0LmRlcG9zaXRfaW5kZXgubmF0aXZlCiAgICBkdXAKICAgIGNvdmVyIDUKICAgIGIvCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1NzEKICAgIC8vIGNvbGxhdGVyYWxfdXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlID49IHNjYWxlZF9jb2xsYXRlcmFsX2Ftb3VudAogICAgZGlnIDExCiAgICBleHRyYWN0IDAgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBkdXAKICAgIGRpZyAyCiAgICBiPj0KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTU3MC0xNTcyCiAgICAvLyBhc3NlcnQgKAogICAgLy8gICAgIGNvbGxhdGVyYWxfdXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlID49IHNjYWxlZF9jb2xsYXRlcmFsX2Ftb3VudAogICAgLy8gKSwgIkluc3VmZmljaWVudCBjb2xsYXRlcmFsIHRvIHNlaXplIgogICAgYXNzZXJ0IC8vIEluc3VmZmljaWVudCBjb2xsYXRlcmFsIHRvIHNlaXplCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1NzQtMTU4MAogICAgLy8gYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICBBUkMyMDBUb2tlbkludGVyZmFjZS5hcmMyMDBfdHJhbnNmZXJGcm9tLAogICAgLy8gICAgIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIC8vICAgICBhcmM0LkFkZHJlc3MoR2xvYmFsLmN1cnJlbnRfYXBwbGljYXRpb25fYWRkcmVzcyksCiAgICAvLyAgICAgYXJjNC5VSW50MjU2KGRlYnRfYW1vdW50KSwKICAgIC8vICAgICBhcHBfaWQ9QXBwbGljYXRpb24oZGVidF9tYXJrZXRfaWQpLAogICAgLy8gKQogICAgaXR4bl9iZWdpbgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNTc3CiAgICAvLyBhcmM0LkFkZHJlc3MoR2xvYmFsLmN1cnJlbnRfYXBwbGljYXRpb25fYWRkcmVzcyksCiAgICBnbG9iYWwgQ3VycmVudEFwcGxpY2F0aW9uQWRkcmVzcwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNTc2CiAgICAvLyBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICB0eG4gU2VuZGVyCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1NzgKICAgIC8vIGFyYzQuVUludDI1NihkZWJ0X2Ftb3VudCksCiAgICBmcmFtZV9kaWcgLTEKICAgIGxlbgogICAgaW50IDMyCiAgICA8PQogICAgYXNzZXJ0IC8vIG92ZXJmbG93CiAgICBpbnQgMzIKICAgIGJ6ZXJvCiAgICBmcmFtZV9kaWcgLTEKICAgIGRpZyAxCiAgICBifAogICAgZnJhbWVfZGlnIC00CiAgICBpdHhuX2ZpZWxkIEFwcGxpY2F0aW9uSUQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTU3NC0xNTgwCiAgICAvLyBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgIEFSQzIwMFRva2VuSW50ZXJmYWNlLmFyYzIwMF90cmFuc2ZlckZyb20sCiAgICAvLyAgICAgYXJjNC5BZGRyZXNzKFR4bi5zZW5kZXIpLAogICAgLy8gICAgIGFyYzQuQWRkcmVzcyhHbG9iYWwuY3VycmVudF9hcHBsaWNhdGlvbl9hZGRyZXNzKSwKICAgIC8vICAgICBhcmM0LlVJbnQyNTYoZGVidF9hbW91bnQpLAogICAgLy8gICAgIGFwcF9pZD1BcHBsaWNhdGlvbihkZWJ0X21hcmtldF9pZCksCiAgICAvLyApCiAgICBtZXRob2QgImFyYzIwMF90cmFuc2ZlckZyb20oYWRkcmVzcyxhZGRyZXNzLHVpbnQyNTYpYm9vbCIKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICB1bmNvdmVyIDIKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICB1bmNvdmVyIDIKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICBpdHhuX2ZpZWxkIEFwcGxpY2F0aW9uQXJncwogICAgaW50IGFwcGwKICAgIGl0eG5fZmllbGQgVHlwZUVudW0KICAgIGludCAwCiAgICBpdHhuX2ZpZWxkIEZlZQogICAgaXR4bl9zdWJtaXQKICAgIGl0eG4gTGFzdExvZwogICAgZXh0cmFjdCAwIDQKICAgIGJ5dGUgMHgxNTFmN2M3NQogICAgPT0KICAgIGFzc2VydCAvLyBBUkM0IHByZWZpeCBpcyB2YWxpZAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNTgyLTE1ODQKICAgIC8vIHNlbGYuX2RlY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfYm9ycm93cygKICAgIC8vICAgICBkZWJ0X21hcmtldF9pZCwgdXNlcl9pZCwgc2NhbGVkX3JlcGF5X2Ftb3VudAogICAgLy8gKQogICAgZnJhbWVfZGlnIC00CiAgICBmcmFtZV9kaWcgLTIKICAgIGRpZyA3CiAgICBjYWxsc3ViIF9kZWNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2JvcnJvd3MKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTU4NQogICAgLy8gc2VsZi5fZGVjcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfYm9ycm93cyhkZWJ0X21hcmtldF9pZCwgc2NhbGVkX3JlcGF5X2Ftb3VudCkKICAgIGZyYW1lX2RpZyAtNAogICAgZGlnIDYKICAgIGNhbGxzdWIgX2RlY3JlbWVudF9tYXJrZXRfdG90YWxfc2NhbGVkX2JvcnJvd3MKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTU4Ny0xNTkyCiAgICAvLyBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgIE5Ub2tlbi5idXJuX2Zyb20sCiAgICAvLyAgICAgYXJjNC5BZGRyZXNzKHVzZXJfaWQpLAogICAgLy8gICAgIGFyYzQuVUludDI1Nihjb2xsYXRlcmFsX2Ftb3VudCksCiAgICAvLyAgICAgYXBwX2lkPUFwcGxpY2F0aW9uKG5ld19jb2xsYXRlcmFsX21hcmtldC5udG9rZW5faWQubmF0aXZlKSwKICAgIC8vICkKICAgIGl0eG5fYmVnaW4KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTU5MAogICAgLy8gYXJjNC5VSW50MjU2KGNvbGxhdGVyYWxfYW1vdW50KSwKICAgIGRpZyAzCiAgICBsZW4KICAgIGludCAzMgogICAgPD0KICAgIGFzc2VydCAvLyBvdmVyZmxvdwogICAgdW5jb3ZlciAzCiAgICBifAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNTkxCiAgICAvLyBhcHBfaWQ9QXBwbGljYXRpb24obmV3X2NvbGxhdGVyYWxfbWFya2V0Lm50b2tlbl9pZC5uYXRpdmUpLAogICAgdW5jb3ZlciAxMQogICAgaW50IDMxMwogICAgaW50IDgKICAgIGV4dHJhY3QzIC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgYnRvaQogICAgaXR4bl9maWVsZCBBcHBsaWNhdGlvbklECiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1ODctMTU5MgogICAgLy8gYXJjNC5hYmlfY2FsbCgKICAgIC8vICAgICBOVG9rZW4uYnVybl9mcm9tLAogICAgLy8gICAgIGFyYzQuQWRkcmVzcyh1c2VyX2lkKSwKICAgIC8vICAgICBhcmM0LlVJbnQyNTYoY29sbGF0ZXJhbF9hbW91bnQpLAogICAgLy8gICAgIGFwcF9pZD1BcHBsaWNhdGlvbihuZXdfY29sbGF0ZXJhbF9tYXJrZXQubnRva2VuX2lkLm5hdGl2ZSksCiAgICAvLyApCiAgICBtZXRob2QgImJ1cm5fZnJvbShhZGRyZXNzLHVpbnQyNTYpdm9pZCIKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICBmcmFtZV9kaWcgLTIKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICBkdXAKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICBpbnQgYXBwbAogICAgaXR4bl9maWVsZCBUeXBlRW51bQogICAgaW50IDAKICAgIGl0eG5fZmllbGQgRmVlCiAgICBpdHhuX3N1Ym1pdAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNTk0LTE1OTYKICAgIC8vIHNlbGYuX2RlY3JlbWVudF9tYXJrZXRfdXNlcl9zY2FsZWRfZGVwb3NpdHMoCiAgICAvLyAgICAgY29sbGF0ZXJhbF9tYXJrZXRfaWQsIHVzZXJfaWQsIHNjYWxlZF9jb2xsYXRlcmFsX2Ftb3VudAogICAgLy8gKQogICAgZnJhbWVfZGlnIC0zCiAgICBmcmFtZV9kaWcgLTIKICAgIGRpZyA0CiAgICBjYWxsc3ViIF9kZWNyZW1lbnRfbWFya2V0X3VzZXJfc2NhbGVkX2RlcG9zaXRzCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE1OTctMTU5OQogICAgLy8gc2VsZi5fZGVjcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfZGVwb3NpdHMoCiAgICAvLyAgICAgY29sbGF0ZXJhbF9tYXJrZXRfaWQsIHNjYWxlZF9jb2xsYXRlcmFsX2Ftb3VudAogICAgLy8gKQogICAgZnJhbWVfZGlnIC0zCiAgICBkaWcgMwogICAgY2FsbHN1YiBfZGVjcmVtZW50X21hcmtldF90b3RhbF9zY2FsZWRfZGVwb3NpdHMKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTYwMS0xNjA2CiAgICAvLyBhcmM0LmFiaV9jYWxsKAogICAgLy8gICAgIEFSQzIwMFRva2VuSW50ZXJmYWNlLmFyYzIwMF90cmFuc2ZlciwKICAgIC8vICAgICBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICAvLyAgICAgYXJjNC5VSW50MjU2KGNvbGxhdGVyYWxfYW1vdW50KSwKICAgIC8vICAgICBhcHBfaWQ9QXBwbGljYXRpb24oY29sbGF0ZXJhbF9tYXJrZXRfaWQpLAogICAgLy8gKQogICAgaXR4bl9iZWdpbgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNjAzCiAgICAvLyBhcmM0LkFkZHJlc3MoVHhuLnNlbmRlciksCiAgICB0eG4gU2VuZGVyCiAgICBmcmFtZV9kaWcgLTMKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25JRAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNjAxLTE2MDYKICAgIC8vIGFyYzQuYWJpX2NhbGwoCiAgICAvLyAgICAgQVJDMjAwVG9rZW5JbnRlcmZhY2UuYXJjMjAwX3RyYW5zZmVyLAogICAgLy8gICAgIGFyYzQuQWRkcmVzcyhUeG4uc2VuZGVyKSwKICAgIC8vICAgICBhcmM0LlVJbnQyNTYoY29sbGF0ZXJhbF9hbW91bnQpLAogICAgLy8gICAgIGFwcF9pZD1BcHBsaWNhdGlvbihjb2xsYXRlcmFsX21hcmtldF9pZCksCiAgICAvLyApCiAgICBtZXRob2QgImFyYzIwMF90cmFuc2ZlcihhZGRyZXNzLHVpbnQyNTYpYm9vbCIKICAgIGl0eG5fZmllbGQgQXBwbGljYXRpb25BcmdzCiAgICBpdHhuX2ZpZWxkIEFwcGxpY2F0aW9uQXJncwogICAgaXR4bl9maWVsZCBBcHBsaWNhdGlvbkFyZ3MKICAgIGludCBhcHBsCiAgICBpdHhuX2ZpZWxkIFR5cGVFbnVtCiAgICBpbnQgMAogICAgaXR4bl9maWVsZCBGZWUKICAgIGl0eG5fc3VibWl0CiAgICBpdHhuIExhc3RMb2cKICAgIGV4dHJhY3QgMCA0CiAgICBieXRlIDB4MTUxZjdjNzUKICAgID09CiAgICBhc3NlcnQgLy8gQVJDNCBwcmVmaXggaXMgdmFsaWQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTYxNAogICAgLy8gKGRlYnRfdXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgLSBzY2FsZWRfcmVwYXlfYW1vdW50KQogICAgdW5jb3ZlciA3CiAgICB1bmNvdmVyIDQKICAgIGItCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE2MTQtMTYxNQogICAgLy8gKGRlYnRfdXNlci5zY2FsZWRfYm9ycm93cy5uYXRpdmUgLSBzY2FsZWRfcmVwYXlfYW1vdW50KQogICAgLy8gKiBuZXdfZGVidF9tYXJrZXQuYm9ycm93X2luZGV4Lm5hdGl2ZQogICAgdW5jb3ZlciA1CiAgICBiKgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNjE2CiAgICAvLyAvLyBTQ0FMRQogICAgYnl0ZSAweDBkZTBiNmIzYTc2NDAwMDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTYxNC0xNjE2CiAgICAvLyAoZGVidF91c2VyLnNjYWxlZF9ib3Jyb3dzLm5hdGl2ZSAtIHNjYWxlZF9yZXBheV9hbW91bnQpCiAgICAvLyAqIG5ld19kZWJ0X21hcmtldC5ib3Jyb3dfaW5kZXgubmF0aXZlCiAgICAvLyAvLyBTQ0FMRQogICAgYi8KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTYxOAogICAgLy8gb2xkX2JvcnJvd192YWx1ZSA9IChvbGRfYm9ycm93X2Ftb3VudCAqIGRlYnRfdXNlci5sYXN0X3ByaWNlLm5hdGl2ZSkgLy8gU0NBTEUKICAgIHVuY292ZXIgNgogICAgZXh0cmFjdCAxMzYgMzIgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICB1bmNvdmVyIDYKICAgIGIqCiAgICBieXRlIDB4MGRlMGI2YjNhNzY0MDAwMAogICAgYi8KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTYxOQogICAgLy8gbmV3X2JvcnJvd192YWx1ZSA9IChuZXdfYm9ycm93X2Ftb3VudCAqIG5ld19kZWJ0X21hcmtldC5wcmljZS5uYXRpdmUpIC8vIFNDQUxFCiAgICBzd2FwCiAgICB1bmNvdmVyIDQKICAgIGIqCiAgICBieXRlIDB4MGRlMGI2YjNhNzY0MDAwMAogICAgYi8KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTYyMC0xNjIyCiAgICAvLyBzZWxmLl91cGRhdGVfZ2xvYmFsX2JvcnJvd3MoCiAgICAvLyAgICAgdXNlcl9pZCwgZGVidF9tYXJrZXRfaWQsIG9sZF9ib3Jyb3dfdmFsdWUsIG5ld19ib3Jyb3dfdmFsdWUKICAgIC8vICkKICAgIGZyYW1lX2RpZyAtMgogICAgZnJhbWVfZGlnIC00CiAgICB1bmNvdmVyIDMKICAgIHVuY292ZXIgMwogICAgY2FsbHN1YiBfdXBkYXRlX2dsb2JhbF9ib3Jyb3dzCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE2MjUtMTYyNgogICAgLy8gY29sbGF0ZXJhbF91c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUKICAgIC8vICogbmV3X2NvbGxhdGVyYWxfbWFya2V0LmRlcG9zaXRfaW5kZXgubmF0aXZlCiAgICBkdXAKICAgIGRpZyAzCiAgICBiKgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNjI3CiAgICAvLyAvLyBTQ0FMRQogICAgYnl0ZSAweDBkZTBiNmIzYTc2NDAwMDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTYyNS0xNjI3CiAgICAvLyBjb2xsYXRlcmFsX3VzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZQogICAgLy8gKiBuZXdfY29sbGF0ZXJhbF9tYXJrZXQuZGVwb3NpdF9pbmRleC5uYXRpdmUKICAgIC8vIC8vIFNDQUxFCiAgICBiLwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNjI0LTE2MjgKICAgIC8vIG9sZF9kZXBvc2l0X2Ftb3VudCA9ICgKICAgIC8vICAgICBjb2xsYXRlcmFsX3VzZXIuc2NhbGVkX2RlcG9zaXRzLm5hdGl2ZQogICAgLy8gICAgICogbmV3X2NvbGxhdGVyYWxfbWFya2V0LmRlcG9zaXRfaW5kZXgubmF0aXZlCiAgICAvLyAgICAgLy8gU0NBTEUKICAgIC8vICkKICAgIGNvdmVyIDIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTYzMAogICAgLy8gKGNvbGxhdGVyYWxfdXNlci5zY2FsZWRfZGVwb3NpdHMubmF0aXZlIC0gc2NhbGVkX2NvbGxhdGVyYWxfYW1vdW50KQogICAgc3dhcAogICAgYi0KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTYzMC0xNjMxCiAgICAvLyAoY29sbGF0ZXJhbF91c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgLSBzY2FsZWRfY29sbGF0ZXJhbF9hbW91bnQpCiAgICAvLyAqIG5ld19jb2xsYXRlcmFsX21hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZQogICAgdW5jb3ZlciAyCiAgICBiKgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNjMyCiAgICAvLyAvLyBTQ0FMRQogICAgYnl0ZSAweDBkZTBiNmIzYTc2NDAwMDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTYzMC0xNjMyCiAgICAvLyAoY29sbGF0ZXJhbF91c2VyLnNjYWxlZF9kZXBvc2l0cy5uYXRpdmUgLSBzY2FsZWRfY29sbGF0ZXJhbF9hbW91bnQpCiAgICAvLyAqIG5ld19jb2xsYXRlcmFsX21hcmtldC5kZXBvc2l0X2luZGV4Lm5hdGl2ZQogICAgLy8gLy8gU0NBTEUKICAgIGIvCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE2MzUKICAgIC8vIG9sZF9kZXBvc2l0X2Ftb3VudCAqIGNvbGxhdGVyYWxfdXNlci5sYXN0X3ByaWNlLm5hdGl2ZQogICAgdW5jb3ZlciAzCiAgICBleHRyYWN0IDEzNiAzMiAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIHVuY292ZXIgMgogICAgYioKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTYzNgogICAgLy8gKSAvLyBTQ0FMRQogICAgYnl0ZSAweDBkZTBiNmIzYTc2NDAwMDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTYzNC0xNjM2CiAgICAvLyBvbGRfZGVwb3NpdF92YWx1ZSA9ICgKICAgIC8vICAgICBvbGRfZGVwb3NpdF9hbW91bnQgKiBjb2xsYXRlcmFsX3VzZXIubGFzdF9wcmljZS5uYXRpdmUKICAgIC8vICkgLy8gU0NBTEUKICAgIGIvCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE2MzgKICAgIC8vIG5ld19kZXBvc2l0X2Ftb3VudCAqIG5ld19jb2xsYXRlcmFsX21hcmtldC5wcmljZS5uYXRpdmUKICAgIHN3YXAKICAgIHVuY292ZXIgMgogICAgYioKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTYzOQogICAgLy8gKSAvLyBTQ0FMRQogICAgYnl0ZSAweDBkZTBiNmIzYTc2NDAwMDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTYzNy0xNjM5CiAgICAvLyBuZXdfZGVwb3NpdF92YWx1ZSA9ICgKICAgIC8vICAgICBuZXdfZGVwb3NpdF9hbW91bnQgKiBuZXdfY29sbGF0ZXJhbF9tYXJrZXQucHJpY2UubmF0aXZlCiAgICAvLyApIC8vIFNDQUxFCiAgICBiLwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNjQwLTE2NDIKICAgIC8vIHNlbGYuX3VwZGF0ZV9nbG9iYWxfY29sbGF0ZXJhbCgKICAgIC8vICAgICB1c2VyX2lkLCBjb2xsYXRlcmFsX21hcmtldF9pZCwgb2xkX2RlcG9zaXRfdmFsdWUsIG5ld19kZXBvc2l0X3ZhbHVlCiAgICAvLyApCiAgICBmcmFtZV9kaWcgLTIKICAgIGZyYW1lX2RpZyAtMwogICAgdW5jb3ZlciAzCiAgICB1bmNvdmVyIDMKICAgIGNhbGxzdWIgX3VwZGF0ZV9nbG9iYWxfY29sbGF0ZXJhbAogICAgcmV0c3ViCgoKLy8gY29udHJhY3QuTGVuZGluZ1Bvb2wuX21pbjY0KGE6IHVpbnQ2NCwgYjogdWludDY0KSAtPiB1aW50NjQ6Cl9taW42NDoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTcwNC0xNzA1CiAgICAvLyBAc3Vicm91dGluZQogICAgLy8gZGVmIF9taW42NChzZWxmLCBhOiBVSW50NjQsIGI6IFVJbnQ2NCkgLT4gVUludDY0OgogICAgcHJvdG8gMiAxCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE3MDYKICAgIC8vIHJldHVybiBhIGlmIGEgPCBiIGVsc2UgYgogICAgZnJhbWVfZGlnIC0yCiAgICBmcmFtZV9kaWcgLTEKICAgIDwKICAgIGZyYW1lX2RpZyAtMQogICAgZnJhbWVfZGlnIC0yCiAgICB1bmNvdmVyIDIKICAgIHNlbGVjdAogICAgcmV0c3ViCgoKLy8gY29udHJhY3QuTGVuZGluZ1Bvb2wuY2FsY3VsYXRlX2Nyb3NzX21hcmtldF9saXF1aWRhdGlvbl9hbW91bnRzKGRlYnRfbWFya2V0X2lkOiBieXRlcywgY29sbGF0ZXJhbF9tYXJrZXRfaWQ6IGJ5dGVzLCB1c2VyOiBieXRlcywgZGVidF9hbW91bnQ6IGJ5dGVzKSAtPiBieXRlczoKY2FsY3VsYXRlX2Nyb3NzX21hcmtldF9saXF1aWRhdGlvbl9hbW91bnRzOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNjQ2LTE2NTMKICAgIC8vIEBhcmM0LmFiaW1ldGhvZAogICAgLy8gZGVmIGNhbGN1bGF0ZV9jcm9zc19tYXJrZXRfbGlxdWlkYXRpb25fYW1vdW50cygKICAgIC8vICAgICBzZWxmLAogICAgLy8gICAgIGRlYnRfbWFya2V0X2lkOiBhcmM0LlVJbnQ2NCwKICAgIC8vICAgICBjb2xsYXRlcmFsX21hcmtldF9pZDogYXJjNC5VSW50NjQsCiAgICAvLyAgICAgdXNlcjogYXJjNC5BZGRyZXNzLAogICAgLy8gICAgIGRlYnRfYW1vdW50OiBhcmM0LlVJbnQyNTYsCiAgICAvLyApIC0+IGFyYzQuU3RhdGljQXJyYXlbYXJjNC5VSW50MjU2LCB0eXBpbmcuTGl0ZXJhbFszXV06CiAgICBwcm90byA0IDEKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTY1NQogICAgLy8gZGVidF9tYXJrZXRfaWQubmF0aXZlLAogICAgZnJhbWVfZGlnIC00CiAgICBidG9pCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE2NTYKICAgIC8vIGNvbGxhdGVyYWxfbWFya2V0X2lkLm5hdGl2ZSwKICAgIGZyYW1lX2RpZyAtMwogICAgYnRvaQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNjU0LTE2NTkKICAgIC8vIHJldHVybiBzZWxmLl9jYWxjdWxhdGVfY3Jvc3NfbWFya2V0X2xpcXVpZGF0aW9uX2Ftb3VudHMoCiAgICAvLyAgICAgZGVidF9tYXJrZXRfaWQubmF0aXZlLAogICAgLy8gICAgIGNvbGxhdGVyYWxfbWFya2V0X2lkLm5hdGl2ZSwKICAgIC8vICAgICB1c2VyLm5hdGl2ZSwKICAgIC8vICAgICBkZWJ0X2Ftb3VudC5uYXRpdmUsCiAgICAvLyApCiAgICBmcmFtZV9kaWcgLTIKICAgIGZyYW1lX2RpZyAtMQogICAgY2FsbHN1YiBfY2FsY3VsYXRlX2Nyb3NzX21hcmtldF9saXF1aWRhdGlvbl9hbW91bnRzCiAgICByZXRzdWIKCgovLyBjb250cmFjdC5MZW5kaW5nUG9vbC5fY2FsY3VsYXRlX2Nyb3NzX21hcmtldF9saXF1aWRhdGlvbl9hbW91bnRzKGRlYnRfbWFya2V0X2lkOiB1aW50NjQsIGNvbGxhdGVyYWxfbWFya2V0X2lkOiB1aW50NjQsIHVzZXJfaWQ6IGJ5dGVzLCBkZWJ0X2Ftb3VudDogYnl0ZXMpIC0+IGJ5dGVzOgpfY2FsY3VsYXRlX2Nyb3NzX21hcmtldF9saXF1aWRhdGlvbl9hbW91bnRzOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNjYxLTE2NjgKICAgIC8vIEBzdWJyb3V0aW5lCiAgICAvLyBkZWYgX2NhbGN1bGF0ZV9jcm9zc19tYXJrZXRfbGlxdWlkYXRpb25fYW1vdW50cygKICAgIC8vICAgICBzZWxmLAogICAgLy8gICAgIGRlYnRfbWFya2V0X2lkOiBVSW50NjQsCiAgICAvLyAgICAgY29sbGF0ZXJhbF9tYXJrZXRfaWQ6IFVJbnQ2NCwKICAgIC8vICAgICB1c2VyX2lkOiBBY2NvdW50LAogICAgLy8gICAgIGRlYnRfYW1vdW50OiBCaWdVSW50LAogICAgLy8gKSAtPiBhcmM0LlN0YXRpY0FycmF5W2FyYzQuVUludDI1NiwgdHlwaW5nLkxpdGVyYWxbM11dOgogICAgcHJvdG8gNCAxCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE2NjktMTY3MAogICAgLy8gIyBHZXQgbWFya2V0cyBhbmQgdXNlciBkYXRhCiAgICAvLyBkZWJ0X21hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQoZGVidF9tYXJrZXRfaWQpCiAgICBmcmFtZV9kaWcgLTQKICAgIGNhbGxzdWIgX2dldF9tYXJrZXQKICAgIHBvcAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNjcxCiAgICAvLyBjb2xsYXRlcmFsX21hcmtldCA9IHNlbGYuX2dldF9tYXJrZXQoY29sbGF0ZXJhbF9tYXJrZXRfaWQpCiAgICBmcmFtZV9kaWcgLTMKICAgIGNhbGxzdWIgX2dldF9tYXJrZXQKICAgIHBvcAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNjcyCiAgICAvLyBkZWJ0X3VzZXIgPSBzZWxmLl9nZXRfdXNlcih1c2VyX2lkLCBkZWJ0X21hcmtldF9pZCkKICAgIGZyYW1lX2RpZyAtMgogICAgZnJhbWVfZGlnIC00CiAgICBjYWxsc3ViIF9nZXRfdXNlcgogICAgcG9wCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE2NzMKICAgIC8vIGNvbGxhdGVyYWxfdXNlciA9IHNlbGYuX2dldF91c2VyKHVzZXJfaWQsIGNvbGxhdGVyYWxfbWFya2V0X2lkKQogICAgZnJhbWVfZGlnIC0yCiAgICBmcmFtZV9kaWcgLTMKICAgIGNhbGxzdWIgX2dldF91c2VyCiAgICBwb3AKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTY3NS0xNjc2CiAgICAvLyAjIEFjY3J1ZSBpbnRlcmVzdCB0byBnZXQgY3VycmVudCBzdGF0ZQogICAgLy8gbmV3X2RlYnRfbWFya2V0ID0gc2VsZi5fYWNjcnVlX2ludGVyZXN0KGRlYnRfbWFya2V0X2lkKQogICAgZnJhbWVfZGlnIC00CiAgICBjYWxsc3ViIF9hY2NydWVfaW50ZXJlc3QKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTY3NwogICAgLy8gbmV3X2NvbGxhdGVyYWxfbWFya2V0ID0gc2VsZi5fYWNjcnVlX2ludGVyZXN0KGNvbGxhdGVyYWxfbWFya2V0X2lkKQogICAgZnJhbWVfZGlnIC0zCiAgICBjYWxsc3ViIF9hY2NydWVfaW50ZXJlc3QKICAgIHN3YXAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTY3OS0xNjgwCiAgICAvLyAjIENhbGN1bGF0ZSBVU0QgdmFsdWUgb2YgZGVidCBiZWluZyByZXBhaWQKICAgIC8vIGRlYnRfdXNkX3ZhbHVlID0gKGRlYnRfYW1vdW50ICogbmV3X2RlYnRfbWFya2V0LnByaWNlLm5hdGl2ZSkgLy8gU0NBTEUKICAgIGludCAyODEKICAgIGludCAzMgogICAgZXh0cmFjdDMgLy8gb24gZXJyb3I6IEluZGV4IGFjY2VzcyBpcyBvdXQgb2YgYm91bmRzCiAgICBmcmFtZV9kaWcgLTEKICAgIGIqCiAgICBieXRlIDB4MGRlMGI2YjNhNzY0MDAwMAogICAgYi8KICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTY4NAogICAgLy8gZGVidF91c2RfdmFsdWUgKiBCaWdVSW50KG5ld19jb2xsYXRlcmFsX21hcmtldC5saXF1aWRhdGlvbl9ib251cy5uYXRpdmUpCiAgICBkaWcgMQogICAgZXh0cmFjdCA2NSA4IC8vIG9uIGVycm9yOiBJbmRleCBhY2Nlc3MgaXMgb3V0IG9mIGJvdW5kcwogICAgYnRvaQogICAgaXRvYgogICAgZGlnIDEKICAgIGIqCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE2ODUKICAgIC8vICkgLy8gQmlnVUludCgxMDAwMCkKICAgIGJ5dGUgMHgyNzEwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE2ODItMTY4NQogICAgLy8gIyBDYWxjdWxhdGUgYm9udXMgaW4gVVNEIHRlcm1zCiAgICAvLyBib251c191c2RfdmFsdWUgPSAoCiAgICAvLyAgICAgZGVidF91c2RfdmFsdWUgKiBCaWdVSW50KG5ld19jb2xsYXRlcmFsX21hcmtldC5saXF1aWRhdGlvbl9ib251cy5uYXRpdmUpCiAgICAvLyApIC8vIEJpZ1VJbnQoMTAwMDApCiAgICBiLwogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNjg3LTE2ODgKICAgIC8vICMgQ2FsY3VsYXRlIHRvdGFsIGNvbGxhdGVyYWwgdmFsdWUgaW4gVVNECiAgICAvLyBjb2xsYXRlcmFsX3VzZF92YWx1ZSA9IGRlYnRfdXNkX3ZhbHVlICsgYm9udXNfdXNkX3ZhbHVlCiAgICBkdXAKICAgIGNvdmVyIDIKICAgIGIrCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE2OTIKICAgIC8vIGNvbGxhdGVyYWxfdXNkX3ZhbHVlICogU0NBTEUKICAgIGJ5dGUgMHgwZGUwYjZiM2E3NjQwMDAwCiAgICBiKgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNjkzCiAgICAvLyApIC8vIG5ld19jb2xsYXRlcmFsX21hcmtldC5wcmljZS5uYXRpdmUKICAgIHVuY292ZXIgMgogICAgaW50IDI4MQogICAgaW50IDMyCiAgICBleHRyYWN0MyAvLyBvbiBlcnJvcjogSW5kZXggYWNjZXNzIGlzIG91dCBvZiBib3VuZHMKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTY5MC0xNjkzCiAgICAvLyAjIENvbnZlcnQgVVNEIHZhbHVlIGJhY2sgdG8gY29sbGF0ZXJhbCB0b2tlbiBhbW91bnQKICAgIC8vIGNvbGxhdGVyYWxfYW1vdW50ID0gKAogICAgLy8gICAgIGNvbGxhdGVyYWxfdXNkX3ZhbHVlICogU0NBTEUKICAgIC8vICkgLy8gbmV3X2NvbGxhdGVyYWxfbWFya2V0LnByaWNlLm5hdGl2ZQogICAgZHVwCiAgICBjb3ZlciAyCiAgICBiLwogICAgY292ZXIgMgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNjk1LTE2OTYKICAgIC8vICMgQ29udmVydCBib251cyBVU0QgdmFsdWUgYmFjayB0byBjb2xsYXRlcmFsIHRva2VuIGFtb3VudAogICAgLy8gYm9udXNfYW1vdW50ID0gKGJvbnVzX3VzZF92YWx1ZSAqIFNDQUxFKSAvLyBuZXdfY29sbGF0ZXJhbF9tYXJrZXQucHJpY2UubmF0aXZlCiAgICBzd2FwCiAgICBieXRlIDB4MGRlMGI2YjNhNzY0MDAwMAogICAgYioKICAgIHN3YXAKICAgIGIvCiAgICBzd2FwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE2OTkKICAgIC8vIGFyYzQuVUludDI1NihkZWJ0X2Ftb3VudCksCiAgICBmcmFtZV9kaWcgLTEKICAgIGxlbgogICAgaW50IDMyCiAgICA8PQogICAgYXNzZXJ0IC8vIG92ZXJmbG93CiAgICBpbnQgMzIKICAgIGJ6ZXJvCiAgICBmcmFtZV9kaWcgLTEKICAgIGRpZyAxCiAgICBifAogICAgY292ZXIgMgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxNzAwCiAgICAvLyBhcmM0LlVJbnQyNTYoY29sbGF0ZXJhbF9hbW91bnQpLAogICAgZGlnIDEKICAgIGxlbgogICAgaW50IDMyCiAgICA8PQogICAgYXNzZXJ0IC8vIG92ZXJmbG93CiAgICBkdXAKICAgIGNvdmVyIDIKICAgIGJ8CiAgICBzd2FwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE3MDEKICAgIC8vIGFyYzQuVUludDI1Nihib251c19hbW91bnQpLAogICAgZGlnIDMKICAgIGxlbgogICAgaW50IDMyCiAgICA8PQogICAgYXNzZXJ0IC8vIG92ZXJmbG93CiAgICB1bmNvdmVyIDMKICAgIGJ8CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjE2OTgtMTcwMgogICAgLy8gcmV0dXJuIGFyYzQuU3RhdGljQXJyYXlbYXJjNC5VSW50MjU2LCB0eXBpbmcuTGl0ZXJhbFszXV0oCiAgICAvLyAgICAgYXJjNC5VSW50MjU2KGRlYnRfYW1vdW50KSwKICAgIC8vICAgICBhcmM0LlVJbnQyNTYoY29sbGF0ZXJhbF9hbW91bnQpLAogICAgLy8gICAgIGFyYzQuVUludDI1Nihib251c19hbW91bnQpLAogICAgLy8gKQogICAgY292ZXIgMgogICAgY29uY2F0CiAgICBzd2FwCiAgICBjb25jYXQKICAgIHJldHN1YgoKCi8vIGNvbnRyYWN0LlVwZ3JhZGVhYmxlLnNldF92ZXJzaW9uKGNvbnRyYWN0X3ZlcnNpb246IGJ5dGVzLCBkZXBsb3ltZW50X3ZlcnNpb246IGJ5dGVzKSAtPiB2b2lkOgpzZXRfdmVyc2lvbjoKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTAyLTEwNQogICAgLy8gQGFyYzQuYWJpbWV0aG9kCiAgICAvLyBkZWYgc2V0X3ZlcnNpb24oCiAgICAvLyAgICAgc2VsZiwgY29udHJhY3RfdmVyc2lvbjogYXJjNC5VSW50NjQsIGRlcGxveW1lbnRfdmVyc2lvbjogYXJjNC5VSW50NjQKICAgIC8vICkgLT4gTm9uZToKICAgIHByb3RvIDIgMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMDYKICAgIC8vIGFyYzQuZW1pdChWZXJzaW9uVXBkYXRlZChjb250cmFjdF92ZXJzaW9uLCBkZXBsb3ltZW50X3ZlcnNpb24pKQogICAgZnJhbWVfZGlnIC0yCiAgICBmcmFtZV9kaWcgLTEKICAgIGNvbmNhdAogICAgbWV0aG9kICJWZXJzaW9uVXBkYXRlZCh1aW50NjQsdWludDY0KSIKICAgIHN3YXAKICAgIGNvbmNhdAogICAgbG9nCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwNwogICAgLy8gc2VsZi5jb250cmFjdF92ZXJzaW9uID0gY29udHJhY3RfdmVyc2lvbi5uYXRpdmUKICAgIGZyYW1lX2RpZyAtMgogICAgYnRvaQogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1OAogICAgLy8gc2VsZi5jb250cmFjdF92ZXJzaW9uID0gVUludDY0KCkKICAgIGJ5dGUgImNvbnRyYWN0X3ZlcnNpb24iCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwNwogICAgLy8gc2VsZi5jb250cmFjdF92ZXJzaW9uID0gY29udHJhY3RfdmVyc2lvbi5uYXRpdmUKICAgIHN3YXAKICAgIGFwcF9nbG9iYWxfcHV0CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEwOAogICAgLy8gc2VsZi5kZXBsb3ltZW50X3ZlcnNpb24gPSBkZXBsb3ltZW50X3ZlcnNpb24ubmF0aXZlCiAgICBmcmFtZV9kaWcgLTEKICAgIGJ0b2kKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTkKICAgIC8vIHNlbGYuZGVwbG95bWVudF92ZXJzaW9uID0gVUludDY0KCkKICAgIGJ5dGUgImRlcGxveW1lbnRfdmVyc2lvbiIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTA4CiAgICAvLyBzZWxmLmRlcGxveW1lbnRfdmVyc2lvbiA9IGRlcGxveW1lbnRfdmVyc2lvbi5uYXRpdmUKICAgIHN3YXAKICAgIGFwcF9nbG9iYWxfcHV0CiAgICByZXRzdWIKCgovLyBjb250cmFjdC5VcGdyYWRlYWJsZS5ncmFudF91cGdyYWRlcih1cGdyYWRlcjogYnl0ZXMpIC0+IHZvaWQ6CmdyYW50X3VwZ3JhZGVyOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjYtMTI3CiAgICAvLyBAYXJjNC5hYmltZXRob2QKICAgIC8vIGRlZiBncmFudF91cGdyYWRlcihzZWxmLCB1cGdyYWRlcjogYXJjNC5BZGRyZXNzKSAtPiBOb25lOgogICAgcHJvdG8gMSAwCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjEyOAogICAgLy8gYXNzZXJ0IFR4bi5zZW5kZXIgPT0gR2xvYmFsLmNyZWF0b3JfYWRkcmVzcywgIm11c3QgYmUgY3JlYXRvciIKICAgIHR4biBTZW5kZXIKICAgIGdsb2JhbCBDcmVhdG9yQWRkcmVzcwogICAgPT0KICAgIGFzc2VydCAvLyBtdXN0IGJlIGNyZWF0b3IKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTI5CiAgICAvLyBhcmM0LmVtaXQoVXBncmFkZXJHcmFudGVkKGFyYzQuQWRkcmVzcyhzZWxmLnVwZ3JhZGVyKSwgdXBncmFkZXIpKQogICAgaW50IDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NjEKICAgIC8vIHNlbGYudXBncmFkZXIgPSBBY2NvdW50KCkKICAgIGJ5dGUgInVwZ3JhZGVyIgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMjkKICAgIC8vIGFyYzQuZW1pdChVcGdyYWRlckdyYW50ZWQoYXJjNC5BZGRyZXNzKHNlbGYudXBncmFkZXIpLCB1cGdyYWRlcikpCiAgICBhcHBfZ2xvYmFsX2dldF9leAogICAgYXNzZXJ0IC8vIGNoZWNrIHNlbGYudXBncmFkZXIgZXhpc3RzCiAgICBmcmFtZV9kaWcgLTEKICAgIGNvbmNhdAogICAgbWV0aG9kICJVcGdyYWRlckdyYW50ZWQoYWRkcmVzcyxhZGRyZXNzKSIKICAgIHN3YXAKICAgIGNvbmNhdAogICAgbG9nCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjYxCiAgICAvLyBzZWxmLnVwZ3JhZGVyID0gQWNjb3VudCgpCiAgICBieXRlICJ1cGdyYWRlciIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTMwCiAgICAvLyBzZWxmLnVwZ3JhZGVyID0gdXBncmFkZXIubmF0aXZlCiAgICBmcmFtZV9kaWcgLTEKICAgIGFwcF9nbG9iYWxfcHV0CiAgICByZXRzdWIKCgovLyBjb250cmFjdC5VcGdyYWRlYWJsZS5vbl91cGRhdGUoKSAtPiB2b2lkOgpvbl91cGRhdGU6CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjExMC0xMTEKICAgIC8vIEBhcmM0LmJhcmVtZXRob2QoYWxsb3dfYWN0aW9ucz1bIlVwZGF0ZUFwcGxpY2F0aW9uIl0pCiAgICAvLyBkZWYgb25fdXBkYXRlKHNlbGYpIC0+IE5vbmU6CiAgICBwcm90byAwIDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTEyLTExNQogICAgLy8gIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjCiAgICAvLyAjIFdBUk5JTkc6IFRoaXMgYXBwIGNhbiBiZSB1cGRhdGVkIGJ5IHRoZSBjcmVhdG9yCiAgICAvLyAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKICAgIC8vIGFzc2VydCBUeG4uc2VuZGVyID09IHNlbGYudXBncmFkZXIsICJtdXN0IGJlIHVwZ3JhZGVyIgogICAgdHhuIFNlbmRlcgogICAgaW50IDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NjEKICAgIC8vIHNlbGYudXBncmFkZXIgPSBBY2NvdW50KCkKICAgIGJ5dGUgInVwZ3JhZGVyIgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMTItMTE1CiAgICAvLyAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKICAgIC8vICMgV0FSTklORzogVGhpcyBhcHAgY2FuIGJlIHVwZGF0ZWQgYnkgdGhlIGNyZWF0b3IKICAgIC8vICMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwogICAgLy8gYXNzZXJ0IFR4bi5zZW5kZXIgPT0gc2VsZi51cGdyYWRlciwgIm11c3QgYmUgdXBncmFkZXIiCiAgICBhcHBfZ2xvYmFsX2dldF9leAogICAgYXNzZXJ0IC8vIGNoZWNrIHNlbGYudXBncmFkZXIgZXhpc3RzCiAgICA9PQogICAgYXNzZXJ0IC8vIG11c3QgYmUgdXBncmFkZXIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MTE2CiAgICAvLyBhc3NlcnQgc2VsZi51cGRhdGFibGUgPT0gVUludDY0KDEpLCAibm90IGFwcHJvdmVkIgogICAgaW50IDAKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NjAKICAgIC8vIHNlbGYudXBkYXRhYmxlID0gYm9vbCgxKQogICAgYnl0ZSAidXBkYXRhYmxlIgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToxMTYKICAgIC8vIGFzc2VydCBzZWxmLnVwZGF0YWJsZSA9PSBVSW50NjQoMSksICJub3QgYXBwcm92ZWQiCiAgICBhcHBfZ2xvYmFsX2dldF9leAogICAgYXNzZXJ0IC8vIGNoZWNrIHNlbGYudXBkYXRhYmxlIGV4aXN0cwogICAgaW50IDEKICAgID09CiAgICBhc3NlcnQgLy8gbm90IGFwcHJvdmVkCiAgICByZXRzdWIKCgovLyBjb250cmFjdC5Eb3JrRmlMZW5kaW5nUG9vbC5fX2luaXRfXygpIC0+IHZvaWQ6Cl9faW5pdF9fOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToyMTAwCiAgICAvLyBkZWYgX19pbml0X18oc2VsZikgLT4gTm9uZToKICAgIHByb3RvIDAgMAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1MDYKICAgIC8vIHNlbGYub3duZXIgPSBBY2NvdW50KCkKICAgIGJ5dGUgIm93bmVyIgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToyMTAxLTIxMDIKICAgIC8vICMgb3duYWJsZSBzdGF0ZQogICAgLy8gc2VsZi5vd25lciA9IEdsb2JhbC5jcmVhdG9yX2FkZHJlc3MKICAgIGdsb2JhbCBDcmVhdG9yQWRkcmVzcwogICAgYXBwX2dsb2JhbF9wdXQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTA3CiAgICAvLyBzZWxmLnBhdXNlZCA9IFVJbnQ2NCgpCiAgICBieXRlICJwYXVzZWQiCiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjIxMDMtMjEwNAogICAgLy8gIyBsZW5kaW5nIHBvb2wgc3RhdGUKICAgIC8vIHNlbGYucGF1c2VkID0gVUludDY0KDEpCiAgICBpbnQgMQogICAgYXBwX2dsb2JhbF9wdXQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NTA4CiAgICAvLyBzZWxmLnN0b2tlbl9hcHBfaWQgPSBVSW50NjQoKSAgIyBzdGFibGUgbWFya2V0CiAgICBieXRlICJzdG9rZW5fYXBwX2lkIgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToyMTA1CiAgICAvLyBzZWxmLnN0b2tlbl9hcHBfaWQgPSBVSW50NjQoMCkgICMgc3RhYmxlIG1hcmtldAogICAgaW50IDAKICAgIGFwcF9nbG9iYWxfcHV0CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjUwOQogICAgLy8gc2VsZi5zZWNvbmRzX3Blcl95ZWFyID0gVUludDY0KCkgICMgc2Vjb25kcyBwZXIgeWVhcgogICAgYnl0ZSAic2Vjb25kc19wZXJfeWVhciIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MjEwNgogICAgLy8gc2VsZi5zZWNvbmRzX3Blcl95ZWFyID0gVUludDY0KFNFQ09ORFNfUEVSX1lFQVIpCiAgICBpbnQgMzE1MzYwMDAKICAgIGFwcF9nbG9iYWxfcHV0CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjU4CiAgICAvLyBzZWxmLmNvbnRyYWN0X3ZlcnNpb24gPSBVSW50NjQoKQogICAgYnl0ZSAiY29udHJhY3RfdmVyc2lvbiIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MjEwNy0yMTA4CiAgICAvLyAjIHVwZ3JhZGVhYmxlIHN0YXRlCiAgICAvLyBzZWxmLmNvbnRyYWN0X3ZlcnNpb24gPSBVSW50NjQoMCkKICAgIGludCAwCiAgICBhcHBfZ2xvYmFsX3B1dAogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weTo1OQogICAgLy8gc2VsZi5kZXBsb3ltZW50X3ZlcnNpb24gPSBVSW50NjQoKQogICAgYnl0ZSAiZGVwbG95bWVudF92ZXJzaW9uIgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToyMTA5CiAgICAvLyBzZWxmLmRlcGxveW1lbnRfdmVyc2lvbiA9IFVJbnQ2NCgxKQogICAgaW50IDEKICAgIGFwcF9nbG9iYWxfcHV0CiAgICAvLyBzcmMvc3JjL2NvbnRyYWN0LnB5OjYwCiAgICAvLyBzZWxmLnVwZGF0YWJsZSA9IGJvb2woMSkKICAgIGJ5dGUgInVwZGF0YWJsZSIKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6MjExMAogICAgLy8gc2VsZi51cGRhdGFibGUgPSBib29sKDEpCiAgICBpbnQgMQogICAgYXBwX2dsb2JhbF9wdXQKICAgIC8vIHNyYy9zcmMvY29udHJhY3QucHk6NjEKICAgIC8vIHNlbGYudXBncmFkZXIgPSBBY2NvdW50KCkKICAgIGJ5dGUgInVwZ3JhZGVyIgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToyMTExCiAgICAvLyBzZWxmLnVwZ3JhZGVyID0gR2xvYmFsLmNyZWF0b3JfYWRkcmVzcwogICAgZ2xvYmFsIENyZWF0b3JBZGRyZXNzCiAgICBhcHBfZ2xvYmFsX3B1dAogICAgcmV0c3ViCg==",
    "clear": "I3ByYWdtYSB2ZXJzaW9uIDEwCgpjb250cmFjdC5Eb3JrRmlMZW5kaW5nUG9vbC5jbGVhcl9zdGF0ZV9wcm9ncmFtOgogICAgLy8gc3JjL3NyYy9jb250cmFjdC5weToyMDk4CiAgICAvLyBjbGFzcyBEb3JrRmlMZW5kaW5nUG9vbChMZW5kaW5nUG9vbCwgVXBncmFkZWFibGUpOgogICAgaW50IDEKICAgIHJldHVybgo="
  },
  "state": {
    "global": {
      "num_byte_slices": 2,
      "num_uints": 6
    },
    "local": {
      "num_byte_slices": 0,
      "num_uints": 0
    }
  },
  "schema": {
    "global": {
      "declared": {
        "contract_version": {
          "type": "uint64",
          "key": "contract_version"
        },
        "deployment_version": {
          "type": "uint64",
          "key": "deployment_version"
        },
        "owner": {
          "type": "bytes",
          "key": "owner"
        },
        "paused": {
          "type": "uint64",
          "key": "paused"
        },
        "seconds_per_year": {
          "type": "uint64",
          "key": "seconds_per_year"
        },
        "stoken_app_id": {
          "type": "uint64",
          "key": "stoken_app_id"
        },
        "updatable": {
          "type": "uint64",
          "key": "updatable"
        },
        "upgrader": {
          "type": "bytes",
          "key": "upgrader"
        }
      },
      "reserved": {}
    },
    "local": {
      "declared": {},
      "reserved": {}
    }
  },
  "contract": {
    "name": "DorkFiLendingPool",
    "methods": [
      {
        "name": "post_update",
        "args": [],
        "readonly": false,
        "returns": {
          "type": "void"
        }
      },
      {
        "name": "get_owner",
        "args": [],
        "readonly": true,
        "returns": {
          "type": "address"
        }
      },
      {
        "name": "transfer_ownership",
        "args": [
          {
            "type": "address",
            "name": "new_owner"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "void"
        }
      },
      {
        "name": "is_paused",
        "args": [],
        "readonly": false,
        "returns": {
          "type": "bool"
        }
      },
      {
        "name": "pause",
        "args": [
          {
            "type": "uint64",
            "name": "pause"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "void"
        }
      },
      {
        "name": "get_stoken_app_id",
        "args": [],
        "readonly": false,
        "returns": {
          "type": "uint64"
        }
      },
      {
        "name": "set_stoken_app_id",
        "args": [
          {
            "type": "uint64",
            "name": "stoken_app_id"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "void"
        }
      },
      {
        "name": "get_user",
        "args": [
          {
            "type": "address",
            "name": "user_id"
          },
          {
            "type": "uint64",
            "name": "market_id"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "(uint256,uint256,uint256,uint256,uint64,uint256)"
        }
      },
      {
        "name": "create_market",
        "args": [
          {
            "type": "uint64",
            "name": "token_id"
          },
          {
            "type": "uint64",
            "name": "collateral_factor"
          },
          {
            "type": "uint64",
            "name": "liquidation_threshold"
          },
          {
            "type": "uint64",
            "name": "reserve_factor"
          },
          {
            "type": "uint64",
            "name": "borrow_rate"
          },
          {
            "type": "uint64",
            "name": "slope"
          },
          {
            "type": "uint256",
            "name": "max_total_deposits"
          },
          {
            "type": "uint256",
            "name": "max_total_borrows"
          },
          {
            "type": "uint64",
            "name": "liquidation_bonus"
          },
          {
            "type": "uint64",
            "name": "close_factor"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "uint64"
        }
      },
      {
        "name": "create_market_cost",
        "args": [],
        "readonly": true,
        "returns": {
          "type": "uint64"
        }
      },
      {
        "name": "get_market",
        "args": [
          {
            "type": "uint64",
            "name": "token_id"
          }
        ],
        "readonly": true,
        "returns": {
          "type": "(bool,uint256,uint256,uint64,uint64,uint64,uint64,uint64,uint64,uint256,uint256,uint256,uint256,uint64,uint256,uint256,uint64,uint64)"
        }
      },
      {
        "name": "get_market_price",
        "args": [
          {
            "type": "uint64",
            "name": "token_id"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "uint256"
        }
      },
      {
        "name": "get_market_ntoken_id",
        "args": [
          {
            "type": "uint64",
            "name": "token_id"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "uint64"
        }
      },
      {
        "name": "set_market_price",
        "args": [
          {
            "type": "uint64",
            "name": "token_id"
          },
          {
            "type": "uint256",
            "name": "price"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "void"
        }
      },
      {
        "name": "pause_market",
        "args": [
          {
            "type": "uint64",
            "name": "token_id"
          },
          {
            "type": "uint64",
            "name": "pause"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "void"
        }
      },
      {
        "name": "deposit",
        "args": [
          {
            "type": "uint64",
            "name": "market_id"
          },
          {
            "type": "uint256",
            "name": "amount"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "void"
        }
      },
      {
        "name": "withdraw",
        "args": [
          {
            "type": "uint64",
            "name": "market_id"
          },
          {
            "type": "uint256",
            "name": "amount"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "void"
        }
      },
      {
        "name": "borrow",
        "args": [
          {
            "type": "uint64",
            "name": "market_id"
          },
          {
            "type": "uint256",
            "name": "amount"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "void"
        }
      },
      {
        "name": "get_scaled_repay_amount",
        "args": [
          {
            "type": "uint64",
            "name": "market_id"
          },
          {
            "type": "uint256",
            "name": "amount"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "uint256"
        }
      },
      {
        "name": "repay",
        "args": [
          {
            "type": "uint64",
            "name": "market_id"
          },
          {
            "type": "uint256",
            "name": "amount"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "void"
        }
      },
      {
        "name": "redeem",
        "args": [
          {
            "type": "uint64",
            "name": "market_id"
          },
          {
            "type": "uint256",
            "name": "amount"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "void"
        }
      },
      {
        "name": "mint",
        "args": [
          {
            "type": "uint64",
            "name": "market_id"
          },
          {
            "type": "uint256",
            "name": "amount"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "void"
        }
      },
      {
        "name": "sync_user_market_for_price_change",
        "args": [
          {
            "type": "address",
            "name": "user_id"
          },
          {
            "type": "uint64",
            "name": "market_id"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "void"
        }
      },
      {
        "name": "get_global_user",
        "args": [
          {
            "type": "address",
            "name": "user_id"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "(uint256,uint256,uint64)"
        }
      },
      {
        "name": "get_global_user_collateral",
        "args": [
          {
            "type": "address",
            "name": "user_id"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "uint256"
        }
      },
      {
        "name": "get_global_user_health",
        "args": [
          {
            "type": "address",
            "name": "user_id"
          },
          {
            "type": "uint64",
            "name": "liquidation_threshold"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "uint256"
        }
      },
      {
        "name": "liquidate_cross_market",
        "args": [
          {
            "type": "uint64",
            "name": "debt_market_id"
          },
          {
            "type": "uint64",
            "name": "collateral_market_id"
          },
          {
            "type": "address",
            "name": "user"
          },
          {
            "type": "uint256",
            "name": "debt_amount"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "void"
        }
      },
      {
        "name": "calculate_cross_market_liquidation_amounts",
        "args": [
          {
            "type": "uint64",
            "name": "debt_market_id"
          },
          {
            "type": "uint64",
            "name": "collateral_market_id"
          },
          {
            "type": "address",
            "name": "user"
          },
          {
            "type": "uint256",
            "name": "debt_amount"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "uint256[3]"
        }
      },
      {
        "name": "set_version",
        "args": [
          {
            "type": "uint64",
            "name": "contract_version"
          },
          {
            "type": "uint64",
            "name": "deployment_version"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "void"
        }
      },
      {
        "name": "grant_upgrader",
        "args": [
          {
            "type": "address",
            "name": "upgrader"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "void"
        }
      },
      {
        "name": "approve_update",
        "args": [
          {
            "type": "bool",
            "name": "approval"
          }
        ],
        "readonly": false,
        "returns": {
          "type": "void"
        },
        "desc": "Approve update."
      }
    ],
    "networks": {}
  },
  "bare_call_config": {
    "update_application": "CALL",
    "no_op": "CREATE"
  }
}

/**
 * Defines an onCompletionAction of 'no_op'
 */
export type OnCompleteNoOp =  { onCompleteAction?: 'no_op' | OnApplicationComplete.NoOpOC }
/**
 * Defines an onCompletionAction of 'opt_in'
 */
export type OnCompleteOptIn =  { onCompleteAction: 'opt_in' | OnApplicationComplete.OptInOC }
/**
 * Defines an onCompletionAction of 'close_out'
 */
export type OnCompleteCloseOut =  { onCompleteAction: 'close_out' | OnApplicationComplete.CloseOutOC }
/**
 * Defines an onCompletionAction of 'delete_application'
 */
export type OnCompleteDelApp =  { onCompleteAction: 'delete_application' | OnApplicationComplete.DeleteApplicationOC }
/**
 * Defines an onCompletionAction of 'update_application'
 */
export type OnCompleteUpdApp =  { onCompleteAction: 'update_application' | OnApplicationComplete.UpdateApplicationOC }
/**
 * A state record containing a single unsigned integer
 */
export type IntegerState = {
  /**
   * Gets the state value as a BigInt.
   */
  asBigInt(): bigint
  /**
   * Gets the state value as a number.
   */
  asNumber(): number
}
/**
 * A state record containing binary data
 */
export type BinaryState = {
  /**
   * Gets the state value as a Uint8Array
   */
  asByteArray(): Uint8Array
  /**
   * Gets the state value as a string
   */
  asString(): string
}

export type AppCreateCallTransactionResult = AppCallTransactionResult & Partial<AppCompilationResult> & AppReference
export type AppUpdateCallTransactionResult = AppCallTransactionResult & Partial<AppCompilationResult>

export type AppClientComposeCallCoreParams = Omit<AppClientCallCoreParams, 'sendParams'> & {
  sendParams?: Omit<SendTransactionParams, 'skipSending' | 'atc' | 'skipWaiting' | 'maxRoundsToWaitForConfirmation' | 'populateAppCallResources'>
}
export type AppClientComposeExecuteParams = Pick<SendTransactionParams, 'skipWaiting' | 'maxRoundsToWaitForConfirmation' | 'populateAppCallResources' | 'suppressLog'>

/**
 * Defines the types of available calls and state of the DorkFiLendingPool smart contract.
 */
export type DorkFiLendingPool = {
  /**
   * Maps method signatures / names to their argument and return types.
   */
  methods:
    & Record<'post_update()void' | 'post_update', {
      argsObj: {
      }
      argsTuple: []
      returns: void
    }>
    & Record<'get_owner()address' | 'get_owner', {
      argsObj: {
      }
      argsTuple: []
      returns: string
    }>
    & Record<'transfer_ownership(address)void' | 'transfer_ownership', {
      argsObj: {
        newOwner: string
      }
      argsTuple: [newOwner: string]
      returns: void
    }>
    & Record<'is_paused()bool' | 'is_paused', {
      argsObj: {
      }
      argsTuple: []
      returns: boolean
    }>
    & Record<'pause(uint64)void' | 'pause', {
      argsObj: {
        pause: bigint | number
      }
      argsTuple: [pause: bigint | number]
      returns: void
    }>
    & Record<'get_stoken_app_id()uint64' | 'get_stoken_app_id', {
      argsObj: {
      }
      argsTuple: []
      returns: bigint
    }>
    & Record<'set_stoken_app_id(uint64)void' | 'set_stoken_app_id', {
      argsObj: {
        stokenAppId: bigint | number
      }
      argsTuple: [stokenAppId: bigint | number]
      returns: void
    }>
    & Record<'get_user(address,uint64)(uint256,uint256,uint256,uint256,uint64,uint256)' | 'get_user', {
      argsObj: {
        userId: string
        marketId: bigint | number
      }
      argsTuple: [userId: string, marketId: bigint | number]
      returns: UserData
    }>
    & Record<'create_market(uint64,uint64,uint64,uint64,uint64,uint64,uint256,uint256,uint64,uint64)uint64' | 'create_market', {
      argsObj: {
        tokenId: bigint | number
        collateralFactor: bigint | number
        liquidationThreshold: bigint | number
        reserveFactor: bigint | number
        borrowRate: bigint | number
        slope: bigint | number
        maxTotalDeposits: bigint | number
        maxTotalBorrows: bigint | number
        liquidationBonus: bigint | number
        closeFactor: bigint | number
      }
      argsTuple: [tokenId: bigint | number, collateralFactor: bigint | number, liquidationThreshold: bigint | number, reserveFactor: bigint | number, borrowRate: bigint | number, slope: bigint | number, maxTotalDeposits: bigint | number, maxTotalBorrows: bigint | number, liquidationBonus: bigint | number, closeFactor: bigint | number]
      returns: bigint
    }>
    & Record<'create_market_cost()uint64' | 'create_market_cost', {
      argsObj: {
      }
      argsTuple: []
      returns: bigint
    }>
    & Record<'get_market(uint64)(bool,uint256,uint256,uint64,uint64,uint64,uint64,uint64,uint64,uint256,uint256,uint256,uint256,uint64,uint256,uint256,uint64,uint64)' | 'get_market', {
      argsObj: {
        tokenId: bigint | number
      }
      argsTuple: [tokenId: bigint | number]
      returns: MarketData
    }>
    & Record<'get_market_price(uint64)uint256' | 'get_market_price', {
      argsObj: {
        tokenId: bigint | number
      }
      argsTuple: [tokenId: bigint | number]
      returns: bigint
    }>
    & Record<'get_market_ntoken_id(uint64)uint64' | 'get_market_ntoken_id', {
      argsObj: {
        tokenId: bigint | number
      }
      argsTuple: [tokenId: bigint | number]
      returns: bigint
    }>
    & Record<'set_market_price(uint64,uint256)void' | 'set_market_price', {
      argsObj: {
        tokenId: bigint | number
        price: bigint | number
      }
      argsTuple: [tokenId: bigint | number, price: bigint | number]
      returns: void
    }>
    & Record<'pause_market(uint64,uint64)void' | 'pause_market', {
      argsObj: {
        tokenId: bigint | number
        pause: bigint | number
      }
      argsTuple: [tokenId: bigint | number, pause: bigint | number]
      returns: void
    }>
    & Record<'deposit(uint64,uint256)void' | 'deposit', {
      argsObj: {
        marketId: bigint | number
        amount: bigint | number
      }
      argsTuple: [marketId: bigint | number, amount: bigint | number]
      returns: void
    }>
    & Record<'withdraw(uint64,uint256)void' | 'withdraw', {
      argsObj: {
        marketId: bigint | number
        amount: bigint | number
      }
      argsTuple: [marketId: bigint | number, amount: bigint | number]
      returns: void
    }>
    & Record<'borrow(uint64,uint256)void' | 'borrow', {
      argsObj: {
        marketId: bigint | number
        amount: bigint | number
      }
      argsTuple: [marketId: bigint | number, amount: bigint | number]
      returns: void
    }>
    & Record<'get_scaled_repay_amount(uint64,uint256)uint256' | 'get_scaled_repay_amount', {
      argsObj: {
        marketId: bigint | number
        amount: bigint | number
      }
      argsTuple: [marketId: bigint | number, amount: bigint | number]
      returns: bigint
    }>
    & Record<'repay(uint64,uint256)void' | 'repay', {
      argsObj: {
        marketId: bigint | number
        amount: bigint | number
      }
      argsTuple: [marketId: bigint | number, amount: bigint | number]
      returns: void
    }>
    & Record<'redeem(uint64,uint256)void' | 'redeem', {
      argsObj: {
        marketId: bigint | number
        amount: bigint | number
      }
      argsTuple: [marketId: bigint | number, amount: bigint | number]
      returns: void
    }>
    & Record<'mint(uint64,uint256)void' | 'mint', {
      argsObj: {
        marketId: bigint | number
        amount: bigint | number
      }
      argsTuple: [marketId: bigint | number, amount: bigint | number]
      returns: void
    }>
    & Record<'sync_user_market_for_price_change(address,uint64)void' | 'sync_user_market_for_price_change', {
      argsObj: {
        userId: string
        marketId: bigint | number
      }
      argsTuple: [userId: string, marketId: bigint | number]
      returns: void
    }>
    & Record<'get_global_user(address)(uint256,uint256,uint64)' | 'get_global_user', {
      argsObj: {
        userId: string
      }
      argsTuple: [userId: string]
      returns: GlobalUserData
    }>
    & Record<'get_global_user_collateral(address)uint256' | 'get_global_user_collateral', {
      argsObj: {
        userId: string
      }
      argsTuple: [userId: string]
      returns: bigint
    }>
    & Record<'get_global_user_health(address,uint64)uint256' | 'get_global_user_health', {
      argsObj: {
        userId: string
        liquidationThreshold: bigint | number
      }
      argsTuple: [userId: string, liquidationThreshold: bigint | number]
      returns: bigint
    }>
    & Record<'liquidate_cross_market(uint64,uint64,address,uint256)void' | 'liquidate_cross_market', {
      argsObj: {
        debtMarketId: bigint | number
        collateralMarketId: bigint | number
        user: string
        debtAmount: bigint | number
      }
      argsTuple: [debtMarketId: bigint | number, collateralMarketId: bigint | number, user: string, debtAmount: bigint | number]
      returns: void
    }>
    & Record<'calculate_cross_market_liquidation_amounts(uint64,uint64,address,uint256)uint256[3]' | 'calculate_cross_market_liquidation_amounts', {
      argsObj: {
        debtMarketId: bigint | number
        collateralMarketId: bigint | number
        user: string
        debtAmount: bigint | number
      }
      argsTuple: [debtMarketId: bigint | number, collateralMarketId: bigint | number, user: string, debtAmount: bigint | number]
      returns: [bigint, bigint, bigint]
    }>
    & Record<'set_version(uint64,uint64)void' | 'set_version', {
      argsObj: {
        contractVersion: bigint | number
        deploymentVersion: bigint | number
      }
      argsTuple: [contractVersion: bigint | number, deploymentVersion: bigint | number]
      returns: void
    }>
    & Record<'grant_upgrader(address)void' | 'grant_upgrader', {
      argsObj: {
        upgrader: string
      }
      argsTuple: [upgrader: string]
      returns: void
    }>
    & Record<'approve_update(bool)void' | 'approve_update', {
      argsObj: {
        approval: boolean
      }
      argsTuple: [approval: boolean]
      returns: void
    }>
  /**
   * Defines the shape of the global and local state of the application.
   */
  state: {
    global: {
      contractVersion?: IntegerState
      deploymentVersion?: IntegerState
      owner?: BinaryState
      paused?: IntegerState
      secondsPerYear?: IntegerState
      stokenAppId?: IntegerState
      updatable?: IntegerState
      upgrader?: BinaryState
    }
  }
}
/**
 * Defines the possible abi call signatures
 */
export type DorkFiLendingPoolSig = keyof DorkFiLendingPool['methods']
/**
 * Defines an object containing all relevant parameters for a single call to the contract. Where TSignature is undefined, a bare call is made
 */
export type TypedCallParams<TSignature extends DorkFiLendingPoolSig | undefined> = {
  method: TSignature
  methodArgs: TSignature extends undefined ? undefined : Array<ABIAppCallArg | undefined>
} & AppClientCallCoreParams & CoreAppCallArgs
/**
 * Defines the arguments required for a bare call
 */
export type BareCallArgs = Omit<RawAppCallArgs, keyof CoreAppCallArgs>
/**
 * Represents a UserData result as a struct
 */
export type UserData = {
  scaledDeposits: bigint
  scaledBorrows: bigint
  depositIndex: bigint
  borrowIndex: bigint
  lastUpdateTime: bigint
  lastPrice: bigint
}
/**
 * Converts the tuple representation of a UserData to the struct representation
 */
export function UserData([scaledDeposits, scaledBorrows, depositIndex, borrowIndex, lastUpdateTime, lastPrice]: [bigint, bigint, bigint, bigint, bigint, bigint] ) {
  return {
    scaledDeposits,
    scaledBorrows,
    depositIndex,
    borrowIndex,
    lastUpdateTime,
    lastPrice,
  }
}
/**
 * Represents a MarketData result as a struct
 */
export type MarketData = {
  paused: boolean
  maxTotalDeposits: bigint
  maxTotalBorrows: bigint
  liquidationBonus: bigint
  collateralFactor: bigint
  liquidationThreshold: bigint
  reserveFactor: bigint
  borrowRate: bigint
  slope: bigint
  totalScaledDeposits: bigint
  totalScaledBorrows: bigint
  depositIndex: bigint
  borrowIndex: bigint
  lastUpdateTime: bigint
  reserves: bigint
  price: bigint
  ntokenId: bigint
  closeFactor: bigint
}
/**
 * Converts the tuple representation of a MarketData to the struct representation
 */
export function MarketData([paused, maxTotalDeposits, maxTotalBorrows, liquidationBonus, collateralFactor, liquidationThreshold, reserveFactor, borrowRate, slope, totalScaledDeposits, totalScaledBorrows, depositIndex, borrowIndex, lastUpdateTime, reserves, price, ntokenId, closeFactor]: [boolean, bigint, bigint, bigint, bigint, bigint, bigint, bigint, bigint, bigint, bigint, bigint, bigint, bigint, bigint, bigint, bigint, bigint] ) {
  return {
    paused,
    maxTotalDeposits,
    maxTotalBorrows,
    liquidationBonus,
    collateralFactor,
    liquidationThreshold,
    reserveFactor,
    borrowRate,
    slope,
    totalScaledDeposits,
    totalScaledBorrows,
    depositIndex,
    borrowIndex,
    lastUpdateTime,
    reserves,
    price,
    ntokenId,
    closeFactor,
  }
}
/**
 * Represents a GlobalUserData result as a struct
 */
export type GlobalUserData = {
  totalCollateralValue: bigint
  totalBorrowValue: bigint
  lastUpdateTime: bigint
}
/**
 * Converts the tuple representation of a GlobalUserData to the struct representation
 */
export function GlobalUserData([totalCollateralValue, totalBorrowValue, lastUpdateTime]: [bigint, bigint, bigint] ) {
  return {
    totalCollateralValue,
    totalBorrowValue,
    lastUpdateTime,
  }
}
/**
 * Maps a method signature from the DorkFiLendingPool smart contract to the method's arguments in either tuple of struct form
 */
export type MethodArgs<TSignature extends DorkFiLendingPoolSig> = DorkFiLendingPool['methods'][TSignature]['argsObj' | 'argsTuple']
/**
 * Maps a method signature from the DorkFiLendingPool smart contract to the method's return type
 */
export type MethodReturn<TSignature extends DorkFiLendingPoolSig> = DorkFiLendingPool['methods'][TSignature]['returns']

/**
 * A factory for available 'create' calls
 */
export type DorkFiLendingPoolCreateCalls = (typeof DorkFiLendingPoolCallFactory)['create']
/**
 * Defines supported create methods for this smart contract
 */
export type DorkFiLendingPoolCreateCallParams =
  | (TypedCallParams<undefined> & (OnCompleteNoOp))
/**
 * A factory for available 'update' calls
 */
export type DorkFiLendingPoolUpdateCalls = (typeof DorkFiLendingPoolCallFactory)['update']
/**
 * Defines supported update methods for this smart contract
 */
export type DorkFiLendingPoolUpdateCallParams =
  | TypedCallParams<undefined>
/**
 * Defines arguments required for the deploy method.
 */
export type DorkFiLendingPoolDeployArgs = {
  deployTimeParams?: TealTemplateParams
  /**
   * A delegate which takes a create call factory and returns the create call params for this smart contract
   */
  createCall?: (callFactory: DorkFiLendingPoolCreateCalls) => DorkFiLendingPoolCreateCallParams
  /**
   * A delegate which takes a update call factory and returns the update call params for this smart contract
   */
  updateCall?: (callFactory: DorkFiLendingPoolUpdateCalls) => DorkFiLendingPoolUpdateCallParams
}


/**
 * Exposes methods for constructing all available smart contract calls
 */
export abstract class DorkFiLendingPoolCallFactory {
  /**
   * Gets available create call factories
   */
  static get create() {
    return {
      /**
       * Constructs a create call for the DorkFiLendingPool smart contract using a bare call
       *
       * @param params Any parameters for the call
       * @returns A TypedCallParams object for the call
       */
      bare(params: BareCallArgs & AppClientCallCoreParams & CoreAppCallArgs & AppClientCompilationParams & (OnCompleteNoOp) = {}) {
        return {
          method: undefined,
          methodArgs: undefined,
          ...params,
        }
      },
    }
  }

  /**
   * Gets available update call factories
   */
  static get update() {
    return {
      /**
       * Constructs an update call for the DorkFiLendingPool smart contract using a bare call
       *
       * @param params Any parameters for the call
       * @returns A TypedCallParams object for the call
       */
      bare(params: BareCallArgs & AppClientCallCoreParams & CoreAppCallArgs & AppClientCompilationParams = {}) {
        return {
          method: undefined,
          methodArgs: undefined,
          ...params,
        }
      },
    }
  }

  /**
   * Constructs a no op call for the post_update()void ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static postUpdate(args: MethodArgs<'post_update()void'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'post_update()void' as const,
      methodArgs: Array.isArray(args) ? args : [],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the get_owner()address ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static getOwner(args: MethodArgs<'get_owner()address'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'get_owner()address' as const,
      methodArgs: Array.isArray(args) ? args : [],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the transfer_ownership(address)void ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static transferOwnership(args: MethodArgs<'transfer_ownership(address)void'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'transfer_ownership(address)void' as const,
      methodArgs: Array.isArray(args) ? args : [args.newOwner],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the is_paused()bool ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static isPaused(args: MethodArgs<'is_paused()bool'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'is_paused()bool' as const,
      methodArgs: Array.isArray(args) ? args : [],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the pause(uint64)void ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static pause(args: MethodArgs<'pause(uint64)void'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'pause(uint64)void' as const,
      methodArgs: Array.isArray(args) ? args : [args.pause],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the get_stoken_app_id()uint64 ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static getStokenAppId(args: MethodArgs<'get_stoken_app_id()uint64'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'get_stoken_app_id()uint64' as const,
      methodArgs: Array.isArray(args) ? args : [],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the set_stoken_app_id(uint64)void ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static setStokenAppId(args: MethodArgs<'set_stoken_app_id(uint64)void'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'set_stoken_app_id(uint64)void' as const,
      methodArgs: Array.isArray(args) ? args : [args.stokenAppId],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the get_user(address,uint64)(uint256,uint256,uint256,uint256,uint64,uint256) ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static getUser(args: MethodArgs<'get_user(address,uint64)(uint256,uint256,uint256,uint256,uint64,uint256)'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'get_user(address,uint64)(uint256,uint256,uint256,uint256,uint64,uint256)' as const,
      methodArgs: Array.isArray(args) ? args : [args.userId, args.marketId],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the create_market(uint64,uint64,uint64,uint64,uint64,uint64,uint256,uint256,uint64,uint64)uint64 ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static createMarket(args: MethodArgs<'create_market(uint64,uint64,uint64,uint64,uint64,uint64,uint256,uint256,uint64,uint64)uint64'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'create_market(uint64,uint64,uint64,uint64,uint64,uint64,uint256,uint256,uint64,uint64)uint64' as const,
      methodArgs: Array.isArray(args) ? args : [args.tokenId, args.collateralFactor, args.liquidationThreshold, args.reserveFactor, args.borrowRate, args.slope, args.maxTotalDeposits, args.maxTotalBorrows, args.liquidationBonus, args.closeFactor],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the create_market_cost()uint64 ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static createMarketCost(args: MethodArgs<'create_market_cost()uint64'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'create_market_cost()uint64' as const,
      methodArgs: Array.isArray(args) ? args : [],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the get_market(uint64)(bool,uint256,uint256,uint64,uint64,uint64,uint64,uint64,uint64,uint256,uint256,uint256,uint256,uint64,uint256,uint256,uint64,uint64) ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static getMarket(args: MethodArgs<'get_market(uint64)(bool,uint256,uint256,uint64,uint64,uint64,uint64,uint64,uint64,uint256,uint256,uint256,uint256,uint64,uint256,uint256,uint64,uint64)'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'get_market(uint64)(bool,uint256,uint256,uint64,uint64,uint64,uint64,uint64,uint64,uint256,uint256,uint256,uint256,uint64,uint256,uint256,uint64,uint64)' as const,
      methodArgs: Array.isArray(args) ? args : [args.tokenId],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the get_market_price(uint64)uint256 ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static getMarketPrice(args: MethodArgs<'get_market_price(uint64)uint256'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'get_market_price(uint64)uint256' as const,
      methodArgs: Array.isArray(args) ? args : [args.tokenId],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the get_market_ntoken_id(uint64)uint64 ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static getMarketNtokenId(args: MethodArgs<'get_market_ntoken_id(uint64)uint64'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'get_market_ntoken_id(uint64)uint64' as const,
      methodArgs: Array.isArray(args) ? args : [args.tokenId],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the set_market_price(uint64,uint256)void ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static setMarketPrice(args: MethodArgs<'set_market_price(uint64,uint256)void'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'set_market_price(uint64,uint256)void' as const,
      methodArgs: Array.isArray(args) ? args : [args.tokenId, args.price],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the pause_market(uint64,uint64)void ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static pauseMarket(args: MethodArgs<'pause_market(uint64,uint64)void'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'pause_market(uint64,uint64)void' as const,
      methodArgs: Array.isArray(args) ? args : [args.tokenId, args.pause],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the deposit(uint64,uint256)void ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static deposit(args: MethodArgs<'deposit(uint64,uint256)void'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'deposit(uint64,uint256)void' as const,
      methodArgs: Array.isArray(args) ? args : [args.marketId, args.amount],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the withdraw(uint64,uint256)void ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static withdraw(args: MethodArgs<'withdraw(uint64,uint256)void'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'withdraw(uint64,uint256)void' as const,
      methodArgs: Array.isArray(args) ? args : [args.marketId, args.amount],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the borrow(uint64,uint256)void ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static borrow(args: MethodArgs<'borrow(uint64,uint256)void'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'borrow(uint64,uint256)void' as const,
      methodArgs: Array.isArray(args) ? args : [args.marketId, args.amount],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the get_scaled_repay_amount(uint64,uint256)uint256 ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static getScaledRepayAmount(args: MethodArgs<'get_scaled_repay_amount(uint64,uint256)uint256'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'get_scaled_repay_amount(uint64,uint256)uint256' as const,
      methodArgs: Array.isArray(args) ? args : [args.marketId, args.amount],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the repay(uint64,uint256)void ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static repay(args: MethodArgs<'repay(uint64,uint256)void'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'repay(uint64,uint256)void' as const,
      methodArgs: Array.isArray(args) ? args : [args.marketId, args.amount],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the redeem(uint64,uint256)void ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static redeem(args: MethodArgs<'redeem(uint64,uint256)void'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'redeem(uint64,uint256)void' as const,
      methodArgs: Array.isArray(args) ? args : [args.marketId, args.amount],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the mint(uint64,uint256)void ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static mint(args: MethodArgs<'mint(uint64,uint256)void'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'mint(uint64,uint256)void' as const,
      methodArgs: Array.isArray(args) ? args : [args.marketId, args.amount],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the sync_user_market_for_price_change(address,uint64)void ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static syncUserMarketForPriceChange(args: MethodArgs<'sync_user_market_for_price_change(address,uint64)void'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'sync_user_market_for_price_change(address,uint64)void' as const,
      methodArgs: Array.isArray(args) ? args : [args.userId, args.marketId],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the get_global_user(address)(uint256,uint256,uint64) ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static getGlobalUser(args: MethodArgs<'get_global_user(address)(uint256,uint256,uint64)'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'get_global_user(address)(uint256,uint256,uint64)' as const,
      methodArgs: Array.isArray(args) ? args : [args.userId],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the get_global_user_collateral(address)uint256 ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static getGlobalUserCollateral(args: MethodArgs<'get_global_user_collateral(address)uint256'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'get_global_user_collateral(address)uint256' as const,
      methodArgs: Array.isArray(args) ? args : [args.userId],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the get_global_user_health(address,uint64)uint256 ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static getGlobalUserHealth(args: MethodArgs<'get_global_user_health(address,uint64)uint256'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'get_global_user_health(address,uint64)uint256' as const,
      methodArgs: Array.isArray(args) ? args : [args.userId, args.liquidationThreshold],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the liquidate_cross_market(uint64,uint64,address,uint256)void ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static liquidateCrossMarket(args: MethodArgs<'liquidate_cross_market(uint64,uint64,address,uint256)void'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'liquidate_cross_market(uint64,uint64,address,uint256)void' as const,
      methodArgs: Array.isArray(args) ? args : [args.debtMarketId, args.collateralMarketId, args.user, args.debtAmount],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the calculate_cross_market_liquidation_amounts(uint64,uint64,address,uint256)uint256[3] ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static calculateCrossMarketLiquidationAmounts(args: MethodArgs<'calculate_cross_market_liquidation_amounts(uint64,uint64,address,uint256)uint256[3]'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'calculate_cross_market_liquidation_amounts(uint64,uint64,address,uint256)uint256[3]' as const,
      methodArgs: Array.isArray(args) ? args : [args.debtMarketId, args.collateralMarketId, args.user, args.debtAmount],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the set_version(uint64,uint64)void ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static setVersion(args: MethodArgs<'set_version(uint64,uint64)void'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'set_version(uint64,uint64)void' as const,
      methodArgs: Array.isArray(args) ? args : [args.contractVersion, args.deploymentVersion],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the grant_upgrader(address)void ABI method
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static grantUpgrader(args: MethodArgs<'grant_upgrader(address)void'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'grant_upgrader(address)void' as const,
      methodArgs: Array.isArray(args) ? args : [args.upgrader],
      ...params,
    }
  }
  /**
   * Constructs a no op call for the approve_update(bool)void ABI method
   *
   * Approve update.
   *
   * @param args Any args for the contract call
   * @param params Any additional parameters for the call
   * @returns A TypedCallParams object for the call
   */
  static approveUpdate(args: MethodArgs<'approve_update(bool)void'>, params: AppClientCallCoreParams & CoreAppCallArgs) {
    return {
      method: 'approve_update(bool)void' as const,
      methodArgs: Array.isArray(args) ? args : [args.approval],
      ...params,
    }
  }
}

/**
 * A client to make calls to the DorkFiLendingPool smart contract
 */
export class DorkFiLendingPoolClient {
  /**
   * The underlying `ApplicationClient` for when you want to have more flexibility
   */
  public readonly appClient: ApplicationClient

  private readonly sender: SendTransactionFrom | undefined

  /**
   * Creates a new instance of `DorkFiLendingPoolClient`
   *
   * @param appDetails appDetails The details to identify the app to deploy
   * @param algod An algod client instance
   */
  constructor(appDetails: AppDetails, private algod: Algodv2) {
    this.sender = appDetails.sender
    this.appClient = algokit.getAppClient({
      ...appDetails,
      app: APP_SPEC
    }, algod)
  }

  /**
   * Checks for decode errors on the AppCallTransactionResult and maps the return value to the specified generic type
   *
   * @param result The AppCallTransactionResult to be mapped
   * @param returnValueFormatter An optional delegate to format the return value if required
   * @returns The smart contract response with an updated return value
   */
  protected mapReturnValue<TReturn, TResult extends AppCallTransactionResult = AppCallTransactionResult>(result: AppCallTransactionResult, returnValueFormatter?: (value: any) => TReturn): AppCallTransactionResultOfType<TReturn> & TResult {
    if(result.return?.decodeError) {
      throw result.return.decodeError
    }
    const returnValue = result.return?.returnValue !== undefined && returnValueFormatter !== undefined
      ? returnValueFormatter(result.return.returnValue)
      : result.return?.returnValue as TReturn | undefined
      return { ...result, return: returnValue } as AppCallTransactionResultOfType<TReturn> & TResult
  }

  /**
   * Calls the ABI method with the matching signature using an onCompletion code of NO_OP
   *
   * @param typedCallParams An object containing the method signature, args, and any other relevant parameters
   * @param returnValueFormatter An optional delegate which when provided will be used to map non-undefined return values to the target type
   * @returns The result of the smart contract call
   */
  public async call<TSignature extends keyof DorkFiLendingPool['methods']>(typedCallParams: TypedCallParams<TSignature>, returnValueFormatter?: (value: any) => MethodReturn<TSignature>) {
    return this.mapReturnValue<MethodReturn<TSignature>>(await this.appClient.call(typedCallParams), returnValueFormatter)
  }

  /**
   * Idempotently deploys the DorkFiLendingPool smart contract.
   *
   * @param params The arguments for the contract calls and any additional parameters for the call
   * @returns The deployment result
   */
  public deploy(params: DorkFiLendingPoolDeployArgs & AppClientDeployCoreParams = {}): ReturnType<ApplicationClient['deploy']> {
    const createArgs = params.createCall?.(DorkFiLendingPoolCallFactory.create)
    const updateArgs = params.updateCall?.(DorkFiLendingPoolCallFactory.update)
    return this.appClient.deploy({
      ...params,
      updateArgs,
      createArgs,
      createOnCompleteAction: createArgs?.onCompleteAction,
    })
  }

  /**
   * Gets available create methods
   */
  public get create() {
    const $this = this
    return {
      /**
       * Creates a new instance of the DorkFiLendingPool smart contract using a bare call.
       *
       * @param args The arguments for the bare call
       * @returns The create result
       */
      async bare(args: BareCallArgs & AppClientCallCoreParams & AppClientCompilationParams & CoreAppCallArgs & (OnCompleteNoOp) = {}) {
        return $this.mapReturnValue<undefined, AppCreateCallTransactionResult>(await $this.appClient.create(args))
      },
    }
  }

  /**
   * Gets available update methods
   */
  public get update() {
    const $this = this
    return {
      /**
       * Updates an existing instance of the DorkFiLendingPool smart contract using a bare call.
       *
       * @param args The arguments for the bare call
       * @returns The update result
       */
      async bare(args: BareCallArgs & AppClientCallCoreParams & AppClientCompilationParams & CoreAppCallArgs = {}) {
        return $this.mapReturnValue<undefined, AppUpdateCallTransactionResult>(await $this.appClient.update(args))
      },
    }
  }

  /**
   * Makes a clear_state call to an existing instance of the DorkFiLendingPool smart contract.
   *
   * @param args The arguments for the bare call
   * @returns The clear_state result
   */
  public clearState(args: BareCallArgs & AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.appClient.clearState(args)
  }

  /**
   * Calls the post_update()void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public postUpdate(args: MethodArgs<'post_update()void'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.postUpdate(args, params))
  }

  /**
   * Calls the get_owner()address ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public getOwner(args: MethodArgs<'get_owner()address'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.getOwner(args, params))
  }

  /**
   * Calls the transfer_ownership(address)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public transferOwnership(args: MethodArgs<'transfer_ownership(address)void'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.transferOwnership(args, params))
  }

  /**
   * Calls the is_paused()bool ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public isPaused(args: MethodArgs<'is_paused()bool'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.isPaused(args, params))
  }

  /**
   * Calls the pause(uint64)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public pause(args: MethodArgs<'pause(uint64)void'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.pause(args, params))
  }

  /**
   * Calls the get_stoken_app_id()uint64 ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public getStokenAppId(args: MethodArgs<'get_stoken_app_id()uint64'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.getStokenAppId(args, params))
  }

  /**
   * Calls the set_stoken_app_id(uint64)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public setStokenAppId(args: MethodArgs<'set_stoken_app_id(uint64)void'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.setStokenAppId(args, params))
  }

  /**
   * Calls the get_user(address,uint64)(uint256,uint256,uint256,uint256,uint64,uint256) ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public getUser(args: MethodArgs<'get_user(address,uint64)(uint256,uint256,uint256,uint256,uint64,uint256)'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.getUser(args, params), UserData)
  }

  /**
   * Calls the create_market(uint64,uint64,uint64,uint64,uint64,uint64,uint256,uint256,uint64,uint64)uint64 ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public createMarket(args: MethodArgs<'create_market(uint64,uint64,uint64,uint64,uint64,uint64,uint256,uint256,uint64,uint64)uint64'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.createMarket(args, params))
  }

  /**
   * Calls the create_market_cost()uint64 ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public createMarketCost(args: MethodArgs<'create_market_cost()uint64'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.createMarketCost(args, params))
  }

  /**
   * Calls the get_market(uint64)(bool,uint256,uint256,uint64,uint64,uint64,uint64,uint64,uint64,uint256,uint256,uint256,uint256,uint64,uint256,uint256,uint64,uint64) ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public getMarket(args: MethodArgs<'get_market(uint64)(bool,uint256,uint256,uint64,uint64,uint64,uint64,uint64,uint64,uint256,uint256,uint256,uint256,uint64,uint256,uint256,uint64,uint64)'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.getMarket(args, params), MarketData)
  }

  /**
   * Calls the get_market_price(uint64)uint256 ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public getMarketPrice(args: MethodArgs<'get_market_price(uint64)uint256'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.getMarketPrice(args, params))
  }

  /**
   * Calls the get_market_ntoken_id(uint64)uint64 ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public getMarketNtokenId(args: MethodArgs<'get_market_ntoken_id(uint64)uint64'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.getMarketNtokenId(args, params))
  }

  /**
   * Calls the set_market_price(uint64,uint256)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public setMarketPrice(args: MethodArgs<'set_market_price(uint64,uint256)void'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.setMarketPrice(args, params))
  }

  /**
   * Calls the pause_market(uint64,uint64)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public pauseMarket(args: MethodArgs<'pause_market(uint64,uint64)void'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.pauseMarket(args, params))
  }

  /**
   * Calls the deposit(uint64,uint256)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public deposit(args: MethodArgs<'deposit(uint64,uint256)void'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.deposit(args, params))
  }

  /**
   * Calls the withdraw(uint64,uint256)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public withdraw(args: MethodArgs<'withdraw(uint64,uint256)void'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.withdraw(args, params))
  }

  /**
   * Calls the borrow(uint64,uint256)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public borrow(args: MethodArgs<'borrow(uint64,uint256)void'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.borrow(args, params))
  }

  /**
   * Calls the get_scaled_repay_amount(uint64,uint256)uint256 ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public getScaledRepayAmount(args: MethodArgs<'get_scaled_repay_amount(uint64,uint256)uint256'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.getScaledRepayAmount(args, params))
  }

  /**
   * Calls the repay(uint64,uint256)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public repay(args: MethodArgs<'repay(uint64,uint256)void'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.repay(args, params))
  }

  /**
   * Calls the redeem(uint64,uint256)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public redeem(args: MethodArgs<'redeem(uint64,uint256)void'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.redeem(args, params))
  }

  /**
   * Calls the mint(uint64,uint256)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public mint(args: MethodArgs<'mint(uint64,uint256)void'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.mint(args, params))
  }

  /**
   * Calls the sync_user_market_for_price_change(address,uint64)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public syncUserMarketForPriceChange(args: MethodArgs<'sync_user_market_for_price_change(address,uint64)void'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.syncUserMarketForPriceChange(args, params))
  }

  /**
   * Calls the get_global_user(address)(uint256,uint256,uint64) ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public getGlobalUser(args: MethodArgs<'get_global_user(address)(uint256,uint256,uint64)'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.getGlobalUser(args, params), GlobalUserData)
  }

  /**
   * Calls the get_global_user_collateral(address)uint256 ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public getGlobalUserCollateral(args: MethodArgs<'get_global_user_collateral(address)uint256'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.getGlobalUserCollateral(args, params))
  }

  /**
   * Calls the get_global_user_health(address,uint64)uint256 ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public getGlobalUserHealth(args: MethodArgs<'get_global_user_health(address,uint64)uint256'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.getGlobalUserHealth(args, params))
  }

  /**
   * Calls the liquidate_cross_market(uint64,uint64,address,uint256)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public liquidateCrossMarket(args: MethodArgs<'liquidate_cross_market(uint64,uint64,address,uint256)void'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.liquidateCrossMarket(args, params))
  }

  /**
   * Calls the calculate_cross_market_liquidation_amounts(uint64,uint64,address,uint256)uint256[3] ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public calculateCrossMarketLiquidationAmounts(args: MethodArgs<'calculate_cross_market_liquidation_amounts(uint64,uint64,address,uint256)uint256[3]'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.calculateCrossMarketLiquidationAmounts(args, params))
  }

  /**
   * Calls the set_version(uint64,uint64)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public setVersion(args: MethodArgs<'set_version(uint64,uint64)void'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.setVersion(args, params))
  }

  /**
   * Calls the grant_upgrader(address)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public grantUpgrader(args: MethodArgs<'grant_upgrader(address)void'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.grantUpgrader(args, params))
  }

  /**
   * Calls the approve_update(bool)void ABI method.
   *
   * Approve update.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The result of the call
   */
  public approveUpdate(args: MethodArgs<'approve_update(bool)void'>, params: AppClientCallCoreParams & CoreAppCallArgs = {}) {
    return this.call(DorkFiLendingPoolCallFactory.approveUpdate(args, params))
  }

  /**
   * Extracts a binary state value out of an AppState dictionary
   *
   * @param state The state dictionary containing the state value
   * @param key The key of the state value
   * @returns A BinaryState instance containing the state value, or undefined if the key was not found
   */
  private static getBinaryState(state: AppState, key: string): BinaryState | undefined {
    const value = state[key]
    if (!value) return undefined
    if (!('valueRaw' in value))
      throw new Error(`Failed to parse state value for ${key}; received an int when expected a byte array`)
    return {
      asString(): string {
        return value.value
      },
      asByteArray(): Uint8Array {
        return value.valueRaw
      }
    }
  }

  /**
   * Extracts a integer state value out of an AppState dictionary
   *
   * @param state The state dictionary containing the state value
   * @param key The key of the state value
   * @returns An IntegerState instance containing the state value, or undefined if the key was not found
   */
  private static getIntegerState(state: AppState, key: string): IntegerState | undefined {
    const value = state[key]
    if (!value) return undefined
    if ('valueRaw' in value)
      throw new Error(`Failed to parse state value for ${key}; received a byte array when expected a number`)
    return {
      asBigInt() {
        return typeof value.value === 'bigint' ? value.value : BigInt(value.value)
      },
      asNumber(): number {
        return typeof value.value === 'bigint' ? Number(value.value) : value.value
      },
    }
  }

  /**
   * Returns the smart contract's global state wrapped in a strongly typed accessor with options to format the stored value
   */
  public async getGlobalState(): Promise<DorkFiLendingPool['state']['global']> {
    const state = await this.appClient.getGlobalState()
    return {
      get contractVersion() {
        return DorkFiLendingPoolClient.getIntegerState(state, 'contract_version')
      },
      get deploymentVersion() {
        return DorkFiLendingPoolClient.getIntegerState(state, 'deployment_version')
      },
      get owner() {
        return DorkFiLendingPoolClient.getBinaryState(state, 'owner')
      },
      get paused() {
        return DorkFiLendingPoolClient.getIntegerState(state, 'paused')
      },
      get secondsPerYear() {
        return DorkFiLendingPoolClient.getIntegerState(state, 'seconds_per_year')
      },
      get stokenAppId() {
        return DorkFiLendingPoolClient.getIntegerState(state, 'stoken_app_id')
      },
      get updatable() {
        return DorkFiLendingPoolClient.getIntegerState(state, 'updatable')
      },
      get upgrader() {
        return DorkFiLendingPoolClient.getBinaryState(state, 'upgrader')
      },
    }
  }

  public compose(): DorkFiLendingPoolComposer {
    const client = this
    const atc = new AtomicTransactionComposer()
    let promiseChain:Promise<unknown> = Promise.resolve()
    const resultMappers: Array<undefined | ((x: any) => any)> = []
    return {
      postUpdate(args: MethodArgs<'post_update()void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.postUpdate(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      getOwner(args: MethodArgs<'get_owner()address'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.getOwner(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      transferOwnership(args: MethodArgs<'transfer_ownership(address)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.transferOwnership(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      isPaused(args: MethodArgs<'is_paused()bool'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.isPaused(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      pause(args: MethodArgs<'pause(uint64)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.pause(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      getStokenAppId(args: MethodArgs<'get_stoken_app_id()uint64'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.getStokenAppId(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      setStokenAppId(args: MethodArgs<'set_stoken_app_id(uint64)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.setStokenAppId(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      getUser(args: MethodArgs<'get_user(address,uint64)(uint256,uint256,uint256,uint256,uint64,uint256)'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.getUser(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(UserData)
        return this
      },
      createMarket(args: MethodArgs<'create_market(uint64,uint64,uint64,uint64,uint64,uint64,uint256,uint256,uint64,uint64)uint64'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.createMarket(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      createMarketCost(args: MethodArgs<'create_market_cost()uint64'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.createMarketCost(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      getMarket(args: MethodArgs<'get_market(uint64)(bool,uint256,uint256,uint64,uint64,uint64,uint64,uint64,uint64,uint256,uint256,uint256,uint256,uint64,uint256,uint256,uint64,uint64)'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.getMarket(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(MarketData)
        return this
      },
      getMarketPrice(args: MethodArgs<'get_market_price(uint64)uint256'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.getMarketPrice(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      getMarketNtokenId(args: MethodArgs<'get_market_ntoken_id(uint64)uint64'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.getMarketNtokenId(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      setMarketPrice(args: MethodArgs<'set_market_price(uint64,uint256)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.setMarketPrice(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      pauseMarket(args: MethodArgs<'pause_market(uint64,uint64)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.pauseMarket(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      deposit(args: MethodArgs<'deposit(uint64,uint256)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.deposit(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      withdraw(args: MethodArgs<'withdraw(uint64,uint256)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.withdraw(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      borrow(args: MethodArgs<'borrow(uint64,uint256)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.borrow(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      getScaledRepayAmount(args: MethodArgs<'get_scaled_repay_amount(uint64,uint256)uint256'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.getScaledRepayAmount(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      repay(args: MethodArgs<'repay(uint64,uint256)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.repay(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      redeem(args: MethodArgs<'redeem(uint64,uint256)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.redeem(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      mint(args: MethodArgs<'mint(uint64,uint256)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.mint(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      syncUserMarketForPriceChange(args: MethodArgs<'sync_user_market_for_price_change(address,uint64)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.syncUserMarketForPriceChange(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      getGlobalUser(args: MethodArgs<'get_global_user(address)(uint256,uint256,uint64)'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.getGlobalUser(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(GlobalUserData)
        return this
      },
      getGlobalUserCollateral(args: MethodArgs<'get_global_user_collateral(address)uint256'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.getGlobalUserCollateral(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      getGlobalUserHealth(args: MethodArgs<'get_global_user_health(address,uint64)uint256'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.getGlobalUserHealth(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      liquidateCrossMarket(args: MethodArgs<'liquidate_cross_market(uint64,uint64,address,uint256)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.liquidateCrossMarket(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      calculateCrossMarketLiquidationAmounts(args: MethodArgs<'calculate_cross_market_liquidation_amounts(uint64,uint64,address,uint256)uint256[3]'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.calculateCrossMarketLiquidationAmounts(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      setVersion(args: MethodArgs<'set_version(uint64,uint64)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.setVersion(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      grantUpgrader(args: MethodArgs<'grant_upgrader(address)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.grantUpgrader(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      approveUpdate(args: MethodArgs<'approve_update(bool)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.approveUpdate(args, {...params, sendParams: {...params?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      get update() {
        const $this = this
        return {
          bare(args?: BareCallArgs & AppClientComposeCallCoreParams & AppClientCompilationParams & CoreAppCallArgs) {
            promiseChain = promiseChain.then(() => client.update.bare({...args, sendParams: {...args?.sendParams, skipSending: true, atc}}))
            resultMappers.push(undefined)
            return $this
          },
        }
      },
      clearState(args?: BareCallArgs & AppClientComposeCallCoreParams & CoreAppCallArgs) {
        promiseChain = promiseChain.then(() => client.clearState({...args, sendParams: {...args?.sendParams, skipSending: true, atc}}))
        resultMappers.push(undefined)
        return this
      },
      addTransaction(txn: TransactionWithSigner | TransactionToSign | Transaction | Promise<SendTransactionResult>, defaultSender?: SendTransactionFrom) {
        promiseChain = promiseChain.then(async () => atc.addTransaction(await algokit.getTransactionWithSigner(txn, defaultSender ?? client.sender)))
        return this
      },
      async atc() {
        await promiseChain
        return atc
      },
      async simulate(options?: SimulateOptions) {
        await promiseChain
        const result = await atc.simulate(client.algod, new modelsv2.SimulateRequest({ txnGroups: [], ...options }))
        return {
          ...result,
          returns: result.methodResults?.map((val, i) => resultMappers[i] !== undefined ? resultMappers[i]!(val.returnValue) : val.returnValue)
        }
      },
      async execute(sendParams?: AppClientComposeExecuteParams) {
        await promiseChain
        const result = await algokit.sendAtomicTransactionComposer({ atc, sendParams }, client.algod)
        return {
          ...result,
          returns: result.returns?.map((val, i) => resultMappers[i] !== undefined ? resultMappers[i]!(val.returnValue) : val.returnValue)
        }
      }
    } as unknown as DorkFiLendingPoolComposer
  }
}
export type DorkFiLendingPoolComposer<TReturns extends [...any[]] = []> = {
  /**
   * Calls the post_update()void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  postUpdate(args: MethodArgs<'post_update()void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'post_update()void'>]>

  /**
   * Calls the get_owner()address ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  getOwner(args: MethodArgs<'get_owner()address'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'get_owner()address'>]>

  /**
   * Calls the transfer_ownership(address)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  transferOwnership(args: MethodArgs<'transfer_ownership(address)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'transfer_ownership(address)void'>]>

  /**
   * Calls the is_paused()bool ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  isPaused(args: MethodArgs<'is_paused()bool'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'is_paused()bool'>]>

  /**
   * Calls the pause(uint64)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  pause(args: MethodArgs<'pause(uint64)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'pause(uint64)void'>]>

  /**
   * Calls the get_stoken_app_id()uint64 ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  getStokenAppId(args: MethodArgs<'get_stoken_app_id()uint64'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'get_stoken_app_id()uint64'>]>

  /**
   * Calls the set_stoken_app_id(uint64)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  setStokenAppId(args: MethodArgs<'set_stoken_app_id(uint64)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'set_stoken_app_id(uint64)void'>]>

  /**
   * Calls the get_user(address,uint64)(uint256,uint256,uint256,uint256,uint64,uint256) ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  getUser(args: MethodArgs<'get_user(address,uint64)(uint256,uint256,uint256,uint256,uint64,uint256)'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'get_user(address,uint64)(uint256,uint256,uint256,uint256,uint64,uint256)'>]>

  /**
   * Calls the create_market(uint64,uint64,uint64,uint64,uint64,uint64,uint256,uint256,uint64,uint64)uint64 ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  createMarket(args: MethodArgs<'create_market(uint64,uint64,uint64,uint64,uint64,uint64,uint256,uint256,uint64,uint64)uint64'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'create_market(uint64,uint64,uint64,uint64,uint64,uint64,uint256,uint256,uint64,uint64)uint64'>]>

  /**
   * Calls the create_market_cost()uint64 ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  createMarketCost(args: MethodArgs<'create_market_cost()uint64'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'create_market_cost()uint64'>]>

  /**
   * Calls the get_market(uint64)(bool,uint256,uint256,uint64,uint64,uint64,uint64,uint64,uint64,uint256,uint256,uint256,uint256,uint64,uint256,uint256,uint64,uint64) ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  getMarket(args: MethodArgs<'get_market(uint64)(bool,uint256,uint256,uint64,uint64,uint64,uint64,uint64,uint64,uint256,uint256,uint256,uint256,uint64,uint256,uint256,uint64,uint64)'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'get_market(uint64)(bool,uint256,uint256,uint64,uint64,uint64,uint64,uint64,uint64,uint256,uint256,uint256,uint256,uint64,uint256,uint256,uint64,uint64)'>]>

  /**
   * Calls the get_market_price(uint64)uint256 ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  getMarketPrice(args: MethodArgs<'get_market_price(uint64)uint256'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'get_market_price(uint64)uint256'>]>

  /**
   * Calls the get_market_ntoken_id(uint64)uint64 ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  getMarketNtokenId(args: MethodArgs<'get_market_ntoken_id(uint64)uint64'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'get_market_ntoken_id(uint64)uint64'>]>

  /**
   * Calls the set_market_price(uint64,uint256)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  setMarketPrice(args: MethodArgs<'set_market_price(uint64,uint256)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'set_market_price(uint64,uint256)void'>]>

  /**
   * Calls the pause_market(uint64,uint64)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  pauseMarket(args: MethodArgs<'pause_market(uint64,uint64)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'pause_market(uint64,uint64)void'>]>

  /**
   * Calls the deposit(uint64,uint256)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  deposit(args: MethodArgs<'deposit(uint64,uint256)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'deposit(uint64,uint256)void'>]>

  /**
   * Calls the withdraw(uint64,uint256)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  withdraw(args: MethodArgs<'withdraw(uint64,uint256)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'withdraw(uint64,uint256)void'>]>

  /**
   * Calls the borrow(uint64,uint256)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  borrow(args: MethodArgs<'borrow(uint64,uint256)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'borrow(uint64,uint256)void'>]>

  /**
   * Calls the get_scaled_repay_amount(uint64,uint256)uint256 ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  getScaledRepayAmount(args: MethodArgs<'get_scaled_repay_amount(uint64,uint256)uint256'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'get_scaled_repay_amount(uint64,uint256)uint256'>]>

  /**
   * Calls the repay(uint64,uint256)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  repay(args: MethodArgs<'repay(uint64,uint256)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'repay(uint64,uint256)void'>]>

  /**
   * Calls the redeem(uint64,uint256)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  redeem(args: MethodArgs<'redeem(uint64,uint256)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'redeem(uint64,uint256)void'>]>

  /**
   * Calls the mint(uint64,uint256)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  mint(args: MethodArgs<'mint(uint64,uint256)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'mint(uint64,uint256)void'>]>

  /**
   * Calls the sync_user_market_for_price_change(address,uint64)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  syncUserMarketForPriceChange(args: MethodArgs<'sync_user_market_for_price_change(address,uint64)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'sync_user_market_for_price_change(address,uint64)void'>]>

  /**
   * Calls the get_global_user(address)(uint256,uint256,uint64) ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  getGlobalUser(args: MethodArgs<'get_global_user(address)(uint256,uint256,uint64)'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'get_global_user(address)(uint256,uint256,uint64)'>]>

  /**
   * Calls the get_global_user_collateral(address)uint256 ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  getGlobalUserCollateral(args: MethodArgs<'get_global_user_collateral(address)uint256'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'get_global_user_collateral(address)uint256'>]>

  /**
   * Calls the get_global_user_health(address,uint64)uint256 ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  getGlobalUserHealth(args: MethodArgs<'get_global_user_health(address,uint64)uint256'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'get_global_user_health(address,uint64)uint256'>]>

  /**
   * Calls the liquidate_cross_market(uint64,uint64,address,uint256)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  liquidateCrossMarket(args: MethodArgs<'liquidate_cross_market(uint64,uint64,address,uint256)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'liquidate_cross_market(uint64,uint64,address,uint256)void'>]>

  /**
   * Calls the calculate_cross_market_liquidation_amounts(uint64,uint64,address,uint256)uint256[3] ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  calculateCrossMarketLiquidationAmounts(args: MethodArgs<'calculate_cross_market_liquidation_amounts(uint64,uint64,address,uint256)uint256[3]'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'calculate_cross_market_liquidation_amounts(uint64,uint64,address,uint256)uint256[3]'>]>

  /**
   * Calls the set_version(uint64,uint64)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  setVersion(args: MethodArgs<'set_version(uint64,uint64)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'set_version(uint64,uint64)void'>]>

  /**
   * Calls the grant_upgrader(address)void ABI method.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  grantUpgrader(args: MethodArgs<'grant_upgrader(address)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'grant_upgrader(address)void'>]>

  /**
   * Calls the approve_update(bool)void ABI method.
   *
   * Approve update.
   *
   * @param args The arguments for the contract call
   * @param params Any additional parameters for the call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  approveUpdate(args: MethodArgs<'approve_update(bool)void'>, params?: AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, MethodReturn<'approve_update(bool)void'>]>

  /**
   * Gets available update methods
   */
  readonly update: {
    /**
     * Updates an existing instance of the DorkFiLendingPool smart contract using a bare call.
     *
     * @param args The arguments for the bare call
     * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
     */
    bare(args?: BareCallArgs & AppClientComposeCallCoreParams & AppClientCompilationParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, undefined]>
  }

  /**
   * Makes a clear_state call to an existing instance of the DorkFiLendingPool smart contract.
   *
   * @param args The arguments for the bare call
   * @returns The typed transaction composer so you can fluently chain multiple calls or call execute to execute all queued up transactions
   */
  clearState(args?: BareCallArgs & AppClientComposeCallCoreParams & CoreAppCallArgs): DorkFiLendingPoolComposer<[...TReturns, undefined]>

  /**
   * Adds a transaction to the composer
   *
   * @param txn One of: A TransactionWithSigner object (returned as is), a TransactionToSign object (signer is obtained from the signer property), a Transaction object (signer is extracted from the defaultSender parameter), an async SendTransactionResult returned by one of algokit utils helpers (signer is obtained from the defaultSender parameter)
   * @param defaultSender The default sender to be used to obtain a signer where the object provided to the transaction parameter does not include a signer.
   */
  addTransaction(txn: TransactionWithSigner | TransactionToSign | Transaction | Promise<SendTransactionResult>, defaultSender?: SendTransactionFrom): DorkFiLendingPoolComposer<TReturns>
  /**
   * Returns the underlying AtomicTransactionComposer instance
   */
  atc(): Promise<AtomicTransactionComposer>
  /**
   * Simulates the transaction group and returns the result
   */
  simulate(options?: SimulateOptions): Promise<DorkFiLendingPoolComposerSimulateResult<TReturns>>
  /**
   * Executes the transaction group and returns the results
   */
  execute(sendParams?: AppClientComposeExecuteParams): Promise<DorkFiLendingPoolComposerResults<TReturns>>
}
export type SimulateOptions = Omit<ConstructorParameters<typeof modelsv2.SimulateRequest>[0], 'txnGroups'>
export type DorkFiLendingPoolComposerSimulateResult<TReturns extends [...any[]]> = {
  returns: TReturns
  methodResults: ABIResult[]
  simulateResponse: modelsv2.SimulateResponse
}
export type DorkFiLendingPoolComposerResults<TReturns extends [...any[]]> = {
  returns: TReturns
  groupId: string
  txIds: string[]
  transactions: Transaction[]
}
